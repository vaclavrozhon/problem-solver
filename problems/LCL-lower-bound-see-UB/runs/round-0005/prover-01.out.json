{
  "progress_md": "Round 0005 \u2014 Parametric, radius-1 rule schemas (directional tokens adopted), B=2 instantiation blueprint, and finite-length canonical contexts\n\nContext and objective\n- We continue the NEXPTIME-hardness program via Succinct 3-Coloring (S3Col) by finalizing DP-auditable, radius-1 rule schemas for: (i) deterministic per-bit boundary probes that separate 2^B canonical vertex types; (ii) per-side color gating; (iii) seam activation via directional tokens Tok\u2192/Tok\u2190 with a local verdict enforcing simultaneously EDGE and Eq; and (iv) a bridging policy that either vacuously holds (inactive/mixed) or reduces to the same local seam constraints regardless of repetition z. We also provide a B=2 symbol list and explicit Cout\u2013out fragments sufficient for a DP check.\n- Minor gaps to output.md: (1) Please add a parenthetical note that types E_w(a) are computed with respect to fixed interior inputs (our PORT.RIDbit copies the fixed \u03a3_in). (2) When feasible functions are used, it helps to define the context set C explicitly as those types realized by w_1 S w_2 with |w_i| \u2208 {\u2113_pump, \u2113_pump+1}; hence |C| \u2264 \u2113_pump. (We do not edit output.md, only flagging these clarifications.)\n\nA) Per-bit probe (Type-Separation) \u2014 explicit radius-1 rules (deterministic, no escape)\nSymbols/tracks used (folded via disjoint roles; sizes add):\n- Roles: {PAD, HEAD, PORT, PROBE, RUN, VERD, ERR, S} \u00d7 Phase\u2208[c0] (constant c0).\n- PORT subtracks: Addr\u2208{1,\u2026,B}, RIDbit\u2208{0,1}.\n- Probe states per j\u2208[B]: Start_j, Head_j, Test_j, Accept_j (role=PROBE).\n- Boundary outputs: For the 4 boundary positions, reserve B 4-tuples Q_j. We refer to the second-from-left boundary output as BL2_j for injection.\n- Cin\u2013out: PORT cells have (input b, output RIDbit=b) allowed for b\u2208{0,1}. Non-PORT roles ignore RIDbit in Cin\u2013out; ERR and PAD accept any input (standard).\n- PORT well-formedness and contiguity: Allowed PORT\u2013PORT Cout\u2013out pairs on interior edges are exactly (P(k,\u00b7) \u2192 P(k+1,\u00b7)) for k=1,\u2026,B\u22121; no other PORT adjacency allowed. The unique PORT block abuts S.\nCout\u2013out rules (parametric in j):\n- Injection: (BL2_j \u2192 Start_j) is the only allowed successor from BL2_j.\n- March: For any non-PORT y, allow (Head_j \u2192 Head_j at y); forbid any pairs from {Start_j,Head_j,Test_j,Accept_j} to ERR or to \u22a5.\n- At PORT(k,b):\n  \u2022 If k\u2260j: allow (Head_j(prev) \u2192 Head_j(curr)), no other successor.\n  \u2022 If k=j and b=1: allow (Head_j(prev) \u2192 Test_j(curr)), then (Test_j \u2192 Accept_j) to the next cell.\n  \u2022 If k=j and b=0: no successor listed from Head_j; dead-ends.\n- Accept exit: (Accept_j \u2192 PAD) followed by PAD self-plumbing.\nType-Separation claim TS (re-stated, DP-checkable): Fix boundary inputs a\u22c6. For any canonical left block L(u) with PORT adjacent to S, E_{L(u)}(a\u22c6)[Q_j] = u_j. Proof sketch: under Q_j, the only legal continuation is the deterministic chain above; it reaches PORT(j, u_j) and continues iff u_j=1; Cin\u2013out ties RIDbit to the input bit. ERR/\u22a5 are disallowed near PROBE, eliminating alternative completions. Symmetric right probe gives 2^B right-types.\nAlphabet/adjacency budget: PROBE contributes O(B) symbols, PORT contributes O(B), reserved boundary outputs contribute O(B). The adjacency table needs O(B^2) pairs for (Head_j \u2194 PORT(k,\u00b7)); others are O(1). With disjoint roles, |\u03a3_out| = \u0398(B) and |Cout\u2013out| = O(B^2) + O(\u03b2), feasible with \u03b2 = s^{c1} and B = s^{c0}, c1 \u2265 2c0.\n\nB) Per-side color gating and directional-token seam activation (mixed pairs accept)\nSymbols/tracks:\n- S colors: {S_R, S_G, S_B, S_\u22a5} (role=S). Only the color field is under f; all other subtracks derive from neighbors.\n- Gate tokens at the interior neighbor of S: GateL (left side canonical), GateR (right side canonical). If absent, neighbor is neutral PAD.\n- Directional tokens on the corridor: Tok\u2192, Tok\u2190 \u2208 {0,1} carried by RUN/PAD/VERD cells across the bridge wb\u2218wc. Tokens propagate deterministically; see rules below.\nPer-side gating (purely local):\n- If S\u2019s interior neighbor is Gate\u2022, S may be in {S_R,S_G,S_B,S_\u22a5}; otherwise S must be S_\u22a5 (only S_\u22a5-adjacency pairs are listed to neutral neighbors).\nToken seeding (only when the side is canonical and colored):\n- If (GateL \u2194 S_x) with x\u2208{R,G,B}, the first corridor cell to the right of S1 is forced to Tok\u2192=1 (a special Seed\u2192 state). If S1=S_\u22a5, no seeding: Tok\u2192=0.\n- Analogously, if (S2_x \u2194 GateR) with x\u2208{R,G,B}, the first corridor cell to the left of S2 is forced to Tok\u2190=1 (Seed\u2190); else Tok\u2190=0.\nToken propagation (radius-1):\n- Along the corridor toward the opposite end, for any consecutive interior edge i\u2192i+1, allowed pairs enforce: Tok\u2192(i)=1 \u21d2 Tok\u2192(i+1)=1; Tok\u2190(i+1)=1 \u21d2 Tok\u2190(i)=1. (Implement by restricting allowed symbol pairs to those with nonincreasing zeros, i.e., once 1 is present it persists; in practice, corridor symbols carry both bits, and Cout\u2013out allows only pairs with Tok\u2192 nondecreasing left\u2192right and Tok\u2190 nondecreasing right\u2192left.) Outside the corridor, tokens are implicitly 0 (no symbols with tokens permitted).\nMust-color and mixed-pair fallback (enforced at S by inspecting opposite token on its neighbor):\n- Let N1 be S1\u2019s interior neighbor; if Tok\u2192(N1)=0, any S1\u2208{S_R,S_G,S_B,S_\u22a5} may attach to neutral neighbors; if Tok\u2192(N1)=1 (which occurs only when the right side is canonical and colored), then S1\u2260S_\u22a5 is required and the neighbor must be the designated FWD cell (see below). Symmetrically at S2 using Tok\u2190.\n- Consequently, mixed pairs (exactly one side canonical/colored) have no opposite-direction token locally; colored S on the canonical side attaches to a neutral neighbor; the inactive side is S_\u22a5; PAD plumbing accepts unconditionally. No seam tableau runs.\n\nC) Seam RUN tableau and local verdict (EDGE and Eq simultaneously)\nCorridor layout near S:\n- FWD cell immediately right of S1: records FwdColor \u2208 {R,G,B} equal to S1; allowed pairings: (S1_x \u2194 FWD(FwdColor=x)) only; if Tok\u2192(FWD)=0, neutral pairs to PAD are also allowed; if Tok\u2192=1, only the FWD pairing is allowed (must-color enforced).\n- VERD cell immediately left of S2: symbol Ver(FwdColor\u2208{R,G,B}, EDGE\u2208{0,1}, Eq\u2208{0,1}).\nRUN tableau enablement:\n- RUN-role symbols (row-by-row U-simulation) are permitted on the corridor only when (Tok\u2192=1 and Tok\u2190=1) on those cells; else only PAD is permitted. ERR is globally available but explicitly disallowed adjacent to RUN/VERD when any token bit is 1 (no escape in active modes).\nU\u2019s task (constant alphabet): read enc(D) in HEAD; read u from left PORT and v from right PORT; compute EDGE=D(u,v) and Eq=[u=v] in poly(s) steps. The last row writes Ver(FwdColor,EDGE,Eq) into the VERD cell next to S2; FwdColor is copied unaltered from the FWD cell via a constant-width forwarder track (enforced by local equalities).\nLocal verdict at S2\u2013VERD edge (radius-1 adjacency list):\n- For each c\u2208{R,G,B} and bits e,q\u2208{0,1}, allowed pairs (S2_col, Ver(FwdColor=c,EDGE=e,Eq=q)) are:\n  \u2022 If q=1: allow only when S2_col = c (forces equality on u=v). If additionally e=1, this case is unreachable because we ensure D(u,u)=0 in preprocessing (or the seam would be contradictory). If e=0, equality holds; allowed.\n  \u2022 If q=0 and e=1: allow only when S2_col \u2260 c (forces inequality on edges).\n  \u2022 If q=0 and e=0: allow all 3\u00d73 color combinations.\n- Must-color at S2: If Tok\u2190(VERD)=1, forbid S2_\u22a5; otherwise S2_\u22a5 is allowed (mixed/inactive pairs).\nCorrectness (active-active): Acceptance iff (EDGE=0 or colors differ) and (Eq=0 or colors equal). Mixed/inactive: tokens absent locally; neutral plumbing accepts unconditionally.\n\nD) Bridging (F2) is vacuous or reduces to local seam\n- For inactive/mixed contexts: S choices are either \u22a5 (inactive) or unrestricted on the canonical side with PAD neighbors (mixed); repetitions w_i^z away from S are filled by PAD/\u22a5 self-loops; Cout\u2013out includes PAD\u2013PAD self-transitions for every interior edge type; thus wz_1 S wz_2 always extends independently of z.\n- For active-active canonical pairs: all constraints are confined to the immediate corridor around S (FWD, RUN rows, and VERD), which has constant width; repeating w_i does not create new constraints across S and does not affect U\u2019s computation (it reads PORTs adjacent to S). Hence feasibility for z=1 implies feasibility for all z \u2265 1. Formally, by Lemma 1 in output.md (periodicity), we may check z up to Z, but here local wiring already makes the outcome z-invariant.\n\nE) B=2 concrete instance (DP-auditable)\nSymbols to enumerate (suggested names):\n- S: S_R, S_G, S_B, S_\u22a5.\n- PORT: P1^0,P1^1,P2^0,P2^1.\n- PROBE: Start_1,Head_1,Test_1,Accept_1; Start_2,Head_2,Test_2,Accept_2.\n- Boundary outputs: Q_1, Q_2; we treat BL2_1 and BL2_2 as the left second boundary outputs selecting Start_j.\n- Gating: GateL, GateR; otherwise PAD.\n- Corridor bits: tokens Tok\u2192/Tok\u2190 \u2208 {0,1} carried in symbol variants (we can realize four variants of PAD and RUN cells to encode the two bits; only those pairs consistent with monotone propagation are listed).\n- RUN: a tiny fixed alphabet sufficient to tabulate D on {00,01,10,11} and Eq=[u=v].\n- VERD: Ver(c\u2208{R,G,B}, e\u2208{0,1}, q\u2208{0,1}).\nCin\u2013out (B=2): Allow PORT b-outputs matching the input bit b; all other roles accept any input bit (copy-through or don\u2019t-care). Optionally, forbid ROLE=PORT unless the HEAD/PORT header is present (enforced by Cout\u2013out grammar between HEAD and PORT).\nCout\u2013out key fragments (B=2):\n- Probes: as in A, instantiate k\u2208{1,2} and j\u2208{1,2}. Enumerate (Head_j \u2194 Port^P(k,\u00b7)) march, (Port^P(k\u2260j,\u00b7) \u2192 Head_j), (Port^P(j,1) \u2192 Test_j \u2192 Accept_j), and no successor on (Port^P(j,0) \u2192 \u00b7). No ERR/\u22a5 adjacent to Start/Head/Test/Accept.\n- Gating at S: (GateL \u2194 S_color) for color\u2208{R,G,B,\u22a5}; (\u00acGateL \u2194 S_\u22a5) only. Same on the right with GateR.\n- Tokens: (GateL \u2194 S_color) forces Seed\u2192(Tok\u2192=1) on the next interior cell; otherwise Tok\u2192=0. Enforce Tok\u2192 nondecreasing left\u2192right and Tok\u2190 nondecreasing right\u2192left by allowing only corridor pairs (x,y) with y.Tok\u2192 \u2265 x.Tok\u2192 and x.Tok\u2190 \u2265 y.Tok\u2190.\n- Must-color at S: If N1.Tok\u2192=1 then forbid (S1=\u22a5 \u2194 N1); also require (S1 \u2194 FWD) pairing; symmetrically if N2.Tok\u2190=1 require (S2 \u2194 VERD).\n- RUN enablement: Only when both token bits are 1 on corridor cells are RUN-row symbols permitted (else PAD). ERR adjacent to RUN or VERD is forbidden in this mode.\n- Verdict adjacency: Explicitly list allowed pairs (S2_col \u2194 Ver(c,e,q)) following the cases in C.\nDP audit checks:\n1) Probe: Four left seeds L(00),L(01),L(10),L(11) with contiguous PORT zone next to S. For each u, and boundary outputs Q_1,Q_2 under fixed a\u22c6, the DP should yield E(u)[Q_1]=u_1 and E(u)[Q_2]=u_2.\n2) Seam: Take D as a 4-cycle on {00,01,10,11} and Eq by equality. Build right seeds R(v). For all 16 ordered pairs (L(u),R(v)), the DP should accept iff (u=v \u21d2 colors equal) and (D(u,v)=1 \u21d2 colors differ). Mixed pairs (canonical on one side only) accept regardless, with S on inactive side = \u22a5.\n\nF) Existence of canonical contexts at lengths \u2113_pump or \u2113_pump+1 (specialized padding lemma)\nLemma CN (canonical contexts exist with prescribed side-length parity). For each index u\u2208{0,1}^B there is at least one left word w_1 of length in {\u2113_pump, \u2113_pump+1} whose suffix adjacent to S is a well-formed canonical block W_L(u) (HEAD \u00b7 PORT(B) \u00b7 RUN prefix) and PAD elsewhere; likewise for right contexts.\n- Proof sketch (uses output.md Lemmas 11\u201312, 14\u201315): Start from a seed word U_L(u) = PAD^z \u00b7 W_L(u) with z\u226b1 chosen so that Type(PAD^z) stabilizes and replacing PAD^z by any PAD^{z\u2032} with the same type preserves the type of U_L(u). By Lemma 15 (periodicity), select z\u2032 so that |PAD^{z\u2032} \u00b7 W_L(u)| hits \u2113_pump or \u2113_pump+1. All pumping/replacement happens in PAD outside the seam, so the HEAD/PORT layout and probe/seam interfaces are unaffected. Symmetric for the right.\n\nG) Why (F1)\u21d43-coloring and why (F2) imposes no extra burden\n- Completeness: Given \u03c7: {0,1}^B\u2192{R,G,B}, set f(Type(L(u)))=\u03c7(u), f(Type(R(v)))=\u03c7(v), f(others)=\u22a5. Active-active seam checks EDGE and Eq and enforces inequality on edges and equality on u=v via local verdict; mixed pairs pass via fallback plumbing.\n- Soundness: If f passes (F1), then for each u, both \u03c4^L_u and \u03c4^R_u must be non-\u22a5 (else some active-active diagonal pair would violate must-color); the diagonal (u,u) has Eq=1, so the colors match, defining \u03c7(u). For any edge (u,v), EDGE=1 forces \u03c7(u)\u2260\u03c7(v). Thus \u03c7 is a proper 3-coloring.\n- Bridging (F2): As argued in D), repeating w_i adds only PAD away from S; in active-active pairs the corridor logic is local-invariant; mixed/inactive are vacuous. Hence any f that satisfies (F1) also satisfies (F2) in this construction.\n\nH) Risks and resolutions (for DP and audit)\n- Probe uniqueness/escape: We explicitly forbid ERR/\u22a5 adjacent to PROBE states and give each probe state a unique successor; PORT contiguity is enforced by allowing only Addr\u2192Addr+1 across PORT. This makes E(a\u22c6)[Q_j] a single-bit function of RIDbit[j].\n- Seam activation locality: Tokens are read only one hop from S; must-color is triggered iff the opposite-direction token is present; RUN/VERD are permitted only when both tokens are present. Mixed pairs see no opposite token and thus accept.\n- Verdict consistency: The Eq gate enforces equal colors only on u=v; to avoid Eq\u2227EDGE contradictions, set D(u,u)=0 in preprocessing of the succinct graph (standard and WLOG for 3-coloring).\n- Alphabet/adjacency budgets: With disjoint-role subalphabets, |\u03a3_out|=\u0398(B) and |Cout\u2013out|=O(B^2)+O(1). Choose \u03b2\u2265c\u00b7B^2 to be safe (or \u03b2=\u0398(B) with careful symbol reuse as in A\u2013C).\n\nNext steps (concrete, auditable)\n1) Produce a machine-readable B=2 instance: enumerate \u03a3_out symbols listed in E), tabulate Cin\u2013out and the Cout\u2013out fragments for probes, gating, token propagation, RUN enablement, must-color, and verdict adjacency. Run the O(k\u03b2^2) DP to validate the probe bits and seam acceptance on all 16 ordered pairs (L(u),R(v)).\n2) Generalize the parametric tables (Head_j/Port(k,\u00b7), Tok monotonicity, S-adjacent constraints, verdict pairs) for arbitrary B and bundle them into the reduction.\n3) Integrate Lemma TS (probes), Lemma RG (gating+tokens), Lemma SG (seam verdict) into the curated output once B=2 validation passes; add Lemma CN (canonical contexts existence) referencing output.md Lemmas 11\u201312,14\u201315.\n4) Package the reduction D \u21a6 P_D formally and state the equivalence (3-colorable \u21d4 feasible f), concluding NEXPTIME-hardness of the classification (O(1)/\u0398(log* n)/\u0398(n)) under the explicit \u03b2-normalized, r=1 model.\n"
}