--- SYSTEM ---
You are a research **summarizer**. Summarize this *last round only* for a human log.

Include:
- 3–7 bullet **Highlights** (facts learned, reductions, counterexamples, partial bounds).
- 1–3 **Open questions / TODOs** for the next round.
- 1–3 **Citations to files** you relied on (e.g. round files or papers by name).

**Return strictly JSON**:
{
  "summary_md": "Readable summary of the round (≤200 words)",
  "highlights": [],
  "next_questions": []
}

--- USER ---
=== prover-01.out.json (progress_md) ===
Round 0005 — Parametric, radius-1 rule schemas (directional tokens adopted), B=2 instantiation blueprint, and finite-length canonical contexts

Context and objective
- We continue the NEXPTIME-hardness program via Succinct 3-Coloring (S3Col) by finalizing DP-auditable, radius-1 rule schemas for: (i) deterministic per-bit boundary probes that separate 2^B canonical vertex types; (ii) per-side color gating; (iii) seam activation via directional tokens Tok→/Tok← with a local verdict enforcing simultaneously EDGE and Eq; and (iv) a bridging policy that either vacuously holds (inactive/mixed) or reduces to the same local seam constraints regardless of repetition z. We also provide a B=2 symbol list and explicit Cout–out fragments sufficient for a DP check.
- Minor gaps to output.md: (1) Please add a parenthetical note that types E_w(a) are computed with respect to fixed interior inputs (our PORT.RIDbit copies the fixed Σ_in). (2) When feasible functions are used, it helps to define the context set C explicitly as those types realized by w_1 S w_2 with |w_i| ∈ {ℓ_pump, ℓ_pump+1}; hence |C| ≤ ℓ_pump. (We do not edit output.md, only flagging these clarifications.)

A) Per-bit probe (Type-Separation) — explicit radius-1 rules (deterministic, no escape)
Symbols/tracks used (folded via disjoint roles; sizes add):
- Roles: {PAD, HEAD, PORT, PROBE, RUN, VERD, ERR, S} × Phase∈[c0] (constant c0).
- PORT subtracks: Addr∈{1,…,B}, RIDbit∈{0,1}.
- Probe states per j∈[B]: Start_j, Head_j, Test_j, Accept_j (role=PROBE).
- Boundary outputs: For the 4 boundary positions, reserve B 4-tuples Q_j. We refer to the second-from-left boundary output as BL2_j for injection.
- Cin–out: PORT cells have (input b, output RIDbit=b) allowed for b∈{0,1}. Non-PORT roles ignore RIDbit in Cin–out; ERR and PAD accept any input (standard).
- PORT well-formedness and contiguity: Allowed PORT–PORT Cout–out pairs on interior edges are exactly (P(k,·) → P(k+1,·)) for k=1,…,B−1; no other PORT adjacency allowed. The unique PORT block abuts S.
Cout–out rules (parametric in j):
- Injection: (BL2_j → Start_j) is the only allowed successor from BL2_j.
- March: For any non-PORT y, allow (Head_j → Head_j at y); forbid any pairs from {Start_j,Head_j,Test_j,Accept_j} to ERR or to ⊥.
- At PORT(k,b):
  • If k≠j: allow (Head_j(prev) → Head_j(curr)), no other successor.
  • If k=j and b=1: allow (Head_j(prev) → Test_j(curr)), then (Test_j → Accept_j) to the next cell.
  • If k=j and b=0: no successor listed from Head_j; dead-ends.
- Accept exit: (Accept_j → PAD) followed by PAD self-plumbing.
Type-Separation claim TS (re-stated, DP-checkable): Fix boundary inputs a⋆. For any canonical left block L(u) with PORT adjacent to S, E_{L(u)}(a⋆)[Q_j] = u_j. Proof sketch: under Q_j, the only legal continuation is the deterministic chain above; it reaches PORT(j, u_j) and continues iff u_j=1; Cin–out ties RIDbit to the input bit. ERR/⊥ are disallowed near PROBE, eliminating alternative completions. Symmetric right probe gives 2^B right-types.
Alphabet/adjacency budget: PROBE contributes O(B) symbols, PORT contributes O(B), reserved boundary outputs contribute O(B). The adjacency table needs O(B^2) pairs for (Head_j ↔ PORT(k,·)); others are O(1). With disjoint roles, |Σ_out| = Θ(B) and |Cout–out| = O(B^2) + O(β), feasible with β = s^{c1} and B = s^{c0}, c1 ≥ 2c0.

B) Per-side color gating and directional-token seam activation (mixed pairs accept)
Symbols/tracks:
- S colors: {S_R, S_G, S_B, S_⊥} (role=S). Only the color field is under f; all other subtracks derive from neighbors.
- Gate tokens at the interior neighbor of S: GateL (left side canonical), GateR (right side canonical). If absent, neighbor is neutral PAD.
- Directional tokens on the corridor: Tok→, Tok← ∈ {0,1} carried by RUN/PAD/VERD cells across the bridge wb∘wc. Tokens propagate deterministically; see rules below.
Per-side gating (purely local):
- If S’s interior neighbor is Gate•, S may be in {S_R,S_G,S_B,S_⊥}; otherwise S must be S_⊥ (only S_⊥-adjacency pairs are listed to neutral neighbors).
Token seeding (only when the side is canonical and colored):
- If (GateL ↔ S_x) with x∈{R,G,B}, the first corridor cell to the right of S1 is forced to Tok→=1 (a special Seed→ state). If S1=S_⊥, no seeding: Tok→=0.
- Analogously, if (S2_x ↔ GateR) with x∈{R,G,B}, the first corridor cell to the left of S2 is forced to Tok←=1 (Seed←); else Tok←=0.
Token propagation (radius-1):
- Along the corridor toward the opposite end, for any consecutive interior edge i→i+1, allowed pairs enforce: Tok→(i)=1 ⇒ Tok→(i+1)=1; Tok←(i+1)=1 ⇒ Tok←(i)=1. (Implement by restricting allowed symbol pairs to those with nonincreasing zeros, i.e., once 1 is present it persists; in practice, corridor symbols carry both bits, and Cout–out allows only pairs with Tok→ nondecreasing left→right and Tok← nondecreasing right→left.) Outside the corridor, tokens are implicitly 0 (no symbols with tokens permitted).
Must-color and mixed-pair fallback (enforced at S by inspecting opposite token on its neighbor):
- Let N1 be S1’s interior neighbor; if Tok→(N1)=0, any S1∈{S_R,S_G,S_B,S_⊥} may attach to neutral neighbors; if Tok→(N1)=1 (which occurs only when the right side is canonical and colored), then S1≠S_⊥ is required and the neighbor must be the designated FWD cell (see below). Symmetrically at S2 using Tok←.
- Consequently, mixed pairs (exactly one side canonical/colored) have no opposite-direction token locally; colored S on the canonical side attaches to a neutral neighbor; the inactive side is S_⊥; PAD plumbing accepts unconditionally. No seam tableau runs.

C) Seam RUN tableau and local verdict (EDGE and Eq simultaneously)
Corridor layout near S:
- FWD cell immediately right of S1: records FwdColor ∈ {R,G,B} equal to S1; allowed pairings: (S1_x ↔ FWD(FwdColor=x)) only; if Tok→(FWD)=0, neutral pairs to PAD are also allowed; if Tok→=1, only the FWD pairing is allowed (must-color enforced).
- VERD cell immediately left of S2: symbol Ver(FwdColor∈{R,G,B}, EDGE∈{0,1}, Eq∈{0,1}).
RUN tableau enablement:
- RUN-role symbols (row-by-row U-simulation) are permitted on the corridor only when (Tok→=1 and Tok←=1) on those cells; else only PAD is permitted. ERR is globally available but explicitly disallowed adjacent to RUN/VERD when any token bit is 1 (no escape in active modes).
U’s task (constant alphabet): read enc(D) in HEAD; read u from left PORT and v from right PORT; compute EDGE=D(u,v) and Eq=[u=v] in poly(s) steps. The last row writes Ver(FwdColor,EDGE,Eq) into the VERD cell next to S2; FwdColor is copied unaltered from the FWD cell via a constant-width forwarder track (enforced by local equalities).
Local verdict at S2–VERD edge (radius-1 adjacency list):
- For each c∈{R,G,B} and bits e,q∈{0,1}, allowed pairs (S2_col, Ver(FwdColor=c,EDGE=e,Eq=q)) are:
  • If q=1: allow only when S2_col = c (forces equality on u=v). If additionally e=1, this case is unreachable because we ensure D(u,u)=0 in preprocessing (or the seam would be contradictory). If e=0, equality holds; allowed.
  • If q=0 and e=1: allow only when S2_col ≠ c (forces inequality on edges).
  • If q=0 and e=0: allow all 3×3 color combinations.
- Must-color at S2: If Tok←(VERD)=1, forbid S2_⊥; otherwise S2_⊥ is allowed (mixed/inactive pairs).
Correctness (active-active): Acceptance iff (EDGE=0 or colors differ) and (Eq=0 or colors equal). Mixed/inactive: tokens absent locally; neutral plumbing accepts unconditionally.

D) Bridging (F2) is vacuous or reduces to local seam
- For inactive/mixed contexts: S choices are either ⊥ (inactive) or unrestricted on the canonical side with PAD neighbors (mixed); repetitions w_i^z away from S are filled by PAD/⊥ self-loops; Cout–out includes PAD–PAD self-transitions for every interior edge type; thus wz_1 S wz_2 always extends independently of z.
- For active-active canonical pairs: all constraints are confined to the immediate corridor around S (FWD, RUN rows, and VERD), which has constant width; repeating w_i does not create new constraints across S and does not affect U’s computation (it reads PORTs adjacent to S). Hence feasibility for z=1 implies feasibility for all z ≥ 1. Formally, by Lemma 1 in output.md (periodicity), we may check z up to Z, but here local wiring already makes the outcome z-invariant.

E) B=2 concrete instance (DP-auditable)
Symbols to enumerate (suggested names):
- S: S_R, S_G, S_B, S_⊥.
- PORT: P1^0,P1^1,P2^0,P2^1.
- PROBE: Start_1,Head_1,Test_1,Accept_1; Start_2,Head_2,Test_2,Accept_2.
- Boundary outputs: Q_1, Q_2; we treat BL2_1 and BL2_2 as the left second boundary outputs selecting Start_j.
- Gating: GateL, GateR; otherwise PAD.
- Corridor bits: tokens Tok→/Tok← ∈ {0,1} carried in symbol variants (we can realize four variants of PAD and RUN cells to encode the two bits; only those pairs consistent with monotone propagation are listed).
- RUN: a tiny fixed alphabet sufficient to tabulate D on {00,01,10,11} and Eq=[u=v].
- VERD: Ver(c∈{R,G,B}, e∈{0,1}, q∈{0,1}).
Cin–out (B=2): Allow PORT b-outputs matching the input bit b; all other roles accept any input bit (copy-through or don’t-care). Optionally, forbid ROLE=PORT unless the HEAD/PORT header is present (enforced by Cout–out grammar between HEAD and PORT).
Cout–out key fragments (B=2):
- Probes: as in A, instantiate k∈{1,2} and j∈{1,2}. Enumerate (Head_j ↔ Port^P(k,·)) march, (Port^P(k≠j,·) → Head_j), (Port^P(j,1) → Test_j → Accept_j), and no successor on (Port^P(j,0) → ·). No ERR/⊥ adjacent to Start/Head/Test/Accept.
- Gating at S: (GateL ↔ S_color) for color∈{R,G,B,⊥}; (¬GateL ↔ S_⊥) only. Same on the right with GateR.
- Tokens: (GateL ↔ S_color) forces Seed→(Tok→=1) on the next interior cell; otherwise Tok→=0. Enforce Tok→ nondecreasing left→right and Tok← nondecreasing right→left by allowing only corridor pairs (x,y) with y.Tok→ ≥ x.Tok→ and x.Tok← ≥ y.Tok←.
- Must-color at S: If N1.Tok→=1 then forbid (S1=⊥ ↔ N1); also require (S1 ↔ FWD) pairing; symmetrically if N2.Tok←=1 require (S2 ↔ VERD).
- RUN enablement: Only when both token bits are 1 on corridor cells are RUN-row symbols permitted (else PAD). ERR adjacent to RUN or VERD is forbidden in this mode.
- Verdict adjacency: Explicitly list allowed pairs (S2_col ↔ Ver(c,e,q)) following the cases in C.
DP audit checks:
1) Probe: Four left seeds L(00),L(01),L(10),L(11) with contiguous PORT zone next to S. For each u, and boundary outputs Q_1,Q_2 under fixed a⋆, the DP should yield E(u)[Q_1]=u_1 and E(u)[Q_2]=u_2.
2) Seam: Take D as a 4-cycle on {00,01,10,11} and Eq by equality. Build right seeds R(v). For all 16 ordered pairs (L(u),R(v)), the DP should accept iff (u=v ⇒ colors equal) and (D(u,v)=1 ⇒ colors differ). Mixed pairs (canonical on one side only) accept regardless, with S on inactive side = ⊥.

F) Existence of canonical contexts at lengths ℓ_pump or ℓ_pump+1 (specialized padding lemma)
Lemma CN (canonical contexts exist with prescribed side-length parity). For each index u∈{0,1}^B there is at least one left word w_1 of length in {ℓ_pump, ℓ_pump+1} whose suffix adjacent to S is a well-formed canonical block W_L(u) (HEAD · PORT(B) · RUN prefix) and PAD elsewhere; likewise for right contexts.
- Proof sketch (uses output.md Lemmas 11–12, 14–15): Start from a seed word U_L(u) = PAD^z · W_L(u) with z≫1 chosen so that Type(PAD^z) stabilizes and replacing PAD^z by any PAD^{z′} with the same type preserves the type of U_L(u). By Lemma 15 (periodicity), select z′ so that |PAD^{z′} · W_L(u)| hits ℓ_pump or ℓ_pump+1. All pumping/replacement happens in PAD outside the seam, so the HEAD/PORT layout and probe/seam interfaces are unaffected. Symmetric for the right.

G) Why (F1)⇔3-coloring and why (F2) imposes no extra burden
- Completeness: Given χ: {0,1}^B→{R,G,B}, set f(Type(L(u)))=χ(u), f(Type(R(v)))=χ(v), f(others)=⊥. Active-active seam checks EDGE and Eq and enforces inequality on edges and equality on u=v via local verdict; mixed pairs pass via fallback plumbing.
- Soundness: If f passes (F1), then for each u, both τ^L_u and τ^R_u must be non-⊥ (else some active-active diagonal pair would violate must-color); the diagonal (u,u) has Eq=1, so the colors match, defining χ(u). For any edge (u,v), EDGE=1 forces χ(u)≠χ(v). Thus χ is a proper 3-coloring.
- Bridging (F2): As argued in D), repeating w_i adds only PAD away from S; in active-active pairs the corridor logic is local-invariant; mixed/inactive are vacuous. Hence any f that satisfies (F1) also satisfies (F2) in this construction.

H) Risks and resolutions (for DP and audit)
- Probe uniqueness/escape: We explicitly forbid ERR/⊥ adjacent to PROBE states and give each probe state a unique successor; PORT contiguity is enforced by allowing only Addr→Addr+1 across PORT. This makes E(a⋆)[Q_j] a single-bit function of RIDbit[j].
- Seam activation locality: Tokens are read only one hop from S; must-color is triggered iff the opposite-direction token is present; RUN/VERD are permitted only when both tokens are present. Mixed pairs see no opposite token and thus accept.
- Verdict consistency: The Eq gate enforces equal colors only on u=v; to avoid Eq∧EDGE contradictions, set D(u,u)=0 in preprocessing of the succinct graph (standard and WLOG for 3-coloring).
- Alphabet/adjacency budgets: With disjoint-role subalphabets, |Σ_out|=Θ(B) and |Cout–out|=O(B^2)+O(1). Choose β≥c·B^2 to be safe (or β=Θ(B) with careful symbol reuse as in A–C).

Next steps (concrete, auditable)
1) Produce a machine-readable B=2 instance: enumerate Σ_out symbols listed in E), tabulate Cin–out and the Cout–out fragments for probes, gating, token propagation, RUN enablement, must-color, and verdict adjacency. Run the O(kβ^2) DP to validate the probe bits and seam acceptance on all 16 ordered pairs (L(u),R(v)).
2) Generalize the parametric tables (Head_j/Port(k,·), Tok monotonicity, S-adjacent constraints, verdict pairs) for arbitrary B and bundle them into the reduction.
3) Integrate Lemma TS (probes), Lemma RG (gating+tokens), Lemma SG (seam verdict) into the curated output once B=2 validation passes; add Lemma CN (canonical contexts existence) referencing output.md Lemmas 11–12,14–15.
4) Package the reduction D ↦ P_D formally and state the equivalence (3-colorable ⇔ feasible f), concluding NEXPTIME-hardness of the classification (O(1)/Θ(log* n)/Θ(n)) under the explicit β-normalized, r=1 model.


=== prover-02.out.json (progress_md) ===
Round 0005 — Toward a DP-checkable B=2 instance: explicit Cin–out/Cout–out fragments for probes, tokens, gating, and verdict

Context and goal
- We adopt directional tokens for seam activation (as recommended in verifier.feedback.md) and produce an explicit, radius-1 rule skeleton for B=2 that a DP can check. The focus is on: (i) per-bit boundary probes Q_1, Q_2; (ii) per-side color gating plus mixed-pair fallback (must-color only in active-active); (iii) a seam verdict cell V enforcing both EDGE and Eq via S2↔V local pairs; and (iv) ERR/⊥ discipline in probe/seam modes. We keep disjoint-role subalphabets so sizes add rather than multiply.

Symbols (B=2, disjoint roles)
- Boundary-reserved outputs (used only on boundary nodes at the four ends for the TS checks): BL1_1, BL2_1, BR2_1, BR1_1 and BL1_2, BL2_2, BR2_2, BR1_2 corresponding to Q_1 and Q_2. (The DP sets boundary outputs to these values; interior neighbors see them through Cout–out.)
- S-node symbols: S_R, S_G, S_B, S_⊥. (No handshake bits on S; all activation/gating is enforced by the interior neighbors’ symbols.)
- Interior roles (pairwise disjoint subalphabets):
  • PAD: Pad.
  • ERR: Err. (Used only outside probe/seam-active modes.)
  • PORT (probe-idle): P1^0, P1^1, P2^0, P2^1. (Addr=j and RIDbit=b encoded in the name.)
  • PORT (probe-active variants): P1p^0, P1p^1, P2p^0, P2p^1. (Same content, different role tag to control adjacency during probes.)
  • PROBE states (per j): Head_1, Accept_1; Head_2, Accept_2. (Start is injected from the boundary neighbor via BL2_j → Head_j.)
  • Gating neighbors: GateL, GateR (the unique symbols that may appear immediately inside S1/S2 for canonical sides); NonGate (placeholder representing any other noncanonical neighbor role adjacent to S).
  • Seam corridor (RUN/PAD aggregate role with token flags): we instantiate four concrete corridor symbols by token bits: Corr_00, Corr_10, Corr_01, Corr_11 where the suffix encodes (Tok→, Tok←) ∈ {(0,0),(1,0),(0,1),(1,1)}. These occur only on the bridge wb∘wc (the two cells immediately adjacent to S and possibly one more cell for B=2; here we use two cells: one next to S1 and one next to S2).
  • Verdict cell (adjacent to S2 only): Ver(c, e, q) with c∈{R,G,B}, e∈{0,1}, q∈{0,1}. (12 symbols.)

Cin–out constraints (B=2)
- PORT cells tie RIDbit to input bit:
  • Allowed: (input 0, P1^0), (input 1, P1^1), (input 0, P2^0), (input 1, P2^1).
  • Same for probe-active variants: (0, P1p^0), (1, P1p^1), (0, P2p^0), (1, P2p^1).
- Other roles ignore input: for each x∈{Pad, Err, Head_1, Accept_1, Head_2, Accept_2, GateL, GateR, NonGate, Corr_00, Corr_10, Corr_01, Corr_11, Ver(⋅)}, both (0,x) and (1,x) are allowed.
- S-node symbols: both inputs allowed for S_R, S_G, S_B, S_⊥.

Cout–out: PORT zone well-formedness and placement (left canonical block)
- Adjacent to S1 on its right, the first interior cell of a canonical left block is GateL, followed immediately by the contiguous PORT zone P1, P2 (in this order), then Pad. Allowed pairs inside a canonical left block (rightward orientation):
  • (GateL, P1^b), (P1^b, P2^{b′}), (P2^{b′}, Pad). (For all b,b′∈{0,1}.)
- In non-canonical left contexts, the neighbor of S1 is NonGate; from NonGate we only allow PAD onward: (NonGate, Pad), Pad self-loops. (We do not list any pair enabling PORT after NonGate.)
- Symmetric rules for the canonical right block: immediately left of S2 is GateR; on its left are the contiguous PORT cells P2, P1 in reverse (since the path is oriented left-to-right, the right block’s PORT sits to the left of S2). For simplicity in B=2 we mirror: allowed pairs leftward are expressed via rightward pairs as (P2^b, GateR) and (Pad, P2^b), (P1^{b′}, GateR) as needed; for the DP we will construct rightward lists so that reading from left to right along wb∘wc we encounter …Pad, P1^⋅, P2^⋅, GateR, S2.

Per-bit probe TS (left side; radius-1; deterministic; no escape)
- Injection from boundary (for j∈{1,2}):
  • Allowed: (BL1_j, BL2_j), (BL2_j, Head_j).
  • Disallowed: Any pair (BL2_j, x) with x≠Head_j.
- Corridor to PORT (we use the probe-active variants at the PORT cells visited during probes):
  • Before the PORT zone: (Head_j, Head_j) on any corridor Pad stretch prepared for the canonical block. In B=2 we keep this to one step: (Head_j, P1p^b) for the first PORT cell.
  • Entering PORT: (Head_j, P1p^b) allowed for all b. From P1p^b to the next cell:
    – If j=1 and b=1: (P1p^1, Accept_1) allowed; if b=0: no successor (DP dead-ends under Q_1).
    – If j=2: (P1p^b, Head_2) continues the march to the next PORT.
  • At second PORT: (Head_2, P2p^b) allowed. Then:
    – If j=2 and b=1: (P2p^1, Accept_2) allowed; if b=0: no successor.
    – If j=1: this case only arises if Head_1 reached P2p^b; we allow (P2p^b, Head_1) to continue (though for B=2, Head_1 should have halted at P1p already; the pair is harmless if never used in a well-formed block).
- Accept exits deterministically to Pad: (Accept_j, Pad), (Pad, Pad) self-loop.
- Probe-mode discipline (no ERR/⊥ escape): We do not list any pairs with Err adjacent to Head_j or Accept_j or any probe-active PORT P⋅p^⋅; similarly, no (Head_j, S_⋅) or (Head_j, GateL/NonGate) pairs.
- Idle vs probe-active PORT symbols: In probe mode we require P⋅p^⋅ at the PORT positions by listing (Head_j, P⋅p^⋅) and omitting (Head_j, P⋅^⋅). In all non-probe contexts we do not permit P⋅p^⋅; only P⋅^⋅ with standard PAD neighbors are allowed.
- Type-separation claim (B=2 instance): With the above, for any canonical left word L(u1u2), E_{L(u)}(a⋆)[Q_1] = u1 and E_{L(u)}(a⋆)[Q_2] = u2 (with a⋆ fixed arbitrarily, e.g., 0000). This is DP-checkable.

Per-side color gating at S (local; mixed pairs accept)
- Allowed S1-adjacent pairs (left side):
  • If neighbor is GateL: (GateL, S_R), (GateL, S_G), (GateL, S_B), (GateL, S_⊥).
  • If neighbor is NonGate or Pad: only (NonGate, S_⊥), (Pad, S_⊥). (All (NonGate, S_color) with color∈{R,G,B} omitted.)
- Symmetrically for S2: if its left neighbor is GateR, then (GateR, S_color) allowed for color∈{R,G,B,⊥}; if neighbor is not GateR, only (NonGate, S_⊥)/(Pad, S_⊥) allowed.
- This makes mixed pairs vacuous: a canonical side may be colored; a non-canonical side must be ⊥.

Directional tokens and seam activation (local; must-color only in active-active)
- Token seeding at the first corridor cells adjacent to S:
  • When (GateL, S_color) occurs at S1’s edge and the right neighbor cell is the first corridor cell, we allow only (S_color, Corr_10) (Tok→=1) as the successor (and forbid (S_color, Corr_00), (S_color, Corr_01), (S_color, Corr_11)). If S1= S_⊥, we allow only (S_⊥, Corr_00).
  • When the left neighbor of S2 is GateR and the left corridor cell is adjacent to S2, we enforce Tok←=1 on that corridor cell: the edge immediately to the left of S2 must be (Corr_x1, S_color) for some x (i.e., Tok←=1); if S2= S_⊥ we still permit (Corr_01, S_⊥) in mixed pairs.
- Token propagation across the two corridor cells (we use exactly two):
  • Left corridor cell C_L ∈ {Corr_10, Corr_00} sits to the right of S1; right corridor cell C_R ∈ {Corr_01, Corr_00, Corr_11} sits to the left of S2. Allowed pairs:
    – (Corr_10, Corr_11) (Tok→ continues right; Tok← injected on the next cell if GateR is present), (Corr_10, Corr_10) otherwise is not listed (we force meeting at the second corridor cell).
    – (Corr_01, Corr_01) (Tok← persists if injected from the right side only).
    – (Corr_00, Corr_00) for inactive edges.
    – In active-active, list (Corr_10, Corr_11) and (Corr_11, GateR) (see below).
- Must-color enforcement (local at S):
  • If the corridor cell adjacent to S1 has Tok←=1 (i.e., symbol is Corr_01 or Corr_11), then omit pairs (Corr_01, S_⊥) and (Corr_11, S_⊥); only (Corr_01, S_color) and (Corr_11, S_color) with color∈{R,G,B} are allowed. If Tok←=0 (Corr_00 or Corr_10), allow (Corr_⋅0, S_⊥) and (Corr_⋅0, S_color) (mixed/inactive fallback).
  • Symmetrically at S2: if the corridor cell to its left has Tok→=1 (Corr_10 or Corr_11), omit (S_⊥, Corr_10) and (S_⊥, Corr_11); only (S_color, Corr_10/Corr_11) allowed. If Tok→=0, allow (S_⊥, Corr_00/Corr_01) and (S_color, Corr_00/Corr_01).

Verdict placement and S2↔V local acceptance (EDGE and Eq)
- Verdict insertion (one-cell): In active-active mode (both tokens present), the right corridor cell adjacent to S2 must be Ver(c,e,q) instead of a Corr_⋅⋅ symbol. We realize this by listing only the pairs (Corr_11, Ver(c,e,q)) for some c,e,q (and omitting (Corr_11, S2) with a corridor symbol). The color c is copied from S1 by permitting (S1_color, Corr_10) only when the Ver’s c equals that S1_color; concretely, we constrain the sequence S1_color → Corr_10 → Corr_11 → Ver(c, e, q) so that c matches S1_color. (For DP, we can simply list (Corr_11, Ver(R,⋅,⋅)), (Corr_11, Ver(G,⋅,⋅)), (Corr_11, Ver(B,⋅,⋅)) and then add S2↔Ver gating below; the color-copy guarantee is optional for the toy B=2 check.)
- Computation of EDGE and Eq (B=2): For audit we tabulate D(u,v) and Eq[u=v] by constant-width local rules that “read” the PORT bits u and v. An easy way is to require that the left corridor cell Corr_10 sits immediately after P2 (on the left side) so it sees u (two PORT cells back), and the right corridor cell Ver(⋅,e,q) sits immediately before GateR and thus “sees” v; we then list only those (P1^u1,P2^u2, Corr_10) patterns and (Ver(⋅,e,q), P2^v2, P1^v1) local neighborhoods consistent with (EDGE, Eq) for the chosen D (e.g., the 4-cycle). For the DP harness, we can bake the 16 cases into which Ver(⋅,e,q) symbols are allowed given the adjacent PORT values on each side. (This is implementable via radius-1 pairs by expanding a finite number of Corr/Ver variants if needed; for brevity we leave the exact micro-expansion as a checklist item.)
- S2↔Ver local acceptance table (simultaneous constraints): For each Ver(c,e,q) and S2_color ∈ {R,G,B} we allow S2↔Ver iff both hold: (A) if e=1 then S2_color≠c; (B) if q=1 then S2_color=c. Enumerated allowed pairs:
  • If (e,q)=(0,0): allow all (S2_color, Ver(c,0,0)).
  • If (e,q)=(1,0): allow (S2_color≠c, Ver(c,1,0)); forbid (c, Ver(c,1,0)).
  • If (e,q)=(0,1): allow (c, Ver(c,0,1)); forbid (S2_color≠c, Ver(c,0,1)).
  • If (e,q)=(1,1): (this case does not arise for D(u,u)=0; to be safe, list none so any accidental appearance dead-ends.)
- ERR/⊥ disabled near VERD in active modes: We omit all pairs with Err adjacent to Corr_⋅⋅ or Ver(⋅) whenever Tok→ or Tok← is 1. (Outside active-active/mixed, ERR is permitted next to Pad/NonGate.)

Mixed-pair fallback
- If exactly one side is canonical, then one token is present and the other absent. Locally, this permits S_color on the canonical side (GateL/R adjacency), forces S_⊥ on the non-canonical side (NonGate adjacency), allows corridor cells to be Corr_10 or Corr_01 near the canonical side and Corr_00 elsewhere, and crucially allows S↔Corr pairs with S_⊥ (since opposite-direction token is 0). No Ver(⋅) appears (no Corr_11), so the pair accepts unconditionally via PAD/corridor self-loops.

ERR discipline outside special modes
- Outside probes or active seam (i.e., when no Head_j/Accept_j/P⋅p^⋅ or Corr_⋅⋅/Ver(⋅) present), we allow (Pad, Err), (Err, Err), (Err, Pad) to guarantee malformed interiors can always be completed and never constrain f.

B=2 DP audit plan (concrete checklist)
1) TS probe checks: Build four canonical left seeds L(00), L(01), L(10), L(11) whose interior right of S is GateL, P1^{u1}, P2^{u2}, Pad. Set boundary inputs a⋆ (e.g., 0000). For Q_1: boundary outputs (BL1_1, BL2_1, BR2_1, BR1_1); run the DP and confirm extendibility iff u1=1. Similarly for Q_2 vs u2.
2) Seam/mixed pairs: Build R(v) symmetrically so that left of S2 is Pad, P2^{v2}, P1^{v1}, GateR. For each pair (u,v), activate corridor tokens as per GateL/GateR presence. Instantiate the toy succinct graph D as the 4-cycle on {00,01,11,10} with D(u,u)=0. Bake the 16 cases into the allowed Ver(⋅,e,q) alongside the local S2↔Ver acceptance table above. Verify:
   • Mixed pairs (exactly one side canonical) accept for any S_color on the canonical side and S_⊥ on the non-canonical side.
   • Active-active pairs accept iff (D(u,v)=0 or colors differ) AND (u=v ⇒ colors equal). (Since Eq=1 only for u=v, the latter becomes a requirement.)
3) ERR/⊥-escape: Confirm via the adjacency that no Head_j, P⋅p^⋅, Corr_⋅⋅, or Ver(⋅) has any outgoing pair to Err; attempts dead-end as intended.

Alphabet/adjacency budget (B=2 instance)
- Symbols: S(4) + PORT idle(4) + PORT probe(4) + PROBE(4) + Gate*(2) + NonGate(1) + Pad(1) + Err(1) + Corr(4) + Ver(12) + boundary tokens(8) = 45 symbols. Adjacency table lists O(10^2) pairs; well within β for any reasonable β≥64.

Gaps in output.md (observations; no edits made)
- Context set C not explicitly defined in output.md: As used in our reduction and the NEXPTIME upper bound, C denotes types realized by words w_1 S w_2 with |w_i|∈{ℓ_pump, ℓ_pump+1}. It may help to add this remark (|C|≤ℓ_pump), though the main theorems do not depend on it.
- Finite-Z bound is stated (Cor. 4) with Z≤|T|^2; we use this for (F2) in the upper bound. For hardness we neutralize (F2) via ⊥-plumbing; output.md does not describe this family-specific trick (by design), but our notes rely on it.

Obstacles/risks and mitigations
- Verdict e/q linkage to PORT bits (B=2): We sketched two radius-1 realizations: (i) expand Corr/Ver symbols to encode the (u,v) case and list only consistent pairs; (ii) constrain the corridor placement to sit adjacent to the PORT cells and list only (PORT, Corr)/(Corr, Ver)/(Ver, PORT) pairs consistent with the table of (EDGE,Eq). Either is DP-checkable with a finite list; we propose to use (i) to keep the corridor width at two.
- “Simultaneous activation” locality: Resolved via tokens. Must-color and the requirement to attach to Ver(⋅) are triggered solely by the presence of the opposite-direction token on the adjacent corridor cell; this is local and symmetric.
- Probe determinism: We listed the unique successors from BL2_j and from probe-active PORT cells; no pairs to Err/S/Pad are present before Accept_j, preventing escape.

Next steps (auditable deliverables)
1) Finalize the B=2 machine-readable instance: list the exact symbol set and the Cout–out adjacency pairs as above, plus the 16-case table wiring (u,v)↦(EDGE,Eq) into Corr/Ver pairs. Share with the DP harness.
2) Run the DP to validate: TS per-bit probes; mixed-pair acceptance; active-active seam behavior for all 16 (u,v) with the S2↔Ver acceptance table; absence of Err/⊥ escape.
3) Generalize the probe schema to arbitrary B (add Head_j/Accept_j and P_kp^⋅ symbols) and state the O(B^2) adjacency count bound explicitly; verify symbol budgets with β≥c·B^2.
4) Add a short r=1 padding lemma (or cite Lemmas 11, 14–15) guaranteeing existence of canonical contexts at lengths ℓ_pump and ℓ_pump+1 with the PORT zone abutting S; ensure pumping occurs in PAD only.
5) After B=2 validation, formalize Lemma TS (type separation), Lemma RG (gating + tokens), and Lemma SG (seam verdict with EDGE/Eq) and integrate into the curated output once vetted.


=== prover-03.out.json (progress_md) ===
Round 0005 — Parametric radius-1 rule schemas made DP-ready (B=2 instance blueprint) and locality checks consolidated

Context and objective
- We are proving NEXPTIME-hardness of the β-normalized, radius-1 classification on oriented paths by reducing Succinct 3-Coloring to Feasible-Function Existence (F1). The verifier asked for fully local, radius-1 rule schemas that (i) separate 2^B vertex types via per-bit boundary probes, (ii) realize per-side color gating and mixed-pair vacuity, and (iii) implement an active seam with a local verdict enforcing both EDGE=1 ⇒ color-inequality and Eq=1 ⇒ color-equality. We adopt the directional-token activation to keep mixed pairs unconditional and must-color only in active-active pairs. Below I spell out parametric Cout–out rule schemas and instantiate a B=2 DP-auditable skeleton.

Gaps spotted in output.md (minor; no edits)
- None new. The parenthetical “interior inputs may be arbitrary; if the model fixes interior inputs, the definition is with respect to those fixed inputs” is present; we rely on the fixed-interior-inputs interpretation. The finite-Z bound Z ≤ |T|^2 is already recorded (Corollary 4).

Symbols, roles, and disjoint subalphabets (budget discipline)
- We keep disjoint role subalphabets so sizes add, not multiply. Output symbols encode: Role ∈ {S, GATE_L, GATE_R, PORT, PROBE, PAD, RUN, VERD, ERR}, color ∈ {⊥,R,G,B} used only when Role=S, PORT-fields Addr∈{1,…,B}, RIDbit∈{0,1}, probehead ∈ {None, Start_j, Head_j, Test_j, Accept_j}, tokens Tok→,Tok←∈{0,1} present only on RUN/PAD in the bridge, verdict fields (EDGE,Eq,FwdCol) present only when Role=VERD. Cin–out ties RIDbit to Σ_in for Role=PORT and is otherwise permissive.

A. Per-bit boundary probe — parametric Cout–out schema (Type-Separation)
Setup
- Reserve B boundary-output 4-tuples Q_j, j∈[B]. We use only the left pair (positions 1,2) actively; the right pair is a neutral terminator (RB_pad2,RB_pad1). Fix a boundary-input 4-tuple a⋆.
Canonical left block W_L(u)
- Adjacent to S on its right: a contiguous PORT zone of length B with symbols Port(k,b) (Role=PORT, Addr=k, RIDbit=b=u_k). The remainder is PAD/HEAD as filler; RUN is absent unless the seam is active. Addr increases strictly left→right; the PORT zone abuts S.
Allowed Cout–out pairs (all unlisted pairs disallowed)
- Boundary injection and uniqueness:
  • (QL1_j, QL2_j) is allowed for each j; for any i≠j, (QL1_i, QL2_j) is disallowed.
  • (QL2_j, Start_j) is allowed; for any x ≠ Start_j, (QL2_j, x) is disallowed.
- Deterministic march (no error/⊥ escape while probing):
  • (Start_j, Head_j) is allowed; no other successor from Start_j.
  • For any non-PORT role y∈{PAD,HEAD}, (Head_j, Head_j@y) is allowed; pairs (Head_j, ERR_•), (Head_j, ⊥@S), and (Head_j, any non-probehead) are disallowed.
- PORT scan and test at Addr:
  • For k≠j, (Head_j, Head_j@Port(k,b)) is allowed (pass-through over wrong address).
  • For k=j and RIDbit=b:
    – If b=1: (Head_j, Test_j@Port(j,1)) is allowed, then (Test_j@Port(j,1), Accept_j) is allowed.
    – If b=0: no outgoing pair from Head_j into Port(j,0) (dead end).
- Accept exit:
  • (Accept_j, PAD) is allowed; while probehead∈{Start_j,Head_j,Test_j,Accept_j} appears on either endpoint of an edge, no pair with ERR_• nor ⊥ is listed.
- PORT well-formedness (static, local): within the zone, only pairs (Port(k,b), Port(k+1,b′)) are allowed; no skips, no reordering. The left neighbor of Port(1,·) must be S (or the seam’s right S when mirrored).
Claim TS (per-bit separation)
- For any canonical L(u) and the boundary assignment (QL1_j, QL2_j, RB_pad2, RB_pad1), the DP has a legal completion iff u_j=1. Proof: the only possible evolution is the deterministic pipeline above; it reaches Port(j,·) and accepts iff RIDbit=1; no alternative paths or error-plumbing exist during the probe.

B. Per-side gating, directional tokens, and mixed pairs
Per-side gating (local, independent across sides)
- The interior neighbor of S is GATE_L (left side) iff a canonical left block starts there; otherwise PAD/HEAD. Allowed S-adjacent pairs:
  • If neighbor∈{PAD,HEAD}, then only (neighbor, S_⊥) is allowed.
  • If neighbor=GATE_L, then (GATE_L, S_c) is allowed for c∈{R,G,B,⊥}. Symmetrically on the right side with GATE_R.
Directional tokens (purely local activation)
- Seeding:
  • If the cell to the right of S1 is GATE_L and S1∈{R,G,B}, then (S1_c, Tok→=1@RUN) is allowed; otherwise only (S1_token, Tok→=0@PAD/RUN) is allowed.
  • If the cell to the left of S2 is GATE_R and S2∈{R,G,B}, then (Tok←=1@RUN, S2_c) is allowed; otherwise only (Tok←=0@PAD/RUN, S2_token) is allowed.
- Propagation:
  • Along the bridge, only (Tok→=1, Tok→=1) and (Tok→=0, Tok→=0) pairs are listed left→right; similarly (Tok←=1, Tok←=1) and (Tok←=0, Tok←=0) right→left. No pair can spontaneously create a 1 from 0.
Must-color and mixed-pair fallback (enforced locally at S)
- At S1, adjacency to the right neighbor obeys:
  • If neighbor carries Tok→=1: pairs (S1_⊥, neighbor) are disallowed; S1 must be colored and must attach to RUN (or VERD, see below); (S1_c, PAD) is disallowed to prevent neutral fallback in active mode.
  • If neighbor carries Tok→=0: both (S1_⊥, neighbor) and (S1_c, PAD) are allowed (fallback); no activation of RUN.
- Symmetrically at S2 with Tok←.
Consequences
- In mixed pairs (exactly one canonical side), exactly one token is present near S; the colored side is permitted (by GATE_*), the opposite side must be ⊥, and the seam cannot activate (since the opposite-direction token is 0). Neutral PAD-plumbing accepts.
- In active-active pairs, both tokens are 1; locally at S we forbid ⊥ and forbid attaching to neutral neighbors, forcing RUN activation and a verdict neighbor.

C. Seam tableau and verdict adjacency (local enforcement of EDGE and Eq)
Verdict interface (radius-1, small)
- The immediate neighbor to the right of S2 may be VERD(e,q,cFwd) only when both tokens are 1 (RUN active) and after the RUN corridor has stabilized; ERR is disallowed adjacent to RUN/VERD in active mode.
- Allowed S2–VERD pairs implement the conjunction:
  • If e=1 (edge), then Color(S2) ≠ cFwd (forbid equal-color pairs); if e=0, both equal and unequal allowed.
  • If q=1 (same index), then Color(S2) = cFwd (forbid unequal-color pairs); if q=0, both equal and unequal allowed.
- This yields acceptance iff (e=0 or colors differ) and (q=0 or colors equal). We ensure D(u,u)=0 so e∧q never conflicts.
Computation of (EDGE,Eq,FwdCol)
- RUN carries: (i) a one-cell forwarder that copies S1’s color into cFwd (checked by local equality along the corridor), (ii) a fixed-width, row-by-row computation of EDGE=D(u,v) and Eq=[u=v] from the nearby PORT bits, enforced by local row-consistency pairs. In DP-auditable B=2 we tabulate a 4×4 truth table for D and Eq and materialize VERD accordingly.

D. B=2 explicit skeleton (sufficient for DP audit)
Alphabet sketch (names are individual Σ_out symbols; roles are disjoint)
- S: S_R, S_G, S_B, S_⊥.
- Gating: GATE_L, GATE_R.
- PORT: P1^0, P1^1, P2^0, P2^1.
- Probe states: Start_1, Head_1, Test_1, Accept_1, Start_2, Head_2, Test_2, Accept_2.
- Boundary tokens: QL1_1, QL2_1, QL1_2, QL2_2, RB2_pad, RB1_pad.
- Tokens on bridge: Tok00, Tok10, Tok01, Tok11 encoding (Tok→,Tok←)∈{0,1}^2.
- RUN (constant small alphabet) and VERD(e,q,c) for e,q∈{0,1}, c∈{R,G,B}.
Cin–out (radius-0 constraints)
- For PORT symbols: Cin–out allows Pj^b only when Σ_in bit at that node equals b. For all other roles, both input bits are allowed.
Cout–out: key allowed pairs (representative list sufficient for DP harness)
- Probe (j=1): (QL1_1, QL2_1), (QL2_1, Start_1), (Start_1, Head_1), (Head_1, Head_1) over PAD/HEAD, (Head_1, Head_1) over P2^b, (Head_1, Test_1) over P1^1, (Test_1, Accept_1), (Accept_1, PAD). For j=2 swap P1↔P2 in the test pair.
- PORT contiguity: (P1^b, P2^{b′}) allowed; no other PORT–PORT pair.
- Gating: (GATE_L, S_c) for c∈{R,G,B,⊥}; (PAD, S_⊥) and (HEAD, S_⊥) only; similarly on the right with GATE_R.
- Token seeding/propagation (bridge cells immediately inside S): (S_c, Tok10) allowed iff neighbor is right of S1 and S1 is adjacent to GATE_L; otherwise only (S_token, Tok00). Along the bridge, (Tok10, Tok10), (Tok00, Tok00) left→right; symmetrically right→left for Tok←, combining into Tok00, Tok10, Tok01, Tok11.
- Must-color: if neighbor of S has Tok←=1 (i.e., Tok01 or Tok11), pairs (S2_⊥, Tok•) are disallowed; if Tok←=0 (Tok00 or Tok10), both (S2_⊥, Tok•) and (S2_c, PAD) are allowed. Symmetric rule at S1 with Tok→.
- Verdict adjacency (explicit): for each e,q,cFwd and color d∈{R,G,B}, allow (S2_d, VERD(e,q,cFwd)) iff [(e=1 ⇒ d≠cFwd) and (q=1 ⇒ d=cFwd)]. For example, disallow (S2_R, VERD(1,0,R)), allow (S2_G, VERD(1,0,R)); disallow (S2_G, VERD(0,1,R)), allow (S2_R, VERD(0,1,R)). When Tok←=0, VERD never appears (RUN inactive), and neutral PAD neighbors are allowed.
- ERR disabled near PROBE/RUN/VERD: no pairs with ERR on either endpoint adjacent to any of Start_j, Head_j, Test_j, Accept_j, RUN, or VERD.
DP checks to run (auditable)
- TS: For four L(u) with u∈{00,01,10,11}, and the pair (QL1_1,QL2_1) on the left and (RB2_pad,RB1_pad) on the right, verify by O(kβ^2) DP that acceptance equals u_1; similarly QL1_2,QL2_2 yields u_2.
- Seam: Fix a toy D on 4 vertices (e.g., a 4-cycle) and Eq=[u=v]. Ensure RUN places VERD(e,q,·) and S2–VERD adjacency enforces: (i) if D(u,v)=1, only unequal colors pass; (ii) if u=v, only equal colors pass; (iii) mixed pairs accept regardless of the colored canonical side’s choice on S (the opposite side must be ⊥ by gating).

E. Why the rules are local, deterministic where needed, and budget-feasible
- Probe determinism: Reserved boundary pairs Q_j force Start_j uniquely; Head_j has a single successor on every edge; at Addr=j the only way forward depends on RIDbit; ERR/⊥ are not allowed adjacent to probe states. Hence E_{L(u)}(a⋆)[Q_j]=u_j.
- Mixed-pair vacuity and must-color: The opposite-direction token locally indicates whether the seam is active; only when it is 1 do we (i) forbid ⊥ at S and (ii) forbid attaching to neutral PAD; otherwise all fallbacks are allowed.
- Verdict locality: All semantic checks reduce to S2↔VERD adjacency; the forward color is carried explicitly; EDGE and Eq are pinned by the local RUN-to-VERD interface.
- Budget: With disjoint roles, symbols scale as O(B) (PORT and probe states) plus O(1) for others; the Cout–out table uses O(B^2) entries for (Head_j ↔ Port(k,·)) and O(β) elsewhere. Choose β ≥ c·B^2 to leave slack.

F. Obstacles and how addressed
- Token spurious creation: Prevented by listing only (Tok0→Tok0) and (Tok1→Tok1) along the corridor, with seeding tied to GATE_* adjacency; no rule lists 0→1 without a gate.
- Probe escape: All pairs with ERR/⊥ adjacent to probe states are omitted; Start/Head/Test/Accept have unique successors.
- Seam mis-activation: Only the presence of the opposite-direction token adjacent to S forbids ⊥ and neutral neighbors; there is no cross-seam dependence beyond immediate neighbors.
- Length normalization: We still rely on pumping/replacement to realize canonical W_L(u), W_R(v) at lengths ℓ_pump or ℓ_pump+1 with the PORT zone abutting S; we will supply a short, r=1 specialization of Lemmas 11–15 to make this self-contained.

G. Next steps (concrete, auditable)
1) Produce a machine-readable B=2 instance: enumerate Σ_out symbols as listed; provide Cin–out (PORT bit-tying) and Cout–out pairs exactly as above (including the explicit S2–VERD table and probe pairs). Run the O(kβ^2) DP to verify TS and the mixed/active seam behavior on all 16 ordered pairs (L(u), R(v)).
2) Fill in the RUN-to-VERD micro-tableau for B=2: a finite, row-by-row transition system that reads u,v from the two-port zones and writes VERD(e,q,cFwd) adjacent to S2; ensure ERR is disallowed near RUN in active mode.
3) Generalize token and probe tables from B=2 to arbitrary B (the only growth is the set {Start_j,Head_j,Test_j,Accept_j} and the PORT addresses).
4) Write a short r=1 padding lemma: “For each u, there exist left/right contexts of lengths in {ℓ_pump,ℓ_pump+1} with the same near-S structure (HEAD+PORT) and the same type near S,” by pumping PAD and applying Lemma 11 (replacement) to preserve type at the seam.
5) After B=2 validation, promote Lemmas TS (probe separation), RG (gating+tokens), and SG (seam verdict) into the curated output.

H. Minimal claims ready for DP audit (summarized)
- TS: Under the boundary 4-tuples (QL1_j,QL2_j,RB2_pad,RB1_pad), E_{L(u)}(a⋆)[·] equals u_j. Distinct u give distinct left-types; mirrored on the right.
- Mixed pairs accept unconditionally: exactly one token present ⇒ S-side with 0 allows ⊥ and neutral fallback; no RUN/VERD appears.
- Active-active: both tokens present ⇒ must-color; S2↔VERD adjacency enforces simultaneously EDGE and Eq constraints; ERR is disallowed near RUN/VERD.
These are all checkable by the O(kβ^2) DP once the above symbol list and pair tables are instantiated.


=== prover-04.out.json (progress_md) ===
Round 0005 — Parametric, radius-1 rule schemas you can DP-check; adopting directional tokens

Context and objective
- We adopt the verifier’s recommendation to use directional tokens for seam activation. This round supplies explicit, radius-1 Cout–out (and the relevant Cin–out) rule schemas that are ready to be instantiated (especially for B=2) and verified by the O(kβ^2) DP. We also give a short, specialized padding lemma (radius 1) to justify canonical contexts at lengths in {ℓ_pump, ℓ_pump+1} without changing near-S behavior.

A. Per-bit probe: explicit local rules (Type-Separation TS)
Symbols/tracks (folded into Σ_out; disjoint role subalphabets so sizes add):
- Boundary outputs: for each j∈[B], four reserved tokens Q^L1_j, Q^L2_j, Q^R2_j, Q^R1_j. All non-reserved boundary outputs are ordinary tokens Bnd•.
- PORT zone (adjacent to S on canonical left): Port^I(k,b) and Port^P(k,b) for k∈[B], b∈{0,1}. Port^I used in idle, Port^P in probe mode; both carry (Role=PORT, Addr=k, RIDbit=b).
- Probe states per j: Start_j, Head_j, Test_j, Accept_j (Role=PROBE). No other role has ProbeHead≠None.
Cin–out constraints:
- When Role=PORT, RIDbit equals the node’s input bit; otherwise unrestricted.
Cout–out pairs (all omitted pairs are illegal):
- Boundary injection (reserved probes only): (Q^L1_j, Q^L2_j) and (Q^L2_j, Start_j). No other successor from Q^L2_j.
- Corridor marching to PORT[1]: (Start_j, Head_j). For any non-PORT corridor cell y, (Head_j_prev, Head_j_y). No pairs from Head_j to ERR/⊥ (disables escape).
- Entering PORT and scan-by-address:
  • For any k,b: (Head_j_prev, Port^P(k,b)).
  • If k≠j: (Port^P(k,b), Head_j_next) (head keeps moving).
  • If k=j and b=1: (Port^P(j,1), Test_j), then (Test_j, Accept_j). If k=j and b=0: Test_j has no legal successor (dead-end). No (Test_j,•) except (Test_j,Accept_j).
- Accept exit to PAD: (Accept_j, PAD), and then PAD self-loops.
- Mode exclusivity: Any adjacency involving Start_j/Head_j/Test_j/Accept_j appears only under Q_j; there are no pairs from PAD/HEAD/PORT^I into any PROBE state. Thus PROBE states cannot spontaneously appear unless Q_j is used.
- PORT contiguity/monotonicity (independent of probes): For consecutive PORT cells x→y, allowed pairs enforce Addr(x)+1=Addr(y), starting at Addr=1 and ending at Addr=B. This makes a contiguous block abutting S; non-PORT intrusions in between have no legal pairs with PORT neighbors.
Claim TS (restated, DP-checkable): For canonical L(u) with a well-formed contiguous PORT zone at S, and fixed boundary inputs a⋆, the DP on the 4-node boundary with outputs Q_j accepts iff u_j=1, hence E_{L(u)}(a⋆)[Q_j]=u_j. Determinism comes from unique successors and the prohibition of ERR/⊥ near PROBE.

B. Per-side color gating and seam activation with directional tokens
Symbols/tracks:
- S-color tokens at the two S nodes: S_⊥, S_R, S_G, S_B.
- Gate tokens adjacent to S inside canonical blocks: GateL on left interior neighbor of S1; GateR on right interior neighbor of S2.
- Corridor roles across the bridge wb∘wc: RUN, PAD, VERD (verdict cell role). Each corridor symbol encodes Tok→,Tok←∈{0,1} (two bits) used only on corridor roles.
Local gating at S (Cout–out pairs touching S and its interior neighbor):
- Permission: If neighbor is GateL (resp. GateR), allow S∈{S_R,S_G,S_B,S_⊥} on that side; else only S_⊥ allowed. This is per-side, independent.
Directional token seeding (purely local):
- If the interior neighbor is GateL and S1∈{S_R,S_G,S_B}, then the immediate corridor cell to the right of S1 must have Tok→=1; otherwise Tok→=0.
- If the interior neighbor is GateR and S2∈{S_R,S_G,S_B}, then the immediate corridor cell to the left of S2 must have Tok←=1; otherwise Tok←=0.
Token propagation (deterministic):
- For any corridor edge x→y, allowed iff Tok→(y) ≥ Tok→(x) and Tok←(y) ≥ Tok←(x), and once a token bit becomes 1 it stays 1 across the entire bridge (monotone propagation). Concretely, list the four allowed bit-pairs per edge: (0,0)→(0,0), (1,0)→(1,0), (0,1)→(0,1), (1,1)→(1,1). Disallow any decrease.
Must-color and mixed-pair fallback (local checks at S):
- If the interior neighbor’s Tok bit from the opposite side is 1 (Tok→ at S1’s neighbor; Tok← at S2’s), then the only allowed S tokens are S_R,S_G,S_B (forbid S_⊥). Also, in this case S must attach to a non-PAD verdict/corridor neighbor (see C below); attaching to neutral PAD is forbidden. If the opposite token bit is 0, both S_⊥ and S_{R,G,B} are allowed and may attach to PAD neighbors (mixed/inactive acceptance).
Remark: These three rules ensure: (i) only canonical sides can choose colors; (ii) must-color is enforced only in active-active (both tokens present); and (iii) mixed pairs accept via PAD-only plumbing.

C. RUN tableau and verdict cell with local EDGE/Eq gate
Verdict neighbor format:
- The cell immediately to the right of S2 (inside the corridor) takes a role VERD(e,q,c) with e=EDGE∈{0,1}, q=Eq∈{0,1}, and c=FwdColor∈{R,G,B}. A 1-bit forwarder track copies S1’s color along the corridor; pairwise neighbor equalities enforce consistency until VERD.
Local acceptance at S2↔VERD (enumerable finite list):
- Allowed pairs (S2, VERD(e,q,c)) exactly when both constraints hold:
  • If e=1, then S2’s color ≠ c; else (e=0) no restriction.
  • If q=1, then S2’s color = c; else (q=0) no restriction.
- Concretely: for e=0,q=0 allow all 3×3 color pairs; e=1,q=0 allow all unequal pairs; e=0,q=1 allow only (S2=c); e=1,q=1 allow none (this case should be unreachable if D(u,u)=0; if it occurs due to a malformed tableau, the instance correctly dead-ends).
RUN corridor robustness and activation:
- When both Tok→=Tok←=1 (active-active), Cout–out permits only RUN/VERD states (no ERR/⊥) and requires a well-formed row-by-row simulation of U that reads (enc(D), u, v). Any malformed step has no legal continuation (local refutation). When at least one token is 0, RUN/VERD symbols are disallowed and PAD plumbing is allowed.

D. B=2 auditable micro-instance (symbol list and key pairs)
Symbols (minimal set):
- S: S_⊥, S_R, S_G, S_B.
- PORT (left): Port^I(1,0/1), Port^I(2,0/1), Port^P(1,0/1), Port^P(2,0/1).
- Probe: Start_1, Head_1, Test_1, Accept_1; Start_2, Head_2, Test_2, Accept_2.
- Boundary: Q^L1_1,Q^L2_1,Q^R2_1,Q^R1_1 and same for j=2; also generic Bnd• tokens.
- Gate: GateL, GateR.
- Corridor: PAD_00, PAD_10, PAD_01, PAD_11 (PAD with Tok→Tok← bits), and VERD(c∈{R,G,B}, e∈{0,1}, q∈{0,1}); RUN_x (finite work alphabet, omitted here but locally checked).
Key Cout–out pairs (subsample; full set by schemas A–C):
- Probes: (Q^L2_1, Start_1), (Start_1, Head_1), (Head_1, Port^P(1,b)), (Port^P(1,1), Test_1), (Test_1, Accept_1), (Accept_1, PAD_00), (Head_1, Port^P(2,b)), (Port^P(2,b), Head_1). Mirror for j=2.
- PORT contiguity: (Port^I(1,•), Port^I(2,•)) allowed; (Port^I(2,•), non-PORT) terminates block; no other cross.
- Gating at S1: (GateL, S_{R/G/B/⊥}) allowed; (non-GateL, S_⊥) only. Similarly for S2 and GateR.
- Token seeding/propagation: From GateL with S1∈{R,G,B} require the right neighbor be PAD/RUN with Tok→=1; else Tok→=0. Along corridor, (PAD_ab, PAD_ab) and (PAD_a b, PAD_a b) with nondecreasing bits as above.
- Must-color: If the cell next to S2 has Tok←=1, forbid (S_⊥, •) and forbid attachment to bare PAD; require the neighbor be VERD or a RUN boundary state. If Tok←=0, allow (S_any, PAD_•0) freely.
- Verdict: enumerate allowed (S2_color, VERD(e,q,c)) as per C.
DP audit steps:
1) Build L(00), L(01), L(10), L(11) with a length-2 PORT zone abutting S and seed HEAD/PAD elsewhere. Fix a⋆. Verify E_{L(u)}(a⋆)[Q_1]=u_1 and E_{L(u)}(a⋆)[Q_2]=u_2.
2) Define a toy D on 4 vertices (00–01–11–10–00). Implement U as a constant table writing VERD(e,q,c) with q=1 iff u=v and e=1 on edges. For all 16 ordered pairs (L(u),R(v)): active-active accepts iff [(edge ⇒ colors differ) ∧ (u=v ⇒ colors equal)]. Mixed pairs (exactly one Gate) accept for any color on the canonical side and ⊥ on the other.

E. Padding lemma for canonical contexts (radius 1, specialized)
Lemma Pad (explicit). Fix any finite “near-S” pattern W (HEAD·PORT(B)·RUN), and a PAD filler P (Role=PAD) whose Type(P^t) stabilizes by t≥t0 (exists by Lemma 15). For each large ℓ∈{ℓ_pump, ℓ_pump+1}, there exists t such that |P^t·W|=ℓ and Type(P^t·W) depends only on Type(W) (independent of t once t≥t0). Moreover, since PAD never uses PROBE/RUN/PORT roles, the probe/seam interfaces at S are unchanged.
Proof sketch: By periodicity of Type(P^t) and replacement (Lemma 11), increasing t beyond t0 does not change Type(P^t·W). Adjust t by at most 1 to hit the desired length. Apply symmetrically on the right. Hence canonical contexts with PORT abutting S exist at both target lengths without altering the gadgets.

F. Budget and locality recap (for the tables you will instantiate)
- Disjoint role subalphabets (S, PORT, PROBE, GATE, PAD, RUN, VERD, BOUNDARY) prevent unintended cross-products; sizes add. Dominant counts: O(B) PORT symbols (both I/P variants) and O(B) probe states. Adjacency table has O(B^2) nonzeros from (Head_j↔Port^P(k,•)) and a constant number elsewhere. Choose β ≥ c·B^2.

Gaps/clarifications in output.md
- None critical remain; output.md already states the “fixed interior inputs” interpretation parenthetically in Definitions. You may consider adding a short note that C (context types) is realized by w_1 S w_2 with |w_i|∈{ℓ_pump,ℓ_pump+1}, hence |C|≤ℓ_pump (used implicitly in our verifier loops).

Next steps (auditable)
1) Instantiate the above schemas for B=2: provide the full Cin–out mask (RIDbit copy) and the complete Cout–out table fragment covering A–D.
2) Run the O(kβ^2) DP to validate TS and the seam behavior on all 16 pairs; include traces for any failing pair (none expected).
3) Generalize the B=2 tables parametrically to arbitrary B (the only growth is in the families {Port^•(k,·)} and {Start/Head/Test/Accept}_j and {Q}_j).
4) Incorporate Lemma Pad (E) into output.md as a short lemma once the DP confirms behavior.
5) Package the S3Col→FFE(F1) reduction with these gadgets; ensure ⊥-plumbing makes (F2) vacuous, concluding NEXPTIME-hardness of the 3-way classifier in this explicit model.

=== Verifier (summary_md) ===

=== Verifier (verdict) ===
partial success

