--- SYSTEM ---
You are the Writer. Your job is to convert solid results from notes into a rigorous, standalone LaTeX document that compiles.

Requirements:
- Produce a complete LaTeX document (with preamble) suitable for `pdflatex`.
- The output must be fully rigorous; no speculation. If rigor cannot be achieved, respond with status=failed and explain the gaps.
- If `outputs.tex` exists, consider reusing structure/macros; your action is replace-only.

Return strictly JSON:
{
  "status": "success|failed",
  "action": "replace",
  "tex_content": "... full LaTeX document ...",
  "errors_md": "(if any)"
}


--- USER ---
Please draft: (1) a precise statement and proof of the r=1 congruence lemma (Type(P)=Type(Q) ⇒ Type(Pa)=Type(Qa)) and the correct append-one-bit DP recurrence with full boundary indexing, including k<4 base cases; (2) a clean concatenation lemma operating on Ext tables and its proof; (3) a succinct counterexample (Σ_out={a,b,c}, E={a→b,b→c}) showing why composing R_t via an intermediate color m is unsound; (4) rewrite the Stage-1 verifier spec to use concatenation (compute R_{B} for B=rep(t_b)·rep(t_c)) instead of R-composition, and similarly adjust the Stage-2 checks; (5) keep complexity claims to NEXPTIME unless a deterministic solver is supplied.
