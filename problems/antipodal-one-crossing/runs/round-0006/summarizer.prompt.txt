--- SYSTEM ---
You are a research **summarizer**. Summarize this *last round only* for a human log.

Include:
- 3–7 bullet **Highlights** (facts learned, reductions, counterexamples, partial bounds).
- 1–3 **Open questions / TODOs** for the next round.
- 1–3 **Citations to files** you relied on (e.g. round files or papers by name).

**Return strictly JSON**:
{
  "summary_md": "Readable summary of the round (≤200 words)",
  "highlights": [],
  "next_questions": []
}

--- USER ---
=== prover-01.out.json (progress_md) ===
Round 0006 — Firming up the both-good (u_v) refinement: boundary-label equivalence; global inequality; and actionable LP prep

Audit of output.md (gaps and precisions)
- What is solid: The anchored-driven refinement is now fully rigorous (Lemma I; Proposition J; Lemma K for boundary sampling; explicit finite-n constants Corollary E0.1, Corollary J1′). This quantitatively converts degree imbalance into a linear gain.
- Remaining gap flagged in verifier notes: The complementary both-good refinement via the c_v-labels (u_v) is not yet curated because we lacked a clean justification that, at a both-good boundary, the boundary switch indicator equals [c_v(K) ≠ c_v(L)]. This equivalence is actually a consequence of the exact way Dvořák’s modification uses f at boundaries for good Q3’s. Below I state a short lemma (Boundary-label equivalence) and then a global Proposition (both-good u_v gain) that can be added to output.md.

New lemma (to add): Boundary-label equivalence for good Q3’s
- Statement. Fix a boundary j and let v=v_{3j} be its shared vertex. Suppose both neighboring Q3’s at boundary j are good. Let K,L be their (ordered) 3-sets of directions as in Lemma K. With c_v(·) as in Corollary D (the color at v of the first edge along f1 inside a good Q3), we have
  1_{switch at boundary j} = 1[ c_v(K) ≠ c_v(L) ].
- Proof idea (clean, local). In the modified geodesic, the 3-step segment used inside a good Q3(v,w) is (v, f(v,w), f(w,v), w) with f=f1 (since for good cubes f2≡f1 by Dvořák’s definition). At boundary j, the last edge of the preceding block is (f(v, v_{3j−3}), v), and the first edge of the next block is (v, f(v, v_{3j+3})). Both are of the form (v, f(v, ·)) and hence have colors c_v(K) and c_v(L), respectively. Therefore a boundary switch occurs if and only if these two colors differ, i.e., iff c_v(K)≠c_v(L).
- Why useful here. This bridges the previously missing step and legitimizes translating the both-good boundary switch distribution into the disagreement distribution of the c_v-labels under disjoint sampling of K,L.

Proposition (both-good boundary refinement via u_v)
- Setup. For each vertex v, let G_v be the set of good triples at v, c_v:G_v→{R,B} the first-edge color at v under f1, p_v the c_v-red fraction, and u_v:=|2p_v−1|. For a boundary j with shared vertex v, let q_v be the conditional probability (given v_{3j}=v) that both neighboring Q3’s are good.
- Claim. With the boundary-label equivalence and Lemma C, we have
  E[1_{both-good at boundary}·1_{switch}] = a/2 − (1/2)·E_v[q_v·u_v^2] ± o(1).
  Consequently,
  E[switches] ≤ (1/3 + b/12)·n − (1/6)·E_v[q_v·u_v^2]·n + o(n).
- Proof. Condition on a fixed boundary j and v=v_{3j}. By Lemma K, (K,L) is uniform over ordered disjoint pairs and independent of v. Conditioning further on both-good at v restricts (K,L) to ordered disjoint pairs in G_v; by uniformity, (K,L) is uniform on that subset. By the boundary-label equivalence, the boundary switch occurs iff c_v(K)≠c_v(L). Lemma C (applied with T=G_v and labeling c_v) gives P[c_v(K)≠c_v(L)] = 1/2 − u_v^2/2 ± O(1/n). Thus, conditioning on v,
  E[1_{both-good}·1_{switch} | v] = q_v·(1/2 − u_v^2/2) ± O(1/n).
Averaging v uniformly (Proposition G) yields the displayed equality. Summing over ≈n/3 boundaries and adding the interior term (1 − p/2) per block gives the global inequality. ∎
- Corollary (explicit unconditional coefficient). Anchored ⇒ good implies q_v ≥ τ_v^2 − O(1/n) (Lemma E0 plus Lemma E). Hence
  E[switches] ≤ (1/3 + b/12)·n − (1/6)·E_v[τ_v^2·u_v^2]·n + o(n)
  ≤ (1/3 + b/12 − (1/96)·E_v[u_v^2] + o(1))·n,
using τ_v ≥ 1/4 − O(1/n).
- Why useful. This provides a second, rigorous, vertex-averaged saving that applies even when degree-variance T_v is tiny. It complements Proposition J and cleanly isolates the (still difficult) regime where both T_v and u_v are small.

Relationship between the two refinements (anchored vs u_v)
- They hold simultaneously and provide two independent lower bounds on the both-good boundary saving; at analysis time we may take their maximum. Formally we state them as separate propositions to avoid double counting, since anchored-pairs are a subset of both-good.
- Sanity checks:
  • Balanced degrees and symmetric c_v (u_v=0): u_v route gives no gain; anchored route also gives none as T_v=0.
  • Degree-biased but c_v perfectly balanced (contrived): anchored route still yields a linear gain via T_v.
  • Balanced degrees but c_v has variance (u_v^2>0): the u_v route yields a linear gain even when T_v≈0.

Small auxiliary inequality (anchored triples imply a baseline u_v)
- For any v with red degree r, anchored triples at v force c_v(K) to equal the star color on those K, hence
  u_v ≥ |C(r,3) − C(n−r,3)| / (C(r,3) + C(n−r,3)).
  As n→∞ with x=r/n=1/2+t,
  u_v ≥ 6|t| + O(t^3),
  since (x^3 − (1−x)^3)/(x^3 + (1−x)^3) = (3/2)|2t| + O(t^3) divided by (1/4+3t^2). This lower bound is exact (finite-n) in the displayed ratio form using only “anchored ⇒ good” and τ_v. It shows u_v cannot be uniformly tiny if degree-imbalance is macroscopic, and quantifies how T_v feeds into u_v.

Examples (toy instances to test the u_v route)
- Dictatorial-direction Q3 (bad): shows that c_v is undefined there; consistent with us only using c_v on good triples.
- Mixed good classes with a marked vertex (balanced star): it is possible to arrange at a single v that p_v≠1/2 (u_v>0) while r_v=n/2 by biasing the f1-start colors across non-anchored good classes; this illustrates that the u_v route can operate in T_v≈0 regimes.

Notes on constants and finite-n bookkeeping
- The o(1) in the u_v proposition can be replaced by an explicit ≤ (20/(n−12)) using Corollary E0.1 when translating disjoint-pair uniformity for G_v; this makes the finite-n coefficient fully explicit, matching the style of Corollary J1′.
- For clarity when curating: state explicitly that ordered/unordered distinctions do not affect disagreement ratios under uniformity; in the both-good conditioning, (K,L) is uniform over ordered disjoint pairs in G_v.

LP blueprint (balanced regime) — concrete next actions
- Enumerative input for the LP:
  1) List marked-Q3 isomorphism classes (2-colorings of Q3 with one vertex marked), tag good/bad (by Dvořák’s definition), and for good classes record the f1-start color at the mark.
  2) For each class π, tabulate the triple of face-types at the mark among {mono, two-adjacent, two-opposite, alternating}. This induces linear maps z_π ↦ star- and 4-cycle-type marginals at v.
- Constraints (recap): normalization; marginalization from z_π to star and 4-cycle types; 4-cycle consistency across the three faces at v and across cubes sharing a face; Dvořák’s badness filters (Lemma 9 at v and at the antipode in the cube); color-swap and S_n symmetries; disjoint-pair product approximation with ±20/(n−12) slack.
- Objective: maximize b_v under these constraints. Any universal optimum < 1/2 (for large n) yields b ≤ 1/2 − γ and thus beats 3/8 universally.

Obstacles and why they matter
- The LP requires the marked-Q3 enumeration; without it we cannot compute the face-type linear maps nor enforce the badness filters precisely.
- Combining the two savings (anchored and u_v) additively is not immediate due to overlap on anchored-good pairs; we therefore present them as separate bounds and take the stronger one when analyzing a given coloring.

Next steps (auditable deliverables)
1) Curate the Boundary-label equivalence lemma and the u_v Proposition (both-good refinement) into output.md, together with the finite-n explicit version using Corollary E0.1.
2) Add the simple anchored-implies-u_v lower bound (ratio of binomials) as an auxiliary lemma; it clarifies how T_v forces u_v.
3) Begin the marked-Q3 enumeration with a marked vertex: produce the class list and the (good/bad, f1-start, face-type) table. This concretely instantiates the LP for the balanced regime.

Why this advances the program
- It closes the key gap in the both-good refinement, providing a second rigorous, vertex-averaged saving term. Together with the anchored route, we now have two robust mechanisms that yield linear-in-n improvements in large structural regimes. The LP plan targets the remaining near-balanced case where both T_v and u_v^2 are small, exactly the obstruction to a universal δ>0 improvement over 3/8.


=== prover-02.out.json (progress_md) ===
Round 0006 — Firming up the u_v-based both-good refinement: boundary–label equivalence, conditioning, and a rigorous global inequality; plus minor audits and next steps

Audit of output.md (gaps and clarifications)
- Good: The anchored-driven refinement (Lemma I, Proposition J, Corollary J1, I.1) is now rigorous and self-contained; Lemma K (uniformity of boundary direction pairs) and Corollary E0.1 provide the needed sampling backbone with explicit finite-n constants.
- Gap to close: The complementary both-good refinement via u_v (outlined in notes.md and earlier rounds) is still missing from output.md because we had not yet proved that the boundary switch equals the disagreement of the c_v labels when both neighboring Q3’s are good. This round supplies that equivalence and the uniformity-of-conditioning step, enabling a rigorous Proposition (K-type) and its global corollary.

New lemmas (ready to curate)
- Lemma L (Boundary–label equivalence for good Q3’s at the shared vertex v). Fix a good Q3(v,w) and Dvořák’s choice f∈{f1,f2}, so the path used inside Q3(v,w) from v to w is (v, f(v,w), f(w,v), w). Define c_v(K) to be the color of the edge (v, f(v,w)) (as in Corollary D). Consider a boundary between two consecutive blocks with shared vertex v where the previous block uses Q3(v′,v) and the next block uses Q3(v,w). Then the color of the incoming edge at v (last edge of the previous block) equals the color of the edge (f(v,w), v) in Q3(v,w) and thus equals c_v of the previous cube’s 3-set; the color of the outgoing edge at v (first edge of the next block) equals the color of (v, f(v,w)) and thus equals c_v of the next cube’s 3-set. Hence, on the both-good event, “switch at the boundary” is exactly the event [c_v(K_prev) ≠ c_v(K_next)].
  Proof. For the previous block Q3(v′,v), the used path is (v′, f(v′,v), f(v,v′), v). The last edge at v is (f(v,v′), v), which is the same undirected edge as (v, f(v,v′)) whose color defines c_v(K_prev). For the next block Q3(v,w), the first edge at v is (v, f(v,w)), which is exactly the edge whose color defines c_v(K_next). Since edge colors are undirected and f satisfies d(f(w,v), f(v,w))=1, the boundary switch occurs iff these two colors differ. ∎

- Proposition G3 (Both-good conditioning is uniform on disjoint good pairs and E_v[q_v]=a). Fix a boundary index j. Condition on the shared vertex v=v_{3j}. By Lemma K, the ordered pair (K,L) of direction 3-sets is uniform over ordered disjoint pairs and independent of v. Conditioning further on K,L∈G_v (both cubes good at v), (K,L) is uniform over ordered disjoint pairs from G_v. Consequently, with q_v := P[K,L∈G_v | v], we have E_v[q_v] = a, where a is the global both-good probability for neighboring Q3’s.
  Proof. Uniformity before conditioning is Lemma K. Conditioning on K,L∈G_v restricts to a uniform law on the induced set of disjoint good pairs. Averaging over v (uniform by Proposition G) yields E_v[q_v]=P(both good)=a. ∎

Proposition K (Both-good boundary refinement via u_v — rigorous statement and proof)
- Setup at v. Let G_v⊆C([n],3) be the set of good triples at v, c_v: G_v→{R,B} the label defined in Corollary D, p_v the red fraction, and u_v:=|2p_v−1|.
- Boundary-level identity. At a fixed boundary j with shared vertex v, on the event that both neighboring Q3’s are good, Lemma L implies
  P[switch at boundary j | v, both-good] = P[c_v(K)≠c_v(L) | v, K,L∈G_v].
  By Proposition G3, (K,L) is uniform over ordered disjoint pairs from G_v; hence by Corollary D (pair-sampling under disjointness),
  P[switch | v, both-good] = 1/2 − u_v^2/2 ± O(1/n).
- Averaging (using E_v[q_v]=a). Let q_v := P[K,L∈G_v | v]. Then
  E[1_{both-good}·1_{switch at boundary}] = E_v[q_v·(1/2 − u_v^2/2)] ± O(1/n)
  = (a/2) − (1/2)·E_v[q_v·u_v^2] ± O(1/n).
- Global bound. Summing over ≈n/3 boundaries and adding the interior 1 − p/2 per block, we obtain
  E[switches] ≤ (1/3 + b/12)·n − (1/6)·E_v[q_v·u_v^2]·n + o(n).
- Unconditional corollary (via the anchored lower bound on q_v). Since anchored triples A_v ⊆ G_v, Lemma E0 with T=A_v gives q_v ≥ P[K,L∈A_v | v] = τ_v^2 ± O(1/n). Therefore
  E[switches] ≤ (1/3 + b/12)·n − (1/6)·E_v[τ_v^2·u_v^2]·n + o(n)
  ≤ (1/3 + b/12 − (1/96)·E_v[u_v^2] + o(1))·n,
  using τ_v ≥ 1/4 − O(1/n).
- Why useful here. This furnishes a second, independent both-good saving that can be nontrivial even when the degree-variance T_v is tiny but the good-cube label bias u_v has variance. In particular, in highly biased stars (e.g., r_v∈{0,n}), u_v=1 and τ_v=1, and the bound yields the same −1/6 savings per n as the anchored route, matching expectations.

Consistency and non-overcounting
- The anchored-driven bound (Proposition J) and the u_v-driven bound (Proposition K) both act on the both-good boundary term. They should not be added; instead, one may take their pointwise maximum or pick the stronger one for a given coloring. For the purposes of output.md, we recommend adding Proposition K as an independent refinement and stating the final bound as the minimum of the two right-hand sides; in analysis we can use whichever gives the larger saving.

Small sanity checks
- Balanced degrees and balanced labels: If r_v≡n/2 and c_v is balanced (u_v≡0), then Proposition K yields no improvement, as desired. Proposition J also yields no improvement (T_v≡0); we revert to Dvořák’s baseline (1/3 + b/12 + o(1))·n.
- Extreme bias: If r_v∈{0,n} and (hence) u_v≡1 and τ_v≡1, Proposition K gives a saving (1/6)·n, consistent with Proposition J’s (2/3)·τ_v^2 T_v n = (2/3)·(1)·(1/4)·n = (1/6)·n.

Finite-n remarks
- Using Corollary E0.1 with T=A_v (anchored set), we can make the inequality q_v ≥ τ_v^2 − 20/(n−12) explicit for n≥20. This yields an explicit finite-n version of the u_v-bound: replace E_v[τ_v^2·u_v^2] by E_v[(τ_v^2 − 20/(n−12))_+·u_v^2], keeping the remainder in the o(n) term.

How to add to output.md
- Add Lemma L (boundary–label equivalence) under the “Additional proven results” section.
- Add Proposition G3 (uniformity under both-good conditioning and E_v[q_v]=a).
- Add Proposition K with the full proof above, and a Corollary K1 stating the unconditional 1/96 bound via τ_v ≥ 1/4.
- Optional: include the finite-n explicit slack from Corollary E0.1 in Proposition K’s error term.

Obstacles and open points
- We still lack a universal lower bound on E_v[u_v^2] (and on E_v[T_v]). Thus neither Proposition J nor K alone gives an unconditional δ>0. The remaining bottleneck is the “balanced regime” where both T_v and u_v^2 are tiny; here we must push b ≤ 1/2 − γ.
- Discrete minimization of H(r,n): still optional; not needed for the current propositions.

Next steps (auditable)
1) Curate Lemma L, Proposition G3, and Proposition K (with its corollary) into output.md, using Corollary E0.1 to make the finite-n error explicit if desired.
2) Begin the balanced-regime LP: enumerate marked-Q3 isomorphism classes with a marked vertex; tag good/bad and, for good, the f1-start color at the mark; compute each class’s triple of face-types at the mark. This table feeds the LP variables z_π and linear constraints to star/face marginals.
3) Implement the first LP relaxation (balanced r_v=n/2) with symmetry reductions and product-approximation for disjoint pairs, including explicit ±20/(n−12) slack. Solve numerically to estimate γ in b ≤ 1/2 − γ.
4) Optional: prove the discrete minimization of H(r,n) at balance (n≥8) for completeness.

Why this is progress
- We resolved the key missing justification for the u_v-based both-good refinement by proving the boundary–label equivalence (Lemma L) and the correct conditioning uniformity (Proposition G3). This enables a fully rigorous Proposition K and a clean global inequality yielding a linear saving proportional to E_v[τ_v^2·u_v^2]. Together with Proposition J, we now have two independent, checkable mechanisms that turn local imbalances (degree or label) into global savings, cleanly isolating the balanced regime for the forthcoming LP attack on b. 

=== Verifier (summary_md) ===

=== Verifier (verdict) ===
partial success

