=== SYSTEM ===
You are a research mathematician. 

You are being run in a loop with a verifier that checks rigor. Your goal is to make **incremental, auditable progress**. You are not expected to solve the problem at once, but to generate new, testable ideas.

Inputs: 
- task statement 
- notes.md (summary of past progress; optional) 
- output.md (rigorously proven results curated so far; optional) 
- summary of past rounds (optional) 
- possibly some reference papers.

What counts as progress:
- Extract small lemmas/heuristics from literature and state them cleanly with one-line "why useful here".
- Explore small examples & try to break your own claims with toy counterexamples.
- Prove special cases or nontrivial bounds.
- If an approach fails, explain crisply why.
- Point out flaws in notes.md or output.md (but do not rewrite output.md yourself).

**Discipline.** 
- Read notes, outputs, summaries carefully before proposing new work. 
- Reference papers if relevant, but focus on *incremental, checkable steps*. 
- Do not output Markdown code fences, only raw JSON. 
- Length: at least ~200 words. 
- Organize your reasoning with short headings (Ideas, Examples, Obstacles, Next steps), make clear what your claims are and how they are supported. 
- Remember: the verifier curates notes and outputs, you only suggest.

**Return strictly JSON**:
{
  "progress_md": "Your progress notes for this round in Markdown (KaTeX allowed). Point out any gaps in output.md clearly. Do not modify output.md directly."
}


=== USER ===
=== Task (txt) ===

# Problem Statement

We consider the problem of estimating the winner in an election run under **Ranked Choice Voting** (also known as *Instant-Runoff Voting*).  

Suppose there are \(K\) candidates. Each voter submits a complete ranking of these candidates. The voting rule proceeds in rounds: in each round, every ballot is assigned to the top-ranked candidate who is still in contention. The candidate with the smallest number of votes is eliminated (with ties broken according to a fixed deterministic rule), and this candidate is crossed out from all ballots. The process repeats until only one candidate remains, who is declared the winner.

Our goal is not to compute the exact winner from the full set of ballots, but rather to estimate a *robust* winner from a random sample of ballots. To make this precise, we introduce the notion of an **ε-winner**. A candidate \(c\) is called an ε-winner of an election profile if it is possible to add at most an ε-fraction of additional ballots to the election so that \(c\) becomes the winner under Ranked Choice Voting. In other words, \(c\) is “close” to being the true winner, in the sense that a small perturbation of the electorate would make \(c\) win. There may be more ε-winners. The real winner is ε-winner for any ε. 

The sampling model is as follows. We assume there is a large population of voters, each ballot drawn independently from the empirical distribution of this population. The algorithm does not see all the ballots; instead, it may sample ballots at random, with replacement. The task of the algorithm is: given parameters \(\varepsilon\) and \(\delta\), and access to at most \(m\) random ballots, output a candidate \(\hat{c}\) such that with probability at least \(1-\delta\), the candidate \(\hat{c}\) is an ε-winner of the true election.

There is a natural algorithm for this problem: Sample a subset of votes and run the ranked-choice algorithm on them; output the winner. How many samples are needed for this algorithm to succeed? We seek the best possible upper and lower bound. 



=== Notes ===

# Notes



# Path-wise IRV certification and concentration

- Define, for any subset A of candidates and candidate x ∈ A, the linear functional score_x(P; A) := Pr_{b∼P}[x is the top-ranked among A on ballot b]. For a fixed elimination order σ = (e_1, e_2, …, e_{K-1}, w), define A_r := [K] \ {e_1,…,e_{r-1}} and, for each y ∈ A_r \ {e_r}, the margin functional d_{r,y}(P) := score_y(P; A_r) − score_{e_r}(P; A_r).
- Feasibility of σ under P is equivalent to d_{r,y}(P) ≥ 0 for all r and y; ties are broken by a fixed rule consistent with σ.
- Certificate distribution: Let R be the full ranking that lists candidates in the order (w, e_{K−1}, e_{K−2}, …, e_1). Let Q be the point mass on R. Under Q, for every round r, e_r is never top among A_r (so score_{e_r}(Q; A_r)=0). The top among A_r is always w, hence d_{r,y}(Q) = 1 if y=w and 0 otherwise.
- Additive-ballot model: Adding an α-fraction of additional ballots from Q transforms P into P′ := (P + α Q)/(1+α). For any linear functional ℓ, ℓ(P′) = (ℓ(P) + α ℓ(Q))/(1+α).
- Uniform concentration: The family of functionals F := { (A, y, x) ↦ score_y(·; A) − score_x(·; A) : A ⊆ [K], |A|≥2, y≠x∈A } has cardinality U = Σ_{s=2}^K C(K,s) s(s−1) = K(K−1) 2^{K−2}. Hoeffding plus a union bound yields that with m ≥ C (log U + log(1/δ))/ε^2 = C' (K + log(1/δ))/ε^2, we have |ℓ(S) − ℓ(P)| ≤ ε for all ℓ ∈ F w.p. ≥ 1−δ.
- Path-wise certificate (informal): If IRV run on the sample S produces σ, and d_{r,y}(S) ≥ 2ε for all r,y on that path, then on the uniform concentration event, d_{r,y}(P) ≥ ε. Adding α=ε fraction of ballots from Q makes d_{r,y}(P′) ≥ ε/(1+ε) for y≠w and ≥ (ε+ε)/(1+ε) for y=w, so σ is feasible on P′ and w wins. Thus w is an ε-winner.

Remarks and contrasts
- This approach controls adaptivity: we concentrate uniformly over all d_{r,y}, so the random sets A_r along the sample path pose no extra difficulty.
- A previously suggested per-round “repair by adding ≤ 2η mass” must be reformulated as a single added distribution Q (e.g., the ranking R above). Sequential repairs are hard to compose rigorously due to renormalization and cross-effects.
- Identity check: Σ_{s} C(K,s) s(s−1) = K(K−1) 2^{K−2} follows from evaluating E[S(S−1)] for S∼Bin(K,1/2).

Next targets
- Write a clean theorem: with m ≥ C (K+log(1/δ))/ε^2, with prob ≥ 1−δ, either some empirical margin < 2ε (no certificate), or the sample winner is an ε-winner. Provide full proof under the additive-ballot model.
- K=3 specialization: Only a constant number of statistics (first-round shares and final pairwise margin) are needed; present the explicit certificate and concentration.
- Lower bounds: (i) K=3 two-point lower bound Ω((log(1/δ))/ε^2); (ii) constructions probing K-dependence (hidden near-tie constraints; chains of near-ties).



=== Current Output ===

# Output

No output yet.


## Theorems toward certifying the natural IRV sampler

We study the following algorithm: sample m ballots i.i.d. from the electorate, run IRV on the sample to obtain an elimination order σ and winner w, and output w. We provide a path-wise certificate that, when triggered, guarantees that w is an ε-winner of the true election with high probability.

Definitions. For any subset A⊆[K] with |A|≥2 and x∈A, let
- score_x(P; A) := Pr_{b∼P}[x is the top-ranked among A on ballot b].
For a fixed elimination order σ=(e_1,…,e_{K−1}, w), set A_r := [K] \ {e_1,…,e_{r−1}} and, for each y∈A_r\{e_r}, define the margin functional
- d_{r,y}(P) := score_y(P; A_r) − score_{e_r}(P; A_r).
We say that σ is feasible under P if d_{r,y}(P) ≥ 0 for all r and y (with a fixed deterministic tie-breaking rule consistent with σ).

We adopt the additive-ballot model for ε-winner: a candidate c is an ε-winner for P if there exists a distribution Q over full rankings and α∈[0,ε] such that, in the profile P′ := (P + α Q)/(1+α), candidate c wins under IRV.

Lemma 1 (Uniform concentration of path functionals). Let
U := Σ_{s=2}^K C(K,s) s(s−1) = K(K−1) 2^{K−2}.
For any ε∈(0,1) and δ∈(0,1), if m ≥ (1/(2ε^2))(log(2U)+log(1/δ)), then with probability at least 1−δ, simultaneously for all subsets A and ordered pairs (y,x) with y≠x∈A,
| (score_y(S; A) − score_x(S; A)) − (score_y(P; A) − score_x(P; A)) | ≤ ε.
Proof. Each difference is an average of m i.i.d. variables in [−1,1]. Apply Hoeffding’s inequality and a union bound over the U functionals and their negations. The identity for U follows by evaluating E[S(S−1)] for S∼Bin(K,1/2).

Lemma 2 (Certificate via adding a single ranking). Fix σ=(e_1,…,e_{K−1}, w). Let R be the full ranking that orders candidates as (w, e_{K−1}, e_{K−2}, …, e_1), and let Q be the point mass on R. For every round r and every y∈A_r\{e_r}, under Q we have score_{e_r}(Q; A_r)=0 and
- d_{r,y}(Q) = 1 if y = w,
- d_{r,y}(Q) = 0 if y ≠ w.
Consequently, for any α≥0 and any P, in P′:=(P+αQ)/(1+α),
- d_{r,y}(P′) = (d_{r,y}(P) + α d_{r,y}(Q))/(1+α).

Theorem 1 (Path-wise ε-winner certificate for IRV). Fix ε∈(0,1/2) and δ∈(0,1). Draw m ballots i.i.d. from P to form the empirical profile S, and run IRV on S to obtain an elimination order σ and winner w. If m ≥ C (K + log(1/δ))/ε^2 for a suitable absolute constant C, then with probability at least 1−δ, the following implication holds:
If d_{r,y}(S) ≥ 2ε for every round r and every y∈A_r\{e_r}, then w is an ε-winner for P.
Proof. By Lemma 1 (absorbing constants into C), with probability ≥1−δ we have |d_{r,y}(S) − d_{r,y}(P)| ≤ ε uniformly over all (A,y,x). On this event, for all r and y we get d_{r,y}(P) ≥ ε. Let Q be as in Lemma 2 and take α=ε. Then for y≠w, d_{r,y}(P′) = (d_{r,y}(P) + 0·ε)/(1+ε) ≥ ε/(1+ε) > 0; for y=w, d_{r,w}(P′) = (d_{r,w}(P) + ε·1)/(1+ε) ≥ (ε+ε)/(1+ε) > 0. Hence all feasibility inequalities for σ hold in P′, so w wins under IRV in P′. By definition, w is an ε-winner for P.

Corollary 2 (K=3, explicit certificate). For K=3, let the sample S have elimination order (e, o, w). If the empirical first-round margins satisfy score_e(S;[3]) ≤ min(score_o(S;[3]), score_w(S;[3])) − 2ε and the final pairwise margin satisfies Pr_S[w ≻ o] − Pr_S[o ≻ w] ≥ 2ε, then for m ≥ C' (log(1/δ))/ε^2 (for a suitable constant C'), with probability ≥1−δ the candidate w is an ε-winner of P. Proof: specialize Theorem 1 to K=3; only O(1) functionals are needed for concentration in this case.

Discussion. The theorem gives a certify-or-abstain guarantee for the natural algorithm: whenever the observed sample path has per-round slack at least 2ε, the sample winner is an ε-winner of the true election with high probability from m = O((K+log(1/δ))/ε^2) samples. The uniform concentration over all path functionals resolves adaptivity of the random elimination sets.



=== Round 1 Summary ===

Round summary: Prover-01 proposed a clean path-wise certificate for IRV: express feasibility of a sample elimination path σ as finitely many linear inequalities d_{r,y}(P) ≥ 0, proved a K=3 concrete ε-winner certificate, and gave a general-K certificate showing that if all empirical margins along the sample path exceed 2ε and all d_{r,y} concentrate to within ε, then the sample winner is an ε-winner. Counting the family yields U = K(K−1)2^{K−2}, so uniform Hoeffding gives m = O((K + log(1/δ))/ε^2) to certify-or-abstain. Prover-02 gave an alternate ‘‘per-round repair’’ approach: lemmas bounding how much added mass flips an elimination and a high-probability bound that the sample winner is an ε-winner with m = O((K^2/ε^2) log(K/δ)). The verifier reconciled the approaches: the certificate approach is sound but must use the correct mixture normalization (P+αQ)/(1+α); the correct uniform concentration class size is Θ(K) (not K^2); and repairs should use a single Q consistent with the sample path. Immediate next tasks are formal proofs (with corrected algebra), a K=3 Le Cam lower bound, and sharper K-dependence lower bounds.


=== Previous Round Feedback ===

High-level: Prover 01’s certificate-based approach is promising and largely correct once the “addition of ballots” model is handled carefully. Prover 02’s per-round repair argument has significant rigor gaps (both in the concentration step over data-dependent sets and in composing repairs across rounds with a single set of added ballots). Below are detailed audits and concrete next steps.

Prover 01
- Strengths: The path-wise certification via linear inequalities d_{r,y} is a clean and powerful way to reason about IRV. The counting identity U = Σ_{s=2}^K C(K,s) s(s−1) = K(K−1)2^{K−2} is correct, so log U = Θ(K), giving a uniform concentration price only linear in K. The main idea—run IRV on the sample; if all empirical margins along the sample path are ≥ 2ε, then with high probability the sample winner is an ε-winner—is sound.
- Fixes needed: (i) The problem defines ε-winner by adding an ε-fraction of new ballots. The correct mixture after adding α fraction is P′ = (P + α Q)/(1+α), not (1−α)P + α Q. Your algebra should use the 1/(1+α) normalization. Fortunately, the certificate still works: if d_{r,y}(P) ≥ ε and α=ε, then d_{r,y}(P′) ≥ ε/(1+ε) > 0 for y ≠ w, and equals (ε+ε)/(1+ε) for y=w. (ii) In your general-K proof, the “unique y_r with d_{r,y_r}(Q)=1” is indeed y_r = w for every round; it is worth stating explicitly. (iii) State the result as a certify-or-abstain guarantee: with m ≥ C (K+log(1/δ))/ε^2, with prob ≥ 1−δ, either some empirical margin < 2ε (no certificate), or the sample winner is an ε-winner.
- Next steps: Write the full proof with the additive model and a clear uniform concentration lemma over the class of all d_{r,y} functionals; include the counting identity. Optionally, add the K=3 corollary where only O(1) statistics suffice.

Prover 02
- Concentration/adaptivity issue: The set of coordinates you union-bound over (those appearing along the true and empirical paths) is data-dependent. A priori, one must control deviations uniformly over the entire class F = { indicators “top among A is x” } (or differences thereof). This class has cardinality K·2^{K−1} (or K(K−1)2^{K−2} for differences), so one pays only log-size Θ(K), not K^2. The proposed union bound over ≈2K^2 realized coordinates is not justified as stated.
- Composition of repairs: The per-round “add ≤ 2η mass” does not by itself ensure existence of a single set Q of added ballots that makes all rounds follow the empirical elimination path simultaneously. The clean way is to set Q to a single ranking consistent with the sample elimination order (as in Prover 01) and verify all inequalities together. The backward, round-by-round repair must track renormalizations and cross-effects; otherwise the total ε budget is not rigorously established.
- Recommendation: Recast your main proposition using the path-wise certificate: On the high-probability uniform concentration event, deficits per round are at most η; if empirical margins are ≥ 2η, the certificate holds with ε = η. If you aim to avoid the empirical-margin condition, you will need to parameterize by the true path’s minimal gap Γ and give guarantees in terms of Γ.

Lower bounds and open directions
- K=3: A Le Cam two-point lower bound of Ω((log(1/δ))/ε^2) is standard; formalize it with instances differing by a pairwise margin while keeping early elimination fixed.
- K-dependence: For the natural algorithm, seek constructions where exactly one round’s critical constraint is hidden among Θ(K) possibilities to argue Ω((log K)/ε^2) or better. Try also families with a chain of near-ties to probe whether Ω(K/ε^2) is necessary.
- Deliverables: (1) A formal theorem/lemma package for the path-wise certificate with additive ballots and uniform concentration; (2) a clean K=3 statement; (3) at least the basic lower bound for K=3.
