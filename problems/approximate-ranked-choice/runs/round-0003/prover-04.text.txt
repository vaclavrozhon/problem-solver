# Ideas

- General-K two-type certificate (final-pair strategy). For a target c and a chosen pivot b, eliminate all other candidates first (in a data-independent order determined by baseline tallies), using only c-first and b-first added ballots. This yields a closed-form sufficient bound ε_b^*(γ) analogous to the K=3 exact formula.
- Dominance lemma for fixed elimination path: for that path, c-first and b-first ballots dominate any other added ranking in improving all constraints; thus restricting to two types is w.l.o.g. for that path.
- Sampling under a separation condition via sample-splitting: identify the “minimal-of-others” chain with one subsample, then estimate the required tallies with another; overall sample complexity polynomial in K when the chain margins are bounded away from 0.
- Tight Lipschitz bound for K=3 plug-in map: L ≤ 6 in sup norm.

# General-K two-type final-pair certificate

Setup. Candidate set C, |C|=K≥3. For any nonempty S⊆C and a∈S, t_a(S):=Pr[top among S is a]. Fix target c∈C and choose a pivot b∈C\{c}. Fix slack γ>0 to enforce strict separations.

Define the chain of remaining sets and the “minimal-of-others” sequence:
- S_1 := C.
- For j=1,…,K−2: pick
  e_j ∈ argmin_{e ∈ S_j \ {b,c}} t_e(S_j), and set S_{j+1} := S_j \ {e_j}.
  (Break ties by the fixed deterministic rule; γ>0 will make them irrelevant.)

Define the cumulative deficits
- A_b(γ) := max_{1≤j≤K−2} [ t_{e_j}(S_j) − t_c(S_j) + γ ]_+.
- B_b(γ) := max_{1≤j≤K−2} [ t_{e_j}(S_j) − t_b(S_j) + γ ]_+.
- D_{b,c}(γ) := t_b({b,c}) − t_c({b,c}) + γ.

Theorem (two-type final-pair certificate). If we add α≥0 mass of c-first ballots and β≥0 mass of b-first ballots with
- α ≥ A_b(γ),
- β ≥ B_b(γ), and
- α − β ≥ D_{b,c}(γ),
then along the elimination path S_1,…,S_{K−1} the candidates e_1,…,e_{K−2} are eliminated in order, and in the final {b,c} round, c beats b by γ; hence c is the IRV winner. Moreover, among such two-type additions, the minimum total mass is
  ε_b^*(γ) = B_b(γ) + max{ A_b(γ), B_b(γ) + D_{b,c}(γ) }.
Finally, define ε^{cert}(γ;c) := min_{b≠c} ε_b^*(γ) and ε^{cert}(c) := lim_{γ→0^+} ε^{cert}(γ;c).

Proof (sketch). Under added α,β of c-first and b-first ballots, for each j the updated tallies on S_j are t'_c(S_j)=t_c(S_j)+α, t'_b(S_j)=t_b(S_j)+β, and t'_x(S_j)=t_x(S_j) for every x∈S_j\{b,c}. By construction, e_j is the (tie-broken) minimal among S_j\{b,c}. The constraints α ≥ A_b(γ) and β ≥ B_b(γ) ensure t'_c(S_j) > t'_{e_j}(S_j) and t'_b(S_j) > t'_{e_j}(S_j); as the other “others” exceed or tie e_j already and are unchanged, e_j is strictly the unique minimal in S_j and is eliminated. Iterating yields S_{K−1}={b,c}. In the final, each c-first ballot contributes +1 to t'_c({b,c}), each b-first contributes +1 to t'_b({b,c}), so α−β ≥ D_{b,c}(γ) enforces a strict c win. Minimizing α+β over the polyhedron {α≥A, β≥B, α−β≥D} is achieved at β=B and α=max{A,B+D}, giving ε_b^*(γ) as stated.

Remark. For K=3 this recovers the exact formula in the notes (A=[p_a−p_c+γ]_+, B=[p_a−p_b+γ]_+, D=t_b({b,c})−t_c({b,c})+γ), and ε^*(γ;c)=min_b ε_b^*(γ).

# Dominance of two types for a fixed path

Lemma (two-type suffices for fixed path). Fix c, b, γ and a specific elimination path e_1,…,e_{K−2}. Consider the LP minimizing ||y||_1 over nonnegative measures y on rankings subject to, for every j,
- t'_c(S_j) ≥ t'_{e_j}(S_j) + γ,
- t'_b(S_j) ≥ t'_{e_j}(S_j) + γ,
and final-round t'_c({b,c}) ≥ t'_b({b,c}) + γ. There is an optimal y supported on two rankings: a c-first ranking and a b-first ranking, and its cost equals B_b(γ)+max{A_b(γ), B_b(γ)+D_{b,c}(γ)}.

Proof (outline). Each constraint’s LHS is affine in y with coefficients 1[top_{S_j}(r)=c] or 1[top_{S_j}(r)=b]; any ranking r with top_{S_j}(r)∉{c,b} contributes 0 to the corresponding constraint. A c-first ranking contributes 1 to all c-vs-e_j constraints (every j) and +1 to the final c−b margin; similarly b-first contributes 1 to all b-vs-e_j constraints and −1 to the final margin. Thus, for any r, replacing y(r) by an equal mass on c-first (if r ranks c≻b) or b-first (if r ranks b≻c) weakly improves all constraints coordinatewise. Hence an optimal solution exists with support on these two types, and its optimal value is the 2-variable minimum stated above.

# Example (K=4)

Let C={a,b,c,d}, target c, pivot b. Suppose
- First-round: t_a(C)=0.26, t_b(C)=0.24, t_c(C)=0.22, t_d(C)=0.28.
- After removing a: on S_2={b,c,d}, t_d(S_2)=0.33, t_b(S_2)=0.37, t_c(S_2)=0.35.
- Pairwise: t_c({b,c})=0.55, t_b({b,c})=0.45.
Take γ→0. Then e_1=a (minimal among {a,d}), e_2=d. Compute
- A_b = max{0.26−0.22, 0.33−0.35, 0}_+ = 0.04.
- B_b = max{0.26−0.24, 0.33−0.37, 0}_+ = 0.02.
- D_{b,c} = 0.45 − 0.55 = −0.10.
Thus ε_b^* = 0.02 + max{0.04, −0.08} = 0.06. Adding α=0.04 of c-first and β=0.02 of b-first ensures elimination of a then d and a c-over-b final.

# Sampling with separation via sample-splitting (general K)

Separation assumption. Along the chain S_1,…,S_{K−1} for a fixed b, let
  μ_j := min_{x∈S_j\{b,c,e_j}} ( t_x(S_j) − t_{e_j}(S_j) ), and μ := min_j μ_j.
Assume μ>0 (the minimal-of-others is separated from the second-minimal by at least μ at every round).

Algorithm.
- Stage 1 (identify chain): Draw m_1 ballots. For j=1,…,K−2, compute empirical tallies on S_j^hat recursively (starting from S_1^hat=C) and set e_j^hat to the empirical argmin over S_j^hat\{b,c}.
- Stage 2 (estimate deficits): Independently draw m_2 ballots. For the sets S_j^true (the true chain) we do not know their identity, but if Stage 1 succeeds (i.e., e_j^hat=e_j for all j), then S_j^hat=S_j. On Stage 2 data, estimate t_{e_j}(S_j), t_b(S_j), t_c(S_j) for all j, and t_b({b,c}), t_c({b,c}). Form A_b, B_b, D_{b,c} and ε_b^*.
- Decision: If min_b \, \widehat{ε}_b^*(γ) ≤ ε − 2τ, return c.

Guarantee. There exist absolute constants c_1,c_2 such that the following suffices:
- m_1 ≥ c_1 (log(K/δ)) / μ^2 ensures P(Stage 1 identifies the true chain for that b) ≥ 1−δ/2 (Hoeffding + union bound across ≤K steps and ≤K candidates per step).
- m_2 ≥ c_2 (log( (3(K−2)+2)/δ )) / τ^2 ensures that, conditional on Stage 1 success, all needed tallies are within ±τ simultaneously with probability ≥1−δ/2.
Then P(ε_b^*(γ) ≤ \widehat{ε}_b^*(γ)+2τ) ≥ 1−δ, so the decision is sound: if declared, c is an ε-winner.

Remarks.
- This yields m = O( (log(K/δ))/μ^2 + (log(K/δ))/ε^2 ). When μ is small (nearly tied “others”), Stage 1 may fail; one can fall back to the c-first certificate (Theorem 2 in notes) which has exponential-in-K uniform estimation but no separation requirement.
- Extending a polynomial-sample, distribution-free guarantee for a general fixed elimination order remains open; it relates to bounding sup_{λ∈Λ} ||λ||_1 in the LP dual (see notes).

# K=3 Lipschitz constant for the plug-in map

Let for K=3 and fixed c with opponent b and “other” a,
  ε_a^*(γ) = B_γ + max{A_γ, B_γ + D_γ},
with A_γ=[p_a − p_c + γ]_+, B_γ=[p_a − p_b + γ]_+, D_γ=t_b({b,c}) − t_c({b,c}) + γ. Then the map (p_a,p_b,p_c,t_b({b,c}),t_c({b,c})) ↦ ε_a^*(γ) is 6-Lipschitz in the sup norm: for any perturbation of these five inputs by at most τ in sup norm, |Δε_a^*(γ)| ≤ 6τ.

Proof. Piecewise linear analysis: If max selects A_γ, then ε=B_γ+A_γ and the l_1 norm of any subgradient is ≤ 4. If max selects B_γ+D_γ, then ε=2B_γ+D_γ and the l_1 norm of any subgradient is ≤ 6. Hence global sup-norm Lipschitz constant ≤ 6.

# Obstacles

- Dual sensitivity bound. For the general fixed-order LP, showing sup_{λ∈Λ} ||λ||_1 = poly(K) (hence polynomial sample complexity for certifying that fixed order) remains open. Naive per-constraint “additive mass” arguments fail because a single ranking can worsen other constraints.
- General-K exact minimal augmentation likely requires mixed-type additions beyond two types and/or changing the elimination path; our two-type certificate is sufficient but not necessarily tight for K≥4.

# Next steps

- Formalize the general-K two-type certificate (statement above) into proofs.md; add the K=4 example.
- Develop the two-stage sampling theorem under a clean chain-separation condition μ, and integrate a fallback to the c-first certifier when μ is tiny.
- Attempt to tighten the K=3 Lipschitz constant (6→4) or provide an exact value.
- Pursue bounding sup_{λ∈Λ} ||λ||_1 by constructing structured dual solutions and adversarial rankings; even bounds like O(K) would suffice for polynomial sample guarantees per fixed order.
- Explore whether allowing two pivots (three-type scheme: c-first and two opponent-first types) yields a strictly stronger certificate with similar O(K^2) statistics.
