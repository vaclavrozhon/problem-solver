=== SYSTEM ===
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md, proofs.md, and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (informal progress & exploratory work so far)
- proofs.md (rigorous proofs & detailed mathematics so far)
- output.md (main results summary so far)

**Three-tier file system guidelines**:
- **notes.md**: Readable running log of exploratory work, intuitions, failed attempts, ideas. Prefer appending. Replace only if old notes are clearly misleading. Should be self-contained.
- **proofs.md**: Complete rigorous mathematical proofs with full details. Contains proven lemmas, theorems, and detailed derivations. Only add mathematically verified content here.
- **output.md**: ONLY the main problem results. Think twice before adding anything. Should contain a concise summary of the most important theorems that directly advance the main problem. Extremely selective.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions.",
  "summary_md": "Concise summary of this round's work for summarizer.",
  "verdict": "promising|uncertain|unlikely",
  "blocking_issues": ["List of issues preventing progress"],
  "per_prover": [{"prover_id": "01", "brief_feedback": "feedback", "score": "promising|uncertain|unlikely"}],
  "notes_update": {"action": "append|replace", "content": "Markdown for notes.md"},
  "proofs_update": {"action": "append|replace", "content": "Markdown for proofs.md"}, 
  "output_update": {"action": "append|replace", "content": "Markdown for output.md"}
}

**Verdict definitions**:
- **promising**: Significant mathematical progress, publishable results, or clear path to solution
- **uncertain**: Some progress but with unresolved issues or incomplete reasoning  
- **unlikely**: No meaningful progress, fundamentally flawed approaches, or just exploratory work

**Update guidelines**:
- Use null for any update field you don't want to modify
- notes_update: Include informal reasoning, failed attempts, intuitions, exploratory work
- proofs_update: Only include complete, rigorous proofs that you have verified
- output_update: Only include main problem results that directly advance toward the solution


=== USER ===
=== Task (txt) ===

# Problem Statement

We consider the problem of estimating the winner in an election run under **Ranked Choice Voting** (also known as *Instant-Runoff Voting*).  

Suppose there are \(K\) candidates. Each voter submits a complete ranking of these candidates. The voting rule proceeds in rounds: in each round, every ballot is assigned to the top-ranked candidate who is still in contention. The candidate with the smallest number of votes is eliminated (with ties broken according to a fixed deterministic rule), and this candidate is crossed out from all ballots. The process repeats until only one candidate remains, who is declared the winner.

Our goal is not to compute the exact winner from the full set of ballots, but rather to estimate a *robust* winner from a random sample of ballots. To make this precise, we introduce the notion of an **ε-winner**. A candidate \(c\) is called an ε-winner of an election profile if it is possible to add at most an ε-fraction of additional ballots to the election so that \(c\) becomes the winner under Ranked Choice Voting. In other words, \(c\) is “close” to being the true winner, in the sense that a small perturbation of the electorate would make \(c\) win. There may be more ε-winners. The real winner is ε-winner for any ε. 

The sampling model is as follows. We assume there is a large population of voters, each ballot drawn independently from the empirical distribution of this population. The algorithm does not see all the ballots; instead, it may sample ballots at random, with replacement. The task of the algorithm is: given parameters \(\varepsilon\) and \(\delta\), and access to at most \(m\) random ballots, output a candidate \(\hat{c}\) such that with probability at least \(1-\delta\), the candidate \(\hat{c}\) is an ε-winner of the true election.

The central question is: **what is the sample complexity of this problem?**  
That is, how many samples \(m\) are sufficient (and necessary) in order for an algorithm to reliably identify an ε-winner with probability at least \(1-\delta\)? We seek both upper bounds, by designing sampling algorithms and analyzing their guarantees, and lower bounds, by proving that no algorithm can succeed with significantly fewer than a certain number of samples. 



=== Notes ===

# Notes



# Corrected certificate and counterexample for K = 3

Notation: For a candidate set C with |C| = K and any nonempty S ⊆ C with c ∈ S and |S| ≥ 2, define t_a(S) = Pr[top among S is a] under the population distribution P over full rankings.

Corrected c-first certificate: Define

M_c(P) := max_{S ⊆ C, c ∈ S, |S| ≥ 2} [ min_{a ∈ S \ {c}} t_a(S) − t_c(S) ]_+.

If ε > M_c(P), then adding ε' (with 0 < ε' ≤ ε) mass of c-first ballots ensures that in every subset S encountered along any IRV elimination path, c's tally strictly exceeds the minimum among S \ {c}, so c cannot be eliminated and is the eventual winner. This yields a sound, distribution-free sufficient condition. Note the strict inequality requirement; in algorithmic use we maintain a margin so that ε' < ε and ties do not involve c.

Uniform estimation: The family {1[top_S(r) = a]} over all (a, S) has size K · 2^{K-1}. Hoeffding + union bound gives uniform estimation of all t_a(S) within ±τ using m = O((log(K · 2^{K-1}) + log(1/δ))/τ^2) samples. The plug-in estimate \hat M_c satisfies |\hat M_c − M_c| ≤ 2τ.

Counterexample to "K = 3 exactness" of c-first certificate: Let first-place shares be a = 0.38, b = 0.35, c = 0.27. Suppose c beats b head-to-head by margin m = 0.10 but loses to a by margin 0.20. The c-first certificate f_c requires ε ≥ max{0.35 − 0.27, 0.20, 0} = 0.20. However, adding α = 0.11 of c-first ballots and β = 0.03 of b-first ballots yields new first-place tallies c' = 0.38, b' = 0.38, a' = 0.38 (with tiny extra slack to make a uniquely minimal). Then a is eliminated first; in the final, the c vs b margin is m + α − β = 0.10 + 0.11 − 0.03 = 0.18 > 0, so c wins. Total added mass ≈ 0.14 < 0.20. Thus, for K = 3, the minimal augmentation need not equal the c-first-only threshold. A full characterization must allow mixed additions.

LP approach (status and caveats): For a fixed elimination order π, the condition that π(j) is eliminated at round j can be written linearly in terms of the baseline tallies t_a(S_j) and the additive contributions of the added mass y(r) via indicators 1[top_{S_j}(r) = a]. This leads to a linear program minimizing total added mass. To be rigorous one must encode the fixed tie-breaking rule (e.g., by strict inequalities or lexicographic tie constraints). Sensitivity of the LP optimum to perturbations in the t_a(S) (estimated from samples) is the key technical step for a polynomial-in-K sample bound using this approach; deriving an explicit O(poly(K)) Lipschitz constant remains open.

Lower bounds: The Ω((1/ε^2) log(1/δ)) dependence is necessary even for K = 2 (majority). Stronger K-dependent lower bounds (Ω((log K)/ε^2) or Ω(K/ε^2)) are plausible but require explicit constructions.

Next steps summary:
- Formalize LP with tie-breaking and derive sensitivity bounds.
- Provide a correct, closed-form minimal-augmentation characterization for K = 3 allowing mixed additions (compare two strategies: avoid facing a losing opponent by flipping the first-round loser vs. directly fixing the head-to-head deficit).
- Explore whether the worst-case S for the c-first certificate can be restricted by |S| ≤ r for a constant r.
- Build K-dependent lower bounds via Fano/packing constructions over top-of-S events.


## K = 3: exact minimal augmentation via two-type reduction

Let C = {a,b,c} and fix target winner c. Denote first-round shares p_x := t_x({a,b,c}) and pairwise shares t_x({b,c}), t_x({a,c}). To remove dependence on tie-breaking, introduce a slack γ > 0 and require strict separations in all inequalities.

Targeting elimination of a in round 1 and a c vs b final, it suffices to consider only two added ballot types: c-first (amount α ≥ 0) and b-first (amount β ≥ 0). These induce the linear constraints
- First round: p_a + 0 ≤ p_b + β − γ and p_a + 0 ≤ p_c + α − γ, i.e.,
  β ≥ B_γ := [p_a − p_b + γ]_+ and α ≥ A_γ := [p_a − p_c + γ]_+.
- Final: t'_c({b,c}) ≥ t'_b({b,c}) + γ, i.e., α − β ≥ D_γ := t_b({b,c}) − t_c({b,c}) + γ.
The minimum total mass is then
  ε_a^*(γ) = min_{α,β≥0} {α+β : α ≥ A_γ, β ≥ B_γ, α − β ≥ D_γ} = B_γ + max{A_γ, B_γ + D_γ}.
By a dominance argument, a-first additions are never optimal for this targeted strategy: if an a-first ballot ranks c ≻ b, it is dominated by a c-first ballot (strictly improves both elimination inequalities and matches the bc margin); if it ranks b ≻ c, it is dominated by a b-first ballot (improves the relevant elimination inequality and matches the bc margin). The symmetric expression ε_b^*(γ) is obtained by swapping a and b. The exact minimal augmentation to make c win is
  ε^*(γ; c) = min{ε_a^*(γ), ε_b^*(γ)}, and ε^*(c) = lim_{γ→0^+} ε^*(γ; c).
This matches the counterexample in the notes (a=0.38, b=0.35, c=0.27 with c beating b head-to-head): A_0=0.11, B_0=0.03, D_0=−0.10, hence ε_a^*(0) = 0.03 + max{0.11, −0.07} = 0.14.

Sampling for K = 3: Computing ε^*(γ; c) requires only five tallies: p_a, p_b, p_c, t_c({b,c}), t_c({a,c}). A Hoeffding + union bound over these five quantities gives m = Θ((log(1/δ))/ε^2) samples to decide whether ε^*(c) ≤ ε with probability ≥ 1 − δ.

## LP approach: primal/dual and sensitivity status (general K)

For a fixed elimination order π with remaining sets S_j = {π(j),...,π(K)}, add slack γ > 0 and consider variables y(r) ≥ 0 over rankings r. The primal is
- Minimize ∥y∥_1 subject to, for each j and a ∈ S_j \ {π(j)}:
  (t_a(S_j) − t_{π(j)}(S_j)) + ∑_r y(r)(1[top_{S_j}(r)=a] − 1[top_{S_j}(r)=π(j)]) ≥ γ.
Moving baseline tallies to the RHS gives constraints Ay ≥ b, with b_{j,a} = γ − (t_a(S_j) − t_{π(j)}(S_j)). The dual is
- Maximize ∑_{j}∑_{a≠π(j)} λ_{j,a}·(γ − (t_a(S_j) − t_{π(j)}(S_j))) subject to, for every ranking r,
  ∑_{j}∑_{a≠π(j)} λ_{j,a}(1[top_{S_j}(r)=a] − 1[top_{S_j}(r)=π(j)]) ≤ 1, and λ ≥ 0.
Sensitivity: v(b) = max_{λ∈Λ} b^T λ is 1-Lipschitz in the dual norm: |v(b+Δ) − v(b)| ≤ (sup_{λ∈Λ} ∥λ∥_1) ∥Δ∥_∞. Bounding R_K := sup_{λ∈Λ} ∥λ∥_1 by poly(K) would yield a polynomial-in-K sample bound for certifying a fixed π. For K = 3, the two-type reduction collapses Λ to two variables, giving R_3 ≤ 2. For general K, obtaining a good bound on R_K remains open; the per-constraint additive mass approach is invalid because a single added ranking can decrease other constraints when it tops the round-j loser.

## Checklist / next steps
- Formalize the K = 3 theorem and sampling corollary in output.md.
- Keep general c-first certifier and uniform convergence in output.md; use the K = 3 exact result when K = 3.
- Pursue a dual-based sensitivity bound sup_{λ∈Λ} ∥λ∥_1 = poly(K) or an approximate scheme with provable stability.
- Investigate few-type reductions for K ≥ 4 when targeting specific first eliminations.


=== Current Output ===

# Output

No output yet.


# Theorems and results relevant to sampling ε-winners under IRV

We work with a candidate set C of size K. For any nonempty S ⊆ C and a ∈ S, let t_a(S) = Pr[top among S is a] under the population distribution P over full rankings. When we add a nonnegative measure y on rankings with total mass ||y||_1 ≤ ε, the tallies update additively: for each S and a ∈ S,

 t'_a(S) = t_a(S) + ∑_{r} y(r) 1[top_S(r) = a].

We assume ties in IRV are broken by a fixed deterministic rule, but we will enforce strict separations so that tie-breaking is irrelevant for our sufficient conditions.

Theorem 1 (Uniform convergence of top-of-S tallies).
Let F = {f_{a,S}(r) := 1[top_S(r) = a] : a ∈ S ⊆ C, |S| ≥ 1}. For m i.i.d. sampled ballots and any δ ∈ (0,1), with probability at least 1 − δ,

 sup_{a,S} |\hat t_a(S) − t_a(S)| ≤ τ

whenever m ≥ c (log(K · 2^{K-1}) + log(2/δ)) / τ^2 for a universal constant c.

Proof.
There are at most K · 2^{K-1} indicator functions f_{a,S}. Hoeffding’s inequality plus a union bound gives the claim.

Theorem 2 (Sufficient certificate via c-first additions).
Fix c ∈ C and define

 f_c(P) := max_{S ⊆ C, c ∈ S, |S| ≥ 2} [ min_{a ∈ S \ {c}} t_a(S) − t_c(S) ]_+.

If ε > f_c(P), then c is an ε-winner. In particular, adding any ε' with f_c(P) < ε' ≤ ε of c-first ballots (with arbitrary completion below c) makes c the IRV winner under the augmented profile.

Proof.
Adding ε' c-first ballots increases t_c(S) by ε' for every S with c ∈ S and leaves t_a(S) for a ≠ c unchanged. By the choice ε' > f_c(P), for each such S we have t'_c(S) = t_c(S) + ε' > min_{a∈S\{c}} t_a(S). Therefore, at any round in which the remaining set is S, c’s tally strictly exceeds the minimum among other candidates in S and hence c cannot be eliminated. Since some candidate is eliminated in every round, c survives all rounds and is the unique remaining candidate; thus c wins. Because the inequalities are strict, the fixed tie-breaking rule is irrelevant.

Corollary 3 (Sound certifier and its sample complexity).
Let τ > 0, and suppose m satisfies Theorem 1 so that with probability ≥ 1 − δ we have sup_{a,S} |\hat t_a(S) − t_a(S)| ≤ τ. Define the plug-in estimator

 \hat f_c := max_{S ⊆ C, c ∈ S, |S| ≥ 2} [ min_{a ∈ S \ {c}} \hat t_a(S) − \hat t_c(S) ]_+.

Then |\hat f_c − f_c(P)| ≤ 2τ for all c. Consequently, the following procedure is a sound certifier: compute \hat f_c for all c and output any c with \hat f_c ≤ ε − 2τ. With probability at least 1 − δ, every output c satisfies f_c(P) ≤ ε, and hence (by Theorem 2) is an ε-winner.

In particular, choosing τ = ε/4 and m = Θ((log(K · 2^{K-1}) + log(1/δ)) / ε^2) suffices for correctness with probability ≥ 1 − δ.

Proof.
For each fixed S containing c, the map (\{t_a(S)\}_{a∈S}) ↦ min_{a∈S\{c}} t_a(S) − t_c(S) is 2-Lipschitz in the sup norm (the minimum over a ≠ c perturbs by at most τ, and t_c by at most τ). Taking positive part and a maximum over S preserves Lipschitzness, giving |\hat f_c − f_c| ≤ 2τ. The rest follows from Theorem 2.

Proposition 4 (Necessary dependence on ε and δ).
Any algorithm that, with probability at least 1 − δ, outputs an ε-winner from m samples must have m = Ω((1/ε^2) log(1/δ)).

Proof.
For K = 2, IRV reduces to a two-candidate majority. Determining whether a given candidate is an ε-winner requires distinguishing whether their head-to-head share is ≥ 1/2 − ε versus ≤ 1/2 − 2ε, which is standard Bernoulli mean testing and requires Ω((1/ε^2) log(1/δ)) samples by classical information-theoretic or concentration lower bounds.

Remarks and scope.
- The certifier in Theorem 2 is sufficient but not necessary in general (and, in particular, is not exact for K = 3). It uses only c-first additions and enforces non-elimination of c in every potential round, which can be conservative.
- An exact minimal-augmentation characterization for a fixed elimination order can be expressed via a linear program over the added-ballot distribution; making this rigorous with a fixed tie-breaking rule and deriving a stability bound in terms of estimation error in the t_a(S) are promising next steps.


Theorem 5 (K = 3: exact minimal augmentation to make a target c win under IRV).
Let C = {a,b,c} and fix a target winner c. Write first-round shares p_x := t_x({a,b,c}) for x ∈ {a,b,c}, and pairwise tallies t_x({b,c}) and t_x({a,c}). Fix a deterministic tie-breaking rule and introduce a slack parameter γ > 0 to enforce strict separations so that tie-breaking is irrelevant.

Define, for the strategy that eliminates a in round 1 and then pits c against b in the final,
- A_γ := [p_a − p_c + γ]_+,
- B_γ := [p_a − p_b + γ]_+,
- D_γ := t_b({b,c}) − t_c({b,c}) + γ.
Let ε_a^*(γ) be the minimum total mass of added ballots required to realize this strategy. Then
  ε_a^*(γ) = B_γ + max{A_γ, B_γ + D_γ}.
Symmetrically, for the strategy that eliminates b first and then pits c against a, with
- A'_γ := [p_b − p_c + γ]_+,
- B'_γ := [p_b − p_a + γ]_+,
- D'_γ := t_a({a,c}) − t_c({a,c}) + γ,
we have
  ε_b^*(γ) = B'_γ + max{A'_γ, B'_γ + D'_γ}.
Consequently, the exact minimal total added mass to make c the IRV winner with strict margins γ is
  ε^*(γ; c) = min{ε_a^*(γ), ε_b^*(γ)},
and the exact minimal augmentation without slack is ε^*(c) = lim_{γ→0^+} ε^*(γ; c).

Proof.
Consider the strategy targeting a’s elimination in round 1 and a final between c and b. It suffices to consider added ballots of only two types: c-first ballots (total mass α ≥ 0) and b-first ballots (total mass β ≥ 0). Indeed, any added a-first ballot either ranks c ≻ b, in which case a c-first ballot strictly improves both first-round inequalities (it raises p_c and leaves p_b unchanged while an a-first raises p_a) and matches the bc final margin; or it ranks b ≻ c, in which case a b-first ballot strictly improves the relevant first-round inequality (it raises p_b while an a-first raises p_a) and matches the bc final margin. Thus a-first ballots are strictly dominated and never appear in an optimal solution.
Under α and β, the first-round tallies become p'_a = p_a, p'_b = p_b + β, and p'_c = p_c + α. Enforcing that a is strictly below both b and c in round 1 yields α ≥ A_γ and β ≥ B_γ. In the final between b and c, each added c-first ballot contributes 1 to t'_c({b,c}) and each added b-first ballot contributes 1 to t'_b({b,c}); hence t'_c({b,c}) − t'_b({b,c}) = (t_c({b,c}) − t_b({b,c})) + (α − β). The strict final-round win requires α − β ≥ D_γ. Therefore the feasible region is exactly
  { (α,β) ∈ R_+^2 : α ≥ A_γ, β ≥ B_γ, α − β ≥ D_γ }.
Minimizing α + β over this polyhedron is achieved at β = B_γ and α = max{A_γ, B_γ + D_γ}, yielding ε_a^*(γ) = B_γ + max{A_γ, B_γ + D_γ}. The expression for ε_b^*(γ) follows symmetrically. Any winning IRV run with three candidates must eliminate either a or b in the first round and then elect c in the final; hence the minimal total added mass is the minimum of the two strategy optima. Finally, sending γ → 0^+ gives ε^*(c).

Corollary 6 (Sampling complexity for K = 3 exact certifier).
Fix ε, δ ∈ (0,1). Let \hat p_x, \widehat{t}_x({b,c}), \widehat{t}_x({a,c}) be empirical estimates of p_x and the pairwise tallies from m i.i.d. ballots. There exists a universal constant c such that if
  m ≥ c · (log(5/δ)) / τ^2,
then with probability at least 1 − δ we have sup error ≤ τ simultaneously for the five quantities {p_a, p_b, p_c, t_c({b,c}), t_c({a,c})}. The maps (p_a,p_b,p_c,t_c({b,c}),t_c({a,c})) ↦ ε_a^*(γ), ε_b^*(γ), and ε^*(γ; c) are Lipschitz with a universal constant (e.g., ≤ 6) under the sup norm. Consequently, the plug-in decision “declare c an ε-winner if \min{\widehat{ε}_a^*(γ), \widehat{ε}_b^*(γ)} ≤ ε − 2Lτ” is correct with probability at least 1 − δ, where L is a Lipschitz constant (e.g., L = 6). Choosing τ = Θ(ε) yields m = Θ((log(1/δ))/ε^2).

Remarks.
- This exact characterization for K = 3 strictly improves the c-first sufficient certificate (Theorem 2) and matches the counterexample in the notes.
- For general K, an exact minimal-augmentation characterization for a fixed elimination order can be written as a linear program. A dual-based sensitivity analysis suggests that a polynomial-in-K sample bound per fixed order will follow from a poly(K) bound on sup_{λ∈Λ} ∥λ∥_1 over the dual feasible region; establishing such a bound remains open.


=== Prover 1 Output ===

# Ideas
- Extend the K = 3 “two-type” reduction to general K: to force a specific final (c vs y), it suffices to add only c-first and y-first ballots. Then all other candidates can be eliminated in ascending order of their baseline first-place shares without ever adding ballots that top them. This yields a closed-form, data-driven sufficient condition that uses only O(K) tallies (first-round shares and K − 1 pairwise tallies against c), giving a polynomial-in-K sampling bound.
- For K = 4 this collapses to a simple B + max{A, B + D} formula analogous to K = 3 (with A, B taken as maxima across the two nonfinal opponents). For general K, A and B become maxima across the K − 2 nonfinal opponents.
- Sampling: Hoeffding + union bound over at most 2K − 1 quantities yields m = Θ((log K + log(1/δ))/ε^2) to certify this two-type condition.
- Lower bound sketch (for this two-type condition): distinguishing whether there exists a y with near-threshold pairwise margin vs c among K − 1 options needs Ω((log K)/ε^2) samples via Fano/best-arm identification. This matches the log K factor in the sampling upper bound for the two-type certificate.

# Theorem (General K two-type certificate for forcing a c vs y final)
Let C be a set of K ≥ 3 candidates, fix target c ∈ C and a designated opponent y ∈ C \ {c}. Write first-round shares p_x := t_x(C) for x ∈ C, and the pairwise tally t_c({c,y}) against y. Fix a deterministic tie-breaking rule and a slack γ > 0 (to enforce strict inequalities). Consider adding only two types of ballots: c-first (amount α ≥ 0) and y-first (amount β ≥ 0). Define
- A*(y,γ) := max_{w ∈ C\{c,y}} [ p_w − p_c + γ ]_+,
- B*(y,γ) := max_{w ∈ C\{c,y}} [ p_w − p_y + γ ]_+,
- D(y,γ) := t_y({c,y}) − t_c({c,y}) + γ.
Then the following are equivalent:
1) There exists (α,β) with α,β ≥ 0 and α + β ≤ ε such that, under IRV with the augmented profile, every w ∈ C\{c,y} is eliminated before both c and y (in some order sorted by increasing p_w), and in the final round c defeats y by a strict margin (hence the tie-breaking rule is irrelevant).
2) The inequalities
   α ≥ A*(y,γ),   β ≥ B*(y,γ),   and   α − β ≥ D(y,γ)
   hold. Moreover, the minimum total mass α + β satisfying these is
   ε_{2type}(y,γ; c) = B*(y,γ) + max{ A*(y,γ), B*(y,γ) + D(y,γ) }.
Consequently, a sound sufficient condition that c is an ε-winner is that there exists y ∈ C\{c} with ε_{2type}(y,γ; c) ≤ ε; equivalently,
  ε_{2type}(γ; c) := min_{y≠c} ε_{2type}(y,γ; c) ≤ ε.
For K = 3 this coincides with the exact minimal augmentation ε^*(γ; c) from the notes; for K ≥ 4 it is an efficiently checkable sufficient certificate.

Proof.
Sufficiency. If α ≥ A*(y,γ) and β ≥ B*(y,γ), then for every w ∈ C\{c,y} we have p_w ≤ p_c + α − γ and p_w ≤ p_y + β − γ. Since we add no ballots that top any w, all p_w remain at their baseline values. Therefore, among the survivors at any round containing {c,y} and some subset W of C\{c,y}, the unique loser is the w ∈ W with minimal baseline p_w, because c and y each strictly exceed every p_w by at least γ. Thus the nonfinal candidates are eliminated in nondecreasing order of their baseline first-round shares, independent of tie-breaking. When only {c,y} remain, the pairwise margin is (t_c({c,y}) + α) − (t_y({c,y}) + β) = −D(y,γ) + γ + (α − β). The constraint α − β ≥ D(y,γ) guarantees a strict final-round win for c.
Necessity. Consider any feasible augmentation with only c-first and y-first ballots that achieves the claimed elimination pattern. Fix any w ∈ C\{c,y}. At the round when w is eliminated (which must occur before either c or y), both c and y must strictly exceed w’s tally. Because added ballots only contribute to c or y, w’s tally is p_w; hence p_c + α ≥ p_w + γ and p_y + β ≥ p_w + γ, equivalently α ≥ [p_w − p_c + γ]_+ and β ≥ [p_w − p_y + γ]_+. The final-round constraint α − β ≥ D(y,γ) is obviously necessary. Minimization of α + β over these halfspace constraints is the same 2-variable linear program as in K = 3, with solution α = max{A*(y,γ), B*(y,γ) + D(y,γ)} and β = B*(y,γ), yielding the stated optimum B* + max{A*, B* + D}. ∎

Remarks.
- Dominance of two types: allowing any added ballot whose top among the current survivors ever equals some w ∈ C\{c,y} can only increase w’s tally at some round and thus can never help eliminate w earlier; such ballots are weakly dominated by reallocating their mass to c-first or y-first ballots.
- K = 3 specialization: C\{c,y} has a single element a; then A* = [p_a − p_c + γ]_+, B* = [p_a − p_y + γ]_+, D(y,γ) is the pairwise deficit vs y, recovering the earlier exact formula.

# Corollary (Sampling for the two-type certificate)
To evaluate ε_{2type}(γ; c), one needs only: the K first-round shares {p_x}_{x∈C} and the K − 1 pairwise tallies {t_c({c,y})}_{y≠c}. Fix τ > 0. With m ≥ c0 (log(2K) + log(1/δ))/τ^2 i.i.d. ballots (for a universal constant c0), Hoeffding’s inequality and a union bound yield, with probability ≥ 1 − δ, a uniform sup error ≤ τ simultaneously for these quantities. The map (p, {t_c({c,y})}) ↦ ε_{2type}(γ; c) is Lipschitz with constant at most 6 in the sup norm (A*, B*, D are each 2-Lipschitz). Therefore, the plug-in decision “declare c an ε-winner if min_{y≠c} \widehat{ε}_{2type}(y,γ; c) ≤ ε − 6τ” is correct with probability ≥ 1 − δ. Taking τ = Θ(ε) gives m = Θ((log K + log(1/δ))/ε^2).

# Example (K = 4)
Let C = {a,b,c,d}, target c. First-round shares: p_a = 0.20, p_b = 0.26, p_c = 0.25, p_d = 0.29. Choose y = b, so W = {a,d}. Then
- A* = max{0.20 − 0.25, 0.29 − 0.25} = 0.04,
- B* = max{0.20 − 0.26, 0.29 − 0.26} = 0.03.
If t_c({b,c}) = 0.49 (so D = 0.51 − 0.49 = 0.02 for γ → 0^+), the two-type cost is
  ε_{2type}(b; c) = 0.03 + max{0.04, 0.03 + 0.02} = 0.08.
Thus adding α = 0.05 of c-first and β = 0.03 of b-first ballots forces elimination of a and d before c,b and makes c beat b in the final.

# Lower bound sketch for the two-type certifier (log K factor is necessary)
Consider instances where (i) all nonfinal opponents are safely below both c and every y in first-round shares (so A* = B* = 0), and (ii) exactly one opponent y* satisfies t_c({c,y*}) = 1/2 − ε while all other y have t_c({c,y}) ≤ 1/2 − 2ε. Then c is an ε-winner via the two-type certificate iff “∃ y with t_c({c,y}) ≥ 1/2 − ε”. Distinguishing H0: ∀y, t_c({c,y}) ≤ 1/2 − 2ε from H1: ∃! y*, t_c({c,y*}) = 1/2 − ε while the rest are 1/2 − 2ε reduces to a best-arm identification problem over K − 1 Bernoulli means separated by ε. Standard Fano (or change-of-measure for multiple alternatives) implies m = Ω((log K)/ε^2) samples are necessary (to keep both false positive and false negative probabilities below a constant). Hence the log K term in the sampling bound above is information-theoretically unavoidable for certifying this two-type condition.

# Obstacles and why this helps
- This two-type certificate is exact for K = 3 and gives a simple, auditable sufficient condition for general K that depends on only O(K) tallies, yielding m = Θ((log K + log(1/δ))/ε^2). It strictly strengthens the c-first-only certificate in many K ≥ 4 instances (because it can leverage a “friendly” opponent y with a favorable pairwise margin), yet remains computationally trivial.
- It is not generally optimal for K ≥ 4: additional ballot types can, in principle, reduce the required mass by finely steering intermediate-round eliminations. Providing a separation example is an immediate next step.
- The fixed-order LP approach remains the path to exact optimality for general K; its sample complexity analysis hinges on bounding sup_{λ∈Λ} ||λ||_1 in the dual, which is open. The two-type result can be viewed as a low-dimensional, order-free relaxation with a clean stability analysis.

# Next steps
- Incorporate this general-K two-type certificate and its sampling corollary into notes.md (as a sufficient, efficiently checkable condition) and into output.md (as an algorithmic upper bound on sample complexity).
- Construct and analyze a K = 4 counterexample where adding a third ballot type strictly improves over the two-type bound.
- Formalize the lower bound above via an explicit ranking distribution that keeps A* = B* = 0 while toggling a single pairwise margin; then apply Fano to obtain Ω((log K)/ε^2) rigorously.
- Pursue the dual-based sensitivity bound for the fixed-order LP; even a coarse polynomial bound would immediately yield a polynomial-in-K sample complexity for exact certification of a chosen elimination order.



=== Prover 2 Output ===

Ideas
- Close the fixed-order LP sensitivity gap by upper-bounding the dual 1-norm. This yields a clean Lipschitz constant and a polynomial-in-K sample bound for certifying any fixed elimination order π.
- Record a general “two-type along a spine” sufficient certificate for K ≥ 4 (eliminate all non-spine opponents before a final between c and a chosen b), which subsumes the K = 3 formula when only one non-spine opponent exists.
- Provide a K-dependent lower-bound template via Fano, indicating an Ω((log K)/ε^2) necessity in general.

Lemma 1 (Dual 1-norm bound for a fixed elimination order).
Fix an elimination order π on K candidates and slack γ > 0. Let S_j = {π(j),…,π(K)} for j = 1,…,K−1. Consider the LP (minimize total added mass) with constraints
(t_a(S_j) − t_{π(j)}(S_j)) + ∑_r y(r)(1[top_{S_j}(r)=a] − 1[top_{S_j}(r)=π(j)]) ≥ γ
for every j and a ∈ S_j \ {π(j)}. Its dual feasible set Λ_π consists of λ ≥ 0 such that, for every ranking r,
∑_{j=1}^{K-1} ∑_{a∈S_j\{π(j)}} λ_{j,a}(1[top_{S_j}(r)=a] − 1[top_{S_j}(r)=π(j)]) ≤ 1.
Then sup_{λ∈Λ_π} ||λ||_1 ≤ K.

Proof.
For each candidate x, consider the “champion” ranking r_x that places x at the very top (ties arbitrary below). Then for every j with x ∈ S_j \ {π(j)}, we have top_{S_j}(r_x) = x, while top_{S_j}(r_x) ≠ π(j). The dual constraint for r_x reduces to ∑_{j: x∈S_j\{π(j)}} λ_{j,x} ≤ 1. Summing these K inequalities over x gives ∑_{x} ∑_{j: x∈S_j\{π(j)}} λ_{j,x} ≤ K. The left-hand side is exactly ∑_{j}∑_{a∈S_j\{π(j)}} λ_{j,a} = ||λ||_1. Hence ||λ||_1 ≤ K for all λ ∈ Λ_π, proving the claim.

Corollary 2 (Lipschitz sensitivity for a fixed π).
Let v_π(b) denote the optimal value of the primal as a function of the right-hand sides b_{j,a} = γ − (t_a(S_j) − t_{π(j)}(S_j)). Then for any perturbation Δ,
|v_π(b+Δ) − v_π(b)| ≤ K ||Δ||_∞.

Proof.
By LP duality, v_π(b) = max_{λ∈Λ_π} b^T λ. Hence |v_π(b+Δ) − v_π(b)| = |max_{λ} (b+Δ)^T λ − max_{λ} b^T λ| ≤ sup_{λ∈Λ_π} |Δ^T λ| ≤ (sup_{λ} ||λ||_1) ||Δ||_∞ ≤ K ||Δ||_∞ by Lemma 1.

Corollary 3 (Sampling to certify a fixed order π).
For a fixed π, the constraints involve at most M_π := ∑_{j=1}^{K-1} |S_j| ≤ K(K−1)/2 distinct top-of-S indicators. Hoeffding plus a union bound implies that with m ≥ c (log(M_π) + log(2/δ)) / τ^2 samples, we have
sup_{j,a} |(\hat t_a(S_j) − \hat t_{π(j)}(S_j)) − (t_a(S_j) − t_{π(j)}(S_j))| ≤ 2τ
with probability ≥ 1 − δ. Therefore, |\hat v_π − v_π| ≤ K · 2τ. Setting 2Kτ = η, it suffices to take m = Θ((log K + log(1/δ))/η^2).

Usefulness: This gives a polynomial-in-K sample bound to accurately evaluate the minimal augmentation for any fixed π. As a one-sided, sound certifier: if \hat v_π ≤ ε − η, then v_π ≤ ε and the target winner is an ε-winner via π. This does not require uniform estimation over all π.

Remark (On selecting π).
Searching all π is computationally large. Practically, evaluate \hat v_π for a small set of candidate orders (e.g., the empirical IRV order; orders obtained by swapping adjacent eliminations; or a handful of “spine” orders defined below). Whenever any order certifies (\hat v_π ≤ ε − η), the certificate is valid. Guaranteeing success for all instances still requires either a structural approximation result over orders or a broader (potentially exponential) uniform estimation; establishing such an approximation is open.

Proposition 4 (Spine two-type sufficient certificate for general K).
Fix c and choose a “spine opponent” b ≠ c. Let γ > 0. Define
A_γ(b) := max_{S ⊇ {b,c}} max_{a ∈ S\{b,c}} [t_a(S) − t_c(S) + γ]_+,
B_γ(b) := max_{S ⊇ {b,c}} max_{a ∈ S\{b,c}} [t_a(S) − t_b(S) + γ]_+,
D_γ(b) := t_b({b,c}) − t_c({b,c}) + γ.
If one adds α c-first and β b-first ballots with α ≥ A_γ(b), β ≥ B_γ(b), and α − β ≥ D_γ(b), then along any elimination path that always removes candidates in S\{b,c} before either b or c, every such a ∈ S\{b,c} is eliminated strictly before {b,c}, and c defeats b in the final. Hence c is the winner. The total added mass α+β is minimized by
ε_spine(b;γ) = B_γ(b) + max{A_γ(b), B_γ(b) + D_γ(b)}.

Proof (sketch).
- First-round and all intermediate rounds that involve S ⊇ {b,c}: For every a ∈ S\{b,c}, the constraints α ≥ A_γ(b) and β ≥ B_γ(b) ensure p'_a(S) < min{p'_b(S), p'_c(S)} with strict margin γ, so a is never the minimal among S.
- Final: Each c-first (resp. b-first) ballot contributes +1 to t'_c({b,c}) (resp. t'_b({b,c})). The condition α − β ≥ D_γ(b) enforces a strict c-over-b final.
- Optimality under these constraints is the same 2D linear minimization as K = 3: set β = B_γ(b) and α = max{A_γ(b), B_γ(b) + D_γ(b)}.
When K = 3, the maxima in A_γ, B_γ collapse to the unique S = {a,b,c}, recovering the exact formula from the notes. For K ≥ 4, this remains a sound (generally non-tight) certificate that uses only two ballot types.

Example (K = 4, certificate beating c-first-only bound).
Let first-round shares be p_c = 0.24, p_b = 0.26, p_d = 0.25, p_a = 0.25. Suppose for all S ⊇ {b,c} and a ∈ S\{b,c}, the gaps t_a(S) − t_b(S) ≤ 0.03 and t_a(S) − t_c(S) ≤ 0.09, while t_b({b,c}) − t_c({b,c}) = 0.04. Then ε_spine(b;0) = 0.03 + max{0.09, 0.07} = 0.12, while the c-first certificate requires max_S min_{x≠c}(t_x(S) − t_c(S))_+ ≥ 0.09. If the worst S for c-first is larger than 0.12 (possible when some S inflates a over both c and b while keeping b close to c head-to-head), the spine certificate may strictly improve the bound.

Lower bound sketch: Ω((log K)/ε^2) via packing.
Construct a family {P_s}_{s=1}^K of ranking distributions such that (i) under P_s, candidate s is an ε/4-winner while every x ≠ s is not an ε/2-winner; (ii) the pairwise KL divergences satisfy KL(P_s||P_{s′}) ≤ C ε^2 for a constant C. For instance, start from an impartial culture and introduce a small Mallows-type tilt that makes s pairwise beat all others by margin Θ(ε) while keeping all other interactions symmetric; IRV need not elect s, but an O(ε) augmentation (along an appropriate spine with b chosen adversarially) suffices to force s to win, whereas forcing any x ≠ s would require > ε/2. Standard Fano’s inequality then implies that any algorithm identifying an ε/2-winner with probability ≥ 2/3 must use m ≥ c (log K)/ε^2 samples. Formalizing one such tilt with explicit verification of (i)–(ii) is a concrete next step.

Obstacles
- Tightness of the K-bound: while ||λ||_1 ≤ K is sufficient for polynomial sensitivity, it may be loose; sharpening it (e.g., to O(log K)) would further reduce the safety margin needed.
- Selecting π without exponential exploration remains open. Either structural approximation over a poly(K)-sized family of orders or data-dependent strategies with uniform generalization bounds (beyond naive union over (a,S)) are needed.
- The spine certificate is sufficient, not necessary, for K ≥ 4; characterizing exact minimal augmentation even for a fixed π seems to require more than two ballot types in general.

Next steps
- Elevate Lemma 1 and Corollary 2 into notes/proofs; add Corollary 3 as a sampling guarantee for any fixed order π.
- Explore poly(K)-sized families of “spine” orders that approximate optimal LP value within an additive α = o(ε), enabling polynomial sample guarantees without exponential union bounds.
- Formalize the Fano-based Ω((log K)/ε^2) lower bound with an explicit tilted impartial-culture construction and full verification of ε-winner separations.
- Investigate whether the dual K-bound plus structural constraints on rankings can yield Rademacher-style uniform controls over {v_π}_π without enumerating all (a,S).

Minor refinement (K = 3 plug-in Lipschitz constant).
For K = 3, the map (p_a,p_b,p_c,t_c({b,c}),t_c({a,c})) ↦ ε^*(γ;c) is 6-Lipschitz in the sup norm: A_γ, B_γ, D_γ each vary by ≤ 2τ under τ-perturbations of their inputs, and ε^* = B_γ + max{A_γ, B_γ + D_γ} varies by at most 6τ. Choosing τ = ε/12 gives m = Θ((log(1/δ))/ε^2) for a safe plug-in decision.


=== Prover 3 Output ===

Ideas
- Close the LP sensitivity gap for general K: prove a clean, order-independent bound sup_{λ∈Λ} ||λ||_1 ≤ K−1 for the dual of the fixed-order augmentation LP. This yields an explicit Lipschitz constant for the optimum value v(b) with respect to per-constraint tally errors, giving polynomial-in-K sample complexity for certifying any fixed elimination order.
- For K = 3, sharpen the Lipschitz constant for the exact two-type formula to L = 3 (improves on the coarse L = 6), tightening the sampling margin.
- Turn the sensitivity bound into a general sampling theorem: with m = Θ(((K−1)^2 (K log K + log(1/δ)))/ε^2) samples, we can, w.h.p., verify whether min over all elimination orders ending in c has augmentation cost ≤ ε; hence we can certify that c is an ε-winner. This is polynomial in K.

Rigorous results and proofs

Lemma A (Dual norm bound for the fixed-order LP).
Fix K and an elimination order π of the candidates. For S_j := {π(j),…,π(K)} and slack γ > 0, consider the LP whose variables y(r) ≥ 0 (r ranges over full rankings) minimize ||y||_1 subject to, for each j ∈ {1,…,K−1} and each a ∈ S_j \ {π(j)}:
  (t_a(S_j) − t_{π(j)}(S_j)) + ∑_r y(r) (1[top_{S_j}(r) = a] − 1[top_{S_j}(r) = π(j)]) ≥ γ.
Let b_{j,a} := γ − (t_a(S_j) − t_{π(j)}(S_j)). The dual is
  maximize ⟨b, λ⟩ subject to A^T λ ≤ 1 and λ ≥ 0,
where A_{(j,a), r} = 1[top_{S_j}(r) = a] − 1[top_{S_j}(r) = π(j)]. Define R_K := sup_{λ feasible} ||λ||_1. Then R_K ≤ K − 1.

Proof.
Write pos_π(x) for the position of x in π. For each x ∈ C, consider the ranking r_x that places x first (and breaks ties arbitrarily below). For any j < pos_π(x), we have top_{S_j}(r_x) = x ≠ π(j), and for j ≥ pos_π(x), either x ∉ S_j or j = pos_π(x) (for which there is no variable λ_{j,x} since x = π(j)). Therefore, the dual constraint A^T λ ≤ 1 evaluated at r_x becomes ∑_{j < pos_π(x)} λ_{j,x} ≤ 1. Summing these K inequalities over all x yields ∑_x ∑_{j < pos_π(x)} λ_{j,x} ≤ K − 1, but the left-hand side equals ||λ||_1 because λ_{j,a} is defined only for pairs (j,a) with a ∈ S_j \ {π(j)}, equivalently j < pos_π(a). Hence ||λ||_1 ≤ K − 1. ∎

Corollary B (Lipschitz sensitivity for the fixed-order LP optimum).
Let v(b) be the optimal primal value for the fixed-order LP with RHS vector b. For any perturbation Δ, we have
  |v(b + Δ) − v(b)| ≤ (K − 1) ||Δ||_∞.

Proof.
By LP duality, v(b) = max_{λ ∈ Λ} ⟨b, λ⟩. Then for any Δ, |v(b + Δ) − v(b)| = |max_{λ} ⟨b + Δ, λ⟩ − max_{λ} ⟨b, λ⟩| ≤ max_{λ ∈ Λ} |⟨Δ, λ⟩| ≤ (sup_{λ ∈ Λ} ||λ||_1) ||Δ||_∞ ≤ (K − 1) ||Δ||_∞ by Lemma A. ∎

Corollary C (Sampling for a fixed elimination order π).
Fix π and γ > 0. Let τ > 0. Estimate all tallies t_x(S_j) appearing in the LP for this π by empirical frequencies from m i.i.d. ballots. There are at most T_π := ∑_{j=1}^{K−1} |S_j| = (K − 1)(K + 2)/2 such tallies. Hoeffding and a union bound yield that with probability ≥ 1 − δ, we have sup error ≤ τ provided m ≥ c (log(2 T_π/δ))/τ^2 for a universal constant c. The induced RHS perturbation is ||Δ||_∞ ≤ 2τ. Therefore, with probability ≥ 1 − δ,
  |\hat v_π − v_π| ≤ 2 (K − 1) τ.

Remark: This is a per-order, polynomial-in-K guarantee. It requires no exponential union bound over all subsets; only the O(K^2) tallies used by this π enter.

Theorem D (General K: polynomial-sample ε-winner certification via per-order LPs).
Fix ε, δ ∈ (0,1) and γ ∈ (0, ε/4). For each candidate c, consider all elimination orders π that end with c. For each such π, form the LP above (with slack γ) and compute the plug-in optimum \hat v_π from m i.i.d. ballots. Output any candidate ĉ for which min over π ending with ĉ of \hat v_π ≤ ε − 2 (K − 1) τ, where τ is a target accuracy parameter. If
  m ≥ c · (log(2 (K − 1)! · T_π / δ)) / τ^2  with  T_π = (K − 1)(K + 2)/2,
then with probability at least 1 − δ the output ĉ (if any) is an ε-winner of the true election. Choosing τ = ε / (4 (K − 1)) gives
  m = Θ(((K − 1)^2 (K log K + log(1/δ)))/ε^2).

Proof.
There are at most (K − 1)! orders ending with a fixed c. For a fixed π, by Corollary C, Pr[|\hat v_π − v_π| > 2 (K − 1) τ] ≤ 2 T_π e^{−2 m τ^2}. Union bound over the (K − 1)! relevant orders and all c multiplies this failure probability by at most K · (K − 1)!, which adjusts the log by O(K log K). On the complement event, for every π and c we have |\hat v_π − v_π| ≤ 2 (K − 1) τ. Consequently, if min_π \hat v_π ≤ ε − 2 (K − 1) τ, then min_π v_π ≤ ε, i.e., there exists an elimination order π making c win with total added mass ≤ ε. The choice γ < ε/4 ensures strict margins so that tie-breaking is irrelevant. ∎

Note: This is a sample-complexity result; enumerating all orders is computationally expensive but does not affect m. One can also reduce computation by sample-splitting: use a small training subsample to select a handful of promising orders and a disjoint validation subsample with the above bound to certify one of them.

K = 3 refinements

Lemma E (Tight Lipschitz constant L = 3 for ε^*(γ; c) when K = 3).
Recall ε_a^*(γ) = B_γ + max{A_γ, B_γ + D_γ}, with A_γ = [p_a − p_c + γ]_+, B_γ = [p_a − p_b + γ]_+, and D_γ = t_b({b,c}) − t_c({b,c}) + γ. Each of A_γ, B_γ, D_γ is 1-Lipschitz in the sup norm over the five inputs (p_a,p_b,p_c,t_c({b,c}),t_c({a,c})), and max preserves the larger Lipschitz constant of its arguments. Hence Lip(max{A_γ, B_γ + D_γ}) ≤ max{1, 1 + 1} = 2 and Lip(B_γ) ≤ 1, so Lip(ε_a^*(γ)) ≤ 3. The same holds for ε_b^*(γ). Therefore Lip(ε^*(γ; c)) = Lip(min{ε_a^*(γ), ε_b^*(γ)}) ≤ max{3, 3} = 3.

Corollary F (Sharper K = 3 sampling margin).
With m ≥ c (log(5/δ))/τ^2, the plug-in \widehat{ε}^*(γ; c) satisfies |\widehat{ε}^*(γ; c) − ε^*(γ; c)| ≤ 3 τ with probability ≥ 1 − δ. Thus, the acceptance threshold can use margin 3τ instead of the coarse 6τ.

Examples and sanity checks
- Counterexample revisited (K = 3): a = 0.38, b = 0.35, c = 0.27, and t_c({b,c}) − t_b({b,c}) = 0.10. With γ → 0, we have A_0 = 0.11, B_0 = 0.03, D_0 = −0.10. Hence ε_a^*(0) = 0.03 + max{0.11, −0.07} = 0.14 and ε_b^*(0) computed symmetrically is ≥ 0.20 (since c loses to a by margin 0.20). So ε^*(c) = 0.14, strictly below the c-first certificate 0.20; this matches the earlier construction using 0.11 of c-first and 0.03 of b-first ballots.

Obstacles and caveats
- The general K algorithm above certifies existence of a favorable elimination order but is computationally heavy (enumerating (K − 1)! orders per target c). This does not impact sample complexity but motivates algorithmic heuristics (e.g., prune orders via coarse certificates, sample-splitting selection, or greedy search).
- While Lemma A settles the key sensitivity constant, deriving a smaller constant or tighter order-dependent constants (e.g., depending on the shape of π) could further reduce margins.
- Strong K-dependent lower bounds (e.g., Ω((K log K)/ε^2)) for ε-winner identification remain open; constructing hard families that force knowing which elimination order helps is nontrivial.

Next steps
- Incorporate Lemma A, Corollary B, and Theorem D into notes.md/proofs.md, as they resolve the previously marked-open sensitivity step and give a clean polynomial-in-K sample bound for the per-order LP approach.
- Add the L = 3 refinement (Lemma E) and Corollary F to the K = 3 section of output.md.
- Empirical/algorithmic: explore order-pruning strategies that preserve correctness (no false acceptance) while cutting computation, e.g., filter by the c-first certificate and by pairwise margins to select a small set of promising orders before LP evaluation.
- Lower bounds: attempt a packing over elimination orders by embedding index information into small perturbations of per-round tallies so that only one order yields augmentation ≤ ε, targeting a Fano-style Ω((log((K − 1)!))/ε^2) lower bound.



=== Prover 4 Output ===

# Ideas

- General-K two-type certificate (final-pair strategy). For a target c and a chosen pivot b, eliminate all other candidates first (in a data-independent order determined by baseline tallies), using only c-first and b-first added ballots. This yields a closed-form sufficient bound ε_b^*(γ) analogous to the K=3 exact formula.
- Dominance lemma for fixed elimination path: for that path, c-first and b-first ballots dominate any other added ranking in improving all constraints; thus restricting to two types is w.l.o.g. for that path.
- Sampling under a separation condition via sample-splitting: identify the “minimal-of-others” chain with one subsample, then estimate the required tallies with another; overall sample complexity polynomial in K when the chain margins are bounded away from 0.
- Tight Lipschitz bound for K=3 plug-in map: L ≤ 6 in sup norm.

# General-K two-type final-pair certificate

Setup. Candidate set C, |C|=K≥3. For any nonempty S⊆C and a∈S, t_a(S):=Pr[top among S is a]. Fix target c∈C and choose a pivot b∈C\{c}. Fix slack γ>0 to enforce strict separations.

Define the chain of remaining sets and the “minimal-of-others” sequence:
- S_1 := C.
- For j=1,…,K−2: pick
  e_j ∈ argmin_{e ∈ S_j \ {b,c}} t_e(S_j), and set S_{j+1} := S_j \ {e_j}.
  (Break ties by the fixed deterministic rule; γ>0 will make them irrelevant.)

Define the cumulative deficits
- A_b(γ) := max_{1≤j≤K−2} [ t_{e_j}(S_j) − t_c(S_j) + γ ]_+.
- B_b(γ) := max_{1≤j≤K−2} [ t_{e_j}(S_j) − t_b(S_j) + γ ]_+.
- D_{b,c}(γ) := t_b({b,c}) − t_c({b,c}) + γ.

Theorem (two-type final-pair certificate). If we add α≥0 mass of c-first ballots and β≥0 mass of b-first ballots with
- α ≥ A_b(γ),
- β ≥ B_b(γ), and
- α − β ≥ D_{b,c}(γ),
then along the elimination path S_1,…,S_{K−1} the candidates e_1,…,e_{K−2} are eliminated in order, and in the final {b,c} round, c beats b by γ; hence c is the IRV winner. Moreover, among such two-type additions, the minimum total mass is
  ε_b^*(γ) = B_b(γ) + max{ A_b(γ), B_b(γ) + D_{b,c}(γ) }.
Finally, define ε^{cert}(γ;c) := min_{b≠c} ε_b^*(γ) and ε^{cert}(c) := lim_{γ→0^+} ε^{cert}(γ;c).

Proof (sketch). Under added α,β of c-first and b-first ballots, for each j the updated tallies on S_j are t'_c(S_j)=t_c(S_j)+α, t'_b(S_j)=t_b(S_j)+β, and t'_x(S_j)=t_x(S_j) for every x∈S_j\{b,c}. By construction, e_j is the (tie-broken) minimal among S_j\{b,c}. The constraints α ≥ A_b(γ) and β ≥ B_b(γ) ensure t'_c(S_j) > t'_{e_j}(S_j) and t'_b(S_j) > t'_{e_j}(S_j); as the other “others” exceed or tie e_j already and are unchanged, e_j is strictly the unique minimal in S_j and is eliminated. Iterating yields S_{K−1}={b,c}. In the final, each c-first ballot contributes +1 to t'_c({b,c}), each b-first contributes +1 to t'_b({b,c}), so α−β ≥ D_{b,c}(γ) enforces a strict c win. Minimizing α+β over the polyhedron {α≥A, β≥B, α−β≥D} is achieved at β=B and α=max{A,B+D}, giving ε_b^*(γ) as stated.

Remark. For K=3 this recovers the exact formula in the notes (A=[p_a−p_c+γ]_+, B=[p_a−p_b+γ]_+, D=t_b({b,c})−t_c({b,c})+γ), and ε^*(γ;c)=min_b ε_b^*(γ).

# Dominance of two types for a fixed path

Lemma (two-type suffices for fixed path). Fix c, b, γ and a specific elimination path e_1,…,e_{K−2}. Consider the LP minimizing ||y||_1 over nonnegative measures y on rankings subject to, for every j,
- t'_c(S_j) ≥ t'_{e_j}(S_j) + γ,
- t'_b(S_j) ≥ t'_{e_j}(S_j) + γ,
and final-round t'_c({b,c}) ≥ t'_b({b,c}) + γ. There is an optimal y supported on two rankings: a c-first ranking and a b-first ranking, and its cost equals B_b(γ)+max{A_b(γ), B_b(γ)+D_{b,c}(γ)}.

Proof (outline). Each constraint’s LHS is affine in y with coefficients 1[top_{S_j}(r)=c] or 1[top_{S_j}(r)=b]; any ranking r with top_{S_j}(r)∉{c,b} contributes 0 to the corresponding constraint. A c-first ranking contributes 1 to all c-vs-e_j constraints (every j) and +1 to the final c−b margin; similarly b-first contributes 1 to all b-vs-e_j constraints and −1 to the final margin. Thus, for any r, replacing y(r) by an equal mass on c-first (if r ranks c≻b) or b-first (if r ranks b≻c) weakly improves all constraints coordinatewise. Hence an optimal solution exists with support on these two types, and its optimal value is the 2-variable minimum stated above.

# Example (K=4)

Let C={a,b,c,d}, target c, pivot b. Suppose
- First-round: t_a(C)=0.26, t_b(C)=0.24, t_c(C)=0.22, t_d(C)=0.28.
- After removing a: on S_2={b,c,d}, t_d(S_2)=0.33, t_b(S_2)=0.37, t_c(S_2)=0.35.
- Pairwise: t_c({b,c})=0.55, t_b({b,c})=0.45.
Take γ→0. Then e_1=a (minimal among {a,d}), e_2=d. Compute
- A_b = max{0.26−0.22, 0.33−0.35, 0}_+ = 0.04.
- B_b = max{0.26−0.24, 0.33−0.37, 0}_+ = 0.02.
- D_{b,c} = 0.45 − 0.55 = −0.10.
Thus ε_b^* = 0.02 + max{0.04, −0.08} = 0.06. Adding α=0.04 of c-first and β=0.02 of b-first ensures elimination of a then d and a c-over-b final.

# Sampling with separation via sample-splitting (general K)

Separation assumption. Along the chain S_1,…,S_{K−1} for a fixed b, let
  μ_j := min_{x∈S_j\{b,c,e_j}} ( t_x(S_j) − t_{e_j}(S_j) ), and μ := min_j μ_j.
Assume μ>0 (the minimal-of-others is separated from the second-minimal by at least μ at every round).

Algorithm.
- Stage 1 (identify chain): Draw m_1 ballots. For j=1,…,K−2, compute empirical tallies on S_j^hat recursively (starting from S_1^hat=C) and set e_j^hat to the empirical argmin over S_j^hat\{b,c}.
- Stage 2 (estimate deficits): Independently draw m_2 ballots. For the sets S_j^true (the true chain) we do not know their identity, but if Stage 1 succeeds (i.e., e_j^hat=e_j for all j), then S_j^hat=S_j. On Stage 2 data, estimate t_{e_j}(S_j), t_b(S_j), t_c(S_j) for all j, and t_b({b,c}), t_c({b,c}). Form A_b, B_b, D_{b,c} and ε_b^*.
- Decision: If min_b \, \widehat{ε}_b^*(γ) ≤ ε − 2τ, return c.

Guarantee. There exist absolute constants c_1,c_2 such that the following suffices:
- m_1 ≥ c_1 (log(K/δ)) / μ^2 ensures P(Stage 1 identifies the true chain for that b) ≥ 1−δ/2 (Hoeffding + union bound across ≤K steps and ≤K candidates per step).
- m_2 ≥ c_2 (log( (3(K−2)+2)/δ )) / τ^2 ensures that, conditional on Stage 1 success, all needed tallies are within ±τ simultaneously with probability ≥1−δ/2.
Then P(ε_b^*(γ) ≤ \widehat{ε}_b^*(γ)+2τ) ≥ 1−δ, so the decision is sound: if declared, c is an ε-winner.

Remarks.
- This yields m = O( (log(K/δ))/μ^2 + (log(K/δ))/ε^2 ). When μ is small (nearly tied “others”), Stage 1 may fail; one can fall back to the c-first certificate (Theorem 2 in notes) which has exponential-in-K uniform estimation but no separation requirement.
- Extending a polynomial-sample, distribution-free guarantee for a general fixed elimination order remains open; it relates to bounding sup_{λ∈Λ} ||λ||_1 in the LP dual (see notes).

# K=3 Lipschitz constant for the plug-in map

Let for K=3 and fixed c with opponent b and “other” a,
  ε_a^*(γ) = B_γ + max{A_γ, B_γ + D_γ},
with A_γ=[p_a − p_c + γ]_+, B_γ=[p_a − p_b + γ]_+, D_γ=t_b({b,c}) − t_c({b,c}) + γ. Then the map (p_a,p_b,p_c,t_b({b,c}),t_c({b,c})) ↦ ε_a^*(γ) is 6-Lipschitz in the sup norm: for any perturbation of these five inputs by at most τ in sup norm, |Δε_a^*(γ)| ≤ 6τ.

Proof. Piecewise linear analysis: If max selects A_γ, then ε=B_γ+A_γ and the l_1 norm of any subgradient is ≤ 4. If max selects B_γ+D_γ, then ε=2B_γ+D_γ and the l_1 norm of any subgradient is ≤ 6. Hence global sup-norm Lipschitz constant ≤ 6.

# Obstacles

- Dual sensitivity bound. For the general fixed-order LP, showing sup_{λ∈Λ} ||λ||_1 = poly(K) (hence polynomial sample complexity for certifying that fixed order) remains open. Naive per-constraint “additive mass” arguments fail because a single ranking can worsen other constraints.
- General-K exact minimal augmentation likely requires mixed-type additions beyond two types and/or changing the elimination path; our two-type certificate is sufficient but not necessarily tight for K≥4.

# Next steps

- Formalize the general-K two-type certificate (statement above) into proofs.md; add the K=4 example.
- Develop the two-stage sampling theorem under a clean chain-separation condition μ, and integrate a fallback to the c-first certifier when μ is tiny.
- Attempt to tighten the K=3 Lipschitz constant (6→4) or provide an exact value.
- Pursue bounding sup_{λ∈Λ} ||λ||_1 by constructing structured dual solutions and adversarial rankings; even bounds like O(K) would suffice for polynomial sample guarantees per fixed order.
- Explore whether allowing two pivots (three-type scheme: c-first and two opponent-first types) yields a strictly stronger certificate with similar O(K^2) statistics.
