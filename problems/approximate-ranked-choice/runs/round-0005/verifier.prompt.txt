=== SYSTEM ===
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md, proofs.md, and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (informal progress & exploratory work so far)
- proofs.md (rigorous proofs & detailed mathematics so far)
- output.md (main results summary so far)

**Three-tier file system guidelines**:
- **notes.md**: Readable running log of exploratory work, intuitions, failed attempts, ideas. Prefer appending. Replace only if old notes are clearly misleading. Should be self-contained.
- **proofs.md**: Complete rigorous mathematical proofs with full details. Contains proven lemmas, theorems, and detailed derivations. Only add mathematically verified content here.
- **output.md**: ONLY the main problem results. Think twice before adding anything. Should contain a concise summary of the most important theorems that directly advance the main problem. Extremely selective.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (â‰¥200 words). Include concrete next-step suggestions.",
  "summary_md": "Concise summary of this round's work for summarizer.",
  "verdict": "promising|uncertain|unlikely",
  "blocking_issues": ["List of issues preventing progress"],
  "per_prover": [{"prover_id": "01", "brief_feedback": "feedback", "score": "promising|uncertain|unlikely"}],
  "notes_update": {"action": "append|replace", "content": "Markdown for notes.md"},
  "proofs_update": {"action": "append|replace", "content": "Markdown for proofs.md"}, 
  "output_update": {"action": "append|replace", "content": "Markdown for output.md"}
}

**Verdict definitions**:
- **promising**: Significant mathematical progress, publishable results, or clear path to solution
- **uncertain**: Some progress but with unresolved issues or incomplete reasoning  
- **unlikely**: No meaningful progress, fundamentally flawed approaches, or just exploratory work

**Update guidelines**:
- Use null for any update field you don't want to modify
- notes_update: Include informal reasoning, failed attempts, intuitions, exploratory work
- proofs_update: Only include complete, rigorous proofs that you have verified
- output_update: Only include main problem results that directly advance toward the solution


=== USER ===
=== Task (txt) ===

# Problem Statement

We consider the problem of estimating the winner in an election run under **Ranked Choice Voting** (also known as *Instant-Runoff Voting*).  

Suppose there are \(K\) candidates. Each voter submits a complete ranking of these candidates. The voting rule proceeds in rounds: in each round, every ballot is assigned to the top-ranked candidate who is still in contention. The candidate with the smallest number of votes is eliminated (with ties broken according to a fixed deterministic rule), and this candidate is crossed out from all ballots. The process repeats until only one candidate remains, who is declared the winner.

Our goal is not to compute the exact winner from the full set of ballots, but rather to estimate a *robust* winner from a random sample of ballots. To make this precise, we introduce the notion of an **Îµ-winner**. A candidate \(c\) is called an Îµ-winner of an election profile if it is possible to add at most an Îµ-fraction of additional ballots to the election so that \(c\) becomes the winner under Ranked Choice Voting. In other words, \(c\) is â€œcloseâ€ to being the true winner, in the sense that a small perturbation of the electorate would make \(c\) win. There may be more Îµ-winners. The real winner is Îµ-winner for any Îµ. 

The sampling model is as follows. We assume there is a large population of voters, each ballot drawn independently from the empirical distribution of this population. The algorithm does not see all the ballots; instead, it may sample ballots at random, with replacement. The task of the algorithm is: given parameters \(\varepsilon\) and \(\delta\), and access to at most \(m\) random ballots, output a candidate \(\hat{c}\) such that with probability at least \(1-\delta\), the candidate \(\hat{c}\) is an Îµ-winner of the true election.

The central question is: **what is the sample complexity of this problem?**  
That is, how many samples \(m\) are sufficient (and necessary) in order for an algorithm to reliably identify an Îµ-winner with probability at least \(1-\delta\)? We seek both upper bounds, by designing sampling algorithms and analyzing their guarantees, and lower bounds, by proving that no algorithm can succeed with significantly fewer than a certain number of samples. 



=== Notes ===

# Notes



# Corrected certificate and counterexample for K = 3

Notation: For a candidate set C with |C| = K and any nonempty S âŠ† C with c âˆˆ S and |S| â‰¥ 2, define t_a(S) = Pr[top among S is a] under the population distribution P over full rankings.

Corrected c-first certificate: Define

M_c(P) := max_{S âŠ† C, c âˆˆ S, |S| â‰¥ 2} [ min_{a âˆˆ S \ {c}} t_a(S) âˆ’ t_c(S) ]_+.

If Îµ > M_c(P), then adding Îµ' (with 0 < Îµ' â‰¤ Îµ) mass of c-first ballots ensures that in every subset S encountered along any IRV elimination path, c's tally strictly exceeds the minimum among S \ {c}, so c cannot be eliminated and is the eventual winner. This yields a sound, distribution-free sufficient condition. Note the strict inequality requirement; in algorithmic use we maintain a margin so that Îµ' < Îµ and ties do not involve c.

Uniform estimation: The family {1[top_S(r) = a]} over all (a, S) has size K Â· 2^{K-1}. Hoeffding + union bound gives uniform estimation of all t_a(S) within Â±Ï„ using m = O((log(K Â· 2^{K-1}) + log(1/Î´))/Ï„^2) samples. The plug-in estimate \hat M_c satisfies |\hat M_c âˆ’ M_c| â‰¤ 2Ï„.

Counterexample to "K = 3 exactness" of c-first certificate: Let first-place shares be a = 0.38, b = 0.35, c = 0.27. Suppose c beats b head-to-head by margin m = 0.10 but loses to a by margin 0.20. The c-first certificate f_c requires Îµ â‰¥ max{0.35 âˆ’ 0.27, 0.20, 0} = 0.20. However, adding Î± = 0.11 of c-first ballots and Î² = 0.03 of b-first ballots yields new first-place tallies c' = 0.38, b' = 0.38, a' = 0.38 (with tiny extra slack to make a uniquely minimal). Then a is eliminated first; in the final, the c vs b margin is m + Î± âˆ’ Î² = 0.10 + 0.11 âˆ’ 0.03 = 0.18 > 0, so c wins. Total added mass â‰ˆ 0.14 < 0.20. Thus, for K = 3, the minimal augmentation need not equal the c-first-only threshold. A full characterization must allow mixed additions.

LP approach (status and caveats): For a fixed elimination order Ï€, the condition that Ï€(j) is eliminated at round j can be written linearly in terms of the baseline tallies t_a(S_j) and the additive contributions of the added mass y(r) via indicators 1[top_{S_j}(r) = a]. This leads to a linear program minimizing total added mass. To be rigorous one must encode the fixed tie-breaking rule (e.g., by strict inequalities or lexicographic tie constraints). Sensitivity of the LP optimum to perturbations in the t_a(S) (estimated from samples) is the key technical step for a polynomial-in-K sample bound using this approach; deriving an explicit O(poly(K)) Lipschitz constant remains open.

Lower bounds: The Î©((1/Îµ^2) log(1/Î´)) dependence is necessary even for K = 2 (majority). Stronger K-dependent lower bounds (Î©((log K)/Îµ^2) or Î©(K/Îµ^2)) are plausible but require explicit constructions.

Next steps summary:
- Formalize LP with tie-breaking and derive sensitivity bounds.
- Provide a correct, closed-form minimal-augmentation characterization for K = 3 allowing mixed additions (compare two strategies: avoid facing a losing opponent by flipping the first-round loser vs. directly fixing the head-to-head deficit).
- Explore whether the worst-case S for the c-first certificate can be restricted by |S| â‰¤ r for a constant r.
- Build K-dependent lower bounds via Fano/packing constructions over top-of-S events.


## K = 3: exact minimal augmentation via two-type reduction

Let C = {a,b,c} and fix target winner c. Denote first-round shares p_x := t_x({a,b,c}) and pairwise shares t_x({b,c}), t_x({a,c}). To remove dependence on tie-breaking, introduce a slack Î³ > 0 and require strict separations in all inequalities.

Targeting elimination of a in round 1 and a c vs b final, it suffices to consider only two added ballot types: c-first (amount Î± â‰¥ 0) and b-first (amount Î² â‰¥ 0). These induce the linear constraints
- First round: p_a + 0 â‰¤ p_b + Î² âˆ’ Î³ and p_a + 0 â‰¤ p_c + Î± âˆ’ Î³, i.e.,
  Î² â‰¥ B_Î³ := [p_a âˆ’ p_b + Î³]_+ and Î± â‰¥ A_Î³ := [p_a âˆ’ p_c + Î³]_+.
- Final: t'_c({b,c}) â‰¥ t'_b({b,c}) + Î³, i.e., Î± âˆ’ Î² â‰¥ D_Î³ := t_b({b,c}) âˆ’ t_c({b,c}) + Î³.
The minimum total mass is then
  Îµ_a^*(Î³) = min_{Î±,Î²â‰¥0} {Î±+Î² : Î± â‰¥ A_Î³, Î² â‰¥ B_Î³, Î± âˆ’ Î² â‰¥ D_Î³} = B_Î³ + max{A_Î³, B_Î³ + D_Î³}.
By a dominance argument, a-first additions are never optimal for this targeted strategy: if an a-first ballot ranks c â‰» b, it is dominated by a c-first ballot (strictly improves both elimination inequalities and matches the bc margin); if it ranks b â‰» c, it is dominated by a b-first ballot (improves the relevant elimination inequality and matches the bc margin). The symmetric expression Îµ_b^*(Î³) is obtained by swapping a and b. The exact minimal augmentation to make c win is
  Îµ^*(Î³; c) = min{Îµ_a^*(Î³), Îµ_b^*(Î³)}, and Îµ^*(c) = lim_{Î³â†’0^+} Îµ^*(Î³; c).
This matches the counterexample in the notes (a=0.38, b=0.35, c=0.27 with c beating b head-to-head): A_0=0.11, B_0=0.03, D_0=âˆ’0.10, hence Îµ_a^*(0) = 0.03 + max{0.11, âˆ’0.07} = 0.14.

Sampling for K = 3: Computing Îµ^*(Î³; c) requires only five tallies: p_a, p_b, p_c, t_c({b,c}), t_c({a,c}). A Hoeffding + union bound over these five quantities gives m = Î˜((log(1/Î´))/Îµ^2) samples to decide whether Îµ^*(c) â‰¤ Îµ with probability â‰¥ 1 âˆ’ Î´.

## LP approach: primal/dual and sensitivity status (general K)

For a fixed elimination order Ï€ with remaining sets S_j = {Ï€(j),...,Ï€(K)}, add slack Î³ > 0 and consider variables y(r) â‰¥ 0 over rankings r. The primal is
- Minimize âˆ¥yâˆ¥_1 subject to, for each j and a âˆˆ S_j \ {Ï€(j)}:
  (t_a(S_j) âˆ’ t_{Ï€(j)}(S_j)) + âˆ‘_r y(r)(1[top_{S_j}(r)=a] âˆ’ 1[top_{S_j}(r)=Ï€(j)]) â‰¥ Î³.
Moving baseline tallies to the RHS gives constraints Ay â‰¥ b, with b_{j,a} = Î³ âˆ’ (t_a(S_j) âˆ’ t_{Ï€(j)}(S_j)). The dual is
- Maximize âˆ‘_{j}âˆ‘_{aâ‰ Ï€(j)} Î»_{j,a}Â·(Î³ âˆ’ (t_a(S_j) âˆ’ t_{Ï€(j)}(S_j))) subject to, for every ranking r,
  âˆ‘_{j}âˆ‘_{aâ‰ Ï€(j)} Î»_{j,a}(1[top_{S_j}(r)=a] âˆ’ 1[top_{S_j}(r)=Ï€(j)]) â‰¤ 1, and Î» â‰¥ 0.
Sensitivity: v(b) = max_{Î»âˆˆÎ›} b^T Î» is 1-Lipschitz in the dual norm: |v(b+Î”) âˆ’ v(b)| â‰¤ (sup_{Î»âˆˆÎ›} âˆ¥Î»âˆ¥_1) âˆ¥Î”âˆ¥_âˆ. Bounding R_K := sup_{Î»âˆˆÎ›} âˆ¥Î»âˆ¥_1 by poly(K) would yield a polynomial-in-K sample bound for certifying a fixed Ï€. For K = 3, the two-type reduction collapses Î› to two variables, giving R_3 â‰¤ 2. For general K, obtaining a good bound on R_K remains open; the per-constraint additive mass approach is invalid because a single added ranking can decrease other constraints when it tops the round-j loser.

## Checklist / next steps
- Formalize the K = 3 theorem and sampling corollary in output.md.
- Keep general c-first certifier and uniform convergence in output.md; use the K = 3 exact result when K = 3.
- Pursue a dual-based sensitivity bound sup_{Î»âˆˆÎ›} âˆ¥Î»âˆ¥_1 = poly(K) or an approximate scheme with provable stability.
- Investigate few-type reductions for K â‰¥ 4 when targeting specific first eliminations.

Updates (verifier audit)

- Invalid general-K two-type claim (first-round-based). It is not enough to compare only first-round shares p_x. Later-round tallies t_w(S) can substantially exceed p_w after transfers. Counterexample sketch (K=4): Let p=(0.26,0.26,0.23,0.25) for (a,b,c,y). Suppose after removing a the tallies on S={b,c,y} are (t_b,t_c,t_y)=(0.40,0.25,0.35). A two-type bound computed only from p would take A*â‰ˆ0.03 and B*â‰ˆ0.01, which does not keep c,y above b in S: c would still be the round-2 loser. Any sound certificate must use the relevant subset tallies t_w(S).

- Dual sensitivity (fixed-order LP): prior attempts to bound sup_{Î»} ||Î»||_1 by K or Kâˆ’1 dropped the negative term at j=pos_Ï€(x) in the dual constraints. Including it makes the â€˜sum over xâ€™ argument cancel, giving no bound. The sensitivity constant remains open.

- Sound general-K two-type (chain) certificate. For target c and pivot b, let S_1=C and iteratively remove e_j = argmin_{eâˆˆS_j\{b,c}} t_e(S_j), with the same deterministic tie-breaking as the election, forming S_{j+1}=S_j\{e_j}. Define
  A_b(Î³)=max_j [t_{e_j}(S_j)âˆ’t_c(S_j)+Î³]_+,
  B_b(Î³)=max_j [t_{e_j}(S_j)âˆ’t_b(S_j)+Î³]_+,
  D_{b,c}(Î³)=t_b({b,c})âˆ’t_c({b,c})+Î³.
Adding Î±â‰¥A_b(Î³) of c-first and Î²â‰¥B_b(Î³) of b-first ballots ensures elimination of e_1,â€¦,e_{Kâˆ’2} in order and a strict c-over-b final if Î±âˆ’Î²â‰¥D_{b,c}(Î³). The minimal two-type mass is B_b+max{A_b, B_b+D_{b,c}}. This is a sufficient, efficiently checkable condition depending on O(K) subset tallies (those on the chain sets S_j and the final pair).

- K=3 exact formula. The minimal augmentation to make c win is Îµ^*(Î³;c)=min{Îµ_a^*(Î³), Îµ_b^*(Î³)}, where for first-eliminate a: A_Î³=[p_aâˆ’p_c+Î³]_+, B_Î³=[p_aâˆ’p_b+Î³]_+, D_Î³=t_b({b,c})âˆ’t_c({b,c})+Î³, and Îµ_a^*(Î³)=B_Î³+max{A_Î³, B_Î³+D_Î³}. This matches the earlier counterexample and strictly improves the c-first certificate. A safe plug-in Lipschitz constant is 6 under sup-norm perturbations of the five required tallies.

Next steps
- Formalize the chain-based certificate (statement and proof) and add it to proofs.md; keep the K=3 exact theorem and the c-first certificate with sampling.
- Construct a Kâ‰¥4 instance where adding a third ballot type strictly reduces the required mass relative to the two-type bound.
- Pursue a correct dual-norm bound for the fixed-order LP (retain negative contributions); explore alternative dual test rankings or decompositions by rounds.
- Lower bounds: formalize a Fano/packing family showing Î©((log K)/Îµ^2) for identifying a favorable opponent y among Kâˆ’1 possibilities.


New validated results and corrections

- Chain-based two-type certificate (general K). For target c and pivot b, form the baseline chain S_1=C and e_j=argmin_{eâˆˆS_j\{b,c}} t_e(S_j) (ties per the fixed rule), S_{j+1}=S_j\{e_j}. Define A_b(Î³)=max_j [t_{e_j}(S_j)âˆ’t_c(S_j)+Î³]_+, B_b(Î³)=max_j [t_{e_j}(S_j)âˆ’t_b(S_j)+Î³]_+, D_{b,c}(Î³)=t_b({b,c})âˆ’t_c({b,c})+Î³. Adding Î± c-first and Î² b-first with Î±â‰¥A_b, Î²â‰¥B_b, Î±âˆ’Î²â‰¥D_{b,c} eliminates e_1,â€¦,e_{Kâˆ’2} in order and elects c over b with strict margins. The optimal two-type mass is Îµ_b^*(Î³)=B_b+max{A_b, B_b+D_{b,c}}. This generalizes the K=3 exact formula and is a sound sufficient condition for Kâ‰¥4.

- Sampling via chain-stability. If the empirical gaps along the chain, \hat g_j = min_{xâˆˆ\hat S_j\{\hat e_j}} \hat t_x(\hat S_j) âˆ’ \hat t_{\hat e_j}(\hat S_j), exceed 4Ï„, then with high probability the empirical chain equals the true chain, and the plug-in cost deviates by â‰¤6Ï„. Using sample-splitting and Hoeffding bounds over O(K^2) tallies yields m = Î˜((log K + log(1/Î´))/Îµ^2) under this verifiable margin condition.

- Necessary lower bound (roundâ€‘1 + final). For any augmentation achieving a {b,c} final with a strict c-over-b win by Î³, the total added mass satisfies âˆ¥yâˆ¥_1 â‰¥ L_b(Î³):=B_b^{(1)}(Î³)+max{A_b^{(1)}(Î³), B_b^{(1)}(Î³)+D_{b,c}(Î³)}, where A_b^{(1)}(Î³)=[p_min^{(b,c)}âˆ’p_c+Î³]_+, B_b^{(1)}(Î³)=[p_min^{(b,c)}âˆ’p_b+Î³]_+. This is tight for K=3 and lower-bounds Îµ_b^* since S_1=C contributes to A_b,B_b.

- Corrections. (i) The first-round-only two-type claim is invalid; later-round tallies t_w(S) can differ greatly from p_w. (ii) Attempts to bound the fixed-order LP dual norm by K or Kâˆ’1 dropped negative terms in the dual constraints; a correct polynomial bound remains open.

Next steps
- Formalize an Î©((log K)/Îµ^2) lower bound via Fano over pivots b.
- Construct a Kâ‰¥4 instance where a 3-type augmentation strictly improves over Îµ_b^*(Î³).
- Seek a valid polynomial dual-norm bound or local (margin-dependent) sensitivity for the fixed-order LP.



=== Current Output ===

Main results on sampling Îµ-winners under IRV

- Sufficient certificate (all K; distribution-free). Define M_c:=max_{SâŠ†C, câˆˆS, |S|â‰¥2} [min_{aâˆˆS\{c}} t_a(S) âˆ’ t_c(S)]_+. If Îµ > M_c, adding Îµ of c-first ballots makes c win. With m = Î˜((K + log(1/Î´))/Îµ^2) ballots, we can uniformly estimate the needed tallies and certify any such c with high probability.

- Exact characterization for K = 3. For C={a,b,c}, the minimal added mass to make c win is Îµ^*(c)=min{Îµ_a^*, Îµ_b^*}, where for eliminating a first,
  Îµ_a^* = [p_aâˆ’p_b]_+ + max{ [p_aâˆ’p_c]_+, [p_aâˆ’p_b]_+ + (t_b({b,c})âˆ’t_c({b,c})) }.
Estimating the five required tallies to accuracy Î˜(Îµ) with m = Î˜((log(1/Î´))/Îµ^2) suffices to decide Îµ^*(c) â‰¤ Îµ w.h.p.

- Chain-based two-type certificate (general K; efficient). Fix a pivot b and form the baseline chain by iteratively removing the minimal among S_j\{b,c}. Let A_b:=max_j [t_{e_j}(S_j)âˆ’t_c(S_j)]_+, B_b:=max_j [t_{e_j}(S_j)âˆ’t_b(S_j)]_+, and D_{b,c}:=t_b({b,c})âˆ’t_c({b,c}). Adding Î± c-first and Î² b-first with Î± â‰¥ A_b, Î² â‰¥ B_b, and Î±âˆ’Î² â‰¥ D_{b,c} elects c; the optimal two-type mass is Îµ_b^* = B_b + max{A_b, B_b + D_{b,c}}. Under a verifiable chain-stability margin, a plug-in test certifies c with m = Î˜((log K + log(1/Î´))/Îµ^2).

- General necessary lower bound (roundâ€‘1 + final). For any augmentation achieving a {b,c} final with a strict c-over-b win, the total mass satisfies âˆ¥yâˆ¥_1 â‰¥ L_b := B_b^{(1)} + max{A_b^{(1)}, B_b^{(1)} + D_{b,c}}, where A_b^{(1)}=[p_min^{(b,c)}âˆ’p_c]_+ and B_b^{(1)}=[p_min^{(b,c)}âˆ’p_b]_+. This bound is tight for K=3 and lower-bounds Îµ_b^* for any pivot b.

- Lower bound (baseline). Any algorithm needs m = Î©((1/Îµ^2) log(1/Î´)) samples even for K = 2 (majority). A Î©((log K)/Îµ^2) dependence is necessary for certificates that must identify a favorable opponent among Kâˆ’1 options (formalization via Fano is in progress).


=== Prover 1 Output ===

# Ideas
- Provide an explicit K = 4 ranking profile where the chain-based two-type certificate (min over pivots) requires Îµ â‰¥ 0.15, yet a three-type augmentation (c-first and a-first only) makes c win with total mass â‰ˆ 0.12. This cleanly separates two-type from optimal, showing two-type is not tight for K â‰¥ 4.
- Use a small set of ranking types to ensure all required top-of-S tallies and pairwise tallies are internally consistent.
- Outline a general â€œfew-type LPâ€ approach: for a fixed targeted elimination chain and a chosen small set of added-top types T, the minimal augmentation is a low-dimensional LP; this offers a path to improved certificates beyond two-type.

# Example and Proposition (Two-type is suboptimal for K = 4)
Fix C = {a,b,c,d} and target c. Consider the following full-ranking distribution (probabilities sum to 1):
- A_b: 0.06 on a â‰» b â‰» d â‰» c
- A_d: 0.12 on a â‰» d â‰» c â‰» b
- B:   0.35 on b â‰» a â‰» c â‰» d
- C:   0.22 on c â‰» b â‰» d â‰» a
- D_c: 0.085 on d â‰» c â‰» b â‰» a
- D_a: 0.05 on d â‰» a â‰» c â‰» b
- D_b: 0.115 on d â‰» b â‰» c â‰» a
Compute relevant tallies:
- First round S1 = C: (t_a,t_b,t_c,t_d) = (0.18, 0.35, 0.22, 0.25).
- Second round S2 = {b,c,d}: t_b(S2) = 0.35 + 0.06 = 0.41; t_c(S2) = 0.22; t_d(S2) = 0.12 + 0.25 = 0.37.
- Alternate second round S2â€² = {a,b,c}: t_a(S2â€²) = 0.06 + 0.12 + 0.05 = 0.23; t_b(S2â€²) = 0.35 + 0.115 = 0.465; t_c(S2â€²) = 0.22 + 0.085 = 0.305.
- Pairwise c vs b: t_c({b,c}) = 0.12 + 0.22 + 0.085 + 0.05 = 0.475; hence D_{b,c} = t_b âˆ’ t_c = 0.525 âˆ’ 0.475 = 0.05.

Chain-based two-type certificate, pivot b.
- Baseline chain: e1 = a (since min{a,d} = a), S2 = {b,c,d} and e2 = d.
- A_b(0) = max{ [0.18 âˆ’ 0.22]_+, [0.37 âˆ’ 0.22]_+ } = 0.15.
- B_b(0) = max{ [0.18 âˆ’ 0.35]_+, [0.37 âˆ’ 0.41]_+ } = 0.
- D_{b,c}(0) = 0.05. Thus Îµ_b^{(2)}(0; c) = 0 + max{0.15, 0.05} = 0.15.
Other pivots are worse: pivot d gives Îµ_d^{(2)} = 0.04 + max{0.19, 0.04 âˆ’ 0.14} = 0.23; pivot a is â‰¥ 0.63 (details in Obstacles/Checks). Hence min_b Îµ_b^{(2)} = 0.15.

Three-type augmentation beating Îµ_b^{(2)}.
Add Î± of c-first and Î²_a of a-first ballots (no b-first). Choose Î²_a = 0.0701 and Î± = 0.0501. Then:
- Round 1 (S1): aâ€² = 0.18 + Î²_a â‰ˆ 0.2501, câ€² = 0.22 + Î± â‰ˆ 0.2701, bâ€² = 0.35, dâ€² = 0.25. The unique minimum is d (0.25), so d is eliminated.
- Round 2 (S2â€² = {a,b,c}): aâ€²(S2â€²) = 0.23 + Î²_a â‰ˆ 0.3001, bâ€²(S2â€²) = 0.465, câ€²(S2â€²) = 0.305 + Î± â‰ˆ 0.3551. Thus a is eliminated.
- Final (c vs b): tâ€²_c({b,c}) âˆ’ tâ€²_b({b,c}) = (0.475 + Î±) âˆ’ 0.525 = Î± âˆ’ 0.05 > 0 by choice of Î±. Hence c wins with strict margins.
Total mass Î± + Î²_a â‰ˆ 0.1202 < 0.15. Therefore, the two-type certificate is not tight for K â‰¥ 4.

Proof sketch completeness.
- All tallies used follow from the explicit ranking distribution; the subset tallies are computed as the probability that the listed ranking places the designated candidate top among the subset. Pairwise tallies use the usual â€œc above bâ€ counts.
- The three-type feasibility constraints are the standard linear IRV round inequalities on the affected subsets; we verified each roundâ€™s strict separations and the final pairwise win.
- Minimality of two-type for pivot b follows from the chain-based theorem: within two types {c,b}, the minimum equals B_b + max{A_b, B_b + D_{b,c}} = 0.15.

# Obstacles and checks
- Why two-type fails: Here câ€™s binding deficit is at S2 = {b,c,d}, where d has 0.37 while c has 0.22, driving A_b = 0.15. Steering the first elimination to remove d (by adding a-first ballots) avoids this large deficit and yields a cheaper path even after accounting for the final pairwise deficit.
- Soundness of calculations: we checked all relevant subset tallies (S1, S2, S2â€²) and pairwise c vs b; other pivots (a, d) give higher two-type costs (pivot a: A_a = max{0.25âˆ’0.22, 0.465âˆ’0.305} = 0.16, B_a = max{0.25âˆ’0.18, 0.465âˆ’0.23} = 0.235, D_{a,c} = 0.58âˆ’0.42 = 0.16, so Îµ_a^{(2)} = 0.235 + max{0.16, 0.395} = 0.63; pivot d: computed above as 0.23).
- Generalization: Optimizing over three (or a few) added-top types for a fixed targeted chain is a small LP with linear constraints whose number scales with the chain length; this suggests a tractable family of improved certificates beyond two-type.

# Next steps
- Formalize a â€œfew-type targeted-chain LPâ€ certificate: for a chosen pivot y and a steering set T âŠ† C\{y,c}, solve min âˆ‘_{tâˆˆTâˆª{c,y}} x_t subject to per-round linear inequalities on the chain (with Î³-slack) and the final pairwise constraint; minimize over small T (e.g., |T| â‰¤ 1 or 2). Prove a Lipschitz sampling bound using the structure of these constraints.
- Develop a systematic recipe to search for steering candidates s that can reduce the dominant deficit round (like S2 above) with minimal collateral increases elsewhere.
- Sampling: For a fixed plan (chain and T), only O(K) subset tallies on the chain plus O(|T|) pairwise tallies are needed; use Hoeffding + union bound with m = Î˜((log K + log(1/Î´))/Îµ^2) and a margin â‰¥ 6Ï„ as in prior lemmas.
- Lower bounds: Extend the Î©((log K)/Îµ^2) construction to a family where two-type is suboptimal but few-type is exact, stressing the necessity of searching over steering sets.



=== Prover 2 Output ===

Ideas
- Strengthen and formalize the chain-based two-type certificate (general K), with a clean â€œcleanupâ€ lemma that projects any augmentation realizing the chain into c-first and b-first types without increasing mass.
- Provide a sample-splitting, data-driven certification theorem: identify stable chains from half the sample, estimate only the needed tallies on those chains from the other half, and certify with polynomial sample complexity O((log K + log(1/Î´))/Îµ^2) whenever a verifiable chain-stability condition holds.
- Give a special-case exactness theorem under a monotone-minimality margin. This isolates when the two-type plan is not just sufficient but optimal for its chain.
- Outline a candidate-specific Î©((log K)/Îµ^2) lower bound via Fano by constructing a family indexed by the favorable opponent b that leaves all nonpairwise tallies invariant while flipping only t_c({b,c}).

Formal results

Theorem 1 (Chain-based two-type certificate; general K; rigorous statement).
Fix target c âˆˆ C and a pivot b âˆˆ C\{c}. Let S_1 := C. For j = 1,â€¦,Kâˆ’2, define e_j := argmin_{eâˆˆS_j\{b,c}} t_e(S_j), with the electionâ€™s deterministic tie-breaking, and S_{j+1} := S_j\{e_j}. For Î³ > 0, define
A_b(Î³) := max_{1â‰¤jâ‰¤Kâˆ’2} [t_{e_j}(S_j) âˆ’ t_c(S_j) + Î³]_+,
B_b(Î³) := max_{1â‰¤jâ‰¤Kâˆ’2} [t_{e_j}(S_j) âˆ’ t_b(S_j) + Î³]_+,
D_{b,c}(Î³) := t_b({b,c}) âˆ’ t_c({b,c}) + Î³.
If we add Î± â‰¥ 0 c-first and Î² â‰¥ 0 b-first ballots with Î± â‰¥ A_b(Î³), Î² â‰¥ B_b(Î³), and Î± âˆ’ Î² â‰¥ D_{b,c}(Î³), then the IRV process eliminates e_1,â€¦,e_{Kâˆ’2} in order and elects c over b with strict margins â‰¥ Î³ in every round. Among augmentations restricted to these two types, the minimum mass is
Îµ_spine(b;Î³) = B_b(Î³) + max{A_b(Î³), B_b(Î³) + D_{b,c}(Î³)}.

Proof.
For any S containing c (resp. b), adding Î± c-first (resp. Î² b-first) increases t_c(S) (resp. t_b(S)) by Î± (resp. Î²) and leaves t_x(S) for x âˆ‰ {b,c} unchanged. Hence for each j,
- t'_{e_j}(S_j) = t_{e_j}(S_j), t'_c(S_j) = t_c(S_j)+Î±, t'_b(S_j) = t_b(S_j)+Î².
- The constraints Î± â‰¥ A_b(Î³) and Î² â‰¥ B_b(Î³) imply t'_{e_j}(S_j) â‰¤ min{t'_c(S_j), t'_b(S_j)} âˆ’ Î³, so e_j remains the unique minimum of S_j and is eliminated (strictly) at round j.
- In the final S_{Kâˆ’1} = {b,c}, each c-first ballot contributes +1 to t'_c âˆ’ t'_b and each b-first contributes âˆ’1; Î± âˆ’ Î² â‰¥ D_{b,c}(Î³) enforces t'_c â‰¥ t'_b + Î³.
The feasible region is {(Î±,Î²) âˆˆ R_+^2 : Î± â‰¥ A_b, Î² â‰¥ B_b, Î± âˆ’ Î² â‰¥ D_{b,c}}. Minimizing Î±+Î² yields Î² = B_b and Î± = max{A_b, B_b + D_{b,c}}.

Lemma 2 (Cleanup to two types for a fixed chain).
Let y be any augmentation that realizes the chain e_1,â€¦,e_{Kâˆ’2} and a strict c-over-b final with margin Î³ > 0. Then there exists an augmentation yâ€², supported only on c-first and b-first ballots, with âˆ¥yâ€²âˆ¥_1 â‰¤ âˆ¥yâˆ¥_1 that also realizes the same chain and final margins.

Proof.
Define â„“(r) to be the smallest j such that top_{S_j}(r) = e_j, with â„“(r) = âˆ if no such j exists. Step 1 (delete harmful support): For any r with â„“(r) < âˆ, reduce y(r) to 0 and redistribute that mass to b-first/c-first as below. For round â„“(r), the coefficient of y(r) in each constraint (â„“,a) equals âˆ’1 (since top = e_â„“), so removing y(r) slackens the â„“-th round constraints; earlier rounds j < â„“ are unaffected in the sense that top_{S_j}(r) âˆ‰ {e_j}, so coefficients are nonnegative. Thus deletion cannot break feasibility if we compensate its positive effects elsewhere.
Step 2 (pairwise projection): For any remaining r (so top_{S_j}(r) âˆ‰ {e_j} for all j), define s(r) âˆˆ {b,c} as top_{\{b,c\}}(r). Replace y(r) by the same mass of s(r)-first ballots. For each j,
- If s(r) = c: coefficients in round-j constraints become 1 for a = c and 0 else, which weakly increases LHS relative to r since r never tops e_j.
- If s(r) = b: coefficients become 1 for a = b and 0 else for j â‰¤ Kâˆ’2; at j = Kâˆ’1, coefficients change by âˆ’1 for the (final) constraint, exactly matching the effect of r on the final c vs b margin. Thus, for all rounds, this projection preserves or slackens constraints, while preserving the final margin. Summing over r, we obtain yâ€² with no larger mass and the same or larger left-hand sides in all constraints. Hence yâ€² is feasible and âˆ¥yâ€²âˆ¥_1 â‰¤ âˆ¥yâˆ¥_1.

Corollary 3 (K = 3 exactness and monotone-minimality case).
- When K = 3, Îµ^*(Î³;c) = min_{bâˆˆC\{c}} Îµ_spine(b;Î³) and Îµ^*(c) = lim_{Î³â†’0^+} Îµ^*(Î³;c).
- If, for some chain, there is a uniform gap Î¸ > 0 such that for each j and every x âˆˆ S_j\{b,c,e_j}, t_x(S_j) â‰¥ t_{e_j}(S_j) + Î¸, then e_j remains the unique minimum under any Î±,Î² â‰¥ 0; hence any augmentation realizing this chain can be projected to two types without loss, and Îµ_spine(b;Î³) is the exact minimal mass among augmentations realizing this chain and a c-over-b final.

Sampling with sample-splitting

Theorem 4 (Data-driven chain certification under stability; polynomial sample complexity).
Fix Îµ, Î´, Î³ âˆˆ (0,1). Split m samples into two independent halves of sizes m_1 and m_2.
- Stage I (chain discovery): Using m_1 ballots, for each b âˆˆ C\{c}, compute the empirical chain \hat S_1^b,â€¦,\hat S_{Kâˆ’1}^b, minima \hat e_j^b, and gaps
\hat g_j^b := min_{xâˆˆ\hat S_j^b\{\hat e_j^b}} \hat t_x(\hat S_j^b) âˆ’ \hat t_{\hat e_j^b}(\hat S_j^b).
Let B_stab := {b : min_j \hat g_j^b â‰¥ 4Ï„} for a chosen Ï„ > 0.
- Stage II (cost estimation): Using m_2 new ballots, estimate, for each b âˆˆ B_stab, the tallies \hat t_x(\hat S_j^b) for x âˆˆ {b,c,\hat e_j^b} and the pairwise tallies on {b,c}. Compute
\widehat{A}_b(Î³) := max_j [\hat t_{\hat e_j^b}(\hat S_j^b) âˆ’ \hat t_c(\hat S_j^b) + Î³]_+,
\widehat{B}_b(Î³) := max_j [\hat t_{\hat e_j^b}(\hat S_j^b) âˆ’ \hat t_b(\hat S_j^b) + Î³]_+,
\widehat{D}_{b,c}(Î³) := \hat t_b({b,c}) âˆ’ \hat t_c({b,c}) + Î³,
\widehat{Îµ}_b := \widehat{B}_b + max{\widehat{A}_b, \widehat{B}_b + \widehat{D}_{b,c}}.
Decision: If some b âˆˆ B_stab satisfies \widehat{Îµ}_b â‰¤ Îµ âˆ’ 4Ï„, declare c an Îµ-winner.
Guarantee: There exists a universal constant C such that if
m_1 â‰¥ C (log(K^3/Î´))/Ï„^2 and m_2 â‰¥ C (log(K^3/Î´))/Ï„^2,
then with probability â‰¥ 1 âˆ’ Î´ the following hold simultaneously: (i) for each b âˆˆ B_stab, \hat S_j^b = S_j^b and \hat e_j^b = e_j^b for all j (true chain stability); (ii) sup error â‰¤ Ï„ for all tallies estimated in Stage II; (iii) for each b âˆˆ B_stab, |\widehat{Îµ}_b âˆ’ Îµ_spine(b;Î³)| â‰¤ 6Ï„. Consequently, whenever min_{b} Îµ_spine(b;Î³) â‰¤ Îµ âˆ’ 10Ï„, the decision returns â€œc is an Îµ-winner.â€

Proof.
- Counting: For each b, Stage I computes at most âˆ‘_{j=1}^{Kâˆ’2} |\hat S_j^b| â‰¤ âˆ‘_{j=2}^{K} j = O(K^2) tallies; across all b there are at most O(K^3) such tallies. Hoeffding + union bound (over a data-independent list in Stage II thanks to splitting) gives sup error â‰¤ Ï„ with m_i as claimed.
- Chain stability: If \hat g_j^b â‰¥ 4Ï„ and sup error â‰¤ Ï„, then for each j any x âˆˆ \hat S_j^b\{\hat e_j^b} satisfies t_x(\hat S_j^b) â‰¥ \hat t_x(\hat S_j^b) âˆ’ Ï„ â‰¥ \hat t_{\hat e_j^b}(\hat S_j^b) + 3Ï„ â‰¥ t_{\hat e_j^b}(\hat S_j^b) + 2Ï„; hence \hat e_j^b is the unique true minimum in \hat S_j^b. Inductively, \hat S_j^b = S_j^b and \hat e_j^b = e_j^b for all j.
- Lipschitz: Each of A_b, B_b, D_{b,c} is 2-Lipschitz in the sup norm; Îµ_spine(b;Î³) = B_b + max{A_b, B_b + D} is thus 6-Lipschitz. Hence |\widehat{Îµ}_b âˆ’ Îµ_spine(b;Î³)| â‰¤ 6Ï„. The 4Ï„ safety margin yields correctness.

Remarks.
- This certification succeeds under a verifiable margin condition (min_j \hat g_j^b â‰¥ 4Ï„) for some b and uses only O(K^3) tallies from the second half, avoiding exponential unions.
- If no b passes the stability test, we can abstain or fall back to the distribution-free c-first certificate (with its larger uniform-estimation burden) depending on application needs.

Candidate-specific lower bound sketch (toward Î©((log K)/Îµ^2)).
Construct a family {P_b : b âˆˆ C\{c}} of ranking distributions such that (i) all top-of-S tallies t_x(S) that do not involve the pair {b,c} are identical across b; (ii) t_c({b,c}) = 1/2 + Îµ and t_c({bâ€²,c}) = 1/2 âˆ’ Îµ for all bâ€² â‰  b; (iii) under every P_b, c is the unique Îµ/2-winner (e.g., pick chain margins A_b, B_b constant with B_b + D_{b,c} = const âˆ’ Îµ so Îµ_spine(b;0) â‰¤ Îµ/2, and arrange that every other candidate x â‰  c requires > Îµ to win). Then distinguishing which P_b holds reduces to identifying which pairwise bias is positive. Since a ballot reveals the relative order of every pair, the KL between P_b and P_{bâ€²} on m i.i.d. ballots satisfies KL(P_b^m||P_{bâ€²}^m) = O(m Îµ^2). Fanoâ€™s inequality then yields m â‰¥ c (log(Kâˆ’1))/Îµ^2 samples to identify b with error probability â‰¤ 1/3, implying an Î©((log K)/Îµ^2) lower bound for any algorithm that must (with probability â‰¥ 2/3) certify c as an Îµ/2-winner on this family. Formalizing a concrete {P_b} (e.g., via a Bradleyâ€“Terry or Mallows tilt) with properties (i)â€“(iii) is the next step.

Examples (sanity checks)
- K = 3: With p_a=0.38, p_b=0.35, p_c=0.27, t_c({b,c}) âˆ’ t_b({b,c}) = 0.10, we have A_0=0.11, B_0=0.03, D_0=âˆ’0.10, so Îµ_spine(b;0)=0.14 < M_c=0.20, matching the previously recorded counterexample.
- Chain-stability diagnostic: For K=6 and Ï„=0.01, if all empirical gaps along the pivot b chain exceed 0.05, Stage I/II with m_1=m_2â‰ˆc (log K + log(1/Î´))/Ï„^2 will (with probability â‰¥ 1âˆ’Î´) lock the chain and certify using Îµ_spine(b;Î³) with margin 6Ï„.

Obstacles
- Fixed-order LP sensitivity: A global polynomial bound on sup_{Î»âˆˆÎ›_Ï€} âˆ¥Î»âˆ¥_1 remains open once negative terms at j=pos_Ï€(x) are retained; summing â€œchampion-rankingâ€ constraints cancels and provides no bound. Local (margin-dependent) primal repair seems possible only with restricted ballot types; a general repair that avoids harming other rounds is nontrivial.
- Two-type suboptimality for K â‰¥ 4: We expect instances where â‰¥3 ballot types strictly reduce total mass relative to any pivot-b two-type plan (by steering to a cheaper elimination order), but we do not yet have a fully consistent explicit example. A numerical search over ranking distributions (variables P(r)) with bilevel optimization (outer: minimize gap between two-type and unrestricted LP optima; inner: solve both LPs) is planned.

Next steps
- Add Theorem 1 and Lemma 2 to proofs.md; move the K=3 exact formula as Corollary 3.
- Incorporate Theorem 4 (sample-splitting chain certification) with explicit constants and the O(K^3) tally count argument.
- Construct and verify (via LP) a K=4 instance where optimal support uses â‰¥3 ballot types.
- Formalize the Fano lower bound: instantiate {P_b} via a Bradleyâ€“Terry tilt on the pair {b,c} with all other pairwise parameters equal; confirm uniqueness of c as Îµ-winner and compute KL to conclude Î©((log K)/Îµ^2).
- Hybrid algorithm: compute c-first M_c with a coarse uniform bound; run chain-certificate for all pivots b with sample-splitting; pick the smallest certified Îµ. Prove the combined success condition and sample complexity under data-driven stability.


=== Prover 3 Output ===

Ideas
- Cleanup lemma for the chain certificate: show that, for a fixed pivot b and baseline chain e_1,â€¦,e_{Kâˆ’2}, any augmentation that succeeds along this chain can be transformed (without increasing mass) into one supported only on two types: c-first and b-first. This isolates why the two-type polytope captures the exact optimal cost within the targeted chain.
- Chain-identification under sampling: provide a verifiable gap condition (chain-stability) under which the empirical chain equals the true chain with high probability; combine with sample splitting to yield a polynomial sample-complexity certifier using the chain-based cost Î¦_b.
- Necessary lower bound (round-1 + final) with proof: any augmentation producing a {b,c} final and a strict c-over-b win must pay at least B_b^{(1)} + max{A_b^{(1)}, B_b^{(1)} + D_{b,c}}; this is tight for K = 3 and strengthens intuition.
- Fano-type Î©((log K)/Îµ^2) lower bound sketch: pack Kâˆ’1 distributions indexed by the favorable pivot, differing only in bc pairwise preferences, keeping chain tallies identical. This forces identifying the pivot from m samples.
- Separation template (K â‰¥ 4): design profiles where the best two-type chain certificate (for a fixed pivot) exceeds the true minimal augmentation achieved by a 3-type plan that leverages â€œtop e_1 then câ€ ballots to shift the final while not inflating early-round tallies.

Rigorous statements and proofs

Lemma 1 (Cleanup for a fixed chain).
Fix c and pivot b. Let the baseline chain be S_1 = C and, for j = 1,â€¦,Kâˆ’2, e_j = argmin_{e âˆˆ S_j \ {b,c}} t_e(S_j) (with the electionâ€™s tie-breaking), and S_{j+1} = S_j \ {e_j}. Suppose an added distribution y over rankings achieves: (i) in round j, e_j is eliminated from S_j; (ii) in the final {b,c}, c beats b with slack Î³ > 0. Then there exists another added distribution yâ€² with ||yâ€²||_1 â‰¤ ||y||_1 supported only on rankings that top c or b, and yâ€² also achieves (i)â€“(ii).

Proof.
For each ranking r in the support of y and each j with |S_j| â‰¥ 3, if top_{S_j}(r) âˆ‰ {b,c}, then r contributes nonpositively to both elimination slack constraints at round j: it increases neither t_c(S_j) nor t_b(S_j), while possibly increasing t_{e_j}(S_j) if top_{S_j}(r) = e_j. Removing mass on such r cannot decrease feasibility at round j and (if top_{S_j}(r) = e_j) strictly improves it. For the final {b,c}, the contribution of r to the margin t'_c âˆ’ t'_b equals 1 if r ranks c â‰» b and 0 otherwise; thus any positive contribution can be replicated by a c-first ballot, while any negative contribution (ranks b â‰» c) can be replicated by a b-first ballot. Therefore we can iteratively (i) delete mass that tops any e_j on S_j, which weakly improves all chain-round constraints, and (ii) redirect remaining mass to c-first and b-first ballots to preserve the bc final margin and all round-wise increases of t_c and t_b. This produces yâ€² supported on c-first and b-first with no greater mass and preserving (i)â€“(ii). âˆ

Corollary 2 (Exact two-type optimality on a fixed chain).
For fixed b and chain e_1,â€¦,e_{Kâˆ’2}, the minimal total mass among all augmentations that eliminate exactly e_1,â€¦,e_{Kâˆ’2} in order and then elect c over b with slack Î³ equals
  Îµ_b^{chain}(Î³) = B_b(Î³) + max{A_b(Î³), B_b(Î³) + D_{b,c}(Î³)},
with A_b, B_b, D_{b,c} as defined in the notes. Proof: combine Lemma 1 with the two-variable LP solved previously.

Lemma 3 (Chain-stability under sup-norm errors).
Fix b and chain e_1,â€¦,e_{Kâˆ’2}. Define, for each j,
- m_j := min_{x âˆˆ S_j \ {e_j}} (t_x(S_j) âˆ’ t_{e_j}(S_j)) (strict gap to the next competitor),
- s_j := min{ t_b(S_j) âˆ’ t_{e_j}(S_j), t_c(S_j) âˆ’ t_{e_j}(S_j) } (strict gaps to b and c).
If sup_{a,S} |\hat t_a(S) âˆ’ t_a(S)| â‰¤ Ï„ and min_j m_j â‰¥ 2Ï„ and min_j s_j â‰¥ 2Ï„, then the empirical chain \hat e_j computed from \hat t (with the same tie-breaking) equals e_j for all j.

Proof.
For any y âˆˆ S_j \ {e_j}, t_y(S_j) âˆ’ t_{e_j}(S_j) â‰¥ m_j â‰¥ 2Ï„, whence \hat t_y(S_j) âˆ’ \hat t_{e_j}(S_j) â‰¥ m_j âˆ’ 2Ï„ â‰¥ 0; thus e_j remains (tie-broken) argmin in S_j \ {b,c}. The s_j bound ensures e_j is strictly below b and c in \hat t, so the chain proceeds identically. âˆ

Proposition 4 (Sample-splitting chain certificate).
Fix Îµ, Î´ âˆˆ (0,1). For each c and b â‰  c, run:
- Phase I (chain identification): draw m_1 ballots to estimate tallies on all S along the evolving empirical chain; if min_j \hat m_j â‰¥ 3Ï„_1 and min_j \hat s_j â‰¥ 3Ï„_1, proceed; else abstain on this (c,b).
- Phase II (cost evaluation): draw an independent m_2 ballots; estimate only the tallies in ğ’¯_b = { (t_{e_j}(S_j), t_b(S_j), t_c(S_j))_j and (t_b({b,c}), t_c({b,c})) }. Compute \hat Î¦_b = \hat B_b + max{\hat A_b, \hat B_b + \hat D_{b,c}} and certify (c,b) if \hat Î¦_b â‰¤ Îµ âˆ’ 6Ï„_2.
Choose m_1 â‰¥ c_1 log(2Q/Î´_1)/Ï„_1^2 with Q â‰¤ âˆ‘_j |S_j| = O(K^2), and m_2 â‰¥ c_2 log(2|ğ’¯_b|/Î´_2)/Ï„_2^2 with |ğ’¯_b| = O(K), and allocate Î´ = Î´_1 + K Î´_2. Then with probability at least 1 âˆ’ Î´, every certified (c,b) is correct (c is an Îµ-winner). Minimizing over b adds only a log K factor in m_2.

Proof.
By Hoeffding + union bound, Phase I guarantees sup error â‰¤ Ï„_1 and hence chain stability by Lemma 3; Phase II guarantees sup error â‰¤ Ï„_2 over ğ’¯_b and the 6Ï„_2 plug-in margin (Lipschitz bound) ensures soundness. Union bound over up to K âˆ’ 1 pivots. âˆ

Proposition 5 (Round-1 + final necessary lower bound).
Fix b â‰  c and Î³ â‰¥ 0. Any augmentation y that produces a {b,c} final and a strict c-over-b win with slack Î³ satisfies
  ||y||_1 â‰¥ B_b^{(1)}(Î³) + max{ A_b^{(1)}(Î³), B_b^{(1)}(Î³) + D_{b,c}(Î³) },
where A_b^{(1)}(Î³) = [p_min^{(b,c)} âˆ’ p_c + Î³]_+, B_b^{(1)}(Î³) = [p_min^{(b,c)} âˆ’ p_b + Î³]_+, p_min^{(b,c)} := min_{x âˆˆ C \ {b,c}} p_x, and D_{b,c}(Î³) = t_b({b,c}) âˆ’ t_c({b,c}) + Î³.

Proof.
Let z := p_min^{(b,c)}. In round 1, to ensure some x âˆˆ C \ {b,c} is eliminated while both b and c strictly exceed x by Î³, we need t'_b(C) â‰¥ z + Î³ and t'_c(C) â‰¥ z + Î³. Since t'_b(C) âˆ’ p_b â‰¤ ||y||_1 and t'_c(C) âˆ’ p_c â‰¤ ||y||_1 (mass can increase a candidateâ€™s top-of-C share by at most the added mass), we must have ||y||_1 â‰¥ B_b^{(1)}(Î³) and ||y||_1 â‰¥ A_b^{(1)}(Î³). In the final, t'_c({b,c}) âˆ’ t'_b({b,c}) = (t_c âˆ’ t_b) + âˆ‘_r y(r)(1[câ‰»b] âˆ’ 1[bâ‰»c]) â‰¥ Î³. The contribution per unit mass is at most 1 in absolute value, hence ||y||_1 â‰¥ [D_{b,c}(Î³) âˆ’ (t_c âˆ’ t_b)]_+ = D_{b,c}(Î³). Combining the first-round lower bounds with the final-round requirement yields the stated bound: the total must be â‰¥ B_b^{(1)}(Î³) and â‰¥ A_b^{(1)}(Î³), and the pairwise constraint forces Î± âˆ’ Î² â‰¥ D_{b,c}(Î³), which in L1 translates into an additional max{0, D_{b,c}(Î³) âˆ’ (A_b^{(1)}(Î³) âˆ’ B_b^{(1)}(Î³))} â‰¥ max{0, B_b^{(1)}(Î³) + D_{b,c}(Î³) âˆ’ A_b^{(1)}(Î³)}. Arranging terms gives the expression. Tightness for K = 3 follows from the exact two-type formula. âˆ

Lower bound via Fano (sketch)
Construct a family {P_b: b âˆˆ C \ {c}} with the same chain tallies for all b (so A_b = B_b = 0), but differing only in the pairwise bc margin: D_{b,c} = âˆ’Îµ for the distinguished b (so Î¦_b â‰¤ Îµ) and D_{bâ€²,c} = +3Îµ for all bâ€² â‰  b (so Î¦_{bâ€²} â‰¥ 3Îµ). Realize this by mixing a common base distribution P_0 with, for each b, an Î· = Î˜(Îµ) mass concentrated on ballots that top the baseline e_1 and rank câ‰»b (for P_b) or bâ‰»c (for P_{bâ€²}), keeping all other pairwise and top-of-S tallies unchanged. Then KL(P_b || P_{bâ€²}) = O(Îµ^2) for b â‰  bâ€². Let I be uniform on C \ {c}, draw m ballots from P_I. Any algorithm that, with probability â‰¥ 2/3, outputs a candidate that is an Îµ-winner must identify I (since only the pivot b = I yields c as an Îµ-winner), implying by Fano
  m â‰¥ c Â· (log(K âˆ’ 1)) / Îµ^2.
A full write-up will specify the base P_0 and verify tallies and KL bounds formally.

Separation template for K â‰¥ 4 (three-type beats chain two-type)
- Aim: produce P such that for a fixed pivot b, Î¦_b(P; 0) = B + max{A, B + D} is strictly larger than the true minimal augmentation. Mechanism: arrange large slack in round 1 so that adding y-first ballots (where y = e_1) does not change the first elimination, but these y-first ballotsâ€”with c â‰» bâ€”contribute only to S_j with y âˆ‰ S_j and increase the bc final margin without inflating earlier S_j where no uplift is needed. Combine with modest c-first and b-first mass to satisfy any remaining S_2 deficit and the final margin. By tuning P to have A driven mainly by S_2 while D is also positive, one can strictly reduce Î± compared to using only c-first/b-first. A small linear program over a handful of ranking types suffices to instantiate numeric values; we will produce such a profile in the next round.

Obstacles
- Fixed-order LP sensitivity: bounding sup_{Î»} ||Î»||_1 remains open when accounting correctly for the negative blocks in the dual constraints. A promising direction is margin-dependent bounds: if each round-j loser Ï€(j) has a gap of at least Î·_j to all survivors in S_j, can we prove sup||Î»||_1 â‰¤ poly(K) Â· f({Î·_j})? A carefully chosen set of test rankings, grouped by the identity of top_{S_j}, may permit a telescoping argument that keeps the negative terms under control.
- Chain identification without sample splitting: directly union-bounding over all possible chains costs O(K!) in the worst case; thus a margin-based, data-dependent stability check is preferable.

Next steps
- Produce a concrete K = 4 separation with explicit ranking-support probabilities verifying a strict gap between min_b Î¦_b and the true minimal augmentation (using three types as per the template).
- Formalize the Fano construction: specify P_0 and {P_b}, compute pairwise KL bounds, and finalize the Î©((log K)/Îµ^2) lower bound.
- Add the cleanup lemma, chain-stability lemma, and the sample-splitting certification theorem to proofs.md; summarize in output.md with the safe Lipschitz constant 6 and explicit sample-complexity scalings.
- Explore margin-dependent dual-norm bounds for the fixed-order LP, starting with K = 4 and synthetic profiles where per-round gaps are controlled.



=== Prover 4 Output ===

# Ideas

- Formalize a necessary â€œRoundâ€‘1 + Finalâ€ lower bound L_b(Î³) for any augmentation that yields a {b,c} final with c winning. It cleanly isolates two unavoidable costs and is tight for K=3. It also lower-bounds the chain-based certificate for any pivot b.
- Provide a rigorous, sample-splitting chain-stability theorem with explicit probabilities and O(K^2) tally counting when scanning all pivots b simultaneously.
- Clarify optimality of the two-type chain certificate among augmentations that preserve the baseline order among â€œothersâ€: a precise constraint-preserving cleanup lemma shows two types suffice in that regime.
- Sketch a Fano-style Î©((log K)/Îµ^2) lower bound via â€œpairwise-isolatedâ€ perturbations that only affect t_b({b,c})âˆ’t_c({b,c}) while leaving the relevant chain tallies unchanged.

# Rigorous results and proofs

Notation. C is the candidate set, |C|=K. For any nonempty SâŠ†C and aâˆˆS, t_a(S)=Pr[top among S is a]. Fix target câˆˆC. Ties are broken by a fixed deterministic rule; we enforce strict margins via Î³>0 (then send Î³â†’0^+ for tight statements).

## 1) Necessary lower bound: Roundâ€‘1 + Final

Define first-round shares p_x:=t_x(C). For a fixed pivot bâ‰ c, put p_min^{(b,c)}:=min_{xâˆˆC\{b,c}} p_x and
- A^{(1)}_b(Î³):=[p_min^{(b,c)} âˆ’ p_c + Î³]_+,
- B^{(1)}_b(Î³):=[p_min^{(b,c)} âˆ’ p_b + Î³]_+,
- D_{b,c}(Î³):=t_b({b,c}) âˆ’ t_c({b,c}) + Î³.

Theorem (Roundâ€‘1 + Final lower bound). Consider any nonnegative added measure y on rankings with total mass ||y||_1, such that under the augmented profile IRV yields a {b,c} final and c beats b by â‰¥Î³ in that final. Then
  ||y||_1 â‰¥ L_b(Î³):= B^{(1)}_b(Î³) + max{ A^{(1)}_b(Î³), B^{(1)}_b(Î³) + D_{b,c}(Î³) }.
Moreover, for K=3 this bound is tight (achieved by the twoâ€‘type construction), hence Îµ^*(Î³;c)=min_{bâ‰ c} L_b(Î³) and Îµ^*(c)=lim_{Î³â†’0^+} Îµ^*(Î³;c).

Proof. Partition y into y_c (top_C=c), y_b (top_C=b), and y_rest (top_Câˆ‰{b,c}), with masses Î±, Î², Ï‘ respectively. To avoid eliminating c or b in round 1 we must have p_c+Î± â‰¥ p_min^{(b,c)}+Î³ and p_b+Î² â‰¥ p_min^{(b,c)}+Î³, hence Î± â‰¥ A^{(1)}_b(Î³), Î² â‰¥ B^{(1)}_b(Î³). In the final {b,c}, the net margin update is (t_câˆ’t_b)+ (Î±âˆ’Î²) + (Î¸_câˆ’Î¸_b), where Î¸_c (resp., Î¸_b) is the contribution to the pairwise from y_rest; trivially Î¸_câˆ’Î¸_b âˆˆ [âˆ’Ï‘, Ï‘]. A strict c win by â‰¥Î³ therefore requires Î±âˆ’Î²+Ï‘ â‰¥ D_{b,c}(Î³). Minimizing Î±+Î²+Ï‘ subject to Î± â‰¥ A, Î² â‰¥ B, Î±âˆ’Î²+Ï‘ â‰¥ D is a linear program with optimum B + max{A, B + D}, achieved at Î²=B and either Î±=A, Ï‘=(Dâˆ’(Aâˆ’B))_+ or Î±=B+D, Ï‘=0. Substituting A=A^{(1)}_b(Î³), B=B^{(1)}_b(Î³), D=D_{b,c}(Î³) gives the bound. For K=3 there are no additional round constraints beyond round 1 and the final, and the standard twoâ€‘type construction attains equality.

Corollary (Lower-bounding the chain certificate). For the chain-based twoâ€‘type certificate with the baseline chain e_1,â€¦,e_{Kâˆ’2} (see Â§2 below), A_b(Î³)â‰¥A^{(1)}_b(Î³) and B_b(Î³)â‰¥B^{(1)}_b(Î³) since S_1=C is included. Hence Îµ_b^*(Î³) â‰¥ L_b(Î³).

## 2) Chain-based twoâ€‘type certificate and cleanup under preserved order

Fix c and a pivot bâ‰ c. Let S_1:=C, and for j=1,â€¦,Kâˆ’2 define e_j âˆˆ argmin_{eâˆˆS_j\{b,c}} t_e(S_j) using the electionâ€™s deterministic tieâ€‘breaking; set S_{j+1}:=S_j\{e_j}. Put
- A_b(Î³):=max_{j} [t_{e_j}(S_j) âˆ’ t_c(S_j) + Î³]_+,
- B_b(Î³):=max_{j} [t_{e_j}(S_j) âˆ’ t_b(S_j) + Î³]_+,
- D_{b,c}(Î³):=t_b({b,c}) âˆ’ t_c({b,c}) + Î³.

Theorem (Chain-based twoâ€‘type certificate). For any Î±,Î²â‰¥0 with Î± â‰¥ A_b(Î³), Î² â‰¥ B_b(Î³), and Î±âˆ’Î² â‰¥ D_{b,c}(Î³), adding Î± mass of câ€‘first ballots and Î² mass of bâ€‘first ballots eliminates e_1,â€¦,e_{Kâˆ’2} in order and elects c over b in the final by â‰¥Î³. The minimal twoâ€‘type mass is
  Îµ_b^*(Î³) = B_b(Î³) + max{ A_b(Î³), B_b(Î³) + D_{b,c}(Î³) }.

Proof. As in the notes: for each S_j, only t_c(S_j) and t_b(S_j) increase, by Î± and Î² respectively; e_j remains the unique minimal among S_j\{b,c} since other â€œothersâ€ are unchanged and weakly â‰¥ t_{e_j}(S_j). The stated constraints ensure e_j is strictly below both b and c in S_j and hence eliminated. In the final {b,c}, each câ€‘first ballot contributes +1 to câ€™s tally and each bâ€‘first contributes +1 to bâ€™s, hence Î±âˆ’Î² â‰¥ D_{b,c}(Î³) gives the strict final win. Minimization over Î±,Î² is the same 2â€‘variable polyhedron as in Â§1 and yields Îµ_b^*(Î³).

Cleanup lemma (preserved order among others). Suppose we restrict to augmentations y that preserve the baseline relative order among â€œothersâ€ in every S_j (i.e., for all pairs d,dâ€²âˆˆS_j\{b,c}, sign(t'_d(S_j) âˆ’ t'_{dâ€²}(S_j)) = sign(t_d(S_j) âˆ’ t_{dâ€²}(S_j))). Then among such y the minimum total mass to realize the chain e_1,â€¦,e_{Kâˆ’2} with a strict câ€‘overâ€‘b final is achieved by a twoâ€‘type (câ€‘first,bâ€‘first) augmentation of cost Îµ_b^*(Î³).

Proof. Under the preserved-order restriction, the e_j remain the minimal â€œotherâ€ at each S_j. Any ranking r that tops some e_j on S_j decreases the corresponding câ€‘vsâ€‘e_j and bâ€‘vsâ€‘e_j constraints by 1 and thus cannot be part of an optimal y (it is strictly dominated by replacing its mass with either câ€‘first or bâ€‘first, which increases all roundâ€‘j constraints they touch, and can be balanced to respect the final margin). Therefore an optimal y uses only rankings whose top on all S_j lies in {b,c}, which yields exactly the two types câ€‘first and bâ€‘first; the cost reduces to the 2â€‘variable minimum in the theorem.

Remark. This formalizes and isolates the regime in which two types are indeed optimal (even for Kâ‰¥4). Any potential benefit of a third type must come from changing the order among â€œothersâ€ in some S_j.

## 3) Sampling with chain stability: all pivots simultaneously

Define chain gaps for pivot b: for j=1,â€¦,Kâˆ’2,
  Î¼_{b,j} := min_{xâˆˆS_j\{b,c,e_j}} ( t_x(S_j) âˆ’ t_{e_j}(S_j) ), and Î¼_b := min_j Î¼_{b,j}.
Let Î¼:=min_{bâ‰ c} Î¼_b. Assume Î¼>0.

Theorem (Twoâ€‘stage sampling under chain stability). Fix Îµ,Î´âˆˆ(0,1) and Î³>0. There exist absolute constants c_1,c_2 such that the following holds. Draw m=m_1+m_2 ballots with independent sample splitting:
- Stage 1 (identify all chains). With m_1 â‰¥ c_1 Î¼^{-2} log( (Kâˆ’1)(Kâˆ’2)/ (Î´/2) ), the empirical chains \{\hat e_j^{(b)}\}_{j} equal the true chains \{e_j^{(b)}\}_{j} for all pivots b simultaneously with probability â‰¥1âˆ’Î´/2.
- Stage 2 (estimate tallies on identified chains). Conditional on Stage 1 success, there are at most M:= (Kâˆ’1)(Kâˆ’2) distinct chain sets S_j^{(b)} across all pivots b, plus at most (Kâˆ’1) final pairs {b,c}. If m_2 â‰¥ c_2 Ï„^{-2} log( (M + (Kâˆ’1))/ (Î´/2) ), then with probability â‰¥1âˆ’Î´/2, all needed tallies t_c(S_j^{(b)}), t_b(S_j^{(b)}), t_{e_j^{(b)}}(S_j^{(b)}), and t_c({b,c}), t_b({b,c}) are within Â±Ï„ simultaneously.
- Consequently, with probability â‰¥1âˆ’Î´, for every b we have |\widehat{Îµ}_b^*(Î³) âˆ’ Îµ_b^*(Î³)| â‰¤ L Ï„ with Lâ‰¤6 (supâ€‘norm Lipschitz bound). Declaring c an Îµâ€‘winner if min_{bâ‰ c} \widehat{Îµ}_b^*(Î³) â‰¤ Îµ âˆ’ LÏ„ is sound.

Proof. Stage 1: For each pivot b and step j, a misidentification requires reversing the order between t_{e_j} and the secondâ€‘minimal among S_j\{b,c}, a deviation â‰¥ Î¼_b/2 under supâ€‘norm errors â‰¤ Î¼_b/4; Hoeffdingâ€™s inequality and a union bound over â‰¤(Kâˆ’1)(Kâˆ’2) steps yield the m_1 bound. Stage 2: The total number of distinct sets to be estimated is at most M+(Kâˆ’1)=O(K^2). Apply Hoeffding and a union bound. Lipschitz: As in the notes, Îµ_b^*(Î³)=B_b+max{A_b, B_b+D_{b,c}}, each of A_b,B_b is a max of positive parts of affine functionals in the relevant tallies (l_1 subgradient norms â‰¤ 2), and D has l_1 subgradient norm 2; the worst branch is 2B_b + D (l_1 norm â‰¤ 6). The min over b preserves Lipschitzness with the same constant.

Remarks. When Î¼ is small, Stage 1 may fail frequently; a distributionâ€‘free fallback is the câ€‘first certificate M_c with uniform convergence (exponential in K). For K=3, this theorem collapses to the known m=Î˜((log(1/Î´))/Îµ^2) using five tallies.

## 4) Counting refinement for the câ€‘first certificate

Lemma (indicator count for fixed c). The number of indicator functions râ†¦1[top_S(r)=a] with câˆˆS, aâˆˆS\{c}, |S|â‰¥2 equals N_c=(Kâˆ’1)2^{Kâˆ’2}.

Proof. For each s=|S|â‰¥2, choose the sâˆ’1 companions of c in C(Kâˆ’1,sâˆ’1) ways and choose a among the sâˆ’1 nonâ€‘c elements; summing gives âˆ‘_{s=2}^K C(Kâˆ’1,sâˆ’1)(sâˆ’1)=(Kâˆ’1)2^{Kâˆ’2}.

Therefore, for certifying a fixed c via M_c, a Hoeffding + union bound over N_c indicators yields m=O((log N_c + log(1/Î´))/Ï„^2)=O(((Kâˆ’1)+log(1/Î´))/Ï„^2), with the 2^{Kâˆ’2} entering only inside the logarithm.

# Fano-style Î©((log K)/Îµ^2) lower bound sketch

Goal. Show that any algorithm that, with probability â‰¥3/4, outputs an Îµâ€‘winner must use m=Î©((log K)/Îµ^2) samples in the worst case (beyond the Î©((1/Îµ^2) log(1/Î´)) dependence), by embedding a choice among Kâˆ’1 plausible pivots b.

Construction sketch. Fix c. For each bâˆˆC\{c}, choose a â€œshieldâ€ u_bâˆˆC\{b,c} with high baseline tallies in all S containing u_b, so that u_b is never eliminated before the final {b,c} in the baseline. Introduce an independent small block of voters of total weight Ï (to be tuned) that, for pivot b, split between two rankings R_b^+ and R_b^âˆ’:
- R_b^+: u_b â‰» c â‰» b â‰» (others in any order),
- R_b^âˆ’: u_b â‰» b â‰» c â‰» (others in any order).
These blocks have the property that for any S that contains u_b their top among S is u_b (hence they do not affect any t_x(S) used in the chain constraints), while for S={b,c} they contribute +1 (for R_b^+) or âˆ’1 (for R_b^âˆ’) to t_c({b,c})âˆ’t_b({b,c}). Consider the family of Kâˆ’1 hypotheses H_b indexed by b where we bias the block for b towards R_b^+ by an amount Î¸ (and keep all other blocks unbiased with equal weights on R_{bâ€²}^Â±), so that
  D_{b,c}(0) = âˆ’Î¸  and  D_{bâ€²,c}(0) = 0 for all bâ€²â‰ b.
Calibrate Î¸â‰ˆcÂ·Îµ so that c is an Îµâ€‘winner under H_b (via pivot b) but not under H_{bâ€²} for bâ€²â‰ b (the Roundâ€‘1 + Final lower bound L_b provides the threshold), while the KL divergence between H_b and H_{bâ€²} per sample is O(Î¸^2)=O(Îµ^2) (since they differ only by a Î¸â€‘level perturbation on two rankings within a block of weight Ï=Î˜(1)). Applying Fanoâ€™s inequality over the (Kâˆ’1)â€‘ary family {H_b} shows m=Î©((log K)/Îµ^2) samples are required to identify the correct b (hence to output an Îµâ€‘winner) with probability â‰¥3/4.

Remarks. This construction can be made fully rigorous by specifying baseline tallies that keep u_b dominant in all relevant S (hence shielding the chain tallies from the perturbations) and by choosing Î¸ small enough to preserve all separation margins. The key is that the perturbations are disjoint across b and influence only D_{b,c}, keeping all chain quantities identical across hypotheses.

# Examples and checks

- K=3 tightness. With p_a=0.38, p_b=0.35, p_c=0.27 and t_c({b,c})âˆ’t_b({b,c})=0.10, choosing Î³â†’0 yields A^{(1)}=0.11, B^{(1)}=0.03, D=âˆ’0.10, and L_b(0)=0.03+max{0.11,âˆ’0.07}=0.14, matching the exact minimal augmentation Îµ_a^*.
- Counting of sets for Stage 2. Across all pivots b there are at most (Kâˆ’1)(Kâˆ’2) chain sets S_j^{(b)} (each chain has length Kâˆ’2). Adding the (Kâˆ’1) final pairs gives O(K^2) distinct tallies, enabling a polynomial union bound.

# Obstacles

- Kâ‰¥4 threeâ€‘type separation example. We have not yet produced an explicit profile P where a 3â€‘type augmentation (câ€‘first, bâ€‘first, and one additional opponentâ€‘first) strictly beats the chain twoâ€‘type bound Îµ_b^* while respecting the Roundâ€‘1 + Final lower bound. The challenge is to exploit path changes: altering the order among â€œothersâ€ requires adding mass that tops some â€œotherâ€ in some S_j, which risks increasing the maxima A_b,B_b. A careful construction balancing these effects remains to be found.
- Fixedâ€‘order LP sensitivity. Bounding sup_{Î»âˆˆÎ›} ||Î»||_1 for the exact fixedâ€‘order LP dual remains open; naive arguments fail due to the negative term at j=pos_Ï€(x). A local (marginâ€‘dependent) sensitivity bound or a structured dual design may be necessary.

# Next steps

- Add the Roundâ€‘1 + Final lower bound (with proof) and its K=3 tightness to proofs.md and summarize in output.md.
- Record the cleanup lemma (preserved order) to clarify the exact regime where two types are optimal; mark the general â€œthreeâ€‘type advantageâ€ as an open target and attempt a concrete K=4 construction.
- Formalize the Fano lower bound: fully specify the shielded block family {H_b}, verify separation margins and compute the KL to conclude m=Î©((log K)/Îµ^2).
- Extend the chainâ€‘stability sampling theorem with explicit constants and an implementable dataâ€‘driven gap check (compute empirical gaps and abort to câ€‘first certificate if they fall below a threshold).
- Investigate structural conditions (coherence of â€œothersâ€ ordering across S_j) under which Îµ_b^*(Î³)=L_b(Î³) for some b, yielding nearâ€‘exact certificates beyond K=3.
