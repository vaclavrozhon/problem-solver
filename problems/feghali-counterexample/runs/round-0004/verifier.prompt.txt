=== SYSTEM ===
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md, proofs.md, and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (informal progress & exploratory work so far)
- proofs.md (rigorous proofs & detailed mathematics so far)
- output.md (main results summary so far)

**Three-tier file system guidelines**:
- **notes.md**: Readable running log of exploratory work, intuitions, failed attempts, ideas. Prefer appending. Replace only if old notes are clearly misleading. Should be self-contained.
- **proofs.md**: Complete rigorous mathematical proofs with full details. Contains proven lemmas, theorems, and detailed derivations. Only add mathematically verified content here.
- **output.md**: ONLY the main problem results. Think twice before adding anything. Should contain a concise summary of the most important theorems that directly advance the main problem. Extremely selective.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions.",
  "summary_md": "Concise summary of this round's work for summarizer.",
  "verdict": "promising|uncertain|unlikely",
  "blocking_issues": ["List of issues preventing progress"],
  "per_prover": [{"prover_id": "01", "brief_feedback": "feedback", "score": "promising|uncertain|unlikely"}],
  "notes_update": {"action": "append|replace", "content": "Markdown for notes.md"},
  "proofs_update": {"action": "append|replace", "content": "Markdown for proofs.md"}, 
  "output_update": {"action": "append|replace", "content": "Markdown for output.md"}
}

**Verdict definitions**:
- **promising**: Significant mathematical progress, publishable results, or clear path to solution
- **uncertain**: Some progress but with unresolved issues or incomplete reasoning  
- **unlikely**: No meaningful progress, fundamentally flawed approaches, or just exploratory work

**Update guidelines**:
- Use null for any update field you don't want to modify
- notes_update: Include informal reasoning, failed attempts, intuitions, exploratory work
- proofs_update: Only include complete, rigorous proofs that you have verified
- output_update: Only include main problem results that directly advance toward the solution


=== USER ===
=== Task (txt) ===

Try to find as strong as possible counterexample to the following question: 

Problem 1. A function theoretic problem, with possible applications to digraphs (suggested by Carl Feghali) Statement and Motivation: Consider two functions f and g from a set E into a set F such that f(x) 6= g(x) for every x ∈ E . Suppose that there exists a positive integer n such that for any element z in F either |f −1 (z)| ≤ n or |g −1 (z)| ≤ n. It was shown in [2] that E can be partitioned into 2n + 1 subsets E1, E2, . . . , , E2n+1 such that f(Ei) ∩ g(Ei) = ∅ for each 1 ≤ i ≤ 2n + 1. This result has nice applications in digraphs, and a short proof was later given in [1]. Question: Is it possible to generalise the above to any number of functions? More specifically, consider functions f1, . . . , fk from a set E into a set F such that fi(x) 6= fj (x) for every x ∈ E and 1 ≤ i < j ≤ k. Suppose that there exists a positive integer n such that for any element z in F, there exists an integer t ∈ {1, . . . , k} such that |f −1 t (z)| ≤ n. Is it true that E can be partitioned into 2n + 1 subsets of E1, . . . , E2n+1 such that fp(Ei) ∩ fq(Ei) = ∅ for each 1 ≤ i ≤ 2n + 1 and 1 ≤ p < q ≤ k?

Attached is a simple counterexample, but perhaps there are stronger ones that also apply to natural weaker variants of the question. 


=== Notes ===

# Research Notes



Counterexample families and conflict-graph view

- Conflict graph G: vertices E; edge x–y iff ∃ p≠q with f_p(x)=f_q(y). A valid partition equals a proper coloring; #parts = χ(G).

Permutation-based counterexamples (very strong)
- Template: k functions on E⊆S_k, F=[k], f_i(π)=π(i). For any distinct π,σ∈E there exists s with π^{-1}(s)≠σ^{-1}(s), yielding an edge. Hence G is complete for any E⊆S_k.
- Take E = D_k (derangements) ∪ (for each s∈[k], pick n permutations that fix s and no other point). Then for z=s, choose t=s: f_s^{-1}(s) has size n. Therefore n* = n. G is complete, so χ(G)=|E|=|D_k|+kn. For n=1 this is ≈ k!/e + k.
- Small explicit case k=3, n=1: E = {(1 2 3),(1 3 2)} ∪ {(2 3),(1 3),(1 2)}. Then χ(G)=5 while 2n+1=3.
- Variant (informal): For r≥1, by forbidding r disjoint perfect matchings of cells one can pick a large set E_0(r) with |E_0(r)|≈e^{-r}k!, and still ensure that for each z there are ≥ r indices whose fibres at z have size ≤ n after adding nk more permutations. Completeness persists. Rigor via rook polynomials to be written.

Projective-plane counterexamples (robust under strong fibre constraints)
- For k=q+1 (q a prime power): E = lines, F = points in PG(2,q). Proper k-edge-color the incidence bipartite graph; for i∈[k], define f_i(L) to be the point incident to L via color i. Then for all z and i, |f_i^{-1}(z)|=1. Any two lines meet in one point z and receive distinct colors there, so G is complete on |E|=k^2−k+1. Thus n*=1 yet χ(E)=k^2−k+1 > 2n+1.

Caveat / correction
- A proposed general upper bound m≤k^2−k+1 for n*=1 and complete G is false; permutation-based n*=1 examples give m≈k!/e. The mistaken step was assuming that among vertices containing a given z the indices used at z must be distinct; completeness does not force this at a fixed z.

Takeaways
- The permutation family shows that, even with n*=1, χ can be factorial in k; the projective-plane family shows robustness when all fibres are forced to be size 1 simultaneously.
- Next: formalize the r≥1 variant counts; explore upper bounds under added regularity (e.g., all f_i surjective or balanced fibre sizes).

Further refinements and cautions

- Fixed-transversal optimality (permutation template): Fix a bijection τ:F→[k]. If E⊆S_k satisfies |{π∈E: π(τ(z))=z}|≤n for all z, then |E|≤D_k+kn. Proof idea: split E into those avoiding all k cells (τ(z),z) (exactly D_k many) and those hitting at least one; assign each of the latter to the least z with π(τ(z))=z to get an injection into ⋃_z of n slots, hence ≤kn.

- Many small fibres per z via forbidden matchings: Let B be the union of r permutation matrices; let A be its complement (row/col sums = k−r). Then E_0(r):={π: π avoids B} has size per(A)≥((1−r/k)^k)k! by van der Waerden (normalize A by k−r). With f_i(π)=π(i), for every z there are r indices with fibre 0, G is complete, and χ=|E_0(r)| is factorial.

- Caution: Quantitative bounds for the number of permutations that use a fixed forbidden cell (i,z) and avoid all others were claimed using a uniform-row/column argument; this submatrix is not regular in general. Use Hall’s theorem/rook polynomials/LLL for existence (sufficient for n=1) or omit counts.

- General bipartite template: If B is a k-regular bipartite graph on (E,F) with a proper k-edge-coloring and every two vertices of E have a common neighbor in F, then defining f_i(x) as the neighbor of x in color i yields pointwise distinctness, |f_i^{-1}(z)|=1 for all i,z (n=1), and G complete. Projective planes are a canonical example with |E|=k^2−k+1.

To do: formalize Hall/rook-polynomial arguments for pinned completions (r≥2); explore bounds under surjectivity/balanced-fibre constraints.

Upper bounds under strong regularity; scope cautions

- Bijection regime (all fibres 1): If each f_i is a bijection E→F and G is complete, then |E|=|F|=:m satisfies m≤k^2−k+1. Equality holds for projective planes PG(2,q), giving m=k^2−k+1 with n=1. Thus the plane construction is optimal under maximal regularity.
- Uniform r-to-1 regime: If for all i,z we have |f_i^{-1}(z)|=r (so |E|=r|F|) and G is complete, then |E|≤kr(kr−1)+1 by double counting shared images.
- Many small fibres per z (≥r indices): Using r forbidden permutation matchings and van der Waerden’s bound, one obtains a factorial-sized core E_0(r) with G complete and n=1.

Cautions
- The fixed-transversal upper bound |E|≤D_k+kn is sharp within the permutation template when the k capped cells form a bijection τ:F→[k]; it is not claimed in general when witness indices t(z) repeat rows.
- “Pinned completions” through a prescribed forbidden cell lack a simple uniform degree structure; quantitative bounds must use Hall’s theorem, rook polynomials, or LLL. Existence for n=1 suffices for current purposes.
- In the permutation construction, the surjectivity of each f_i holds as stated when τ=id (after renaming indices); otherwise omit surjectivity.

Next: Prove existence (without counts) for pinned completions via Hall; explore near-tight constructions for r>1 in the uniform-fibres regime; and survey symmetric designs beyond planes for additional k.


=== Current Output ===

# Main Results



Counterexamples to the k-function partition conjecture
- For every k≥3 and every integer n with 1≤n≤D_{k-1}, there exist functions f_1,…,f_k:E→[k] with pointwise distinct outputs and parameter n*=n such that the associated conflict graph is complete with χ(G)=|E|=D_k+kn. In particular, for k=3 and n=1 one gets χ=5>2n+1=3.
- For infinitely many k (k=q+1 with q a prime power), there exist functions with the stronger property |f_i^{-1}(z)|=1 for all z and all i, yet the conflict graph is complete on k^2−k+1 vertices, so χ(G)=k^2−k+1>2·1+1.
These show the proposed bound 2n+1 fails dramatically for k≥3, even when n=1 and under strong fibre-regularity conditions.

Additional main result (many small fibres per value): For any k≥3 and integer r with 1≤r≤k−1, there exist functions f_1,…,f_k:E→[k] with pointwise distinct outputs such that for every z, at least r indices t satisfy |f_t^{-1}(z)|=0 (hence the hypothesis holds with n=1), while the associated conflict graph is complete with χ(G)≥((1−r/k)^k)k!≈e^{−r}k!. Thus even strong variants requiring many small fibres per z admit factorial-size counterexamples at n=1.

Optimality under bijective fibres: If each f_i is a bijection (|f_i^{-1}(z)|=1 for all i,z) and the conflict graph is complete, then |E|≤k^2−k+1. Projective planes PG(2,q) (k=q+1) attain equality with |E|=k^2−k+1 and n=1. Thus the projective-plane family is optimal under maximal regularity.


=== Prover 1 Output ===

Ideas
- Push counterexamples under three increasingly strong hypotheses on fibres: (i) original “∃t per z” with prescribed n; (ii) “≥ r small indices per z” with n=1; (iii) all fibres equal 1 (bijective regime). In all three, force the conflict graph G to be complete, so the required number of parts equals |E|, which we make as large as possible.

Setup and notation
- Conflict graph G on E: x–y an edge iff ∃ p≠q with f_p(x)=f_q(y). Partitions with fp(Ei)∩fq(Ei)=∅ correspond to proper colorings; #parts = χ(G).
- For z∈F let n*(instance) := max_z min_t |f_t^{-1}(z)|.
- Let D_k be the number of derangements in S_k.

Proposition A (Permutation template with prescribed n; complete graph; optimal within a fixed transversal)
Let k≥3, F=[k], fix a bijection τ:F→[k]. Define functions on permutations by f_i(π)=π(i).
Construction:
- E_0 := {π∈S_k : π(τ(z))≠z for all z} has size D_k.
- For each z, let U_z be any set of n permutations with π(τ(z))=z and π(τ(z′))≠z′ for all z′≠z. There are D_{k-1} such permutations per z, so feasible for 1≤n≤D_{k-1}.
- Let E := E_0 ⊔ (⋃_{z∈F} U_z).
Claims:
1) Pointwise distinctness holds (permutations). 2) For each z, |f_{τ(z)}^{-1}(z)|=n, hence n*=n. 3) G is complete for any E⊆S_k: if π≠σ, pick s with π^{-1}(s)≠σ^{-1}(s), then f_{π^{-1}(s)}(π)=s=f_{σ^{-1}(s)}(σ) with different indices. 4) χ(G)=|E|=D_k+kn.
Optimality within fixed τ: If E⊆S_k satisfies |{π∈E: π(τ(z))=z}|≤n for all z, then writing B:=E\E_0, every π∈B hits at least one cell (τ(z),z). Assign each π∈B to the least such z; this is an injection into ⋃_z of n slots. Hence |E|≤D_k+kn. Our construction attains equality.
Consequence (coefficient lower bound): If a universal bound χ(G)≤c(k)·n* held for all instances, applying it here with n*=1 yields c(k)≥χ(G)=D_k+k≈(1/e)k!.

Proposition B (Many small fibres per value; factorial χ at n=1)
Let 1≤r≤k−1. Choose r bijections τ_1,…,τ_r:F→[k]; define the forbidden set of cells B:=⋃_{j=1}^r {(τ_j(z),z): z∈F}, and let A be its 0–1 complement in the k×k grid. Define E_0(r):={π∈S_k: (i,π(i))∈A for all i}. Set f_i(π)=π(i).
Claims:
- For every z, the r indices {τ_j(z)} satisfy |f_{τ_j(z)}^{-1}(z)|=0; thus the hypothesis holds with n=1 and even “≥ r small indices per z”.
- G is complete (as above).
- Lower bound: A has row/column sums s:=k−r. Normalize B:=A/s to be doubly stochastic. By van der Waerden, perm(A)=|E_0(r)|≥ s^k·(k!/k^k)=k!·(1−r/k)^k≈e^{−r}k!.
Hence χ(G)=|E_0(r)| is factorial in k already at n=1, even under the stronger “≥ r small fibres per z”.

Lemma C (Incidence-design template; uniform fibres = 1; complete G)
Let (F,E,ℐ) be a symmetric 2-(v,k,λ) design (v=b, each block size k, each point replicated k times). The incidence bipartite graph is k-regular, so admits a proper k-edge-coloring (Kőnig). For i∈[k], define f_i(x) as the unique point z∈F incident with block x in color i. Then: (i) pointwise distinctness holds on each x; (ii) |f_i^{-1}(z)|=1 for all i,z; (iii) any two blocks meet in λ≥1 points, and the two colors used at a common point are distinct, hence G is complete on |E|=v.
Example: The projective plane PG(2,q) (λ=1, k=q+1) yields n*=1 and χ(G)=v=q^2+q+1=k^2−k+1.

Examples
- k=3, n=1 (A): E={two 3-cycles}∪{three transpositions}; n*=1; G=K_5; χ=5>2n+1.
- k=3 (C): PG(2,2) gives |E|=7 with all fibres 1; G=K_7.
- r=2, general k (B): χ≥k!·(1−2/k)^k≈e^{−2}k! at n=1.

Obstacles and cautions
- “Pinned completions” for r≥2 (choosing permutations with exactly one hit in B at a prescribed cell and none elsewhere) require nontrivial rook-polynomial/LLL arguments; the naive uniform-degree lower bound after deleting a row/column is false. For our purposes, the core E_0(r) already gives factorial χ at n=1 with ≥r small indices per z.
- The upper bound |E|≤D_k+kn is proven and tight only within the fixed-transversal framework (i.e., the capped cells form a bijection τ:F→[k]). It is not claimed in the general “∃t(z)” setting without fixing τ.

Why these are strong
- Proposition A disproves any bound of the form χ≤c(k)·n with subfactorial c(k); indeed c(k)≥D_k+k.
- Proposition B shows even strengthened hypotheses (“many small indices per value”) fail badly: χ can still be ≈e^{−r}k! at n=1.
- Lemma C shows that, under the strongest regularity (all fibres 1), χ is as large as k^2−k+1, which is optimal in that regime (attained by projective planes).

Next steps
- Write a short proof note formalizing: (i) Proposition A (including the fixed-transversal optimality); (ii) Proposition B with the van der Waerden bound and completeness; (iii) Lemma C.
- Explore quantitative pinned-completion bounds for r≥2 via rook polynomials or the lopsided Lovász local lemma to extend Proposition B to prescribed n>1 while retaining factorial χ.
- Investigate upper bounds under added regularity: e.g., all f_i surjective and nearly balanced fibres; quantify maximal χ in that regime (Θ(k^2·n)?).


=== Prover 2 Output ===

Ideas
- We continue pursuing “complete conflict graph” instances, so the minimum number of parts equals |E|. The permutation template f_i(π)=π(i) with E⊆S_k and F=[k] guarantees completeness for any E, reducing the problem to maximizing |E| subject to fibre constraints.
- Two robust directions:
  1) Fixed-transversal control: choose a bijection τ:[k]→[k] and cap each fibre |{π∈E:π(τ(z))=z}| by n. This yields a sharp upper bound |E|≤D_k+kn, with a matching construction. For n=1 this gives |E|≈k!/e, hence χ(G)≈k!/e even at n*=1.
  2) Many-small-fibres per z: forbid r permutation matchings. The allowed matrix A is (k−r)-regular bipartite; van der Waerden gives |E|≥((1−r/k)^k)k!≈e^{−r}k!, with χ(G)=|E| and n=1 (indeed, ≥r indices have fibre 0 at each z). This shows factorial-size counterexamples persist under stronger hypotheses.

Lemma 1 (Completeness under the permutation template)
Let F=[k], E⊆S_k, and f_i(π)=π(i). For π≠σ, pick s with π^{-1}(s)≠σ^{-1}(s); set p=π^{-1}(s), q=σ^{-1}(s). Then f_p(π)=s=f_q(σ), p≠q, so the conflict graph G is complete. Hence the number of parts equals χ(G)=|E|.

Proposition 2 (Sharp fixed-transversal bound; optimality)
Fix a bijection τ:[k]→[k]. Suppose E⊆S_k satisfies C_z:=|{π∈E: π(τ(z))=z}|≤n for all z. Then |E|≤D_k+kn. Equality holds for
E=D_k ∪ ⋃_{z∈[k]} A_z,
where each A_z has n permutations with exactly one fixed point at (τ(z),z). Proof: Split E=A∪B, where A avoids all k cells (τ(z),z) and B hits at least one. Then |A|≤D_k. Also S:=∑_z C_z≤kn, and mapping each π∈B to the least z with π(τ(z))=z gives |B|≤S≤kn. The construction attains equality since |A|=D_k and each π∈B has a unique fixed cell.
Why useful: Within this regime, maximal |E| for given n is D_k+kn. For n=1, χ(G)=|E|=D_k+k≈k!/e.

Corollary 3 (Strong n=1 counterexamples with surjectivity of every f_i)
With τ=id and E as in Proposition 2 for n=1, each f_i is surjective: derangements cover all z≠i at row i, and the single fixed-point permutation covers z=i. By Lemma 1, G is complete, so χ(G)=D_k+k. Thus at n*=1, one needs ≈k!/e parts. Small case: k=3 gives K_5, refuting 2n+1=3.

Theorem 4 (No subfactorial linear bound in k)
If χ(G)≤c(k)·n* held for all instances with k functions, then applying Corollary 3 (where n*=1 and χ(G)=D_k+k) yields c(k)≥D_k+k≈k!/e. In particular, no bound polynomial in k (times n*) is possible.

Proposition 5 (Factorial cores under “≥r small fibres per z” via van der Waerden)
Let σ_1,…,σ_r∈S_k, and forbid the r matchings B=⋃_{j=1}^r{(i,σ_j(i))}. Let A be the allowed 0–1 k×k matrix; A is (k−r)-regular bipartite. The number of permutations avoiding B equals per(A)≥((k−r)/k)^k k!=((1−r/k)^k)k!. Let E_0(r) be this set of permutations and define f_i(π)=π(i). Then G is complete (Lemma 1), and for each z, the r indices t_j:=σ_j^{-1}(z) satisfy |f_{t_j}^{-1}(z)|=0, so the strengthened hypothesis (≥r small fibres per z, with n=1) holds. Conclusion: χ(G)=|E_0(r)|≥((1−r/k)^k)k!≈e^{−r}k!.
Sketch proof: Normalize A by t=k−r to a doubly-stochastic matrix; Egorychev–Falikman (van der Waerden) yields per(A/t)≥k!/k^k, so per(A)≥t^k·k!/k^k.

Lemma 6 (Pinned completion existence in the forbidden-matchings model)
In the setup of Proposition 5, every allowed edge (i,z) lies in a perfect matching. Hence for any (z,j) one can select a permutation π with π(σ_j^{-1}(z))=z and avoiding all other forbidden cells. Proof: A is (k−r)-regular bipartite; by Kőnig’s line-coloring theorem (edge-chromatic index equals degree) it decomposes into k−r edge-disjoint perfect matchings. Thus each edge lies in some perfect matching.
Why useful: Enables adding, for each (z,j), any prescribed number of “pinned” permutations (up to feasibility), while preserving completeness and small fibres where desired.

Design-based bijective regime (optimal quadratic size at n=1)
If each f_i is a bijection E→F, then |E|=|F|=:m. If G is complete, any two x,y∈E share some z∈F at distinct colors, so the bipartite incidence (E,F) has λ=1. Fisher’s inequality and standard design theory give m≤k^2−k+1, with equality for projective planes PG(2,q) where k=q+1. This yields complete G on m=k^2−k+1 with n*=1 and all fibres 1; optimal in this regime.

Examples
- k=3, n=1: E=D_3∪{(12),(13),(23)} has |E|=5, G=K_5.
- k=3, bijective regime: PG(2,2) gives |E|=7, G=K_7, n*=1, each f_i bijection.
- General r: For fixed r and large k, E_0(r) yields χ(G)≥(e^{−r}+o(1))k! with n=1 and ≥r small fibres per z.

Obstacles
- Fixed-transversal upper bound D_k+kn requires a bijection τ over columns; without this, the “avoid all k cells” term need not equal D_k. Our constructions all enforce such a transversal (τ=id), so the bound is both applicable and tight in those instances.
- Quantitative counts for pinned completions beyond existence require more delicate permanent bounds for irregular 0–1 matrices; for our purposes, Lemma 6 (existence) suffices.

Next steps
- Formalize Proposition 2’s proof (fixed-transversal optimality) and Theorem 4 (c(k)≥Θ(k!)) for proofs.md.
- Record Proposition 5 with a precise citation to Egorychev–Falikman and the edge-coloring decomposition justifying Lemma 6.
- Explore upper bounds under added regularity: e.g., if each f_i is surjective (as in Corollary 3), can χ(G) exceed Θ(k^2)? The plane shows Θ(k^2) is achievable with bijective fibres; investigating the maximal growth under surjectivity might isolate a sharp threshold between quadratic and factorial behaviour.



=== Prover 3 Output ===

Ideas
- Keep the conflict-graph view: a valid partition equals a proper coloring; the target 2n+1 bound asks for χ(G)≤2n+1. Strong counterexamples come from constructing complete G with small n.
- Strengthen two regimes:
  (A) Allow zero fibres: force χ to be factorial while preserving n=1 and even “at least r small fibres per z”.
  (B) Forbid zero fibres (all |f_i^{-1}(z)| equal or at least 1): show optimal quadratic ceiling and provide tight constructions (projective planes) with n=1.

New constructions and proofs
Proposition 1 (Factorial-size K_|E| with n=1 and ≥r small fibres per value).
Fix integers k≥3 and r∈{1,…,k−1}, and any n≥1. Let F=[k], E⊆S_k, and define f_i(π)=π(i) for i∈[k]. Choose r disjoint permutation matrices P_1,…,P_r on [k]×[k] (e.g., cyclic shifts). Let B:=P_1∪…∪P_r and A:=J−B (J all-ones). Define E_0(r):={π∈S_k: π avoids B}.
- For every distinct π,σ∈E_0(r), there exists s with π^{-1}(s)≠σ^{-1}(s), hence f_{π^{-1}(s)}(π)=s=f_{σ^{-1}(s)}(σ) with distinct indices, so the conflict graph on E_0(r) is complete.
- For each z∈F and each j∈[r], the unique row t_j(z) with P_j(t_j(z),z)=1 is forbidden in A; hence f_{t_j(z)}^{-1}(z)=∅ on E_0(r). Thus for every z there are ≥r indices with fibre size 0.
- van der Waerden bound: A has constant row/col sum k−r. After scaling A′:=A/(k−r) is doubly-stochastic, so per(A′)≥k!/k^k. Thus |E_0(r)|=per(A)≥(k−r)^k·k!/k^k = (1−r/k)^k k! ≈ e^{−r}k!.
Now, for each z and each j=1,…,r, add any n permutations π with π(t_j(z))=z (there are (k−1)! choices; pick any n). Let E:=E_0(r) ∪ ⋃_{z,j} E_{z,j} where |E_{z,j}|=n and each π∈E_{z,j} satisfies π(t_j(z))=z. Then:
- Completeness persists (adding vertices preserves the previously witnessed conflicts).
- For each z and each j, f_{t_j(z)}^{-1}(z) has size exactly n (E_0(r) contributed 0 on those cells by construction). Hence for every z there are r indices with fibre size exactly n, so the hypothesis holds with n.
- Therefore χ(G)=|E|≥(1−r/k)^k k! + rn k.
This yields factorial-size complete graphs already at n=1 and even under the strengthened requirement “for each z, at least r indices have |f_t^{-1}(z)|≤n”.

Lemma 2 (Bipartite template; all fibres 1, n=1, complete G).
Let H be a k-regular bipartite graph with parts (E,F) that admits a proper k-edge-coloring into perfect matchings M_1,…,M_k. Define f_i(x) as the unique neighbor of x via M_i. If any two distinct x,y∈E have a common neighbor in H, then:
- Distinctness: {f_1(x),…,f_k(x)}=N_H(x) are pairwise distinct.
- Uniform fibres: for all i,z, |f_i^{-1}(z)|=1 (each M_i is perfect), so n=1 and no zero fibres.
- Completeness: if z∈N(x)∩N(y), the incident colors at z are distinct, say p≠q, and f_p(x)=z=f_q(y), so G is complete.
Classical symmetric designs (PG(2,q), more generally PG(d,q)) supply H.

Proposition 3 (Quadratic ceiling in the bijective regime; tightness at planes).
Suppose |E|=|F|=v and each f_i is a bijection (|f_i^{-1}(z)|=1 ∀i,z). If G is complete, then v≤k^2−k+1, with equality iff every pair of x≠y has exactly one common image value (a symmetric 2-(v,k,1) design, i.e., a projective plane).
Proof. Let c_z be the number of preimages x with z among {f_1(x),…,f_k(x)}. Since each color is bijective and values at an x are distinct, c_z=k for all z. Double-count pairs (unordered) of E-vertices sharing some z: LHS = ∑_z C(c_z,2) = v·C(k,2) = v·k(k−1)/2. Completeness implies every pair is counted at least once, giving RHS ≥ C(v,2)=v(v−1)/2. Hence v≤k(k−1)+1. Equality forces each pair to meet at exactly one z; this is a symmetric 2-(v,k,1) design.
Corollary. For k=q+1 (q a prime power), taking lines vs points in PG(2,q) and applying Lemma 2 gives n=1 and χ(G)=v=k^2−k+1, which is best possible under bijectivity.

Extension 4 (Uniform r-to-1 fibres; upper bound).
Assume for some r≥1 that for all i,z we have |f_i^{-1}(z)|=r (so v=|E|=r|F|). If G is complete, then v≤kr(kr−1)+1.
Proof. For each z, the multiset of preimages across colors has size kr and values are all distinct across colors at fixed x, hence c_z=kr. Double-count: ∑_z C(kr,2) = |F|·kr(kr−1)/2 = (v/r)·kr(kr−1)/2 ≥ C(v,2) = v(v−1)/2. Rearranging gives v≤kr(kr−1)+1.
Remark. Cloning the projective-plane construction r-fold attains v=r(k^2−k+1), which respects but does not meet the bound.

Examples
- k=3 (Fano plane): v=7; f_1,f_2,f_3 bijections; n=1; G=K_7; χ=7>3.
- k=3, factorial family at n=1: E={(123),(132)}∪{(23),(13),(12)} gives G=K_5.
- General k, r=2, n=1: Proposition 1 yields χ≥(1−2/k)^k k! + 2k; for k=6 this is ≥ (4/6)^6·720 + 12 ≈ (0.0878)·720 + 12 ≈ 75 + 12 = 87.

Obstacles
- Near-tightness for Extension 4 (r>1) remains open: our r-fold blow-up preserves n=1 completeness but does not saturate the quadratic bound; constructing complete-G instances with uniform r-to-1 fibres approaching v≈kr(kr−1)+1 would be interesting.
- “Pinned completion” counts (choose permutations through a specific cell while avoiding others) are delicate; for our purposes, existence (abundant choices) suffices and was used without quantitative lower bounds beyond (k−1)!.

Next steps
- Record formal proofs of Propositions 1, 3, 4 and Lemma 2 in proofs.md, including the van der Waerden permanent argument.
- Explore constructions with uniform r-to-1 fibres that increase χ beyond r·(k^2−k+1), or prove stronger upper bounds in that regime.
- Catalog symmetric designs beyond projective planes (biplanes, Hadamard-derived) to widen the set of k with n=1, bijective fibres, and complete G; list explicit (k,v).
- For completeness-based lower bounds, analyze when completeness holds in general k-regular bipartite templates (pairwise co-neighborhood property) to systematize constructions.



=== Prover 4 Output ===

Ideas
- Keep using the conflict graph G on E: x–y is an edge iff ∃ p≠q with f_p(x)=f_q(y). A valid partition is a proper coloring; the minimum number of parts equals χ(G). Strongest counterexamples: make G complete and |E| as large as possible under strong fibre constraints.
- Two “extremal regimes” to sharpen: (A) permutation template E⊆S_k with f_i(π)=π(i) (factorial size); (B) bijection regime (each f_i a bijection), where the projective-plane construction is optimal; we formalize a short, general proof and extend to uniform r-to-1 maps.

A general coverage inequality for complete G
Lemma (pair coverage). Let m:=|E|, and for each i∈[k], z∈F put a_i(z):=|f_i^{-1}(z)|. If G is complete, then
\[
 m(m-1)\ \le\ \sum_{z\in F}\Big(\big(\sum_{i=1}^k a_i(z)\big)^2\ -\ \sum_{i=1}^k a_i(z)^2\Big).
\]
Proof. For p\ne q, define R_{p,q}:=\{(x,y): f_p(x)=f_q(y)\}. Then |R_{p,q}|=\sum_z a_p(z)a_q(z). Completeness says every ordered pair (x,y), x\ne y, lies in \bigcup_{p\ne q}R_{p,q}. Hence m(m-1)≤\sum_{p\ne q}|R_{p,q}|. But
\[\sum_{p\ne q}\sum_z a_p(z)a_q(z)=\sum_z \Big(\big(\sum_i a_i(z)\big)^2-\sum_i a_i(z)^2\Big).\]
This gives the claim.
Why useful: it yields tight upper bounds in structured regimes by plugging fibre constraints.

Consequences
1) Bijection regime (all fibres 1). Suppose |E|=|F|=:m and each f_i is a bijection, so a_i(z)=1 for all i,z. Then for every z, (\sum_i a_i(z))^2−\sum_i a_i(z)^2=k^2−k. Summing over m values of z yields
\[m(m-1)\le m\,(k^2-k)\quad\Rightarrow\quad m\le k^2-k+1.\]
Attainment: For k=q+1 (q prime power), PG(2,q) with a k-edge-coloring of its incidence bipartite graph gives m=q^2+q+1=k^2−k+1, |f_i^{-1}(z)|=1 for all i,z, and G complete. Hence the quadratic bound is tight under maximal regularity.

2) Uniform r-to-1 regime (each f_i is r-to-1). Let m:=|E|, s:=|F|, with m=rs and a_i(z)=r for all i,z. For each z, (\sum_i a_i(z))^2−\sum_i a_i(z)^2=(kr)^2−k r^2=r^2 k(k−1). Summing over s=m/r values of z gives
\[m(m-1)\le (m/r)\,r^2 k(k-1)=m\,r\,k(k-1)\quad\Rightarrow\quad m\le r\,k(k-1)+1.\]
Remark. This corrects an earlier (too strong) claim v≤kr(kr−1)+1; the sharp double-counting yields m≤r k(k−1)+1. The case r=1 recovers the bijection bound. Tightness for r>1 remains open; see Obstacles.

Strengthened factorial counterexamples at n=1 with many small fibres
Construction (for every k≥3 and 1≤r≤k−1). Let F=[k]. For each z, forbid the r “cyclic” cells T_z={z,z+1,…,z+r−1} (indices mod k). Let A be the k×k 0–1 matrix with A_{i,z}=1 iff i∉T_z. Let E be the set of permutations π with A_{i,π(i)}=1 for all i, and define f_i(π)=π(i).
- Fibres: For every z and each t∈T_z, f_t^{-1}(z)=∅; thus for each z there are ≥r indices with fibre 0, so the hypothesis holds with n=1 (indeed, strictly stronger).
- Completeness: The permutation-template argument makes G complete on E.
- Size lower bound (van der Waerden). A has constant row/column sums d:=k−r. Normalize B:=A/d; B is doubly-stochastic. Egorychev–Falikman gives per(B)≥k!/k^k, hence
\[|E|=\operatorname{per}(A)=d^k\operatorname{per}(B)\ge (k−r)^k\,\frac{k!}{k^k}=\big(1−\tfrac{r}{k}\big)^k k!\ge e^{−r}(1−o(1))\,k!\ (k\to\infty).\]
Thus χ(G)=|E| is factorial in k already for n=1 and any fixed r≥1, even under the stronger “≥ r small fibres per z” constraint.

Permutation template with fixed transversal: sharp linear bound in n
Let F=[k], f_i(π)=π(i) on E⊆S_k, and fix a bijection τ:F→[k]. Suppose the “witness caps” hold: |{π∈E: π(τ(z))=z}|≤n for all z.
Proposition. |E|≤D_k+kn, with equality for all 1≤n≤D_{k−1}. Moreover G is complete.
Proof. Split E into E_0 (avoid all designated cells C_τ={ (τ(z),z) }) and E_1 (hit at least one). Then |E_0|=D_k, and by assigning every π∈E_1 to the least z with π(τ(z))=z we get |E_1|≤\sum_z n=kn. For tightness, take E_0:=all derangements, and for each z pick n permutations with a unique fixed point at z (at least D_{k−1} many avail.); completeness follows from the permutation argument.
Corollary. For fixed k and small n, χ(G)=D_k+kn≈e^{−1}k! dominates 2n+1 by a factorial margin.

Examples
- k=3, n=1 (permutation template): E={(123),(132)}∪{(23),(13),(12)} gives χ(G)=5>3.
- k=q+1, n=1 (projective plane): χ(G)=k^2−k+1 with |f_i^{-1}(z)|=1 ∀i,z, optimal in the bijection regime.
- k arbitrary, r=1 (forbidden-cells family): |E|≥(1−1/k)^k k!≈e^{−1}k!, with ≥1 zero-fibre index per z and χ(G)=|E|.

Obstacles and corrections
- Uniform r-to-1: The upper bound m≤r k(k−1)+1 is sharp for r=1 but we lack constructions attaining it for r>1. A naive “duplicate-E” blow-up of the projective-plane example fails: pairs coming from the same duplicated vertex are not adjacent (p must equal q to hit the same point), so G is not complete.
- Pinned completions (through a fixed allowed cell in a regular 0–1 matrix) for n>1: existence of one perfect matching through an edge is easy in regular bipartite graphs (edge-color into 1-factors), but guaranteeing ≥n distinct ones uniformly is nontrivial; we avoid unjustified quantitative claims.

Next steps
- Record the coverage inequality and its corollaries (bijection and uniform r-to-1 bounds) in proofs.md, explicitly correcting the earlier r-to-1 bound to m≤r k(k−1)+1.
- Seek near-tight r>1 constructions. One direction: start from a projective plane on (E,F) and fold multiple E-vertices to share images in a way that preserves completeness (e.g., replace each edge-color class by a small gadget that still yields one image per index). Alternatively, search for incidence structures with “two colors per meeting” that could realize r=2.
- Strengthen factorial families: combine the “forbidden r matchings” core with one pinned matching per z (Hall’s theorem guarantees existence) to also meet additional local constraints (e.g., exactly one designated index per z with fibre ≤1), while retaining size ≈e^{−r}k!.
- Small-k classification: for k=3 and n=1, check by search whether χ(G) can exceed 7 (the bijection bound cap) when allowing non-bijective functions; current best is 7 via Fano plane; a full classification would be informative.


=== Papers (text) ===

=== Paper (papers/paper1.txt) ===
\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{microtype}
\usepackage{hyperref}

\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}

\begin{document}

\title{A Sharp Linear Lower Bound in the Multi-Function Partition Problem}
\author{}
\date{}
\maketitle

\begin{abstract}
We consider $k\ge2$ functions $f_1,\dots,f_k:E\to F$ with pointwise distinct outputs and the associated \emph{conflict graph} $G$ on $E$, where $xy$ is an edge iff there exist $p\ne q$ with $f_p(x)=f_q(y)$. Let
\[
n^{*} \;:=\; \max_{z\in F}\ \min_{t\in[k]} |f_t^{-1}(z)|
\]
be the intrinsic fibre parameter. We prove that any general linear upper bound of the form
$\chi(G)\le c(k)\,n^{*}$ (valid for all such instances with $k$ functions) must satisfy $c(k)\ge k$ for every $k\ge2$.
The proof uses a permutation construction with $\chi(G)=k!$ and $n^{*}=(k-1)!$.
\end{abstract}

\section{Setup}
Let $k\ge2$ and $f_1,\dots,f_k:E\to F$ satisfy \emph{pointwise distinctness}:
\[
\forall x\in E,\ \ \text{the values } f_1(x),\dots,f_k(x)\ \text{are pairwise distinct}.
\]
Define the \emph{conflict graph} $G$ on vertex set $E$ by joining distinct $x,y\in E$ whenever
\begin{equation}\label{eq:conflict}
\exists\, p\ne q\in[k]\ \ \text{such that}\ \ f_p(x)=f_q(y).
\end{equation}
A partition $E=\bigsqcup_i E_i$ has the property that $f_p(E_i)\cap f_q(E_i)=\varnothing$ for all $p\ne q$ if and only if each $E_i$ is a stable set in $G$; hence the minimum number of parts equals $\chi(G)$.

We measure the ``size'' of fibres by
\begin{equation}\label{eq:nstar}
n^{*} \;:=\; \max_{z\in F}\ \min_{t\in[k]} |f_t^{-1}(z)|,
\end{equation}
the smallest integer $n$ for which the hypothesis ``$\forall z\ \exists t$ with $|f_t^{-1}(z)|\le n$'' holds.

\section{A permutation construction}
Let $E=S_k$ be the set of all permutations of $[k]=\{1,\dots,k\}$, take $F=[k]$, and define
\begin{equation}\label{eq:perm}
f_i(\pi)\ :=\ \pi(i)\qquad(\pi\in S_k,\ i\in[k]).
\end{equation}
Pointwise distinctness holds since $\{\pi(1),\dots,\pi(k)\}=[k]$ for each $\pi$.

\begin{lemma}\label{lem:complete}
For the instance \eqref{eq:perm}, the conflict graph $G$ is complete on $|E|=k!$ vertices.
\end{lemma}
\begin{proof}
Let $\pi\ne\sigma\in S_k$. Choose a symbol $s\in[k]$ such that $\pi^{-1}(s)\ne\sigma^{-1}(s)$ (some symbol moves position).
Then with $p:=\pi^{-1}(s)$ and $q:=\sigma^{-1}(s)$ we have $p\ne q$ and
\[
f_p(\pi)=\pi(p)=s=\sigma(q)=f_q(\sigma).
\]
By \eqref{eq:conflict}, $\pi$ and $\sigma$ are adjacent. Hence every pair is adjacent and $G$ is complete.
\end{proof}

\begin{lemma}\label{lem:nstar}
For the instance \eqref{eq:perm}, for every $z\in[k]$ and $i\in[k]$ the fibre size $|f_i^{-1}(z)|=(k-1)!$. Consequently $n^*=(k-1)!$.
\end{lemma}
\begin{proof}
Fix $i$ and $z$. The constraint $f_i(\pi)=z$ is $\pi(i)=z$. The remaining $k-1$ positions can be permuted arbitrarily, giving $(k-1)!$ permutations. For fixed $z$, the minimum of $|f_i^{-1}(z)|$ over $i$ is therefore $(k-1)!$, and taking the maximum over $z$ yields $n^{*}=(k-1)!$.
\end{proof}

Combining Lemmas~\ref{lem:complete} and \ref{lem:nstar} we obtain
\begin{equation}\label{eq:ratio}
\chi(G) \ =\ k!\ =\ k\cdot (k-1)!\ =\ k\,n^{*} .
\end{equation}

\section{Main lower bound}
\begin{theorem}[Sharp linear lower bound]\label{thm:ck}
Let $c:\{2,3,\dots\}\to\mathbb{R}_{\ge0}$ be any function with the property that \emph{for every} instance of $k$ functions as above, the associated conflict graph $G$ satisfies
\[
\chi(G)\ \le\ c(k)\,n^{*}.
\]
Then necessarily $c(k)\ge k$ for every $k\ge2$.
\end{theorem}
\begin{proof}
Apply the assumed bound to the permutation instance \eqref{eq:perm}. By \eqref{eq:ratio} we have $\chi(G)=k\,n^{*}$, hence
\[
k\,n^{*} \ =\ \chi(G)\ \le\ c(k)\,n^{*}.
\]
Since $n^{*}>0$, it follows that $c(k)\ge k$.
\end{proof}

\begin{remark}
The proof is purely extremal and shows that the linear coefficient in any universal bound of the form $\chi(G)\le c(k)\,n^{*}$ cannot be smaller than $k$. In particular, no bound independent of $k$ is possible, and any attempt to use a constant $<k$ fails already on the permutation family.
\end{remark}

\bigskip
\noindent\textbf{Acknowledgement.} The permutation construction is folklore in related coloring problems.

\end{document}

