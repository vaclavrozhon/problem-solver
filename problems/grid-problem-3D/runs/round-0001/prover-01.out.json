{
  "content": "# 3D setup and notation\n\n- Vertices: V=[n]^3, write p=(x(p),y(p),z(p)).\n- For distinct u,v, the sign pattern \u03c3(u,v)\u2208{\u22121,0,+1}^3\\{0} is taken up to global \u00b1, yielding 13 types. For a type T fix a representative s(T)=(s_x,s_y,s_z) with J(T)={i: s_i\u22600} and E(T)={x,y,z}\\J(T). Write P(T)={i\u2208J: s_i=+1}, N(T)={i\u2208J: s_i=\u22121}.\n- Edge color c_3(uv) consists of T together with the minima m_i:=min{u_i,v_i} for i\u2208J(T); coordinates in E(T) are unspecified.\n- Define the strict 3D NE-set of p by NE(p):={q\u2208U: q_x>x(p), q_y>y(p), q_z>z(p)}. A point is 3D-eligible if NE(p)\u2260\u2205.\n\n# A master counting lemma for c_3\n\nFix a type T (choose a representative s(T)=(s_x,s_y,s_z) as above) and a minima vector m=(m_i)_{i\u2208J(T)}\u2208[n]^{J(T)}.\nFor t=(t_i)_{i\u2208E(T)}\u2208[n]^{E(T)} define\n- A_t(T,m):={ u\u2208U: u_i=m_i for i\u2208P(T); u_i>m_i for i\u2208N(T); and u_i=t_i for i\u2208E(T) },\n- B_t(T,m):={ v\u2208U: v_i>m_i for i\u2208P(T); v_i=m_i for i\u2208N(T); and v_i=t_i for i\u2208E(T) }.\n\nLemma (Master multiplicity). The number M_U(T,m) of edges in G[U] colored (T,m) equals\n\u03a3_{t\u2208[n]^{E(T)}} |A_t(T,m)|\u00b7|B_t(T,m)|.\n\nProof. For any edge {u,v} of color (T,m), orient it so that s(T) matches the chosen representative: for i\u2208P(T), u_i<v_i and m_i=u_i; for i\u2208N(T), u_i>v_i and m_i=v_i; for i\u2208E(T), u_i=v_i=t_i. Then u\u2208A_t and v\u2208B_t for the unique t, so the pair contributes 1 to |A_t||B_t|. Conversely any such (u,v) produces color (T,m). Because we fixed a representative s(T), no unordered pair is double-counted. \u220e\n\nRemarks.\n- The formula is orientation-invariant: changing s(T) to \u2212s(T) swaps A_t and B_t.\n- This cleanly generalizes the 2D product counts (Facts for types 1 and 2).\n\n# Useful explicit corollaries\n\nBelow, we state three instances we will repeatedly use (notations \u03b1,\u03b2,\u03b3 are integers in [n]).\n\n1) J={x,y,z}, s=(+,+,+) (all three increase):\nM_U(T,m) = 1_{(m_x,m_y,m_z)\u2208U} \u00b7 |NE(m_x,m_y,m_z)|.\nIn particular, the color ((+,+,+),m) is unique iff (m\u2208U) and |NE(m)|=1.\n\n2) J={x,z}, E={y}, s=(+ ,0 ,\u2212) (x increases, z decreases, y equal):\nFor each fixed row y=\u03b2 define\nr_{\u03b2}(\u03b1,\u03b3):= #{(\u03b1,\u03b2,z)\u2208U: z>\u03b3},\n s_{\u03b2}(\u03b1,\u03b3):= #{(x,\u03b2,\u03b3)\u2208U: x>\u03b1}.\nThen\nM_U(T,(\u03b1,\u03b3)) = \u03a3_{\u03b2=1}^n r_{\u03b2}(\u03b1,\u03b3) \u00b7 s_{\u03b2}(\u03b1,\u03b3).\nConsequently, this color is unique iff there is a unique \u03b2 with r_\u03b2(\u03b1,\u03b3)=s_\u03b2(\u03b1,\u03b3)=1 and r_{\u03b2'}(\u03b1,\u03b3)s_{\u03b2'}(\u03b1,\u03b3)=0 for all \u03b2'\u2260\u03b2.\n\n(The same formulas hold for s=(\u2212,0,+) by symmetry, and for the \u201cmonotone\u201d J={x,z}, s=(+ ,0 ,+) one gets \u03a3_\u03b2 1_{(\u03b1,\u03b2,\u03b3)\u2208U}\u00b7 #{(x,\u03b2,z)\u2208U: x>\u03b1, z>\u03b3}.)\n\n3) J={x}, E={y,z} (only x changes):\nFor each (\u03b2,\u03b3) put d_{\u03b2,\u03b3}(\u03b1):=1_{(\u03b1,\u03b2,\u03b3)\u2208U}\u00b7 #{(x,\u03b2,\u03b3)\u2208U: x>\u03b1}.\nThen M_U(T,\u03b1) = \u03a3_{\u03b2,\u03b3} d_{\u03b2,\u03b3}(\u03b1).\nIn particular, if there is a unique line (\u03b2,\u03b3) with a point at x=\u03b1 and exactly one further point to its right, and no other line contributes, then the x-only color with minima \u03b1 is unique.\n\n# Lexicographic maximizers and antichains\n\nOrder triples by (z,y,x) lex: (z,y,x) <_lex (z',y',x') iff z<z' or [z=z' and (y<y' or (y=y' and x<x'))].\n\nLemma (Lex\u2013max antichain). If a\u2208U is lexicographically maximal among 3D-eligible points (NE(a)\u2260\u2205), then NE(q)=\u2205 for every q\u2208NE(a). In particular NE(a) is an antichain under the product order (strict in all three coordinates).\n\nProof. If q\u2208NE(a) had NE(q)\u2260\u2205, then some r\u2208NE(q) satisfies (z(r),y(r),x(r))>_lex (z(q),y(q),x(q))>_lex (z(a),y(a),x(a)), so r is 3D-eligible and lex-bigger than a, contradicting maximality. \u220e\n\nUsefulness: This is the 3D analogue of Lemma 2.1 in the 2D file; it is the structural input behind all \u201cpropagation\u201d steps.\n\n# A nontrivial special case: coordinatewise injective sets\n\nWe prove the theorem for the class of sets U with no repeated x, no repeated y, and no repeated z.\n\nTheorem (Injective projections \u21d2 unique color). If U\u2286[n]^3 satisfies that the three coordinate projections are injective (no two points share x, likewise for y, z), and |U|\u22652, then G[U] contains an edge whose c_3\u2013color is unique in G[U].\n\nProof.\nArrange the points as u_1,\u2026,u_m by increasing x. Consider the sequences y_i:=y(u_i) and z_i:=z(u_i).\n\nCase 1: both (y_i) and (z_i) are strictly increasing. Then the product order is a chain. Take a:=u_{m\u22121}. Its strict NE\u2013set is NE(a)={u_m}, hence by corollary 1 above, the (+++) color with minima m=(x(a),y(a),z(a)) has multiplicity 1. Thus it is unique.\n\nCase 2: otherwise, there exist i<j with either (y_i>y_j and z_i>z_j) or exactly one of these inequalities holds.\n- Subcase 2a: y_i>y_j and z_i>z_j. Then the edge e=u_i u_j is of J={x,y,z}\u2013type with representative s=(+ ,\u2212 ,\u2212) and minima m=(x_i,y_j,z_j). By injectivity in y and z, A_t(T,m)={u_i} and B_t(T,m)={u_j} for the unique t (there is no freedom in E(T), which is empty here), so by the master lemma M_U(T,m)=1. Hence c_3(e) is unique.\n- Subcase 2b: say y_i>y_j but z_i<z_j (the other symmetric). Then e has J={x,y,z} with representative s=(+ ,\u2212 ,+), minima m=(x_i,y_j,z_i). Again, injectivity forces A={u_i} (x=m_x and z=m_z pin u_i), and B={u_j} (y=m_y pins u_j; also x_j>x_i and z_j>z_i), so multiplicity is 1 and c_3(e) is unique.\nIn all possibilities outside Case 1 we obtain a unique color. \u220e\n\nWhy useful: This eliminates a large \u201cgeneric\u201d regime and shows that collisions in colors fundamentally require some coordinate repetitions; any complete 3D proof can focus on handling repetitions (fibers).\n\n# Small examples and sanity checks\n\n- If U is any 3-term chain in product order, the middle\u2013top edge (between the top two) has a unique (+++) color via corollary 1.\n- If U consists of two points with the same y,z but distinct x, the x-only type appears. If there is no other (y',z')\u2013line with a point at the same minimal x and a right neighbor, then that color is unique by corollary 3.\n\n# Obstacles in directly lifting the 2D propagation\n\nA naive lift of the 2D proof would: fix a lex\u2013max 3D-eligible a, let \u03b3=Z_min(a) be the lowest z-level of NE(a), pick a pair b_1,b_2 on that plane satisfying a \u201crow\u2013good\u201d condition in x\u2013y, and then propagate to a lower plane \u03b3'<\u03b3 using J={x,z} cross\u2013types (corollary 2). The 2D argument crucially used that when dropping from row \u03b2 to \u03b2'<\u03b2, every point on \u03b2' lies strictly below b_2 in the second coordinate, guaranteeing comparability and allowing r(\u03b1,\u03b2')=1. In 3D, if we drop in z but not necessarily in y, we do not automatically get y(c_1)<y(b_2); hence we lose comparability and the key inequality r_\u03b2(\u03b1,\u03b3')=1 may fail across all rows \u03b2.\n\nThis is the main technical gap to bridge in a full 3D proof: one must organize NE(a) simultaneously in the y and z directions to recover a \u201cpropagation\u201d condition ensuring that, for a carefully chosen \u03b2, one has r_\u03b2(\u03b1,\u03b3')=1, forcing s_\u03b2(\u03b1,\u03b3')\u22652 under (H), and hence producing two rightward points on z=\u03b3' at the same row \u03b2 (as in 2D). The master counting lemma (corollary 2) is exactly the tool needed once such an organizational lemma is in place.\n\n# Proposed 3D plane\u2013based dichotomy and propagation (to be formalized next)\n\nDefinitions (plane\u2013row/column\u2013good relative to a): Fix a lex\u2013max 3D-eligible a. Let \u03b3:=min{z>a_z: NE(a)[z]\u2260\u2205}. On the plane z=\u03b3, for rows \u03b2>y(a) define S_{\u03b3,\u03b2}:=NE(a)\u2229{z=\u03b3,y=\u03b2} and for columns \u03b1>x(a) define C_{\u03b3,\u03b1}:=NE(a)\u2229{z=\u03b3,x=\u03b1}.\n- a is z\u2013row\u2013good if there exists a row \u03b2 with |S_{\u03b3,\u03b2}|\u22652 and, listing its x\u2013coordinates x_1<\u22ef<x_t, the second\u2013rightmost/rightmost pair b_1=(x_{t\u22121},\u03b2,\u03b3), b_2=(x_t,\u03b2,\u03b3) has the property that every q\u2208NE(a) with z\u2265\u03b3 and y\u2265\u03b2 other than {b_1,b_2} satisfies x(q)<x(b_1).\n- z\u2013column\u2013good is the analogous statement interchanging x and y on z=\u03b3.\n\nPropagation claim (sketch). Assume (H) \u201cno unique color in G[U]\u201d and a lex\u2013max a as above. If a is z\u2013partially\u2013row\u2013good (same as z\u2013row\u2013good but allowing arbitrary points with z<\u03b3), then either (i) NE(a)[z']=\u2205 for all z'<\u03b3 (hence a is fully z\u2013row\u2013good), or (ii) there exists \u03b3'<\u03b3 and a row \u03b2' with a partially z\u2013row\u2013good pair b_1',b_2'\u2282NE(a) on z=\u03b3', y=\u03b2'. The intended proof mirrors Lemma 3.5 in 2D but uses corollary 2 with J={x,z}: after fixing \u03b3' maximal below \u03b3 with NE(a)[\u03b3']\u2260\u2205, one shows, for an appropriately chosen row \u03b2, that r_\u03b2(x(b_1),\u03b3')=1, whence (H) forces s_\u03b2(x(b_1),\u03b3')\u22652, producing two distinct x\u2019s on z=\u03b3' at the fixed \u03b2. A second push with x(b_2) rules out configurations contradictory to the partially\u2013good definition.\n\nWhy this would work: Once a plane\u2013based dichotomy (z\u2013row\u2013good vs z\u2013column\u2013good) is established for a, one can emulate the terminal step in the 2D proof: non-uniqueness of a certain x-only or y-only color on z=\u03b3 creates a new point a' to the right (or upwards) but not above (in z,y), and iterating yields a finite strictly monotone sequence in x (or y), a contradiction.\n\nWhat remains: The key missing ingredient is a clean selection of \u03b2 on z=\u03b3' ensuring r_\u03b2(\u03b1,\u03b3')=1. This likely follows from a refined choice of the starting row on z=\u03b3 (topmost within NE(a)[\u03b3] as in 2D) and a careful use of the antichain property of NE(a) to force y\u2013comparability across the drop in z. Formalizing this selection is the next target.\n\n# Summary of progress\n\n- Introduced and proved a master multiplicity lemma for the 3D color c_3, with three concrete corollaries (J=3 monotone, J={x,z} cross, J={x} only). These generalize and subsume the 2D counting Facts and will be the engine for 3D propagation.\n- Proved that a lex\u2013max 3D-eligible point has an antichain NE\u2013set (exact 3D analogue of the 2D antichain lemma).\n- Proved the main theorem for a large special class: sets U with injective projections on all three coordinates.\n- Identified the core obstacle in lifting the 2D propagation: controlling y when stepping down in z. Proposed a precise plane\u2013based \u201crow/column\u2013good\u201d dichotomy and a propagation claim using the new counting fact for J={x,z}.\n\n# Next steps (actionable)\n\n1) Formalize the selection of the initial partially z\u2013row\u2013good pair on z=\u03b3 (e.g., choose the topmost row \u03b2 with |S_{\u03b3,\u03b2}|\u22652) and show how this forces, on the next lower plane \u03b3', the existence of a row \u03b2 with r_\u03b2(\u03b1,\u03b3')=1 via the antichain structure.\n2) Prove the z\u2013column\u2013good analogue using J={y,z} counting.\n3) Establish the plane\u2013based dichotomy for every lex\u2013max 3D-eligible a (as in Lemma 3.7 for 2D), finishing the 3D step that replaces Lemma 3.6.\n4) Adapt the final \u201cforward iteration\u201d argument to 3D once the dichotomy is in place, using x-only or y-only colors on z=\u03b3 and the cone\u2013maximizer trick from the 2D proof\u2019s last section.\n\nOnce (1)\u2013(3) are settled, the remainder follows the 2D blueprint with the master counting lemma replacing Fact 2, completing the full 3D proof."
}