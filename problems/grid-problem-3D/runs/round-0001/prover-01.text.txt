# 3D setup and notation

- Vertices: V=[n]^3, write p=(x(p),y(p),z(p)).
- For distinct u,v, the sign pattern σ(u,v)∈{−1,0,+1}^3\{0} is taken up to global ±, yielding 13 types. For a type T fix a representative s(T)=(s_x,s_y,s_z) with J(T)={i: s_i≠0} and E(T)={x,y,z}\J(T). Write P(T)={i∈J: s_i=+1}, N(T)={i∈J: s_i=−1}.
- Edge color c_3(uv) consists of T together with the minima m_i:=min{u_i,v_i} for i∈J(T); coordinates in E(T) are unspecified.
- Define the strict 3D NE-set of p by NE(p):={q∈U: q_x>x(p), q_y>y(p), q_z>z(p)}. A point is 3D-eligible if NE(p)≠∅.

# A master counting lemma for c_3

Fix a type T (choose a representative s(T)=(s_x,s_y,s_z) as above) and a minima vector m=(m_i)_{i∈J(T)}∈[n]^{J(T)}.
For t=(t_i)_{i∈E(T)}∈[n]^{E(T)} define
- A_t(T,m):={ u∈U: u_i=m_i for i∈P(T); u_i>m_i for i∈N(T); and u_i=t_i for i∈E(T) },
- B_t(T,m):={ v∈U: v_i>m_i for i∈P(T); v_i=m_i for i∈N(T); and v_i=t_i for i∈E(T) }.

Lemma (Master multiplicity). The number M_U(T,m) of edges in G[U] colored (T,m) equals
Σ_{t∈[n]^{E(T)}} |A_t(T,m)|·|B_t(T,m)|.

Proof. For any edge {u,v} of color (T,m), orient it so that s(T) matches the chosen representative: for i∈P(T), u_i<v_i and m_i=u_i; for i∈N(T), u_i>v_i and m_i=v_i; for i∈E(T), u_i=v_i=t_i. Then u∈A_t and v∈B_t for the unique t, so the pair contributes 1 to |A_t||B_t|. Conversely any such (u,v) produces color (T,m). Because we fixed a representative s(T), no unordered pair is double-counted. ∎

Remarks.
- The formula is orientation-invariant: changing s(T) to −s(T) swaps A_t and B_t.
- This cleanly generalizes the 2D product counts (Facts for types 1 and 2).

# Useful explicit corollaries

Below, we state three instances we will repeatedly use (notations α,β,γ are integers in [n]).

1) J={x,y,z}, s=(+,+,+) (all three increase):
M_U(T,m) = 1_{(m_x,m_y,m_z)∈U} · |NE(m_x,m_y,m_z)|.
In particular, the color ((+,+,+),m) is unique iff (m∈U) and |NE(m)|=1.

2) J={x,z}, E={y}, s=(+ ,0 ,−) (x increases, z decreases, y equal):
For each fixed row y=β define
r_{β}(α,γ):= #{(α,β,z)∈U: z>γ},
 s_{β}(α,γ):= #{(x,β,γ)∈U: x>α}.
Then
M_U(T,(α,γ)) = Σ_{β=1}^n r_{β}(α,γ) · s_{β}(α,γ).
Consequently, this color is unique iff there is a unique β with r_β(α,γ)=s_β(α,γ)=1 and r_{β'}(α,γ)s_{β'}(α,γ)=0 for all β'≠β.

(The same formulas hold for s=(−,0,+) by symmetry, and for the “monotone” J={x,z}, s=(+ ,0 ,+) one gets Σ_β 1_{(α,β,γ)∈U}· #{(x,β,z)∈U: x>α, z>γ}.)

3) J={x}, E={y,z} (only x changes):
For each (β,γ) put d_{β,γ}(α):=1_{(α,β,γ)∈U}· #{(x,β,γ)∈U: x>α}.
Then M_U(T,α) = Σ_{β,γ} d_{β,γ}(α).
In particular, if there is a unique line (β,γ) with a point at x=α and exactly one further point to its right, and no other line contributes, then the x-only color with minima α is unique.

# Lexicographic maximizers and antichains

Order triples by (z,y,x) lex: (z,y,x) <_lex (z',y',x') iff z<z' or [z=z' and (y<y' or (y=y' and x<x'))].

Lemma (Lex–max antichain). If a∈U is lexicographically maximal among 3D-eligible points (NE(a)≠∅), then NE(q)=∅ for every q∈NE(a). In particular NE(a) is an antichain under the product order (strict in all three coordinates).

Proof. If q∈NE(a) had NE(q)≠∅, then some r∈NE(q) satisfies (z(r),y(r),x(r))>_lex (z(q),y(q),x(q))>_lex (z(a),y(a),x(a)), so r is 3D-eligible and lex-bigger than a, contradicting maximality. ∎

Usefulness: This is the 3D analogue of Lemma 2.1 in the 2D file; it is the structural input behind all “propagation” steps.

# A nontrivial special case: coordinatewise injective sets

We prove the theorem for the class of sets U with no repeated x, no repeated y, and no repeated z.

Theorem (Injective projections ⇒ unique color). If U⊆[n]^3 satisfies that the three coordinate projections are injective (no two points share x, likewise for y, z), and |U|≥2, then G[U] contains an edge whose c_3–color is unique in G[U].

Proof.
Arrange the points as u_1,…,u_m by increasing x. Consider the sequences y_i:=y(u_i) and z_i:=z(u_i).

Case 1: both (y_i) and (z_i) are strictly increasing. Then the product order is a chain. Take a:=u_{m−1}. Its strict NE–set is NE(a)={u_m}, hence by corollary 1 above, the (+++) color with minima m=(x(a),y(a),z(a)) has multiplicity 1. Thus it is unique.

Case 2: otherwise, there exist i<j with either (y_i>y_j and z_i>z_j) or exactly one of these inequalities holds.
- Subcase 2a: y_i>y_j and z_i>z_j. Then the edge e=u_i u_j is of J={x,y,z}–type with representative s=(+ ,− ,−) and minima m=(x_i,y_j,z_j). By injectivity in y and z, A_t(T,m)={u_i} and B_t(T,m)={u_j} for the unique t (there is no freedom in E(T), which is empty here), so by the master lemma M_U(T,m)=1. Hence c_3(e) is unique.
- Subcase 2b: say y_i>y_j but z_i<z_j (the other symmetric). Then e has J={x,y,z} with representative s=(+ ,− ,+), minima m=(x_i,y_j,z_i). Again, injectivity forces A={u_i} (x=m_x and z=m_z pin u_i), and B={u_j} (y=m_y pins u_j; also x_j>x_i and z_j>z_i), so multiplicity is 1 and c_3(e) is unique.
In all possibilities outside Case 1 we obtain a unique color. ∎

Why useful: This eliminates a large “generic” regime and shows that collisions in colors fundamentally require some coordinate repetitions; any complete 3D proof can focus on handling repetitions (fibers).

# Small examples and sanity checks

- If U is any 3-term chain in product order, the middle–top edge (between the top two) has a unique (+++) color via corollary 1.
- If U consists of two points with the same y,z but distinct x, the x-only type appears. If there is no other (y',z')–line with a point at the same minimal x and a right neighbor, then that color is unique by corollary 3.

# Obstacles in directly lifting the 2D propagation

A naive lift of the 2D proof would: fix a lex–max 3D-eligible a, let γ=Z_min(a) be the lowest z-level of NE(a), pick a pair b_1,b_2 on that plane satisfying a “row–good” condition in x–y, and then propagate to a lower plane γ'<γ using J={x,z} cross–types (corollary 2). The 2D argument crucially used that when dropping from row β to β'<β, every point on β' lies strictly below b_2 in the second coordinate, guaranteeing comparability and allowing r(α,β')=1. In 3D, if we drop in z but not necessarily in y, we do not automatically get y(c_1)<y(b_2); hence we lose comparability and the key inequality r_β(α,γ')=1 may fail across all rows β.

This is the main technical gap to bridge in a full 3D proof: one must organize NE(a) simultaneously in the y and z directions to recover a “propagation” condition ensuring that, for a carefully chosen β, one has r_β(α,γ')=1, forcing s_β(α,γ')≥2 under (H), and hence producing two rightward points on z=γ' at the same row β (as in 2D). The master counting lemma (corollary 2) is exactly the tool needed once such an organizational lemma is in place.

# Proposed 3D plane–based dichotomy and propagation (to be formalized next)

Definitions (plane–row/column–good relative to a): Fix a lex–max 3D-eligible a. Let γ:=min{z>a_z: NE(a)[z]≠∅}. On the plane z=γ, for rows β>y(a) define S_{γ,β}:=NE(a)∩{z=γ,y=β} and for columns α>x(a) define C_{γ,α}:=NE(a)∩{z=γ,x=α}.
- a is z–row–good if there exists a row β with |S_{γ,β}|≥2 and, listing its x–coordinates x_1<⋯<x_t, the second–rightmost/rightmost pair b_1=(x_{t−1},β,γ), b_2=(x_t,β,γ) has the property that every q∈NE(a) with z≥γ and y≥β other than {b_1,b_2} satisfies x(q)<x(b_1).
- z–column–good is the analogous statement interchanging x and y on z=γ.

Propagation claim (sketch). Assume (H) “no unique color in G[U]” and a lex–max a as above. If a is z–partially–row–good (same as z–row–good but allowing arbitrary points with z<γ), then either (i) NE(a)[z']=∅ for all z'<γ (hence a is fully z–row–good), or (ii) there exists γ'<γ and a row β' with a partially z–row–good pair b_1',b_2'⊂NE(a) on z=γ', y=β'. The intended proof mirrors Lemma 3.5 in 2D but uses corollary 2 with J={x,z}: after fixing γ' maximal below γ with NE(a)[γ']≠∅, one shows, for an appropriately chosen row β, that r_β(x(b_1),γ')=1, whence (H) forces s_β(x(b_1),γ')≥2, producing two distinct x’s on z=γ' at the fixed β. A second push with x(b_2) rules out configurations contradictory to the partially–good definition.

Why this would work: Once a plane–based dichotomy (z–row–good vs z–column–good) is established for a, one can emulate the terminal step in the 2D proof: non-uniqueness of a certain x-only or y-only color on z=γ creates a new point a' to the right (or upwards) but not above (in z,y), and iterating yields a finite strictly monotone sequence in x (or y), a contradiction.

What remains: The key missing ingredient is a clean selection of β on z=γ' ensuring r_β(α,γ')=1. This likely follows from a refined choice of the starting row on z=γ (topmost within NE(a)[γ] as in 2D) and a careful use of the antichain property of NE(a) to force y–comparability across the drop in z. Formalizing this selection is the next target.

# Summary of progress

- Introduced and proved a master multiplicity lemma for the 3D color c_3, with three concrete corollaries (J=3 monotone, J={x,z} cross, J={x} only). These generalize and subsume the 2D counting Facts and will be the engine for 3D propagation.
- Proved that a lex–max 3D-eligible point has an antichain NE–set (exact 3D analogue of the 2D antichain lemma).
- Proved the main theorem for a large special class: sets U with injective projections on all three coordinates.
- Identified the core obstacle in lifting the 2D propagation: controlling y when stepping down in z. Proposed a precise plane–based “row/column–good” dichotomy and a propagation claim using the new counting fact for J={x,z}.

# Next steps (actionable)

1) Formalize the selection of the initial partially z–row–good pair on z=γ (e.g., choose the topmost row β with |S_{γ,β}|≥2) and show how this forces, on the next lower plane γ', the existence of a row β with r_β(α,γ')=1 via the antichain structure.
2) Prove the z–column–good analogue using J={y,z} counting.
3) Establish the plane–based dichotomy for every lex–max 3D-eligible a (as in Lemma 3.7 for 2D), finishing the 3D step that replaces Lemma 3.6.
4) Adapt the final “forward iteration” argument to 3D once the dichotomy is in place, using x-only or y-only colors on z=γ and the cone–maximizer trick from the 2D proof’s last section.

Once (1)–(3) are settled, the remainder follows the 2D blueprint with the master counting lemma replacing Fact 2, completing the full 3D proof.