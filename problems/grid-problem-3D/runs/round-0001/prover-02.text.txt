# Ideas

- Lift the d=2 machinery to d=3 by working with the strict orthant order “all three coordinates increase.” Generalize the counting “multiplicity = product” for types that mix increasing/decreasing coordinates, and obtain a clean formula that will be a workhorse for forcing the existence of multiple witnesses on a lower z–level.
- Decouple the in–plane (fixed z) combinatorics from the cross–plane (varying z) propagation. Inside a fixed z–plane we can choose a 2D partially row–good pair without appealing to (H); then use a 3D type with one negative (on z) to push to the next lower z–plane by the product multiplicity.
- Record precisely the 3D multiplicity identities (generalizing Facts 2.1–2.2) so the verifier can use them as black boxes in later steps.
- Identify a concrete obstacle: vertical duplicates (same (x,y) occurring at multiple z’s) can break naive iteration, so a selection rule (or an axis–switch) will be needed later.

# Notation and basic 3D facts

- For p=(x,y,z)∈U, define the strict octant
  NE₃(p):={q=(x′,y′,z′)∈U: x′>x, y′>y, z′>z}.
  Write p≺₃q iff q∈NE₃(p).
- A point is eligible if NE₃(p)≠∅.
- Types in d=3: For an edge e=uv, the sign pattern σ(uv)∈{−1,0,+1}³\{(0,0,0)} is taken up to global sign, yielding a type T. Let E(T) be the zero coordinates and J(T)={x,y,z}\E(T) the nonzero coordinates. For i∈J(T), the color records m_i:=min{u_i,v_i}; i∈E(T) is unspecified. Thus c₃(e)=(T,(m_i)_{i∈J(T)}).

- For S⊆{x,y,z} and a tuple t∈[n]^S, denote the fibre
  U[S=t]:= {u∈U: u_i=t_i for all i∈S}.
  For inequalities, e.g. u_P=m_P and u_M>m_M, interpret componentwise on the specified index set.

## Multiplicity formulas (general form)

Let a type T be specified by a partition of indices into P(T)= indices with +, M(T)= indices with −, and E(T)= indices with 0 (up to global sign; we fix the orientation where P(T) are the “increasing” coordinates). For each color parameter m∈[n]^{J(T)}, define for w∈[n]^{E(T)} the sliced sets
- U⁺(w):= {u∈U: u_P=m_P, u_E=w, and u_M>m_M},
- U⁻(w):= {v∈U: v_M=m_M, v_E=w, and v_P>m_P}.

Proposition (Multiplicity for any T). The number of edges in G[U] with color (T,m) equals
  N_T(m)=∑_{w∈[n]^{E(T)}} |U⁺(w)|·|U⁻(w)|.
In particular, when E(T)=∅ (all three coordinates change), this reduces to
  N_T(m) = |{u∈U: u_P=m_P, u_M>m_M}| · |{v∈U: v_M=m_M, v_P>m_P}|.

Proof. Each edge of type T and minima m decomposes uniquely (given our fixed orientation of P/M) as an ordered pair (u,v) with u attains the minima on P and v attains the minima on M, the E–coordinates equal between the endpoints; conversely every such ordered pair produces one undirected edge of that color. Summing over the common E–coordinates yields the claim.

Two useful specializations:
- All–plus (+++): P={x,y,z}, M=∅, E=∅. Then for m=(α,β,γ),
  N_{+++}(α,β,γ) = 1_{(α,β,γ)∈U} · |NE₃(α,β,γ)|.
  Hence (α,β,γ) is unique iff (α,β,γ)∈U and |NE₃(α,β,γ)|=1.
- One minus (++−): P={x,y}, M={z}, E=∅. For m=(α,β,γ),
  N_{++−}(α,β,γ) = r_z(α,β;γ) · s_{xy}(α,β;γ),
  where r_z(α,β;γ):= |{(α,β,z)∈U: z>γ}| and s_{xy}(α,β;γ):= |{(x,y,γ)∈U: x>α, y>β}|.
  Uniqueness iff r_z=s_{xy}=1.

Remark. The six types with |J(T)|=2 (one zero) admit the summed form
  N_T(m)=∑_{w∈[n]^{E(T)}} |U⁺(w)|·|U⁻(w)|,
which will be used later when needed.

## Lexicographic maximizer and antichain property

Order triples by (z,y,x) lex: (z,y,x)≤_lex(z′,y′,x′) iff z<z′, or z=z′ and y<y′, or z=z′, y=y′ and x≤x′.

Lemma (3D lex–max antichain). Let a∈U be lexicographically maximal among eligible points (i.e., NE₃(a)≠∅ and (z(a),y(a),x(a)) is lex–max subject to eligibility). Then NE₃(q)=∅ for every q∈NE₃(a). Equivalently, NE₃(a) is an antichain for ≺₃.

Proof. If q∈NE₃(a) had NE₃(q)≠∅ then there exists r with r≻₃q, hence (z(r),y(r),x(r))>(z(q),y(q),x(q))≥(z(a),y(a),x(a)), contradicting the lex maximality of a.

Consequences: (i) Under (H), |NE₃(a)|≥2 (else the (+++) color at (x(a),y(a),z(a)) would be unique). (ii) No element of NE₃(a) can be ≺₃–comparable to another.

# In–plane structure and a cross–plane propagation lemma

For a fixed level δ, write NE₃(a)[z=δ]:= {q∈NE₃(a): z(q)=δ}. Inside this plane treat x,y as in d=2.

Definition (In–plane partially row–good at level δ). A pair b₁,b₂∈NE₃(a)[z=δ] on the same row y=β with x(b₁)<x(b₂) is partially row–good in the plane if:
- (PR1₂D) within z=δ, b₁,b₂ are the last two points on row β (second–rightmost/rightmost in x);
- (PR2₂D) within z=δ, every other point q with y(q)≥β satisfies x(q)<x(b₁).
This is exactly Definition 2.6 applied to the 2D set NE₃(a)[z=δ], ignoring z.

Observation (existence of a starting in–plane pair). If NE₃(a)[z=δ] contains at least two points, then there exists an in–plane partially row–good pair: take the topmost row β in that plane that has at least two points, and pick the two rightmost on that row; (PR1₂D),(PR2₂D) hold by construction inside the plane.

Lemma (Cross–plane propagation via (++−)). Assume (H), let a be lex–max eligible, and let δ be a z–level with NE₃(a)[z=δ]≠∅. If there is a lower z–level
  γ:= max{z′<δ: NE₃(a)[z=z′]≠∅},
then for any in–plane partially row–good pair b₁,b₂∈NE₃(a)[z=δ] on row β with x(b₁)<x(b₂), there exist two points c₁,c₂∈NE₃(a)[z=γ] with
  x(c_i)>x(b₁) and y(c_i)>y(b₁), i=1,2.

Proof. Consider the (++−) color with parameters (α,β,γ)=(x(b₁),y(b₁),γ). By the multiplicity formula,
  N_{++−}(α,β,γ)= r_z(α,β;γ)· s_{xy}(α,β;γ).
Because γ is the immediate lower level below δ supporting NE₃(a), there are no points with z∈(γ,δ) in NE₃(a); on level z=δ, the fibre {(x,y)=(α,β)} contains exactly b₁; there is no level above δ in NE₃(a). Hence r_z(α,β;γ)=1. Under (H) the color cannot be unique, so s_{xy}(α,β;γ)≥2, i.e., there are at least two points on z=γ with x>α and y>β. These are c₁,c₂.

Remark (why no extra in–plane hypothesis is needed). The argument uses only: (i) δ is a top level above γ within NE₃(a), and (ii) the (++−) identity. No further in–plane exclusions are needed to certify r_z=1.

# Example illustrating an obstacle for naive iteration

Even with the propagation lemma, an attempt to iterate plane–by–plane may fail if vertical duplicates occur (same (x,y) at multiple z). For instance, take U consisting of the three points
  p₁=(2,2,4), p₂=(3,3,3), p₃=(2,2,2).
For a=(1,1,1), NE₃(a)={p₁,p₂,p₃}. The top plane is z=4 with a single point p₁, so we would start instead at z=3 with only p₂. Moving down to z=2 gives p₃ but note that (x,y)=(2,2) occurs at two z–levels (4 and 2). If at some step we select b₁′ with (α′,β′)=(2,2) on z=2 and attempt to push to γ=… there can be r_z(α′,β′;γ)≥2 (witnessed by p₁ and b₁′), allowing s_{xy} to drop to 1 without violating (H). This shows that a blind “always take the rightmost two” can stall. A refined selection (avoid columns that recur above) or an axis–switch is likely needed.

# Next steps toward a full 3D proof

- Axis–choice and dichotomy. In d=2 we proved a dichotomy (row–good or column–good) for a lex–max eligible point. In d=3 a plausible analogue is: for lex–max eligible a, at least one of the three coordinates admits a “plane–good” structure from which one can propagate strictly in that coordinate (using a one–minus type) until the lowest such plane. Formalize a 3–way dichotomy with in–plane partially good pairs on the top supporting plane for that coordinate.
- Selection rule to defeat vertical duplicates. Augment the in–plane selection to avoid picking b₁ whose (x(b₁),y(b₁)) appears at a higher plane. Under a mild combinatorial lemma (to be proved), either there are at least two “vertically unique” choices on the plane, or one can force a (+++) unique color earlier.
- Local cone–maximality. The 2D “cone–maximal implies local antichain” (used to apply dichotomy locally) has a verbatim 3D analogue. This should let us apply the dichotomy not only at the global lex–max a, but also at intermediate points produced by a horizontal/vertical/z–propagation, enabling the final “rightward–and–downward” termination as in d=2.
- No–eligible case in 3D. Generalize Lemma 6.5 (no eligible ⇒ unique color) by considering minimal supporting planes in each coordinate and applying the summed multiplicity for |J|=1,2 types. The 2D logic (“a duplicate at a higher level creates an NE–witness”) extends with the third coordinate checked.

# Rigorous statements ready to be integrated

1) Proposition (Multiplicity for any type T). With P(T),M(T),E(T) and m as above,
   N_T(m)=∑_{w∈[n]^{E(T)}} |{u∈U: u_P=m_P, u_E=w, u_M>m_M}| · |{v∈U: v_M=m_M, v_E=w, v_P>m_P}|.
   In particular for (+++) and (++−) we get the simplified formulas (all–plus; one–minus product).

2) Lemma (3D lex–max antichain). For a lex–max eligible a (w.r.t. (z,y,x) lex), NE₃(q)=∅ for all q∈NE₃(a).

3) In–plane starting pair. If a z–plane δ supports at least two points of NE₃(a), there exists an in–plane partially row–good pair b₁,b₂∈NE₃(a)[z=δ] (2D Definition (PR1),(PR2) applied inside the plane).

4) Lemma (Cross–plane propagation via (++−)). Under (H), if δ is a z–level with NE₃(a)[δ]≠∅ and γ<δ is the highest lower z–level supporting NE₃(a), then for any in–plane partially row–good pair b₁,b₂ on δ there exist c₁,c₂ on γ with x(c_i)>x(b₁), y(c_i)>y(b₁).

These items are independent, checkable steps. Items (1) and (4) give the key “product forcing” across z–levels; item (2) is the standard cone–maximality tool; item (3) furnishes a canonical starting pair inside a plane.

# Why useful here

- (1) supplies the exact multiplicity identities to invoke (H) quantitatively.
- (2) is the 3D analogue of Lemma 3.2 used throughout the 2D proof.
- (3)+(4) replicate the “partially good ⇒ propagation to the next level” engine, now across z–levels via the (++−) type, which carries the z–minimum in the color (so no cross–plane color collision occurs).

# Obstacles

- Vertical duplicates can make r_z>1 at subsequent steps, blocking the inference s_{xy}≥2 from (H). We either need a selection scheme to avoid such columns, or we must switch to another coordinate and propagate there.
- Slices with |J|=2 (one zero) generate colors that ignore one coordinate; uniqueness must then be certified globally via a cross–slice argument (as in 2D Lemma 6.5), which remains to be written in 3D.

# Proposed immediate next tasks for the verifier

- Incorporate Proposition “Multiplicity for any T” (with its proof) into proofs.md; this will be referenced repeatedly.
- Verify the cross–plane propagation lemma in full detail using the (++−) identity.
- Attempt to prove a small “vertical uniqueness or force (+++)” claim: on a top z–plane with at least two points, either there are two points whose (x,y) pairs do not occur on any higher plane (trivial here since topmost) and at least one of which does not occur on any lower plane, or else the all–plus color from some base triggers uniqueness.
- Explore toy counterexamples to refine the selection rule; the example above shows why a naive iteration may stall.

# End