=== SYSTEM ===
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md, proofs.md, and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (informal progress & exploratory work so far)
- proofs.md (rigorous proofs & detailed mathematics so far)
- output.md (main results summary so far)

**Three-tier file system guidelines**:
- **notes.md**: Readable running log of exploratory work, intuitions, failed attempts, ideas. Prefer appending. Replace only if old notes are clearly misleading. Should be self-contained.
- **proofs.md**: Complete rigorous mathematical proofs with full details. Think twice before adding anything. Contains proven lemmas, theorems, and detailed derivations. Only add mathematically verified content here.
- **output.md**: This is the only file that the user is supposed to read. It has to be self-contained. It should contain ONLY the main problem results, and a discussion why they are relevant. It is extremely selective. Think twice before promoting proofs from proofs.md to output.md. Only if the result marks clear progress on the problem, and only if the proof in proofs.md has been thoroughly vetted by provers and you, it can join output.md. Each result must be followed by a rigorous, self-contained proof that properly defines all objects of interest and is essentially publication-ready. 

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions.",
  "summary_md": "Concise summary of this round's work for summarizer.",
  "verdict": "promising|uncertain|unlikely",
  "blocking_issues": ["List of issues preventing progress"],
  "per_prover": [{"prover_id": "01", "brief_feedback": "feedback", "score": "promising|uncertain|unlikely"}],
  "notes_update": {"action": "append|replace", "content": "Markdown for notes.md"},
  "proofs_update": {"action": "append|replace", "content": "Markdown for proofs.md"}, 
  "output_update": {"action": "append|replace", "content": "Markdown for output.md"}
}

**Verdict definitions**:
- **promising**: Significant mathematical progress, publishable results, or clear path to solution
- **uncertain**: Some progress but with unresolved issues or incomplete reasoning  
- **unlikely**: No meaningful progress, fundamentally flawed approaches, or just exploratory work

**Update guidelines**:
- Use null for any update field you don't want to modify
- notes_update: Include informal reasoning, failed attempts, intuitions, exploratory work
- proofs_update: Only include complete, rigorous proofs that you have verified
- output_update: Only include main problem results that directly advance toward the solution


=== USER ===
=== Task (tex) ===

# Problem definition and your task

Fix an integer $n\ge 1$ and let $[n]=\{1,2,\dots,n\}$. Consider the complete graph $G$ on the vertex set

$$
V(G)=[n]\times[n]\times[n].
$$

For two distinct vertices

$$
u=(x_1,y_1,z_1),\qquad v=(x_2,y_2,z_2),
$$

define the **sign pattern**

$$
\sigma(u,v)=\big(\operatorname{sgn}(x_1-x_2),\,\operatorname{sgn}(y_1-y_2),\,\operatorname{sgn}(z_1-z_2)\big)\in\{-1,0,+1\}^3\setminus\{(0,0,0)\}.
$$

The **type** of the undirected edge $e=uv$ is the equivalence class

$$
T(e)=[\sigma(u,v)]\quad\text{modulo global sign }(\sigma\sim -\sigma),
$$

so there are $(3^3-1)/2=13$ types. Let $J(T)\subseteq\{x,y,z\}$ be the coordinates where $T$ is nonzero, and $E(T)=\{x,y,z\}\setminus J(T)$ the coordinates where it is zero.

Define the color map $c_3:E(G)\to\mathcal L$ as follows. For $i\in J(T)$ (the two points $u,v$ disagree on the coordinate), record $m_i:=\min\{u_i,v_i\}$. For $i\in E(T)$, don't record anything. The list of length 3 that contains either the minimum coordinate, or "unspecified", together with the type of the point-pair, is the color of the edge. Check the $d=2$ solution to see how this works. 

For $U\subseteq V(G)$, let $G[U]$ denote the induced subgraph. An edge $e\in E(G[U])$ has a **unique color in $U$** if no other edge of $G[U]$ has the same label $c_3(e)$.

# Your task

Show that for every vertex set $U\subseteq [n]^3$ with $|U|\ge 2$, there exist $u_1,u_2\in U$ such that the edge $u_1u_2$ has a color that appears **exactly once** in $G[U]$ under the coloring $c_3$ above.


Next, you are given a file with a proof for the analogous question in $d=2$. 


\documentclass[11pt]{article}
\usepackage{amsmath,amsthm,amssymb,mathtools}
\usepackage[margin=1in]{geometry}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{claim}[theorem]{Claim}

\newcommand{\NE}{\mathrm{NE}}
\newcommand{\set}[1]{\left\{\,#1\,\right\}}

\begin{document}

\section*{Problem and main theorem}

Fix $n\ge 1$ and write $[n]=\{1,2,\dots,n\}$. Consider the complete graph $G$ on
$V(G)=[n]\times[n]$. For distinct vertices $v_1=(a_1,b_1)$ and $v_2=(a_2,b_2)$, the edge
$e=v_1v_2$ is of type
\begin{itemize}
  \item \textbf{1:} $(a_1-a_2)(b_1-b_2)>0$,
  \item \textbf{2:} $(a_1-a_2)(b_1-b_2)<0$,
  \item \textbf{3:} $a_1=a_2$ (vertical),
  \item \textbf{4:} $b_1=b_2$ (horizontal),
\end{itemize}
with color
\[
c(e)=
\begin{cases}
(1,\min\{a_1,a_2\},\min\{b_1,b_2\}) & \text{type 1},\\
(2,\min\{a_1,a_2\},\min\{b_1,b_2\}) & \text{type 2},\\
(3,\min\{b_1,b_2\}) & \text{type 3},\\
(4,\min\{a_1,a_2\}) & \text{type 4}.
\end{cases}
\]
For $U\subseteq V(G)$, write $G[U]$ for the induced subgraph. An edge $e\in E(G[U])$ has a
\emph{unique color in $U$} if no other edge of $G[U]$ has the same label $c(e)$.

\begin{theorem}\label{thm:unique}
For every $U\subseteq [n]\times[n]$ with $|U|\ge 2$, the graph $G[U]$ contains an edge whose
color under $c$ appears exactly once in $G[U]$.
\end{theorem}

From now on, fix $U$ and assume the following: 
\[
\textbf{(H)}\qquad \text{No color is unique in }G[U].
\]

\section*{Basic notation and counting}

For $p=(x,y)\in U$, define its strict north--east set
\[
\NE(p):=\set{q=(x',y')\in U:\ x'>x\ \text{and}\ y'>y}.
\]
We write $p\prec q$ iff $q\in\NE(p)$ (both coordinates increase).

\begin{fact}[Type~1 multiplicity]\label{fact:t1}
For $(\alpha,\beta)\in[n]^2$,
\[
\#\{e\in E(G[U]): c(e)=(1,\alpha,\beta)\}
= \mathbf 1_{(\alpha,\beta)\in U}\cdot |\NE(\alpha,\beta)|.
\]
In particular, $(1,\alpha,\beta)$ is unique in $U$ iff $(\alpha,\beta)\in U$ and $|\NE(\alpha,\beta)|=1$.
\end{fact}

\begin{fact}[Type~2 multiplicity]\label{fact:t2}
For $(\alpha,\beta)\in[n]^2$ put
\[
r(\alpha,\beta)=\#\{(\alpha,y)\in U:\ y>\beta\},\qquad
s(\alpha,\beta)=\#\{(x,\beta)\in U:\ x>\alpha\}.
\]
Then the number of edges colored $(2,\alpha,\beta)$ in $G[U]$ equals $r(\alpha,\beta)\,s(\alpha,\beta)$.
Thus $(2,\alpha,\beta)$ is unique iff $r(\alpha,\beta)=s(\alpha,\beta)=1$.
\end{fact}

\section*{Lexicographic maximizer}

\begin{definition}[Eligible and lexicographic maximizer]\label{def:lex}
A point $p\in U$ is \emph{eligible} if $\NE(p)\neq\varnothing$.
Order pairs by $(y,x)\le_{\mathrm{lex}}(y',x')$ iff $y<y'$ or $y=y'$ and $x\le x'$.
A point $a\in U$ is a \emph{lexicographic maximizer among eligible points} if
\[
\NE(a)\neq\varnothing\quad\text{and}\quad (a_y,a_x)=\max\nolimits_{\le_{\mathrm{lex}}}
 \set{(y,x): (x,y)\in U,\ \NE(x,y)\neq\varnothing}.
\]
\end{definition}

\begin{lemma}[Lexicographic maximality $\Rightarrow$ no comparable pair]\label{lem:lexheight}
If $a$ is as in Definition~\ref{def:lex}, then $\NE(q)=\varnothing$ for every $q\in \NE(a)$.
Hence $\NE(a)$ is an antichain for $\prec$ (no strictly NE–comparable pair).
\end{lemma}

\begin{proof}
If $q\in\NE(a)$ had $\NE(q)\neq\varnothing$, then $(q_y,q_x)>(a_y,a_x)$ lexicographically,
contradicting maximality. If $r,s\in \NE(a)$ with $r\prec s$, then $\NE(r)\ni s\neq\varnothing$, again a contradiction.
\end{proof}

\section*{Levels in $\NE(a)$ and \emph{row/column–good}}

For $S\subseteq\mathbb{Z}^2$ write $S[y]=\{(x,y)\in S\}$ and $S[x]=\{(x,y)\in S\}$.
For a point $a$ with $\NE(a)\neq\varnothing$ define (when they exist)
\[
Y_{\min}(a):=\min\{\,y>a_y:\ \NE(a)[y]\neq\varnothing\,\},\qquad
X_{\min}(a):=\min\{\,x>a_x:\ \NE(a)[x]\neq\varnothing\,\},
\]
(the \emph{bottommost row} and \emph{leftmost column} of $\NE(a)$).

\begin{definition}[Row–good / Column–good]\label{def:row-good}
Let $a$ be lex–maximal among eligible points.

\smallskip\noindent
\emph{Row–good:}
There exists $\beta=Y_{\min}(a)$ such that $\#\,\NE(a)[\beta]\ge 2$, and if we list the $x$–coordinates of
$\NE(a)[\beta]$ increasingly as $x_1<\cdots<x_t$ ($t\ge 2$) and set
\[
b_1=(x_{t-1},\beta)\quad\text{(second–rightmost)},\qquad
b_2=(x_t,\beta)\quad\text{(rightmost)},
\]
then
\[
\text{(RG)}\qquad \forall q\in \NE(a)\setminus\{b_1,b_2\}:\quad x(q)<x(b_1)\ \ \text{and}\ \ y(q)\ge \beta.
\]
Equivalently: $b_1,b_2$ are the \emph{last two} points of $\NE(a)$—every other point lies strictly to the left of $b_1$ and on row $\beta$ or above.

\smallskip\noindent
\emph{Column–good:} the vertical analogue with $\alpha=X_{\min}(a)$, $d_1,d_2$ the \emph{second–topmost} and \emph{topmost} points in $\NE(a)[\alpha]$, and
\[
\text{(CG)}\qquad \forall q\in \NE(a)\setminus\{d_1,d_2\}:\quad y(q)<y(d_1)\ \ \text{and}\ \ x(q)\ge \alpha.
\]
\end{definition}

\section*{Dichotomy}

\begin{definition}[Corner in $\NE(a)$]\label{def:corner}
Let $a$ be lex–maximal among eligible points. We say $\NE(a)$ contains a \emph{corner} if there exist
\[
(\alpha,\beta),\quad (\alpha',\beta),\quad (\alpha',\beta')\in \NE(a)
\]
with
\[
a_x<\alpha<\alpha',\qquad a_y<\beta'<\beta.
\]
\end{definition}

\medskip

\noindent\textbf{Additional notation.}
For $q=(x(q),y(q))$ we continue to write $x(q),y(q)$ for its coordinates.

\subsection*{Partially good pairs (formalizing the sketch)}

\begin{definition}[Partially row–good / column–good]\label{def:partial}
Let $a$ be lex–maximal among eligible points.

\smallskip\noindent
Two points $b_1,b_2\in\NE(a)$ on the same row $y=\beta$ with $x(b_1)<x(b_2)$ are \emph{partially row–good}
if
\begin{align*}
\text{(PR1)}\ &\text{$b_1,b_2$ are the last two points of $\NE(a)$ on row $\beta$;}\\
\text{(PR2)}\ &\forall q\in\NE(a)\setminus\{b_1,b_2\}:\ y(q)\ge\beta \ \Rightarrow\ x(q)<x(b_1).
\end{align*}
Equivalently, this is exactly (RG) with the sole relaxation that points with $y<\beta$ may exist anywhere.

\smallskip\noindent
Two points $d_1,d_2\in\NE(a)$ on the same column $x=\alpha$ with $y(d_1)<y(d_2)$ are \emph{partially column–good}
if
\begin{align*}
\text{(PC1)}\ &\text{$d_1,d_2$ are the topmost two points of $\NE(a)$ on column $\alpha$;}\\
\text{(PC2)}\ &\forall q\in\NE(a)\setminus\{d_1,d_2\}:\ x(q)\ge\alpha \ \Rightarrow\ y(q)<y(d_1).
\end{align*}
Equivalently, this is (CG) with the sole relaxation that points with $x<\alpha$ may exist anywhere.
\end{definition}

\begin{remark}[On the intended meaning in the sketch]\label{rem:meaning}
The phrasing ``no points are above $b_1$ and above $b_2$'' in the sketch is formalized by (PR2):
above the row $\beta$ there are no points of $\NE(a)$ at columns $\ge x(b_1)$. This was the property actually used
to force $r(\alpha,\beta)=1$ in the type–2 counting (Fact~\ref{fact:t2}).
\end{remark}

\subsection*{Propagation sublemma (rigorous version of the sketch)}

\begin{lemma}[Propagation for partially row–good pairs]\label{lem:prop-row}
Assume \emph{(H)} and let $a$ be lex–maximal among eligible points.
Let $b_1,b_2\in\NE(a)$ be partially row–good on row $\beta$ with $x(b_1)<x(b_2)$.
Then either
\begin{enumerate}
\item[\emph{(i)}] $\NE(a)[y]=\varnothing$ for every $y<\beta$ (hence $a$ is row–good), or
\item[\emph{(ii)}] there exist $b_1',b_2'\in\NE(a)$ on some row $\beta'<\beta$ that are partially row–good.
\end{enumerate}
\end{lemma}

\begin{proof}
If $\NE(a)[y]=\varnothing$ for all $y<\beta$ we are in case (i) and done.
Otherwise, let
\[
\beta':=\max\{\,y<\beta:\ \NE(a)[y]\neq\varnothing\,\}
\]
be the highest row strictly below $\beta$, and within that row choose
\[
c_1\in \NE(a)[\beta']\quad\text{with}\quad x(c_1)=\min\{\,x:\ (x,\beta')\in \NE(a)\,\}.
\]
By Lemma~\ref{lem:lexheight}, every point of $\NE(a)$ has empty NE–set. In particular,
$c_1$ cannot lie strictly to the left of $b_2$ since then $b_2\in\NE(c_1)$; hence
\begin{equation}\label{eq:c1rightofb2}
x(c_1)\ge x(b_2).
\end{equation}

We split according to whether $c_1$ is directly below $b_2$ (same column) or strictly to its right.

\smallskip
\noindent\emph{Case A: $x(c_1)=x(b_2)$.}
Consider the type–2 edge $b_1c_1$. Its color is $(2,\alpha,\gamma)$ with
$\alpha=x(b_1)$ and $\gamma=\beta'$. By the choice of $\beta'$ there is no point of $U$ in
column $x(b_1)$ with $y\in(\beta',\beta)$ (such a point would belong to $\NE(a)$ since $x(b_1)>a_x$).
Moreover, by (PR2) there is no $q\in \NE(a)\setminus\{b_1,b_2\}$ with $y(q)\ge\beta$ and $x(q)\ge x(b_1)$;
hence in column $x(b_1)$ there is no point of $U$ with $y>\beta$ (the only point at height $\ge \beta$ is $b_1$ itself at $y=\beta$).
Consequently
\[
r(\alpha,\gamma)=\#\{(x(b_1),y)\in U:\ y>\beta'\}=1
\]
(the unique witness is $b_1$ at height $\beta$). Since \emph{(H)} forbids uniqueness of $(2,\alpha,\gamma)$,
Fact~\ref{fact:t2} implies $s(\alpha,\gamma)\ge 2$. One of these $s$ witnesses is $c_1$ itself, and because $c_1$
was chosen leftmost on $\beta'$, the second one must have strictly larger $x$; call it $c_2$ (so $x(c_2)>x(c_1)$).

Now consider $b_2c_2$. Its color is $(2,\alpha',\gamma)$ with $\alpha'=x(b_2)$ and the same $\gamma=\beta'$.
By the definition of $\beta'$ there is no point of $U$ in column $x(b_2)$ with $y\in(\beta',\beta)$, and since $x(b_2)\ge x(b_1)$,
(PR2) rules out any $q\in \NE(a)\setminus\{b_1,b_2\}$ with $y(q)\ge\beta$ and $x(q)\ge x(b_2)$; thus there is no point of $U$
in that column with $y>\beta$. Therefore
$r(\alpha',\gamma)=1$ (the only point above height $\beta'$ in that column is $b_2$), so $s(\alpha',\gamma)\ge 2$.
Because $c_2$ is one $\beta'$–witness with $x>\alpha'$, there exists $c_3\in \NE(a)[\beta']$ with $x(c_3)>x(c_2)$.

Let $b_2'$ be the rightmost point of $\NE(a)[\beta']$ and $b_1'$ the second–rightmost point of $\NE(a)[\beta']$.
By construction $(\text{PR1})$ holds for $b_1',b_2'$.
For $(\text{PR2})$: there are no points of $\NE(a)$ on rows $y\in(\beta',\beta)$ by the choice of $\beta'$;
and for rows $y\ge\beta$ there are no points with $x\ge x(b_1)\le x(b_1')$ by (PR2) for the original
pair $b_1,b_2$. Hence every $q\in\NE(a)\setminus\{b_1',b_2'\}$ with $y(q)\ge\beta'$ satisfies $x(q)<x(b_1')$.
Thus $b_1',b_2'$ are partially row–good, verifying case (ii).

\smallskip
\noindent\emph{Case B: $x(c_1)>x(b_2)$.}
Consider $b_2c_1$, which has color $(2,\alpha',\gamma)$ with $\alpha'=x(b_2)$ and $\gamma=\beta'$.
Exactly the same reasoning as in Case~A gives $r(\alpha',\gamma)=1$, hence $s(\alpha',\gamma)\ge 2$.
One witness is $c_1$; since $c_1$ is leftmost on $\beta'$, the second witness $c_2$ must satisfy $x(c_2)>x(c_1)$.
Define $b_2'$ as the rightmost point and $b_1'$ as the second–rightmost point of $\NE(a)[\beta']$.
Then (PR1) holds by definition, and (PR2) follows verbatim as in Case~A. Hence $b_1',b_2'$ are partially row–good.
\end{proof}

\begin{remark}[Minor tidy–up matching the sketch]\label{rem:tidy-up}
In the sketch, after producing $c_2,c_3$ it is stated that one can set $b_1'b_2'=c_2,c_3$.
To ensure (PR1) literally (``last two''), one should in general relabel
$b_1',b_2'$ as the \emph{second–rightmost} and \emph{rightmost} points of $\NE(a)[\beta']$.
This harmless relabeling is the only additional step we make for full rigor.
\end{remark}

\begin{lemma}[Propagation for partially column–good pairs]\label{lem:prop-col}
Assume \emph{(H)} and $a$ lex–maximal among eligible points.
Let $d_1,d_2\in\NE(a)$ be partially column–good on column $\alpha$ with $y(d_1)<y(d_2)$.
Then either
\begin{enumerate}
\item[\emph{(i)}] $\NE(a)[x]=\varnothing$ for every $x<\alpha$ (hence $a$ is column–good), or
\item[\emph{(ii)}] there exist $d_1',d_2'\in\NE(a)$ on some column $\alpha'<\alpha$ that are partially column–good.
\end{enumerate}
\end{lemma}

\begin{proof}
By symmetry of $x\leftrightarrow y$ and $(\text{PR1}),(\text{PR2})\leftrightarrow(\text{PC1}),(\text{PC2})$,
the proof is identical to Lemma~\ref{lem:prop-row}, with Fact~\ref{fact:t2} used in the transposed roles.
\end{proof}

\subsection*{Existence of a starting partially good pair and the dichotomy}

\begin{lemma}[Dichotomy: each lex–maximal $a$ is row–good or column–good]\label{lem:dichotomy-strong}
Assume \emph{(H)} and let $a$ be lexicographically maximal among eligible points.
Then $a$ is row–good or column–good.
\end{lemma}

\begin{proof}
We first note that $\#\NE(a)\ge 2$ under (H): if $\#\NE(a)=1$, then by Fact~\ref{fact:t1}
the color $(1,a_x,a_y)$ appears exactly once (on the unique type–1 edge from $a$), contradicting (H).

Let $p\in\NE(a)$ be a point of maximal $y$ (i.e.\ on the topmost row of $\NE(a)$).
If $\NE(a)[y(p)]$ contains at least two points, let $b_2$ be the rightmost
and $b_1$ the second–rightmost point of that row. Then $b_1,b_2$ are partially row–good:
(PR1) holds by choice; for (PR2), there is no point of $\NE(a)$ with $y>\,y(p)$ and
every other point on $y(p)$ lies to the left of $b_1$.
Applying Lemma~\ref{lem:prop-row} iteratively, either we immediately conclude that no lower row exists
and $a$ is row–good, or we propagate downward until we arrive at the bottommost row,
at which point the pair is row–good by definition. This iteration terminates because the row index
decreases strictly at each step and there are finitely many rows. This settles the case $\#\NE(a)[y(p)]\ge 2$.

It remains to treat the case where $p$ is the unique point on its row.
Let $\beta'$ be the next highest level below $y(p)$ with $\NE(a)[\beta']\neq\varnothing$.
We claim that every point on row $\beta'$ lies on or to the right of $p$ (i.e.\ has $x\ge x(p)$):
indeed, if $q\in\NE(a)[\beta']$ had $x(q)<x(p)$, then $p\in\NE(q)$, which contradicts
Lemma~\ref{lem:lexheight}. There are two subcases.

\smallskip
\noindent\emph{Subcase 1: there is $q_1\in\NE(a)[\beta']$ with $x(q_1)=x(p)$ (``directly below'' $p$).}
If $\NE(a)[\beta']=\{q_1\}$, then the pair $d_1=q_1$, $d_2=p$ is partially column–good:
(PC1) holds because these are the topmost two points in column $x(p)$;
(PC2) holds because there is no row strictly between $\beta'$ and $y(p)$,
there is no point on row $\beta'$ with $x\ge x(p)$ other than $q_1$ itself,
and $p$ is alone on row $y(p)$. Applying Lemma~\ref{lem:prop-col} iteratively,
either we immediately conclude that no more left columns exist and $a$ is column–good,
or we propagate left until reaching the leftmost column, at which point the pair is column–good.
This iteration terminates because the column index decreases strictly at each step and there are finitely many columns.

If instead $\NE(a)[\beta']$ contains another point $q_2$ to the right of $q_1$,
then (H) plus Fact~\ref{fact:t2} applied to the type–2 edge $pq_2$ forces the existence of
$q_3\in\NE(a)[\beta']$ with $x(q_3)>x(q_2)$ (formally, $r(x(p),\beta')=1$ and so $s(x(p),\beta')\ge 2$;
choosing $q_2$ leftmost to the right of $x(p)$ guarantees $x(q_3)>x(q_2)$).
Relabel the rightmost two points on row $\beta'$ as $b_1,b_2$; then $b_1,b_2$ are partially row–good
and we conclude by Lemma~\ref{lem:prop-row} as in the first paragraph (again the iteration terminates as above).

\smallskip
\noindent\emph{Subcase 2: there is no point directly below $p$ on $\beta'$.}
Pick any $q_1\in\NE(a)[\beta']$; we know $x(q_1)>x(p)$. Then the type–2 edge $pq_1$ has color $(2,x(p),\beta')$
with $r(x(p),\beta')=1$ (the only point above height $\beta'$ in column $x(p)$ is $p$),
so (H) and Fact~\ref{fact:t2} yield another $q_2\in\NE(a)[\beta']$ with $x(q_2)>x(q_1)$
(again choose $q_1$ leftmost on $\beta'$ to force $x(q_2)>x(q_1)$).
Relabel the rightmost two points on $\beta'$ as $b_1,b_2$, which are partially row–good,
and finish via Lemma~\ref{lem:prop-row}$\,$— the iteration terminates for the same reason as above.

\smallskip
In all cases, we obtain that $a$ is row–good or column–good.
\end{proof}

\begin{remark}[Explicitly pointing out the sketch’s gaps]\label{rem:gaps}
\leavevmode
\begin{itemize}
\item In the sublemma part of the sketch, after producing $c_2,c_3$ it is said to set $b_1'b_2'=c_2,c_3$.
To certify the ``last two'' requirement, one must relabel $b_1',b_2'$ as the \emph{rightmost two} points
on the row $\beta'$ (Remark~\ref{rem:tidy-up}). This does not change the argument’s structure.
\item In the ``starting pair'' part, the phrase ``there is $q_1$ to the right of $p$'' should be
understood as: $q_1$ lies on the \emph{next highest} row $\beta'$ below $y(p)$ and satisfies $x(q_1)>x(p)$.
With this reading, the verification of the partial row–good property is immediate from the choice of $\beta'$.
\end{itemize}
\end{remark}

\bigskip

\section*{Final proof of Theorem~\ref{thm:unique} (as provided, with small auxiliary lemmas)}

\paragraph{Convention.}
In this section, when we say ``lex–maximal point'', we mean \emph{lex–maximal among eligible points} with respect to the order $(y,x)$.

\begin{lemma}[Lex–max eligible exists inside a cone]\label{lem:cone-max-exists}
Let $p\in U$, and let $\overline{\NE}(p)=\{\,q\in U:\ x(q)\ge x(p),\ y(q)\ge y(p)\,\}$.
If $\overline{\NE}(p)$ contains an eligible point, then it contains a lex–maximal eligible point (with respect to $(y,x)$).
\end{lemma}

\begin{proof}
$\overline{\NE}(p)$ is finite; the set of eligible points inside it is finite and nonempty. A lexicographic maximum exists.
\end{proof}

\begin{lemma}[Local antichain from cone–maximality]\label{lem:local-anti}
Fix $p\in U$ and let $c$ be lex–maximal among eligible points in $\overline{\NE}(p)$.
Then $\NE(q)=\varnothing$ for every $q\in \NE(c)$ (equivalently, $\NE(c)$ is an antichain).
\end{lemma}

\begin{proof}
If $q\in \NE(c)$ had $\NE(q)\neq\varnothing$, then $q$ would be eligible and $(y(q),x(q))>(y(c),x(c))$.
Also $q\in\overline{\NE}(p)$ since $q\ge c\ge p$ coordinatewise. This contradicts the lex–maximality of $c$ among eligible points in $\overline{\NE}(p)$.
\end{proof}

\begin{corollary}[Local dichotomy]\label{cor:local-dichotomy}
Assume \emph{(H)}. If $c\in U$ satisfies $\NE(c)\neq\varnothing$ and $\NE(q)=\varnothing$ for all $q\in\NE(c)$, then $c$ is row–good or column–good (with $a$ replaced by $c$ in Definition~\ref{def:row-good}).
\end{corollary}

\begin{proof}
The proof of Lemma~\ref{lem:dichotomy-strong} uses only (i) $\NE(c)\neq\varnothing$, (ii) $\NE(c)$ is an antichain, and (iii) \emph{(H)}. Under these assumptions the same argument applies verbatim.
\end{proof}

\begin{lemma}[No eligible point $\Rightarrow$ a unique color]\label{lem:no-eligible}
If $\NE(p)=\varnothing$ for every $p\in U$, then $G[U]$ contains an edge whose color is unique.
\end{lemma}

\begin{proof}
If some row contains at least two points, let $\beta$ be the minimum $y$ with $\#U[\beta]\ge 2$, and let $b_1,b_2\in U[\beta]$ be the second–rightmost and rightmost points. We claim $(4,x(b_1))$ is unique. Indeed, if there were another horizontal edge with color $(4,x(b_1))$ on some row $\beta'>\beta$, there would be points $(x(b_1),\beta')$ and $(x',\beta')$ with $x'>x(b_1)$, which makes $(x',\beta')\in \NE\big(x(b_1),\beta\big)$, contradicting that all $\NE(\cdot)$ are empty.

Otherwise, every row contains at most one point. If some column contains at least two points, let $\alpha$ be the minimum $x$ with $\#U[\alpha]\ge 2$, and let $d_1,d_2\in U[\alpha]$ be the second–topmost and topmost points ($y(d_1)<y(d_2)$). We claim $(3,y(d_1))$ is unique. If another vertical edge of color $(3,y(d_1))$ existed on some column $\alpha'\ne \alpha$, then necessarily $\alpha'>\alpha$ (by minimality of $\alpha$) and there would be points $(\alpha',y(d_1))$ and $(\alpha',y')$ with $y'>y(d_1)$. Then $(\alpha',y')\in \NE\big(\alpha,y(d_1)\big)$, again a contradiction.

Finally, if every row and every column contains at most one point, then pick any two distinct points $p=(x_1,y_1)$ and $q=(x_2,y_2)$. Since there are no eligible points, after relabeling we must have $x_1>x_2$ and $y_1<y_2$. The type–2 edge $pq$ has color $(2,\alpha,\beta)=(2,x_2,y_1)$. Because rows and columns are unique, $r(\alpha,\beta)=1$ (the unique point above $\beta$ in column $\alpha$ is $q$) and $s(\alpha,\beta)=1$ (the unique point to the right of $\alpha$ on row $\beta$ is $p$), so the color is unique by Fact~\ref{fact:t2}.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:unique}]
Assume \emph{(H)} for a contradiction. If $U$ contains no eligible point, Lemma~\ref{lem:no-eligible} yields a unique color, contradicting \emph{(H)}. Hence there exists an eligible point.

Pick a lexicographic maximizer $a$ among eligible points (Definition~\ref{def:lex}). By Lemma~\ref{lem:dichotomy-strong}, $a$ is row–good or column–good. By symmetry we may assume $a$ is row–good, with witnesses $(b_1,b_2)$ on the row $\beta=Y_{\min}(a)$, $x(b_1)<x(b_2)$, satisfying (RG).

\smallskip
\noindent\emph{Claim (auxiliary step).} There exists $a'\in U$, $a'\ne a$, that is row–good with $x(a')>x(a)$ and $y(a')\le y(a)$.

\smallskip
\noindent\emph{Proof of the claim.}
Because the horizontal color $c(b_1b_2)=(4,x(b_1))$ is not unique by \emph{(H)}, there exist points $c_1=(x(b_1),\gamma)$ and $c_2=(x',\gamma)$ with $x'>x(b_1)$ on some row $\gamma$; among all such rows choose $\gamma$ maximal and fix $c_1$ on that row. Since $x(c_1)=x(b_1)>a_x$ and $a$ is row–good, we have $c_1\notin \NE(a)$; thus $y(c_1)\le y(a)$. Also $b_2\in \NE(c_1)$ (because $x(b_2)>x(c_1)$ and $y(b_2)=\beta>y(c_1)$).

By Lemma~\ref{lem:cone-max-exists}, inside the weak cone $\overline{\NE}(c_1)=\{x\ge x(c_1),\,y\ge y(c_1)\}$ there exists a lex–maximal \emph{eligible} point~$c$. Note that $c\ne b_2$ because $\NE(b_2)=\varnothing$ (Lemma~\ref{lem:lexheight}). We also have $x(c)\ge x(c_1)=x(b_1)>x(a)$ and $y(c)\ge y(c_1)\le y(a)$, so $c$ lies strictly to the right of $a$ and not above it.

By Lemma~\ref{lem:local-anti}, $\NE(q)=\varnothing$ for every $q\in \NE(c)$, hence by Corollary~\ref{cor:local-dichotomy} the point $c$ is row–good or column–good. If $c$ is row–good, set $a':=c$ and the claim is proved. Otherwise, $c$ is column–good. Let $\alpha=X_{\min}(c)$ and let $d_1,d_2\in \NE(c)[\alpha]$ with $y(d_1)<y(d_2)$. (It may happen that $d_2=b_2$; in any case $d_1\notin \NE(a)$ because $a$ is row–good.)

Consider the type–2 edge $b_1d_1$, whose color is $(2,x(b_1),y(d_1))$. As in the argument in the main text (see the proof of Lemma~\ref{lem:prop-row}, Case~A), using the choice of $\gamma$, (RG), and Fact~\ref{fact:t2} we obtain $r\big(x(b_1),y(d_1)\big)=1$, hence $s\big(x(b_1),y(d_1)\big)\ge 2$. One witness is $d_1$; choosing it leftmost on its row forces another witness strictly to its right. Pushing this once more with $b_2$ in place of $b_1$ yields a third point on that row strictly further right, which contradicts the column–goodness (CG) of $c$ after relabeling the two rightmost points on that row. Therefore $c$ cannot be column–good, and $c$ must be row–good. Setting $a':=c$ proves the claim.

\smallskip
Starting from $a$, repeatedly apply the claim to obtain a strictly increasing sequence of $x$–coordinates for row–good points that are never above the previous one. Since $x\in[n]$, this process cannot continue indefinitely; thus we obtain a contradiction to \emph{(H)}. This completes the proof.
\end{proof}

\begin{remark}[Notes on earlier concerns]
(1) Applying dichotomy to $c$ is justified by Lemmas~\ref{lem:local-anti} and Corollary~\ref{cor:local-dichotomy}: we only need antichain structure within $\NE(c)$, which holds for a cone–lex–max eligible $c$. 
(2) The possibility $c=b_2$ is excluded since $b_2$ is not eligible. 
(3) The case with no eligible points is handled by Lemma~\ref{lem:no-eligible}. 
(4) The termination of the iteration is now stated explicitly.
\end{remark}

\end{document}







=== Notes ===

# Research Notes




=== Current Output ===

# Main Results




=== Prover 1 Output ===

# 3D setup and notation

- Vertices: V=[n]^3, write p=(x(p),y(p),z(p)).
- For distinct u,v, the sign pattern σ(u,v)∈{−1,0,+1}^3\{0} is taken up to global ±, yielding 13 types. For a type T fix a representative s(T)=(s_x,s_y,s_z) with J(T)={i: s_i≠0} and E(T)={x,y,z}\J(T). Write P(T)={i∈J: s_i=+1}, N(T)={i∈J: s_i=−1}.
- Edge color c_3(uv) consists of T together with the minima m_i:=min{u_i,v_i} for i∈J(T); coordinates in E(T) are unspecified.
- Define the strict 3D NE-set of p by NE(p):={q∈U: q_x>x(p), q_y>y(p), q_z>z(p)}. A point is 3D-eligible if NE(p)≠∅.

# A master counting lemma for c_3

Fix a type T (choose a representative s(T)=(s_x,s_y,s_z) as above) and a minima vector m=(m_i)_{i∈J(T)}∈[n]^{J(T)}.
For t=(t_i)_{i∈E(T)}∈[n]^{E(T)} define
- A_t(T,m):={ u∈U: u_i=m_i for i∈P(T); u_i>m_i for i∈N(T); and u_i=t_i for i∈E(T) },
- B_t(T,m):={ v∈U: v_i>m_i for i∈P(T); v_i=m_i for i∈N(T); and v_i=t_i for i∈E(T) }.

Lemma (Master multiplicity). The number M_U(T,m) of edges in G[U] colored (T,m) equals
Σ_{t∈[n]^{E(T)}} |A_t(T,m)|·|B_t(T,m)|.

Proof. For any edge {u,v} of color (T,m), orient it so that s(T) matches the chosen representative: for i∈P(T), u_i<v_i and m_i=u_i; for i∈N(T), u_i>v_i and m_i=v_i; for i∈E(T), u_i=v_i=t_i. Then u∈A_t and v∈B_t for the unique t, so the pair contributes 1 to |A_t||B_t|. Conversely any such (u,v) produces color (T,m). Because we fixed a representative s(T), no unordered pair is double-counted. ∎

Remarks.
- The formula is orientation-invariant: changing s(T) to −s(T) swaps A_t and B_t.
- This cleanly generalizes the 2D product counts (Facts for types 1 and 2).

# Useful explicit corollaries

Below, we state three instances we will repeatedly use (notations α,β,γ are integers in [n]).

1) J={x,y,z}, s=(+,+,+) (all three increase):
M_U(T,m) = 1_{(m_x,m_y,m_z)∈U} · |NE(m_x,m_y,m_z)|.
In particular, the color ((+,+,+),m) is unique iff (m∈U) and |NE(m)|=1.

2) J={x,z}, E={y}, s=(+ ,0 ,−) (x increases, z decreases, y equal):
For each fixed row y=β define
r_{β}(α,γ):= #{(α,β,z)∈U: z>γ},
 s_{β}(α,γ):= #{(x,β,γ)∈U: x>α}.
Then
M_U(T,(α,γ)) = Σ_{β=1}^n r_{β}(α,γ) · s_{β}(α,γ).
Consequently, this color is unique iff there is a unique β with r_β(α,γ)=s_β(α,γ)=1 and r_{β'}(α,γ)s_{β'}(α,γ)=0 for all β'≠β.

(The same formulas hold for s=(−,0,+) by symmetry, and for the “monotone” J={x,z}, s=(+ ,0 ,+) one gets Σ_β 1_{(α,β,γ)∈U}· #{(x,β,z)∈U: x>α, z>γ}.)

3) J={x}, E={y,z} (only x changes):
For each (β,γ) put d_{β,γ}(α):=1_{(α,β,γ)∈U}· #{(x,β,γ)∈U: x>α}.
Then M_U(T,α) = Σ_{β,γ} d_{β,γ}(α).
In particular, if there is a unique line (β,γ) with a point at x=α and exactly one further point to its right, and no other line contributes, then the x-only color with minima α is unique.

# Lexicographic maximizers and antichains

Order triples by (z,y,x) lex: (z,y,x) <_lex (z',y',x') iff z<z' or [z=z' and (y<y' or (y=y' and x<x'))].

Lemma (Lex–max antichain). If a∈U is lexicographically maximal among 3D-eligible points (NE(a)≠∅), then NE(q)=∅ for every q∈NE(a). In particular NE(a) is an antichain under the product order (strict in all three coordinates).

Proof. If q∈NE(a) had NE(q)≠∅, then some r∈NE(q) satisfies (z(r),y(r),x(r))>_lex (z(q),y(q),x(q))>_lex (z(a),y(a),x(a)), so r is 3D-eligible and lex-bigger than a, contradicting maximality. ∎

Usefulness: This is the 3D analogue of Lemma 2.1 in the 2D file; it is the structural input behind all “propagation” steps.

# A nontrivial special case: coordinatewise injective sets

We prove the theorem for the class of sets U with no repeated x, no repeated y, and no repeated z.

Theorem (Injective projections ⇒ unique color). If U⊆[n]^3 satisfies that the three coordinate projections are injective (no two points share x, likewise for y, z), and |U|≥2, then G[U] contains an edge whose c_3–color is unique in G[U].

Proof.
Arrange the points as u_1,…,u_m by increasing x. Consider the sequences y_i:=y(u_i) and z_i:=z(u_i).

Case 1: both (y_i) and (z_i) are strictly increasing. Then the product order is a chain. Take a:=u_{m−1}. Its strict NE–set is NE(a)={u_m}, hence by corollary 1 above, the (+++) color with minima m=(x(a),y(a),z(a)) has multiplicity 1. Thus it is unique.

Case 2: otherwise, there exist i<j with either (y_i>y_j and z_i>z_j) or exactly one of these inequalities holds.
- Subcase 2a: y_i>y_j and z_i>z_j. Then the edge e=u_i u_j is of J={x,y,z}–type with representative s=(+ ,− ,−) and minima m=(x_i,y_j,z_j). By injectivity in y and z, A_t(T,m)={u_i} and B_t(T,m)={u_j} for the unique t (there is no freedom in E(T), which is empty here), so by the master lemma M_U(T,m)=1. Hence c_3(e) is unique.
- Subcase 2b: say y_i>y_j but z_i<z_j (the other symmetric). Then e has J={x,y,z} with representative s=(+ ,− ,+), minima m=(x_i,y_j,z_i). Again, injectivity forces A={u_i} (x=m_x and z=m_z pin u_i), and B={u_j} (y=m_y pins u_j; also x_j>x_i and z_j>z_i), so multiplicity is 1 and c_3(e) is unique.
In all possibilities outside Case 1 we obtain a unique color. ∎

Why useful: This eliminates a large “generic” regime and shows that collisions in colors fundamentally require some coordinate repetitions; any complete 3D proof can focus on handling repetitions (fibers).

# Small examples and sanity checks

- If U is any 3-term chain in product order, the middle–top edge (between the top two) has a unique (+++) color via corollary 1.
- If U consists of two points with the same y,z but distinct x, the x-only type appears. If there is no other (y',z')–line with a point at the same minimal x and a right neighbor, then that color is unique by corollary 3.

# Obstacles in directly lifting the 2D propagation

A naive lift of the 2D proof would: fix a lex–max 3D-eligible a, let γ=Z_min(a) be the lowest z-level of NE(a), pick a pair b_1,b_2 on that plane satisfying a “row–good” condition in x–y, and then propagate to a lower plane γ'<γ using J={x,z} cross–types (corollary 2). The 2D argument crucially used that when dropping from row β to β'<β, every point on β' lies strictly below b_2 in the second coordinate, guaranteeing comparability and allowing r(α,β')=1. In 3D, if we drop in z but not necessarily in y, we do not automatically get y(c_1)<y(b_2); hence we lose comparability and the key inequality r_β(α,γ')=1 may fail across all rows β.

This is the main technical gap to bridge in a full 3D proof: one must organize NE(a) simultaneously in the y and z directions to recover a “propagation” condition ensuring that, for a carefully chosen β, one has r_β(α,γ')=1, forcing s_β(α,γ')≥2 under (H), and hence producing two rightward points on z=γ' at the same row β (as in 2D). The master counting lemma (corollary 2) is exactly the tool needed once such an organizational lemma is in place.

# Proposed 3D plane–based dichotomy and propagation (to be formalized next)

Definitions (plane–row/column–good relative to a): Fix a lex–max 3D-eligible a. Let γ:=min{z>a_z: NE(a)[z]≠∅}. On the plane z=γ, for rows β>y(a) define S_{γ,β}:=NE(a)∩{z=γ,y=β} and for columns α>x(a) define C_{γ,α}:=NE(a)∩{z=γ,x=α}.
- a is z–row–good if there exists a row β with |S_{γ,β}|≥2 and, listing its x–coordinates x_1<⋯<x_t, the second–rightmost/rightmost pair b_1=(x_{t−1},β,γ), b_2=(x_t,β,γ) has the property that every q∈NE(a) with z≥γ and y≥β other than {b_1,b_2} satisfies x(q)<x(b_1).
- z–column–good is the analogous statement interchanging x and y on z=γ.

Propagation claim (sketch). Assume (H) “no unique color in G[U]” and a lex–max a as above. If a is z–partially–row–good (same as z–row–good but allowing arbitrary points with z<γ), then either (i) NE(a)[z']=∅ for all z'<γ (hence a is fully z–row–good), or (ii) there exists γ'<γ and a row β' with a partially z–row–good pair b_1',b_2'⊂NE(a) on z=γ', y=β'. The intended proof mirrors Lemma 3.5 in 2D but uses corollary 2 with J={x,z}: after fixing γ' maximal below γ with NE(a)[γ']≠∅, one shows, for an appropriately chosen row β, that r_β(x(b_1),γ')=1, whence (H) forces s_β(x(b_1),γ')≥2, producing two distinct x’s on z=γ' at the fixed β. A second push with x(b_2) rules out configurations contradictory to the partially–good definition.

Why this would work: Once a plane–based dichotomy (z–row–good vs z–column–good) is established for a, one can emulate the terminal step in the 2D proof: non-uniqueness of a certain x-only or y-only color on z=γ creates a new point a' to the right (or upwards) but not above (in z,y), and iterating yields a finite strictly monotone sequence in x (or y), a contradiction.

What remains: The key missing ingredient is a clean selection of β on z=γ' ensuring r_β(α,γ')=1. This likely follows from a refined choice of the starting row on z=γ (topmost within NE(a)[γ] as in 2D) and a careful use of the antichain property of NE(a) to force y–comparability across the drop in z. Formalizing this selection is the next target.

# Summary of progress

- Introduced and proved a master multiplicity lemma for the 3D color c_3, with three concrete corollaries (J=3 monotone, J={x,z} cross, J={x} only). These generalize and subsume the 2D counting Facts and will be the engine for 3D propagation.
- Proved that a lex–max 3D-eligible point has an antichain NE–set (exact 3D analogue of the 2D antichain lemma).
- Proved the main theorem for a large special class: sets U with injective projections on all three coordinates.
- Identified the core obstacle in lifting the 2D propagation: controlling y when stepping down in z. Proposed a precise plane–based “row/column–good” dichotomy and a propagation claim using the new counting fact for J={x,z}.

# Next steps (actionable)

1) Formalize the selection of the initial partially z–row–good pair on z=γ (e.g., choose the topmost row β with |S_{γ,β}|≥2) and show how this forces, on the next lower plane γ', the existence of a row β with r_β(α,γ')=1 via the antichain structure.
2) Prove the z–column–good analogue using J={y,z} counting.
3) Establish the plane–based dichotomy for every lex–max 3D-eligible a (as in Lemma 3.7 for 2D), finishing the 3D step that replaces Lemma 3.6.
4) Adapt the final “forward iteration” argument to 3D once the dichotomy is in place, using x-only or y-only colors on z=γ and the cone–maximizer trick from the 2D proof’s last section.

Once (1)–(3) are settled, the remainder follows the 2D blueprint with the master counting lemma replacing Fact 2, completing the full 3D proof.


=== Prover 2 Output ===

# Ideas

- Lift the d=2 machinery to d=3 by working with the strict orthant order “all three coordinates increase.” Generalize the counting “multiplicity = product” for types that mix increasing/decreasing coordinates, and obtain a clean formula that will be a workhorse for forcing the existence of multiple witnesses on a lower z–level.
- Decouple the in–plane (fixed z) combinatorics from the cross–plane (varying z) propagation. Inside a fixed z–plane we can choose a 2D partially row–good pair without appealing to (H); then use a 3D type with one negative (on z) to push to the next lower z–plane by the product multiplicity.
- Record precisely the 3D multiplicity identities (generalizing Facts 2.1–2.2) so the verifier can use them as black boxes in later steps.
- Identify a concrete obstacle: vertical duplicates (same (x,y) occurring at multiple z’s) can break naive iteration, so a selection rule (or an axis–switch) will be needed later.

# Notation and basic 3D facts

- For p=(x,y,z)∈U, define the strict octant
  NE₃(p):={q=(x′,y′,z′)∈U: x′>x, y′>y, z′>z}.
  Write p≺₃q iff q∈NE₃(p).
- A point is eligible if NE₃(p)≠∅.
- Types in d=3: For an edge e=uv, the sign pattern σ(uv)∈{−1,0,+1}³\{(0,0,0)} is taken up to global sign, yielding a type T. Let E(T) be the zero coordinates and J(T)={x,y,z}\E(T) the nonzero coordinates. For i∈J(T), the color records m_i:=min{u_i,v_i}; i∈E(T) is unspecified. Thus c₃(e)=(T,(m_i)_{i∈J(T)}).

- For S⊆{x,y,z} and a tuple t∈[n]^S, denote the fibre
  U[S=t]:= {u∈U: u_i=t_i for all i∈S}.
  For inequalities, e.g. u_P=m_P and u_M>m_M, interpret componentwise on the specified index set.

## Multiplicity formulas (general form)

Let a type T be specified by a partition of indices into P(T)= indices with +, M(T)= indices with −, and E(T)= indices with 0 (up to global sign; we fix the orientation where P(T) are the “increasing” coordinates). For each color parameter m∈[n]^{J(T)}, define for w∈[n]^{E(T)} the sliced sets
- U⁺(w):= {u∈U: u_P=m_P, u_E=w, and u_M>m_M},
- U⁻(w):= {v∈U: v_M=m_M, v_E=w, and v_P>m_P}.

Proposition (Multiplicity for any T). The number of edges in G[U] with color (T,m) equals
  N_T(m)=∑_{w∈[n]^{E(T)}} |U⁺(w)|·|U⁻(w)|.
In particular, when E(T)=∅ (all three coordinates change), this reduces to
  N_T(m) = |{u∈U: u_P=m_P, u_M>m_M}| · |{v∈U: v_M=m_M, v_P>m_P}|.

Proof. Each edge of type T and minima m decomposes uniquely (given our fixed orientation of P/M) as an ordered pair (u,v) with u attains the minima on P and v attains the minima on M, the E–coordinates equal between the endpoints; conversely every such ordered pair produces one undirected edge of that color. Summing over the common E–coordinates yields the claim.

Two useful specializations:
- All–plus (+++): P={x,y,z}, M=∅, E=∅. Then for m=(α,β,γ),
  N_{+++}(α,β,γ) = 1_{(α,β,γ)∈U} · |NE₃(α,β,γ)|.
  Hence (α,β,γ) is unique iff (α,β,γ)∈U and |NE₃(α,β,γ)|=1.
- One minus (++−): P={x,y}, M={z}, E=∅. For m=(α,β,γ),
  N_{++−}(α,β,γ) = r_z(α,β;γ) · s_{xy}(α,β;γ),
  where r_z(α,β;γ):= |{(α,β,z)∈U: z>γ}| and s_{xy}(α,β;γ):= |{(x,y,γ)∈U: x>α, y>β}|.
  Uniqueness iff r_z=s_{xy}=1.

Remark. The six types with |J(T)|=2 (one zero) admit the summed form
  N_T(m)=∑_{w∈[n]^{E(T)}} |U⁺(w)|·|U⁻(w)|,
which will be used later when needed.

## Lexicographic maximizer and antichain property

Order triples by (z,y,x) lex: (z,y,x)≤_lex(z′,y′,x′) iff z<z′, or z=z′ and y<y′, or z=z′, y=y′ and x≤x′.

Lemma (3D lex–max antichain). Let a∈U be lexicographically maximal among eligible points (i.e., NE₃(a)≠∅ and (z(a),y(a),x(a)) is lex–max subject to eligibility). Then NE₃(q)=∅ for every q∈NE₃(a). Equivalently, NE₃(a) is an antichain for ≺₃.

Proof. If q∈NE₃(a) had NE₃(q)≠∅ then there exists r with r≻₃q, hence (z(r),y(r),x(r))>(z(q),y(q),x(q))≥(z(a),y(a),x(a)), contradicting the lex maximality of a.

Consequences: (i) Under (H), |NE₃(a)|≥2 (else the (+++) color at (x(a),y(a),z(a)) would be unique). (ii) No element of NE₃(a) can be ≺₃–comparable to another.

# In–plane structure and a cross–plane propagation lemma

For a fixed level δ, write NE₃(a)[z=δ]:= {q∈NE₃(a): z(q)=δ}. Inside this plane treat x,y as in d=2.

Definition (In–plane partially row–good at level δ). A pair b₁,b₂∈NE₃(a)[z=δ] on the same row y=β with x(b₁)<x(b₂) is partially row–good in the plane if:
- (PR1₂D) within z=δ, b₁,b₂ are the last two points on row β (second–rightmost/rightmost in x);
- (PR2₂D) within z=δ, every other point q with y(q)≥β satisfies x(q)<x(b₁).
This is exactly Definition 2.6 applied to the 2D set NE₃(a)[z=δ], ignoring z.

Observation (existence of a starting in–plane pair). If NE₃(a)[z=δ] contains at least two points, then there exists an in–plane partially row–good pair: take the topmost row β in that plane that has at least two points, and pick the two rightmost on that row; (PR1₂D),(PR2₂D) hold by construction inside the plane.

Lemma (Cross–plane propagation via (++−)). Assume (H), let a be lex–max eligible, and let δ be a z–level with NE₃(a)[z=δ]≠∅. If there is a lower z–level
  γ:= max{z′<δ: NE₃(a)[z=z′]≠∅},
then for any in–plane partially row–good pair b₁,b₂∈NE₃(a)[z=δ] on row β with x(b₁)<x(b₂), there exist two points c₁,c₂∈NE₃(a)[z=γ] with
  x(c_i)>x(b₁) and y(c_i)>y(b₁), i=1,2.

Proof. Consider the (++−) color with parameters (α,β,γ)=(x(b₁),y(b₁),γ). By the multiplicity formula,
  N_{++−}(α,β,γ)= r_z(α,β;γ)· s_{xy}(α,β;γ).
Because γ is the immediate lower level below δ supporting NE₃(a), there are no points with z∈(γ,δ) in NE₃(a); on level z=δ, the fibre {(x,y)=(α,β)} contains exactly b₁; there is no level above δ in NE₃(a). Hence r_z(α,β;γ)=1. Under (H) the color cannot be unique, so s_{xy}(α,β;γ)≥2, i.e., there are at least two points on z=γ with x>α and y>β. These are c₁,c₂.

Remark (why no extra in–plane hypothesis is needed). The argument uses only: (i) δ is a top level above γ within NE₃(a), and (ii) the (++−) identity. No further in–plane exclusions are needed to certify r_z=1.

# Example illustrating an obstacle for naive iteration

Even with the propagation lemma, an attempt to iterate plane–by–plane may fail if vertical duplicates occur (same (x,y) at multiple z). For instance, take U consisting of the three points
  p₁=(2,2,4), p₂=(3,3,3), p₃=(2,2,2).
For a=(1,1,1), NE₃(a)={p₁,p₂,p₃}. The top plane is z=4 with a single point p₁, so we would start instead at z=3 with only p₂. Moving down to z=2 gives p₃ but note that (x,y)=(2,2) occurs at two z–levels (4 and 2). If at some step we select b₁′ with (α′,β′)=(2,2) on z=2 and attempt to push to γ=… there can be r_z(α′,β′;γ)≥2 (witnessed by p₁ and b₁′), allowing s_{xy} to drop to 1 without violating (H). This shows that a blind “always take the rightmost two” can stall. A refined selection (avoid columns that recur above) or an axis–switch is likely needed.

# Next steps toward a full 3D proof

- Axis–choice and dichotomy. In d=2 we proved a dichotomy (row–good or column–good) for a lex–max eligible point. In d=3 a plausible analogue is: for lex–max eligible a, at least one of the three coordinates admits a “plane–good” structure from which one can propagate strictly in that coordinate (using a one–minus type) until the lowest such plane. Formalize a 3–way dichotomy with in–plane partially good pairs on the top supporting plane for that coordinate.
- Selection rule to defeat vertical duplicates. Augment the in–plane selection to avoid picking b₁ whose (x(b₁),y(b₁)) appears at a higher plane. Under a mild combinatorial lemma (to be proved), either there are at least two “vertically unique” choices on the plane, or one can force a (+++) unique color earlier.
- Local cone–maximality. The 2D “cone–maximal implies local antichain” (used to apply dichotomy locally) has a verbatim 3D analogue. This should let us apply the dichotomy not only at the global lex–max a, but also at intermediate points produced by a horizontal/vertical/z–propagation, enabling the final “rightward–and–downward” termination as in d=2.
- No–eligible case in 3D. Generalize Lemma 6.5 (no eligible ⇒ unique color) by considering minimal supporting planes in each coordinate and applying the summed multiplicity for |J|=1,2 types. The 2D logic (“a duplicate at a higher level creates an NE–witness”) extends with the third coordinate checked.

# Rigorous statements ready to be integrated

1) Proposition (Multiplicity for any type T). With P(T),M(T),E(T) and m as above,
   N_T(m)=∑_{w∈[n]^{E(T)}} |{u∈U: u_P=m_P, u_E=w, u_M>m_M}| · |{v∈U: v_M=m_M, v_E=w, v_P>m_P}|.
   In particular for (+++) and (++−) we get the simplified formulas (all–plus; one–minus product).

2) Lemma (3D lex–max antichain). For a lex–max eligible a (w.r.t. (z,y,x) lex), NE₃(q)=∅ for all q∈NE₃(a).

3) In–plane starting pair. If a z–plane δ supports at least two points of NE₃(a), there exists an in–plane partially row–good pair b₁,b₂∈NE₃(a)[z=δ] (2D Definition (PR1),(PR2) applied inside the plane).

4) Lemma (Cross–plane propagation via (++−)). Under (H), if δ is a z–level with NE₃(a)[δ]≠∅ and γ<δ is the highest lower z–level supporting NE₃(a), then for any in–plane partially row–good pair b₁,b₂ on δ there exist c₁,c₂ on γ with x(c_i)>x(b₁), y(c_i)>y(b₁).

These items are independent, checkable steps. Items (1) and (4) give the key “product forcing” across z–levels; item (2) is the standard cone–maximality tool; item (3) furnishes a canonical starting pair inside a plane.

# Why useful here

- (1) supplies the exact multiplicity identities to invoke (H) quantitatively.
- (2) is the 3D analogue of Lemma 3.2 used throughout the 2D proof.
- (3)+(4) replicate the “partially good ⇒ propagation to the next level” engine, now across z–levels via the (++−) type, which carries the z–minimum in the color (so no cross–plane color collision occurs).

# Obstacles

- Vertical duplicates can make r_z>1 at subsequent steps, blocking the inference s_{xy}≥2 from (H). We either need a selection scheme to avoid such columns, or we must switch to another coordinate and propagate there.
- Slices with |J|=2 (one zero) generate colors that ignore one coordinate; uniqueness must then be certified globally via a cross–slice argument (as in 2D Lemma 6.5), which remains to be written in 3D.

# Proposed immediate next tasks for the verifier

- Incorporate Proposition “Multiplicity for any T” (with its proof) into proofs.md; this will be referenced repeatedly.
- Verify the cross–plane propagation lemma in full detail using the (++−) identity.
- Attempt to prove a small “vertical uniqueness or force (+++)” claim: on a top z–plane with at least two points, either there are two points whose (x,y) pairs do not occur on any higher plane (trivial here since topmost) and at least one of which does not occur on any lower plane, or else the all–plus color from some base triggers uniqueness.
- Explore toy counterexamples to refine the selection rule; the example above shows why a naive iteration may stall.

# End


=== Prover 3 Output ===

# Goal and plan
We seek an analogue of the 2D theorem for the 3D coloring c3 on V=[n]^3: every nontrivial U⊂[n]^3 spans an edge whose color appears exactly once in G[U]. I lay down a counting “dictionary” for all 13 types in 3D (anchored vs balanced cases), extract immediate corollaries that give uniqueness under simple witness conditions, and isolate a slicing lemma that lifts a 2D–unique color in a single z–plane to a 3D–unique color provided a mild “base isolation” holds. Then I outline a strategy to combine these ingredients toward the full 3D result.

Throughout, for a vertex p=(x,y,z) write
NE3(p):={q∈U: q_x>x, q_y>y, q_z>z}.
For a fixed z, let U_z={ (x,y): (x,y,z)∈U } and inside the slice define
NE2^{(z)}(x,y):= { (x',y')∈U_z: x'>x, y'>y }.
Similarly, for a fixed pair (y,z) let the x–fiber U_{y,z}={x: (x,y,z)∈U}, and analogously for other pairs.


Ideas: anchored vs balanced types and multiplicity formulas

Fix a type T, whose support J(T)⊆{x,y,z} is the set of coordinates where the endpoints differ, and whose sign pattern is taken up to global negation. I call T anchored if, on J(T), all nonzero signs are equal (so one endpoint is simultaneously the minimizer on all of J(T)); otherwise balanced.

I. |J|=3 (all three coordinates differ)

• Anchored (+++ up to ±). Color is (T; α,β,γ) with (α,β,γ) the minima. Multiplicity:
Fact A3. For p=(α,β,γ), the number of edges of color (T;α,β,γ) equals 1_{p∈U}·|NE3(p)|.
In particular, uniqueness holds iff p∈U and |NE3(p)|=1.
Why useful: directly generalizes 2D Fact t1.

• Balanced with one minus, say (+,+,−) up to ±. Then the minima are α on x, β on y, and γ on z, but these minima belong to two different endpoints. Define
a_{xy|z}(α,β,γ):= #{ u∈U: x(u)=α, y(u)=β, z(u)>γ },
b_{z|xy}(α,β,γ):= #{ v∈U: z(v)=γ, x(v)>α, y(v)>β }.
Fact B3(+,+,−). The multiplicity equals a_{xy|z}(α,β,γ)·b_{z|xy}(α,β,γ).
Proof sketch: Each unordered pair is uniquely oriented (x,y increase, z decreases). Then min x,y are realized at u with (α,β,·) and min z at v with (·,·,γ); this gives a bijection between edges of that color and pairs u,v as above. The other two one-minus patterns are analogous with the obvious relabeling.
Why useful: reduces multiplicity to a product of two independent counts across perpendicular fibers, mirroring 2D Fact t2.

II. |J|=2 (one coordinate equal, say z equal)

Within each z–slice we are back in 2D. Let T_xy^= denote a type supported on {x,y} with z equal.

• Anchored (same sign on x,y). Color is (T_xy^=; α,β). Multiplicity:
Fact A2(z–slices). The total number of edges of this color equals
∑_{z=1}^n 1_{(α,β,z)∈U} · | NE2^{(z)}(α,β) |.
Why useful: decomposes across z–slices; anchored forces a base vertex (α,β,z) inside the slice.

• Balanced (opposite sign on x,y). Color is (T_xy^=; α,β). Put, for each z,
r^{(z)}(α,β):= #{ (α,y,z)∈U: y>β },  s^{(z)}(α,β):= #{ (x,β,z)∈U: x>α }.
Fact B2(z–slices). The multiplicity equals ∑_{z=1}^n r^{(z)}(α,β)·s^{(z)}(α,β).
Why useful: again a product structure per slice, then summed over slices.

The two other choices of the equal coordinate are symmetric.

III. |J|=1 (only one coordinate differs)

Say J={x}, y and z are equal. Color is (T_x; α) with α=min x. Define for each pair (y,z)
t_{y,z}(α):= #{ x>α: (x,y,z)∈U }.
Fact A1. The multiplicity equals ∑_{(y,z)} 1_{(α,y,z)∈U} · t_{y,z}(α).
Symmetric statements hold for J={y} and J={z}.
Why useful: reduces to 1D counts on lines (fibers).


Examples (sanity checks)

1) Two points u=(1,1,2), v=(2,2,1). Type is (+,+,−) up to ± with minima (α,β,γ)=(1,1,1). Here a_{xy|z}=#{(1,1,2)}=1 and b_{z|xy}=#{(2,2,1)}=1, hence multiplicity is 1.

2) Anchored |J|=2 within a fixed z. Let U_{z0} contain p=(α,β,z0) and exactly one q=(x',y',z0) with x'>α,y'>β; assume no (α,β,z) exists for z≠z0. Then Fact A2 gives multiplicity 1 (one from z0, zero from other slices).


Rigorous lemmas extracted (immediate consequences)

Lemma 1 (anchored 3D win). If there exists p∈U with |NE3(p)|=1, then G[U] has a unique color, namely the anchored |J|=3 color (T=+++ up to ±) with minima at p.
Proof: Fact A3.

Lemma 2 (anchored 2D-in-slice lift). Fix z0 and suppose there exist α,β with (α,β,z0)∈U and |NE2^{(z0)}(α,β)|=1, and furthermore (α,β,z)=∉U for all z≠z0. Then the |J|=2 anchored color (x,y change, z equal) with minima (α,β) appears exactly once in G[U].
Proof: Fact A2 gives multiplicity 1 at z0 and 0 at z≠z0.

Lemma 3 (balanced 3D product). For (+,+,−) up to ±, if a_{xy|z}(α,β,γ)=s=b_{z|xy}(α,β,γ)=1, then the corresponding color is unique in G[U].
Proof: Fact B3.

Remark (what each lemma buys): Lemma 1 is a direct 3D analogue of the 2D type–1 uniqueness trigger. Lemma 2 is a robust slicing tool: it turns a 2D anchored uniqueness inside one plane into a global uniqueness once the base pair (α,β) does not occur in other slices. Lemma 3 supplies a new 3D–only uniqueness mechanism (balanced |J|=3), unavailable in 2D.


Lex-maximal eligible points in 3D and a local antichain

Define a point a∈U to be 3D–eligible if NE3(a)≠∅. Order triples lex in (z,y,x). A lex–max among 3D–eligible points is any a maximizing (z(a),y(a),x(a)) among {p∈U: NE3(p)≠∅}.

Lemma 4 (3D lex antichain). If a is lex–max among 3D–eligible points, then NE3(q)=∅ for every q∈NE3(a).
Proof: If q∈NE3(a) had some r∈NE3(q), then r has (z(r),y(r),x(r))>(z(q),y(q),x(q))>(z(a),y(a),x(a)), so r would be 3D–eligible and lex–larger than a, a contradiction.

Corollary 4.1. If |NE3(a)|=1, Lemma 1 applies and we are done.

Obstacle: In 2D, Lemma 4 implied that NE(a) was an antichain for the 2D NE order and powered the row/column “propagation.” In 3D, Lemma 4 controls only the 3D–NE order (strict in all three coordinates). It no longer prohibits 2D–NE relations inside a fixed z–slice (z equal), so the exact 2D propagation cannot be transplanted verbatim.


A safe slicing lemma for anchored |J|=2 types

Definition (base–isolation in a slice). Call (α,β) isolated at z0 if (α,β,z0)∈U and (α,β,z)=∉U for all z≠z0.

Lemma 5 (slice-to-global uniqueness). Let z0 be any slice with |U_{z0}|≥2. If, inside the 2D graph on U_{z0} under the 2D coloring (types 1–4 as in the given 2D proof), there exists an anchored type–1 edge from a base (α,β) with |NE2^{(z0)}(α,β)|=1 and (α,β) isolated at z0, then G[U] has a unique color (the |J|=2 anchored xy–type with minima (α,β)).
Proof: Precisely Lemma 2.

Remark. The 2D theorem guarantees some unique color in U_{z0}, but it may be of type 2 (opposite signs) or a horizontal/vertical type, which is not directly safe to lift. Lemma 5 requires specifically a type–1 (anchored) uniqueness in the slice plus isolation of its base pair across slices.


Why these are useful here

• The counting dictionary provides exact multiplicities for every color, turning the global uniqueness goal into concrete witness conditions, particularly the “=1” triggers in Facts A3, B3, A2, B2, A1.

• Lemmas 1–3 enumerate three disjoint mechanisms that force a unique color: a 3D anchored NE–singleton, a 3D balanced one–minus product singleton, and an anchored 2D singleton safely lifted from a slice. Each can be checked locally (around one vertex, two perpendicular fibers, or one slice) and is independent of the rest of the graph.

• Lemma 4 gives a disciplined way to pick a distinguished point a at which either Lemma 1 applies immediately (|NE3(a)|=1) or one tries to organize “propagation” or a slice attack.


Obstacles identified

1) Direct 2D propagation does not lift: Lemma 4 does not prevent 2D–NE comparabilities in a fixed z–slice, so the geometric exclusions used in the 2D propagation (e.g., “c1 cannot be left of b2 else b2∈NE(c1)”) need genuine 3D replacements.

2) Lifting a 2D unique color from a slice is not automatic: horizontal/vertical (|J|=1 in 3D) and balanced slice–types (|J|=2 opposite signs) can easily be replicated in other slices since the 3D color omits the equal coordinate’s value. Hence isolation is needed (Lemma 5) or a different mechanism (Lemma 3).


Concrete next steps

Step A (balanced 3D trigger). Prove a 3D analogue of the 2D “propagation” but aimed at balanced |J|=3 colors via Fact B3: starting from a lex–max 3D–eligible a, either we find q with |NE3(q)|=1 (Lemma 1), or we locate (α,β,γ) with a_{xy|z}=b_{z|xy}=1 (or a symmetric variant), producing a unique balanced |J|=3 color (Lemma 3). The product structure is promising for a forcing argument because “no uniqueness” compels at least a second witness on one factor, which can be pushed to create a third on the other factor, leading to a contradiction with a suitable extremal choice (to be formalized).

Step B (slice anchoring). Inside any slice U_{z0} with ≥2 points, the 2D proof actually constructs an anchored unique color (type 1 or a horizontal/vertical), not necessarily type 2. Isolate the case when the slice’s unique color is type 1, and combine it with base–isolation across slices (Lemma 5). If no slice admits such an isolated base (α,β), set up a descending chain of z–levels forced by “non-uniqueness elsewhere” and show it cannot continue indefinitely.

Step C (fiber sparsity for |J|=1). Use Fact A1 to show: if some line fiber U_{y,z} has exactly two x–points α<α' and no other line fiber contains α, then the color (T_x; α) is unique. Search for such sparse fibers via a simple extremal argument (e.g., fix α minimal appearing in any fiber; if it appears in exactly one fiber, we are done; otherwise try to leverage the repetitions to produce a balanced |J|=3 singleton using Step A).


Small verifiable claims to extract now

Claim 6 (complete multiplicity dictionary). The analogues of Facts A3/B3/A2/B2/A1 hold for every permutation of coordinates and for every sign class in |J|=3 balanced (exactly one minus), |J|=2 anchored/balanced, and |J|=1 anchored. The proofs are routine variants of the two model proofs above (anchored counts by anchoring at a base vertex/fiber; balanced counts factorize into a product along two perpendicular fibers), and the verifier can fill in the symmetric cases.

Claim 7 (two quick-win criteria). If (i) there exists p with |NE3(p)|=1, or (ii) there exist α,β,γ with a_{xy|z}(α,β,γ)=b_{z|xy}(α,β,γ)=1, then G[U] contains a uniquely colored edge under c3.

Claim 8 (safe slice lifting). If some slice z0 contains a 2D–type–1 unique edge with base (α,β) that is isolated across slices, then G[U] has a unique color under c3 (anchored |J|=2 on x,y with z equal).


Summary

• I established explicit and general multiplicity formulas in 3D for all relevant type classes. These reduce uniqueness to checking simple local counts (NE–sizes for anchored, and products of independent counts for balanced types).

• Immediate uniqueness mechanisms (anchored 3D, balanced 3D, and slice-anchored 2D) are isolated as lemmas, with short proofs. These are testable on instances and will be useful subroutines in the full argument.

• The main obstacle to porting the 2D proof is that the 3D lex–antichain blocks only strict 3D increases, not 2D increases inside a slice. I outlined two viable routes: a new “balanced–type propagation” using the product counts (Step A), and a “slice anchoring” strategy combining 2D anchored uniqueness with cross-slice isolation (Step B), plus a fiber–sparsity fallback for |J|=1 (Step C).

The next round will formalize Step A: a propagation lemma for the balanced (+,+,−) class modelled on Fact B3, and a dichotomy showing that a lex–max 3D–eligible a either triggers Lemma 1 or forces a product–singleton as in Lemma 3. This would settle the 3D statement or at least prove a substantial special case.