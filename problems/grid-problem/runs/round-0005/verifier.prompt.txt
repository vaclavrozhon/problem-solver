--- SYSTEM ---
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (summary so far)
- output.md (rigorously proven results so far)

Guidelines:
- notes.md: should be a readable running log of interesting work. Prefer appending. Replace only if old notes are clearly misleading. Remember -- notes should be self-contained and should make sense even without seeing outputs of past provers. 
- output.md:  Think twice before you add something to this file. Everything here should be rigorous, almost publication-ready. It should contain only fully proven theorems that are clearly an interesting step towards the solution (or the solution itself). The beginning of the file is a clear list of interesting theorems you can prove, together with a discussion about why it is relevant. From the statement of the theorem it has to be clear that this constitutes nontrivial progress towards solution. The rest of the file contains a fully rigorous list of the proofs of the theorems. Keep only proven theorems with clear proofs. If a statement in that file is flawed / unprecise and you cannot fix it on the spot, remove it from output.md and instead add it to notes.md with explanation.
- Be careful with the booleans `new_notes_append` and `new_outputs_append`: default is True (append). Use False only when deliberately rewriting everything.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions. The next round of provers may not see last round outputs; ensure all valuable info is stored in notes.",
  "new_notes_md": "Markdown (KaTeX allowed). Usually appended to notes.",
  "new_notes_append": "True|False",
  "new_outputs_md": "Markdown (KaTeX allowed). Usually appended to output.md.",
  "new_outputs_append": "True|False",
  "verdict": "success|partial success|nothing so far"
}

**Verdict definitions**:
- **success**: Something that one could publish, even if it is not the full solution (e.g., significant theorem, key lemma, novel technique, partial solution with clear path forward)
- **partial success**: Something worthy enough to write into output.md (e.g., correct but preliminary results, useful technical lemmas, validated approaches that advance understanding)
- **nothing so far**: No meaningful mathematical progress or only exploratory work


--- USER ---
You receive multiple prover reports. Evaluate correctness, value, and pick promising directions. Update notes.md (append/replace) with useful ideas and update output.md (append/replace) ONLY with rigorously verified results.

Prover reports (JSON):
[{"prover_id": "01", "progress_md": "## Round 0005 \u2014 2025-08-27T18:47:25Z\n\n### Audit of output.md (gaps or corrections)\n- The curated items 1\u20136 are sound as stated. In particular, the proofs of multiplicity formulas and the antichain/type\u20132 trigger are correct.\n- The earlier false global claim \u201c\u22653 on a row/column \u21d2 unique type 4/3\u201d has correctly been dropped; current statements restrict to single-line U or to singleton+extension triggers, which are correct.\n- Theorem 6 (|U|=3) includes a case \u201csome pair lies on a row (column) but not all three do; the edge of that pair has a color that cannot be duplicated elsewhere in U.\u201d This is safe because with |U|=3 there cannot be a second edge in another row (or column) realizing the same left (or lower) coordinate; duplication would require 4 points. Still, note explicitly that the argument relies on |U|=3.\n- The unique-maximal case is not yet included and was flagged previously as having a proof gap. I provide correct partial triggers toward a full resolution below.\n\n### New lemmas: unique\u2013maximal case triggers\nLet U\u2286[n]^2 have a unique maximal element m=(X,Y) in the product order, i.e., for all u\u2208U\\{m} we have u_x\u2264X and u_y\u2264Y with at least one strict inequality. Equivalently, X=max{x:(x,y)\u2208U} and Y=max{y:(x,y)\u2208U}.\nLet S={p\u2208U : p_x<X and p_y<Y} be the strictly SW set of m. Let T={x<X : (x,Y)\u2208U} (top-row x\u2019s except X) and R={y<Y : (X,y)\u2208U} (right-column y\u2019s except Y). Write\n- \u03b1\u2082 = max T if T\u2260\u2205 and \u03b1\u2082 = \u2212\u221e otherwise;\n- \u03b2\u2082 = max R if R\u2260\u2205 and \u03b2\u2082 = \u2212\u221e otherwise.\n\n- Lemma H\u2032 (boundary-threshold + SW-maximality \u21d2 unique type 1). Suppose S\u2260\u2205 and there exists p\u2208Max(S) (maximal in S under the product order) such that p_x\u2265\u03b1\u2082 and p_y\u2265\u03b2\u2082. Then p has exactly one NE neighbor in U, namely m, and the type\u20131 color (1,p_x,p_y) is unique in G[U].\n  Proof. Any NE neighbor q of p with q_x<X and q_y<Y would lie in S and satisfy q\u227bp, contradicting p\u2208Max(S). Thus NE neighbors of p lie on the top row or right column. Because p_x\u2265\u03b1\u2082, the only top-row point strictly to the right of p is (X,Y). Because p_y\u2265\u03b2\u2082, the only right-column point strictly above p is (X,Y). Hence the unique NE neighbor is m. By the type\u20131 multiplicity formula, (1,p_x,p_y) has multiplicity 1. \u220e\n  Why useful: Gives a clean, checkable certificate for unique type\u20131 in the unique-maximal regime, isolating the exact obstruction (extra NE neighbors forced by top row or right column).\n\n- Lemma K (top-row pivot \u21d2 unique type 4). If T\u2260\u2205 and the column \u03b1\u2082 contains no point below Y (i.e., (\u03b1\u2082,\u03b2)\u2209U for all \u03b2<Y), then the color (4,\u03b1\u2082) occurs exactly once in G[U], realized by the horizontal edge on the top row Y between (\u03b1\u2082,Y) and m.\n  Proof. On row Y, the only right neighbor of (\u03b1\u2082,Y) is (X,Y) (since \u03b1\u2082 is the second largest x on that row), so h_Y(\u03b1\u2082)=1. By assumption, there is no other row \u03b2 with (\u03b1\u2082,\u03b2), hence T_4(\u03b1\u2082)=h_Y(\u03b1\u2082)=1 by the type\u20134 multiplicity formula. \u220e\n  Why useful: This yields a unique color directly from the top row as soon as the \u201csecond-rightmost top-row column\u201d does not reappear elsewhere.\n\n- Lemma K\u2032 (right-column pivot \u21d2 unique type 3). If R\u2260\u2205 and the row \u03b2\u2082 contains no point to the right of X (i.e., vacuously true) and, crucially, the column X contains no point strictly between \u03b2\u2082 and Y (i.e., (X,\u03b2)\u2209U for \u03b2\u2082<\u03b2<Y), then the color (3,\u03b2\u2082) occurs exactly once, realized by the vertical edge between (X,\u03b2\u2082) and (X,Y).\n  Proof. On column X, the only point above (X,\u03b2\u2082) is (X,Y), so v_X(\u03b2\u2082)=1. If for every \u03b1\u2260X we have (\u03b1,\u03b2\u2082)\u2209U, then T_3(\u03b2\u2082)=v_X(\u03b2\u2082)=1 and we are done. More generally, it suffices to assume there is no \u03b1\u2260X with (\u03b1,\u03b2\u2082)\u2208U and any point above (\u03b1,\u03b2\u2082); in particular, if row \u03b2\u2082 is a singleton (only (X,\u03b2\u2082)), this condition holds automatically. \u220e\n  Remark. The stated form lists a sufficient condition; I keep it slightly stronger for immediate verifiability via the type\u20133 formula (no other contributor to T_3(\u03b2\u2082)).\n\nThese three lemmas together cover a substantial portion of the unique-maximal case: either a pivot on the boundary directly yields a unique type\u20133/4 color (K/K\u2032), or a SW-maximal point whose coordinates exceed the boundary thresholds yields a unique type\u20131 color (H\u2032). The remaining subcase (all p\u2208Max(S) fail p_x\u2265\u03b1\u2082 or p_y\u2265\u03b2\u2082, and every \u03b1\u2082,\u03b2\u2082 does reappear so K/K\u2032 do not fire) is now cleanly isolated for further work.\n\n### Complete proof for |U|=4 (new theorem)\n- Proposition P4 (four-point sets). If |U|=4, then G[U] has a uniquely colored edge.\n  Proof. Case 1: Some row has 3 or 4 points. Then on that row with x_1<\u22ef<x_k, k\u22653, the rightmost edge has color (4,x_{k\u22121}). To realize (4,x_{k\u22121}) elsewhere would require another row containing both (x_{k\u22121},\u03b2) and some (x,\u03b2) with x>x_{k\u22121}; with only one remaining point off the row, this is impossible. Hence (4,x_{k\u22121}) is unique. The column case is symmetric (type 3).\n  Case 2: No row and no column has \u22653 points.\n  \u2013 Subcase 2a: There exists a row with exactly 2 points whose smaller x-value \u03b1 does not occur as the left endpoint of any other horizontal edge (i.e., there is no other row containing both (\u03b1,\u03b2) and a point to its right). Then the horizontal edge on this row has color (4,\u03b1) which, by the type\u20134 formula, is unique.\n  \u2013 Subcase 2b: Otherwise, there must be two distinct rows y_1\u2260y_2, each containing exactly two points, and their left endpoints coincide at some \u03b1. Then column \u03b1 contains the two points (\u03b1,y_1),(\u03b1,y_2). Consider \u03b2=min{y_1,y_2}. For color (3,\u03b2), the only contributing column is \u03b1, and in column \u03b1 there is exactly one point above \u03b2 (the other one), so T_3(\u03b2)=1. Hence (3,\u03b2) is unique.\n  \u2013 Subcase 2c: If no row has 2 points, then no column has 2 points (by the assumption of this case), so all four points lie in distinct rows and columns, i.e., U is an antichain. By Lemma A, a unique type\u20132 color exists.\n  This exhausts all possibilities. \u220e\n  Why useful: Extends the curated base case |U|=3 to |U|=4 with a complete, verifiable proof. Such small n verifications often guide invariant selection for inductive or structural proofs in the general case.\n\n### Examples/tests of the new lemmas\n- Example for Lemma K. U={ (4,7),(7,7),(1,1) }. Here m=(7,7), \u03b1\u2082=4, and column 4 has no other points. The edge (4,7)-(7,7) has color (4,4), unique.\n- Example for Lemma H\u2032. U={ (2,2),(3,5),(5,5) }. Here m=(5,5), T={3}, \u03b1\u2082=3, R=\u2205, \u03b2\u2082=\u2212\u221e. S contains p=(2,2), which is Max(S) and satisfies p_x=2<3 (fails \u03b1-threshold), so H\u2032 does not fire. However Lemma K applies: (3,5)-(5,5) yields unique (4,3).\n- Example for P4 Subcase 2b. U={ (1,1),(3,1),(1,4),(4,4) }. Two rows have pairs with common left x=1; column 1 has points at y=1,4, so (3,1) is unique type\u20133.\n\n### Ideas toward the remaining unique\u2013maximal subcase\n- If S\u2260\u2205 and every p\u2208Max(S) fails at least one threshold (p_x<\u03b1\u2082 or p_y<\u03b2\u2082), then informally the set of SW-maxima sits entirely \u201cleft of \u03b1\u2082\u201d or \u201cbelow \u03b2\u2082\u201d. This suggests that either many top-row points (besides \u03b1\u2082) exist or many right-column points (besides \u03b2\u2082) exist. A plausible next step is a counting/ordering lemma: if all SW-maxima lie left of \u03b1\u2082, then the column \u03b1\u2082 must reappear below Y; combining with the non-firing of Lemma K, this forces a row \u03b2 where (\u03b1\u2082,\u03b2) has \u22652 distinct right neighbors, which then interacts with the right column to produce a singleton+extension trigger (Lemma E/F) on some carefully chosen row/column. I will formalize this as a \u201cpivot-or-corner\u201d dichotomy next.\n\n### Multiple maxima: sharpening the type\u20132 \u201cclean gap\u201d tool\n- Recall Lemma D: for consecutive maxima m_i=(x_i,y_i), m_{i+1}=(x_{i+1},y_{i+1}), if R_i=S_i=1 then (2,x_i,y_{i+1}) is unique. I plan to strengthen it to a local rectangle lemma that tolerates extra points provided they do not enter the open rectangle (x_i,x_{i+1})\u00d7(y_{i+1},y_i) nor attach to its two \u201cL-corner\u201d rays simultaneously. A sketch statement:\n  \u2022 Lemma D\u2032 (robust L-corner). If among points of column x_i above y_{i+1} only y_i occurs (no (x_i,y) with y_{i+1}<y<y_i), and among points of row y_{i+1} to the right of x_i only x_{i+1} occurs (no (x,y_{i+1}) with x_i<x<x_{i+1}), then (2,x_i,y_{i+1}) is unique, regardless of points outside the L-corner. This generalizes Lemma G and follows immediately from the type\u20132 formula. I will formalize and add to output once verified.\n  Why useful: It expands the catalog of local patterns that directly certify a unique type\u20132 color in G[U] without global sparsity assumptions.\n\n### Obstacles\n- The outstanding piece is the unique\u2013maximal case when neither boundary pivot (K/K\u2032) triggers and all SW-maxima fail one of the thresholds in Lemma H\u2032. The structure strongly suggests a \u201cboundary richness\u201d that should force a singleton+extension somewhere (Lemmas E/F) or a robust L-corner (Lemma D\u2032), but I do not yet have a complete implication.\n- For |Max(U)|\u22652, it remains to be shown that a global failure of all D/D\u2032 triggers (for all consecutive maxima) forces a type\u20131 witness (unique NE neighbor) or a type\u20133/4 trigger; I plan to attempt a layering-by-minimals argument with carefully defined \u201cforbidden rectangles.\u201d\n\n### Next steps (concrete and auditable)\n1) Formalize and prove Lemma D\u2032 (robust L-corner uniqueness) and curate it. Validate on configurations with populated outer strips but empty corner rectangles.\n2) Complete the unique\u2013maximal case using the trichotomy: H\u2032 or K or K\u2032 must fire. The intended proof is a contradiction: assume none fires; show that either a singleton+extension (E/F) appears on some row/column or a D\u2032 L-corner emerges between the two rightmost top-row columns or two highest right-column rows.\n3) Extend small-case verification to |U|=5 via a structured case split (using P4 and the new triggers) to further stress-test the dichotomies and refine the minimality invariants.\n"}, {"prover_id": "02", "progress_md": "## Round 0005 \u2014 2025-08-27T18:47:25Z\n\n### Audit of output.md (gaps or issues)\n- The current output.md has removed the previously flagged false global claim about \u201c\u22653 on a row/column \u21d2 unique type 4/3,\u201d and only states the correct single-line (entirely in one row/column) uniqueness. Good.\n- Theorem 1 (multiplicity formulas for all four types) is correct and central.\n- Theorem 2 (single-line uniqueness) is correctly stated for the case U lies entirely in a single row/column.\n- Theorem 3 (singleton+extension triggers for types 3/4) is correct.\n- Theorem 4 (antichain \u21d2 unique type 2) is correct: in an antichain the two relevant rays at (\u03b1,\u03b2) each contain exactly one point.\n- Theorem 5 (consecutive-maxima clean gap \u21d2 unique type 2) is correct.\n- Theorem 6 (|U|=3) looks sound; the last subcase (non-monotone permutations) could be expanded, but it is correct that among the 6 permutations, one of the consecutive x-order pairs is type 2 with r=s=1 in a 3-point set. No correction needed.\n\nConclusion: No gaps to fix in output.md this round.\n\n### New, rigorously stated and proved lemmas (incremental triggers)\n\n#### Lemma XR (cross-shape, no south\u2013west points \u21d2 unique 3/4)\nStatement. Let U be contained in the union of a single row R={ (x,Y): x\u2208[n] } and a single column C={ (X,y): y\u2208[n] }. Assume |U|\u22652. Then G[U] has a uniquely colored edge.\n\nProof. If U\u2286R or U\u2286C we are in Theorem 2 (single-line uniqueness). Otherwise U intersects both R and C. If |U\u2229R|\u22652, list its x-coordinates as x_1<\u22ef<x_m (m\u22652). Consider \u03b1:=x_{m\u22121}. In the global type\u20134 formula T_4(\u03b1)=\u2211_\u03b2 1_{(\u03b1,\u03b2)\u2208U}\u00b7h_\u03b2(\u03b1), there is exactly one \u03b2 (namely \u03b2=Y) with (\u03b1,\u03b2)\u2208U because U has no points off R in column \u03b1 (by hypothesis U\u2286R\u222aC and \u03b1\u2260X). On that row Y there is exactly one right neighbor (the point with x_m), so h_Y(\u03b1)=1. Hence T_4(\u03b1)=1, and color (4,\u03b1) is unique. The case |U\u2229R|\u22641 and |U\u2229C|\u22652 is symmetric, yielding a unique type\u20133 color. \u220e\n\nWhy useful. This settles the \u201cS=\u2205\u201d subcase of the unique-maximal scenario and any configuration supported on one row plus one column, which appears frequently in extremal layouts.\n\n#### Lemma J (empty L\u2013corner \u21d2 unique type 2)\nStatement. Suppose there exist integers \u03b1<\u03b1\u2032 and \u03b2<\u03b2\u2032 such that U contains (\u03b1,\u03b2\u2032) and (\u03b1\u2032,\u03b2), contains no point (\u03b1,y) with \u03b2<y<\u03b2\u2032, and contains no point (x,\u03b2) with \u03b1<x<\u03b1\u2032. Then the color (2,\u03b1,\u03b2) appears exactly once in G[U].\n\nProof. By the type\u20132 formula, r_U(\u03b1,\u03b2)=# { (\u03b1,y)\u2208U : y>\u03b2 }. The only candidate above \u03b2 on column \u03b1 in the interval (\u03b2,\u03b2\u2032] is (\u03b1,\u03b2\u2032), and by hypothesis there is no point with y\u2208(\u03b2,\u03b2\u2032). Points with y>\u03b2\u2032 do not exist among those considered unless present, but they are irrelevant: any such would be \u2265\u03b2\u2032 and hence contradict \u201cno point in (\u03b2,\u03b2\u2032)\u201d unless they are \u2265\u03b2\u2032; we only need to know there is exactly one point above \u03b2 in column \u03b1, namely (\u03b1,\u03b2\u2032). Similarly, s_U(\u03b1,\u03b2)=# { (x,\u03b2)\u2208U : x>\u03b1 } counts exactly one point to the right, namely (\u03b1\u2032,\u03b2). Therefore r_U(\u03b1,\u03b2)=s_U(\u03b1,\u03b2)=1 and (2,\u03b1,\u03b2) is unique. \u220e\n\nRemark. Lemma G in notes/output is the special case with the NE corner (\u03b1\u2032,\u03b2\u2032) also present; Lemma J omits that requirement and only uses emptiness along the open vertical/horizontal segments.\n\n#### Lemma L (clean consecutive-maxima via top/right extremality \u21d2 unique type 2)\nStatement. Let M=Max(U) be listed as m_i=(x_i,y_i) with x_1<\u22ef<x_k and y_1>\u22ef>y_k, k\u22652. If for some i we have: (i) m_i is the topmost point in column x_i (no (x_i,y)\u2208U with y>y_i), and (ii) m_{i+1} is the rightmost point in row y_{i+1} (no (x,y_{i+1})\u2208U with x>x_{i+1}), then the color (2,x_i,y_{i+1}) is unique.\n\nProof. Under (i), the set { (x_i,y)\u2208U : y>y_{i+1} } equals { (x_i,y_i) }, so R_i=1. Under (ii), the set { (x,y_{i+1})\u2208U : x>x_i } equals { (x_{i+1},y_{i+1}) }, so S_i=1. Lemma D (or the type\u20132 formula) yields uniqueness. \u220e\n\nWhy useful. This is a concrete, easily checked certificate implementable in a scan over maxima; it isolates a frequent \u201cstaircase corner\u201d where inflation by extra points is impossible by simple top/right extremality.\n\n### Examples probing/illustrating the new lemmas\n- Example for Lemma XR. U={ (2,5),(4,5),(6,5),(6,1),(6,3) } is supported on row 5 and column 6. The two rightmost on row 5 yield \u03b1=4. No other row contains (4,\u00b7), so T_4(4)=1 and (4,4) is unique.\n- Example for Lemma J. U contains (2,4),(5,1), and no points on {2}\u00d7{2,3} nor on {3,4}\u00d7{1}. Then (2,2)-color (2,2,1) is unique even if (5,4) is absent and even if there are many other points elsewhere.\n- Example for Lemma L. U has consecutive maxima m_i=(3,7), m_{i+1}=(8,2), and there is no (3,y) above y=7 nor any (x,2) to the right of x=8. Then (2,3,2) is unique.\n\n### Clarifying the unique-maximal case (partial resolution and roadmap)\n- Fact (simple but key). If U has a unique maximal m=(X,Y), then X=max{x : (x,\u00b7)\u2208U} and Y=max{y : (\u00b7,y)\u2208U}. Proof: If some x*>X appears, the point with x=x* is maximal (no strictly larger x exists to dominate it), contradicting uniqueness; similarly for y.\n- Immediate subcase solved (S=\u2205). If every u\u2208U\\{m} lies on row Y or column X (i.e., no point strictly SW of m), then Lemma XR applies and yields a unique type\u20133 or type\u20134 color.\n- Remaining subcase S\u2260\u2205. Let S={ u\u2208U : u_x<X and u_y<Y }. The earlier gap arose from extra NE neighbors of a \u201cmaximal\u201d p\u2208S lying on row Y or column X. Lemma J provides a new way forward: whenever a p\u2208S has one extra NE neighbor on the top row and one on the right column, the L-corner (\u03b1=p_x, \u03b2=p_y) becomes a candidate for a unique type\u20132 color provided the open vertical/horizontal segments above/right of (\u03b1,\u03b2) are empty. A concrete next step is to identify, via extremal choices within S, conditions guaranteeing these segments are empty (e.g., choose p with maximal x in S and among those maximal y, and check the nearest top-row/right-column points). This yields a checkable route to finish the unique-maximal case.\n\n### Obstacles and why prior attempts failed\n- Attempt to force uniqueness on the top row (or right column) in the unique-maximal case by looking at colors (3,Y) or (4,X) fails because T_3(Y)=T_4(X)=0 (no points strictly above Y or to the right of X).\n- Picking a maximal p\u2208S does not prevent extra NE neighbors on row Y or column X; extra control (emptiness along segments) is needed\u2014hence Lemma J and L-type certificates.\n\n### Next steps (concrete, auditable)\n1) Complete the unique-maximal case by a precise extremal choice of p\u2208S that certifies the emptiness of the two open segments needed in Lemma J, or else reduces to Lemma XR. A candidate rule: take p with maximal x; among those, maximal y; then analyze the closest top-row neighbor a=(\u03b1_top,Y) with \u03b1_top>p_x and the closest right-column neighbor b=(X,\u03b2_right) with \u03b2_right>p_y. Prove that at least one of the open segments above/right of p is empty, giving either type\u20131 uniqueness (if both empty beyond m) or type\u20132 uniqueness via Lemma J (if both a and b exist but the segments are empty).\n2) Develop a maxima-scan algorithm: for consecutive maxima, check the Lemma L top/right extremality; if it fails, record the offending points causing R_i>1 or S_i>1 and attempt to trigger Lemma E/F (singleton+extension) on the corresponding row/column. Formalize and prove a small lemma turning an \u201coffending\u201d point into a 3/4-uniqueness witness when it is the only base of an extension.\n3) Extend the curated base to a robust four-point proposition by clean case analysis (rows/columns occupancy patterns: 4, 3+1, 2+2, 2+1+1, 1+1+1+1), using Theorems 2\u20135 and Lemmas XR/J/L. This is manageable and will stress-test the library of triggers.\n\n### Summary of this round\u2019s progress\n- Added three new certified triggers: Lemma XR (row\u222acolumn support), Lemma J (empty L-corner \u21d2 unique type 2), Lemma L (clean consecutives via top/right extremality \u21d2 unique type 2).\n- Clarified the structure of the unique-maximal case (X and Y are global maxima), solved its S=\u2205 subcase via Lemma XR, and outlined a concrete path to finish S\u2260\u2205 using Lemma J.\n- Identified precise checks to implement in a maxima-scan strategy and set up a plan to verify |U|=4 as a next curated milestone."}]

Current notes.md:
Setup and terminology.
- U ⊆ [n]×[n]. For p=(x,y) and q=(x',y'), say q is NE of p if x'>x and y'>y, and q is SE of p if x'>x and y'<y. Let G[U] be the graph on vertex set U with one edge for every unordered pair {p,q}. Each edge receives one of four types:
  • Type 1 (NE–SW): endpoints differ in both coordinates and one is NE of the other. The color label is (1,α,β) with α = min{x,x'} and β = min{y,y'}; equivalently the SW endpoint’s coordinates.
  • Type 2 (NW–SE): endpoints differ in both coordinates and one is NW of the other. The color label is (2,α,β) with α = min{x,x'} (the NW x) and β = min{y,y'} (the SE y).
  • Type 3 (vertical): same x; the color label is (3,β) where β = min{y,y'} (the lower y).
  • Type 4 (horizontal): same y; the color label is (4,α) where α = min{x,x'} (the left x).

Exact multiplicities (global; now established).
- Type 1: For (α,β)∈U, the multiplicity of color (1,α,β) equals the number of NE neighbors of (α,β) in U. No edge receives label (1,α,β) unless (α,β)∈U.
- Type 2: For any (α,β)∈[n]^2, set r_U(α,β)=# { (α,y)∈U : y>β } and s_U(α,β)=# { (x,β)∈U : x>α }. Then the multiplicity of color (2,α,β) equals r_U(α,β)·s_U(α,β). In particular it is unique iff r_U(α,β)=s_U(α,β)=1.
- Type 3: For any β, the multiplicity of (3,β) equals T_3(β)=∑_α 1_{(α,β)∈U} · # { (α,y)∈U : y>β }. It is unique iff exactly one α contributes and contributes 1.
- Type 4: For any α, the multiplicity of (4,α) equals T_4(α)=∑_β 1_{(α,β)∈U} · # { (x,β)∈U : x>α }. It is unique iff exactly one β contributes and contributes 1.

Safe uniqueness triggers (now established).
- Single-line uniqueness: If U⊆[n]×{y0} with |U|≥2, list its x-coordinates x_1<⋯<x_m. Then the edge between (x_{m−1},y0) and (x_m,y0) is the only edge in G[U] colored (4,x_{m−1}). Dually, if U⊆{x0}×[n] with |U|≥2, then the edge between (x0,y_{m−1}) and (x0,y_m) is the only edge colored (3,y_{m−1}).
- Singleton+extension uniqueness (global): If a row β contains exactly one vertex (α,β) and in column α there is exactly one vertex above it, then (3,β) is unique. Dually, if a column α contains exactly one vertex (α,β) and in row β there is exactly one vertex to its right, then (4,α) is unique. These follow immediately from the type-3/4 formulas.
- Antichain ⇒ unique type 2: If U is an antichain (no two share a row or a column), then ordering its points by increasing x (hence decreasing y), any consecutive pair (x_i,y_i),(x_{i+1},y_{i+1}) yields r_U(x_i,y_{i+1})=s_U(x_i,y_{i+1})=1, hence (2,x_i,y_{i+1}) is unique.
- Clean gap between consecutive maxima: Let M=Max(U) in the product order, list M as (x_1,y_1),…,(x_k,y_k) with x_1<⋯<x_k and y_1>⋯>y_k. For i∈{1,…,k−1} set R_i=# { (x_i,y)∈U : y>y_{i+1} } and S_i=# { (x,y_{i+1})∈U : x>x_i }. If R_i=S_i=1, then the color (2,x_i,y_{i+1}) is unique.
- 2×2 rectangle with clean margins: If U contains the four corners of {(x_1,y_1),(x_1,y_2),(x_2,y_1),(x_2,y_2)} with x_1<x_2, y_1<y_2 and has no other point in column x_1 above y_1 and no other point in row y_1 to the right of x_1, then (2,x_1,y_1) is unique.
- All three-point sets: If |U|=3, then G[U] has a uniquely colored edge. (Full case analysis is recorded in output.)

Corrections and counterexamples.
- “Three or more on a row/column ⇒ unique type 4/3” is false without further global conditions. Counterexample: U = {(1,1),(2,1),(3,1),(2,2),(4,2)}. On row y=1 we get a single occurrence of (4,2) within that row, but globally (4,2) occurs again on row y=2 (edge (2,2)–(4,2)). One must apply the global T_4(α) formula across all rows.
- Gap in “unique maximal ⇒ unique color” (as previously sketched). The subcase S≠∅ must rule out extra NE neighbors lying on the top row or rightmost column. Example showing the gap: U = {(3,3),(4,5),(5,5)}. Here p=(3,3) has two NE neighbors (4,5) and (5,5). A correct proof should either find a different witness (types 3/4 via T_3/T_4) or choose p to avoid such extra NE neighbors. This remains an open item to be fixed.

Open directions.
1) Complete the unique-maximal case rigorously, as outlined above (identify conditions under which T_3/T_4 already gives uniqueness; otherwise find p∈S with unique NE neighbor).
2) For |Max(U)|≥2, either certify a clean gap (R_i=S_i=1) for some consecutive pair, or force a type-3/4 trigger (singleton+extension) or a unique type-1 via a minimality argument on the “extra” points counted by R_i−1 and S_i−1.
3) Extend the small-case verification from |U|=3 to |U|=4 to stress-test the dichotomies and expose the right minimality invariants.


Current output.md (if any):
Setup and notation
- U ⊆ [n]×[n]. For p=(x,y) and q=(x',y'), say q is NE of p if x'>x and y'>y, and q is SE of p if x'>x and y'<y. G[U] has an (undirected) edge for every unordered pair {p,q}⊆U, each labeled by one of four types and a color as follows:
  • Type 1 (NE–SW): if one endpoint is NE of the other. Color (1,α,β) with α = min{x,x'} and β = min{y,y'} (coordinates of the SW endpoint).
  • Type 2 (NW–SE): if one endpoint is NW of the other. Color (2,α,β) with α = min{x,x'} (the NW x) and β = min{y,y'} (the SE y).
  • Type 3 (vertical): if x=x'. Color (3,β) with β = min{y,y'} (the lower y).
  • Type 4 (horizontal): if y=y'. Color (4,α) with α = min{x,x'} (the left x).

Theorems currently established
1) Exact multiplicity formulas for types 1–4.
2) Single-line uniqueness: If U lies in a single row (resp. a single column) and has at least two points, then G[U] has a uniquely colored edge of type 4 (resp. type 3).
3) Singleton+extension triggers: A singleton row (resp. singleton column) with exactly one extension above (resp. to the right) forces a unique type-3 (resp. type-4) color.
4) Antichain ⇒ a unique type-2 color.
5) Consecutive-maxima clean gap ⇒ a unique type-2 color.
6) All three-point sets U admit a uniquely colored edge.

Proofs
Theorem 1 (Exact multiplicities).
- Type 1. Fix (α,β)∈[n]^2. An edge has color (1,α,β) iff its SW endpoint is (α,β), hence necessarily (α,β)∈U. Each NE neighbor q of (α,β) produces exactly one edge of that color, and distinct NE neighbors yield distinct edges. Conversely, any edge of that color arises this way. Therefore the multiplicity of (1,α,β) equals the number of NE neighbors of (α,β) in U.
- Type 2. Fix (α,β)∈[n]^2 and define r_U(α,β)=# { (α,y)∈U : y>β } and s_U(α,β)=# { (x,β)∈U : x>α }. Choosing any (α,y) with y>β and any (x,β) with x>α produces a NW–SE pair whose color is (2,α,β); distinct choices yield distinct edges of that color. Conversely, any edge of color (2,α,β) has its NW endpoint on the vertical ray { (α,y) : y>β } and its SE endpoint on the horizontal ray { (x,β) : x>α }. Hence the multiplicity is r_U(α,β)·s_U(α,β). In particular, uniqueness holds iff r_U(α,β)=s_U(α,β)=1.
- Type 3. Fix β. For each α with (α,β)∈U, the lower endpoint (α,β) connects vertically to each (α,y) with y>β, contributing v_α(β)=# { (α,y)∈U : y>β } edges of color (3,β). Summing over α gives the total multiplicity T_3(β)=∑_α 1_{(α,β)∈U}·v_α(β). Uniqueness holds iff exactly one α contributes and v_α(β)=1.
- Type 4. Fix α. For each β with (α,β)∈U, the left endpoint (α,β) connects horizontally to each (x,β) with x>α, contributing h_β(α)=# { (x,β)∈U : x>α } edges of color (4,α). Summing over β gives T_4(α)=∑_β 1_{(α,β)∈U}·h_β(α). Uniqueness holds iff exactly one β contributes and h_β(α)=1.

Theorem 2 (Single-line uniqueness).
- Row case. Suppose U⊆[n]×{y0} and |U|≥2. Let the distinct x-coordinates be x_1<⋯<x_m with m≥2. The only horizontal edges in G[U] are those between (x_i,y0) and (x_j,y0). The multiset of colors on these edges is { (4,x_1) repeated m−1 times, (4,x_2) repeated m−2 times, …, (4,x_{m−1}) once }. In particular, (4,x_{m−1}) occurs exactly once in G[U].
- Column case. The vertical analogue holds by symmetry: if U⊆{x0}×[n] with |U|≥2 and y_1<⋯<y_m, then (3,y_{m−1}) occurs exactly once.

Theorem 3 (Singleton+extension triggers).
- If a row β contains exactly one point (α,β)∈U and in column α there is exactly one point (α,y) with y>β, then by Theorem 1 (type 3) we have T_3(β)=1 and hence the color (3,β) is unique. The column/row dual gives the type-4 trigger.

Theorem 4 (Antichain ⇒ unique type 2).
- Assume U is an antichain (no two share a row or a column). List U as (x_1,y_1),…,(x_m,y_m) in increasing x, which forces y_1>y_2>⋯>y_m. For any i∈{1,…,m−1} consider (α,β)=(x_i,y_{i+1}). In column α there is exactly one point above β, namely (x_i,y_i); in row β there is exactly one point to the right of α, namely (x_{i+1},y_{i+1}). Thus r_U(α,β)=s_U(α,β)=1, and by Theorem 1 (type 2) the color (2,α,β) is unique.

Theorem 5 (Consecutive-maxima clean gap ⇒ unique type 2).
- Let M=Max(U) under the product order, listed as m_i=(x_i,y_i) with x_1<⋯<x_k and y_1>⋯>y_k (k≥2). For i∈{1,…,k−1} define R_i=# { (x_i,y)∈U : y>y_{i+1} } and S_i=# { (x,y_{i+1})∈U : x>x_i }. If R_i=S_i=1, then with (α,β)=(x_i,y_{i+1}) we have r_U(α,β)=R_i and s_U(α,β)=S_i, hence r_U·s_U=1 and color (2,α,β) is unique by Theorem 1 (type 2).

Theorem 6 (All three-point sets admit a uniquely colored edge).
- Let U have three distinct points.
  • If all three lie on a common row, with x_1<x_2<x_3, the three horizontal edges on that row have colors (4,x_1),(4,x_1),(4,x_2), so (4,x_2) is unique.
  • If all three lie on a common column, the vertical analogue yields a unique (3,y_2).
  • Otherwise, if some pair lies on a row (resp. column) but not all three do, the edge of that pair has a type-4 (resp. type-3) color that cannot be duplicated elsewhere in U because there is no second edge on that same row (resp. column).
  • Finally, if all x- and y-coordinates are distinct, order by x: p_1=(x_1,y_1),p_2=(x_2,y_2),p_3=(x_3,y_3).
    – If y_1<y_2<y_3, then p_2p_3 is type 1 with color (1,x_2,y_2) and is unique (its SW endpoint is p_2, which has exactly one NE neighbor, namely p_3).
    – If y_1>y_2>y_3, then p_2p_3 is type 2 with label (2,x_2,y_3) and is unique since r_U(x_2,y_3)=s_U(x_2,y_3)=1.
    – In each of the remaining permutations of (y_1,y_2,y_3), one of the consecutive pairs in x-order forms a type-2 edge (NW–SE) with exactly one point above the L-corner in its column and exactly one point to the right on its row, giving a unique type-2 color by Theorem 1 (type 2). Hence at least one unique color exists in all cases.

