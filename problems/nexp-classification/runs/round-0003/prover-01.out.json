{
  "content": "# Ideas\n\n- Fix the flaw in the previous O(1)-test by incorporating residue/period constraints of the per-type period transition A_\u03c4 := M_\u03c4\u00b7E. The naive test via L_\u03c4 = \u22c3_{e\u2264\u03b2} diag(A_\u03c4^e) fails (parity counterexample) because it only guarantees some lengths, not all; O(1) requires feasibility for arbitrary block lengths k (\u2265 a constant). Use the graph-theoretic period (gcd of cycle lengths) of SCCs of A_\u03c4.\n- Provide an EXPTIME-decidable necessary-and-sufficient per-type criterion: an aperiodic SCC (period 1) yields eventual loops of all large lengths at its vertices. Combined with a constant-size bridging matrix condition across short types, this yields a correct EXPTIME O(1) test.\n- Keep the NEXPTIME middle-gap test as-is (with \u03c4_b,\u03c4_c\u2208R_K\u222aR_{K+1}). A full trichotomy in NEXPTIME follows by: if O(1) test passes \u21d2 O(1); else run middle-gap test \u21d2 \u0398(log* n) if accept, \u0398(n) otherwise.\n\n# Lemmas and corrected O(1) criterion\n\nLet E\u2208{0,1}^{\u03b2\u00d7\u03b2}, S_i diagonal (i\u2208{0,1}), M(w)=S_{i_1}\u00b7E\u00b7S_{i_2}\u00b7\u2026\u00b7E\u00b7S_{i_k}. For a \u201cperiod type\u201d \u03c4 with matrix M_\u03c4, define A_\u03c4 := M_\u03c4\u00b7E. For a short type \u03c3 with matrix M_\u03c3, define C_\u03c3 := E\u00b7M_\u03c3\u00b7E.\n\n- Lemma (eventual loops in aperiodic SCC). For any Boolean adjacency A on \u03b2 nodes and any node x in an SCC of period 1 (i.e., the gcd of all cycle lengths in that SCC equals 1), there exists N such that (A^m)[x,x]=1 for all m \u2265 N.\n  Why useful: if a long periodic block has type \u03c4 and we pick x in an aperiodic SCC of A_\u03c4, then regardless of the number k of periods (as long as k is large enough), we can realize a labeling with boundary output x on both ends of the block.\n\n- Definition (aperiodic boundary set). For \u03c4, compute the SCC decomposition of the digraph of A_\u03c4. Let L_\u03c4 := { x \u2208 \u03a3_out : x lies in an SCC of A_\u03c4 with period 1 }.\n\n- Lemma (bridging across short block). Let \u03c4_l,\u03c4_r be long-block types, \u03c3 a short-block type. If \u2203 x_l\u2208L_{\u03c4_l}, x_r\u2208L_{\u03c4_r} with C_\u03c3[x_l,x_r]=1, then for all sufficiently large long-block repetition counts, one can label the left and right long blocks to present boundary outputs x_l and x_r, respectively, and then label the short block to connect them locally.\n  Why useful: reduces each interface to a constant matrix check; together with the previous lemma ensures compatibility for arbitrary (large) repetition counts.\n\n- Theorem (EXPTIME decision for O(1) on oriented paths). There is a deterministic EXPTIME procedure that decides whether the problem is O(1):\n  1) Build the reachable type set T (|T|\u22642^{\u03b2^2}) and the length-filtered sets R_\u2113 for 1\u2264\u2113\u22642|T| (by iterating \u03b4(M,i)=M\u00b7E\u00b7S_i).\n  2) Let L_pattern=|T|, L_width=|T|. For every \u03c4\u2208R_{\u2264L_pattern}, compute L_\u03c4 via SCC periods of A_\u03c4. If L_\u03c4=\u2205 for some \u03c4, return \u201cnot O(1)\u201d.\n  3) For every triple (\u03c4_l,\u03c3,\u03c4_r) with \u03c4_l,\u03c4_r\u2208R_{\u2264L_pattern} and \u03c3\u2208\u22c3_{\u2113\u22642L_width} R_\u2113, compute C_\u03c3 and check \u2203 x_l\u2208L_{\u03c4_l}, x_r\u2208L_{\u03c4_r} with C_\u03c3[x_l,x_r]=1. If any triple fails, return \u201cnot O(1)\u201d. Otherwise, return \u201cO(1)\u201d.\n\nSketch of correctness. Necessity: If O(1), then every long periodic block type \u03c4 must be fillable for arbitrarily many repetitions k; hence some x admits loops for all large k, forcing x to lie in an aperiodic SCC (period=1), so L_\u03c4\u2260\u2205. Interfaces must be fillable for all separators \u03c3, hence the C_\u03c3 condition must hold for some choices x_l,x_r in those L_\u03c4 sets (apply replacement on long blocks to enforce those choices). Sufficiency: Construct the O(1) algorithm by the standard (L_width,L_count,L_pattern)-partition; in each long block of type \u03c4 choose any x\u2208L_\u03c4 and realize boundary x on both ends using the eventual-loop property; then at each short \u03c3 pick (x_l,x_r) satisfying C_\u03c3 and fill \u03c3 locally. All operations depend only on constant-radius choices.\n\nComplexity: Building T and R_\u2113 is 2^{O(\u03b2^2)}\u00b7poly(\u03b2). Each L_\u03c4 needs SCC and period computation (poly(\u03b2)). The universal triple check is |T|^3 many constant-size matrix queries. Overall EXPTIME in \u03b2.\n\n# Examples\n\n- 2-coloring parity obstruction (\u0398(log* n) on cycles): \u03a3_out={a,b}, E is the 2-cycle a\u2194b, Cin\u2013out admits both outputs on both inputs. For any \u03c4, A_\u03c4 has all SCCs of period 2, so L_\u03c4=\u2205. The test correctly rejects O(1).\n- Trivial labeling: E is all-ones, Cin\u2013out admits any output at either input. Each A_\u03c4 is primitive (aperiodic strongly connected), so every L_\u03c4=\u03a3_out. For any \u03c3, C_\u03c3 is all-ones, the interface check passes; the test accepts O(1).\n\n# Obstacles / checks\n\n- We must align the \u201cunit step\u201d consistently: a long block with k repetitions of w has boundary transfer (M_\u03c4\u00b7E)^k composed with a final M_\u03c4 or not? Our interface uses C_\u03c3=E\u00b7M_\u03c3\u00b7E between blocks. The choice A_\u03c4:=M_\u03c4\u00b7E ensures A_\u03c4^k represents k periods with the correct inter-period edge; the aperiodicity conclusion is unaffected by off-by-one constants.\n- We restrict long-block \u201cperiod types\u201d to \u03c4\u2208R_{\u2264L_pattern}; this covers all primitive-word periods exposed by the partition. Types that cannot appear as periods are irrelevant for the O(1) decision.\n\n# Middle gap (recap)\n\n- Keep the NEXPTIME certificate f_type : T\u00d7{00,01,10,11}\u00d7T\u2192\u03a3_out^2 and verify for \u03c4_b,\u03c4_c\u2208R_{K}\u222aR_{K+1} the scalar condition (E\u00b7M_{\u03c4_b}\u00b7E\u00b7M_{\u03c4_c}\u00b7E)[\u2113_2,r_1]=1 (EXPTIME check). If no such f_type exists, conclude \u0398(n).\n\n# Next steps\n\n1) Write the formal proofs for: (i) eventual-loop lemma; (ii) necessity of aperiodic SCCs per \u03c4; (iii) sufficiency via replacement and partition; and the exact alignment of products A_\u03c4^k and C_\u03c3 across interfaces.\n2) Implement the EXPTIME O(1)-test and integrate with the existing NEXPTIME middle-gap verifier. Validate on randomized \u03b2 and hand-crafted parity-like counterexamples.\n3) (Optional) Optimize by pruning \u03c4 that provably cannot arise as period types (e.g., by checking primitivity of representatives), though not needed for complexity bounds.\n\n# Conclusion\n\n- The corrected O(1)-test replaces the flawed per-type loop-set condition with an EXPTIME-checkable aperiodicity condition (period-1 SCCs of A_\u03c4) plus constant-size interface checks. This blocks the parity counterexample and matches the intuition that O(1) labeling needs boundary feasibility for all large repetition counts. Coupled with the existing NEXPTIME middle-gap test, this yields a full NEXPTIME trichotomy for \u03b2-normalized, radius-1 LCLs on oriented paths.\n"
}