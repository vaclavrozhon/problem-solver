
--- Page 1 ---
Non-trivial lower bound for 3-coloring
the ring in the quantum LOCAL model
François Le Gall and Ansis Rosmanis
Graduate School of Mathematics
Nagoya University
December 6, 2022
Abstract
We consider the LOCAL model of distributed computing, where in a single round of
communication each node can send to each of its neighbors a message of an arbitrary
size. It is know that, classically, the round complexity of 3-coloring an n-node ring
is Θ(log∗n). In the case where communication is quantum, only trivial bounds were
known: at least some communication must take place.
We study distributed algorithms for coloring the ring that perform only a single
round of one-way communication. Classically, such limited communication is already
known to reduce the number of required colors from Θ(n), when there is no commu-
nication, to Θ(log n).
In this work, we show that the probability of any quantum
single-round one-way distributed algorithm to output a proper 3-coloring is exponen-
tially small in n.
1
Introduction
Graph coloring is one of the most fundamental tasks considered in distributed computing
(see [BE13] for a recent introduction). The coloring of a ring is particularly well studied
and understood. While it is easy to see that 2-coloring an n-node ring requires exactly n/2
rounds for an even n and is impossible for an odd n, things are much more interesting for 3-
coloring. Cole and Vishkin presented a 1
2 log∗n+O(1) round algorithm for 3-coloring [CV86,
GPS88]. Linial [Lin92] showed the Cole–Vishkin algorithm to be optimal for deterministic
algorithms, and then Naor [Nao91] extended that lower bound to randomized algorithms.
The complexity of graph coloring is much less understood in the quantum setting due
to the diﬃculty of characterizing the power of quantum entanglement. While quantum
entanglement enables non-local correlations, it by itself does not enable communication.
This property is known as non-signaling, and Gavoille, Kosowski, and Markiewicz used it
to show that quantum distributed algorithms for 2-coloring require at least n/4 rounds of
communication [GKM09]. As for 3-coloring, up to the best of our knowledge, prior to the
1
arXiv:2212.02768v1  [quant-ph]  6 Dec 2022

--- Page 2 ---
current work no non-trivial bounds on the round complexity were known. Namely, it was
clear that at least some communication must take place, because a non-communicating
quantum node is no diﬀerent from a non-communicating classical node, but no more than
that was known.
We consider the LOCAL model introduced by Linial [Lin92, Pel00], where the band-
width of communication links is unlimited. We additionally assume that the ring is directed
and each node knows which of its two communication ports is for communicating with its
successor, and which for its predecessor. One can consider the standard, two-way model,
where the communication can go both along and against the direction of a directed link,
and the one-way model, where the messages can be sent only in the direction of the links
(see Figure 1).
standard, two-way model
one-way model
Figure 1: The standard and the one-way LOCAL models on the ring. The direction of links is
indicated by arrows (
), while the direction of communication is indicated by the direction of
the paper plane symbols.
We can observe that, due to node’s ability to forward its entire memory to its succes-
sor, every locally checkable labeling problem1 that can be optimally solved in r rounds in
the one-way model can be solved in ⌈r/2⌉rounds in the standard model, and no faster.
Thus, studying the one-way model can provide a more ﬁne-grained characterization of the
complexity of the problem. For example, r rounds of the standard model enable O(log(2r)n)-
coloring, while r rounds of the one-way model enable O(log(r)n)-coloring. This ﬁne-graining
also allows us to prove the ﬁrst non-trivial hardness result for quantum distributed algo-
rithms for 3-coloring:
Theorem 1. The probability that a single-round one-way quantum distributed algorithm
properly 3-colors an n-node ring is exponentially small in n; in particular, it is at most
(11
15)⌊n/10⌋.
The inspiration for our result is the observation that the uniform distribution over
all proper colorings exhibits some very long-range correlations, which we detail below in
1Essentially, a problem for which the correctness of a solution can be checked in a constant number of
rounds [NS95]. Coloring is clearly locally checkable.
2

--- Page 3 ---
Section 1.1.
We further observe that all proper colorings exhibit a certain correlation
between the distance between two randomly chosen nodes and whether these nodes have
the same color. We sketch this latter observation for an 11-node ring as an example in
Section 1.2, and we note that this observation leads to a weaker version of Theorem 1
having the bound (1382
1383)⌊n/16⌋instead of (11
15)⌊n/10⌋. Improving the base of the exponent
from (1382
1383)1/16 to (11
15)1/10 requires a more thorough inspection of random colorings that
may arise from quantum distributed algorithms. Here, in Section 1.3, we brieﬂy outline
that approach, as well as describe how it might help to address the case of multiple-round
distributed algorithms in the future.
1.1
Uniform coloring requires global communication
As discussed in the works by Gavoille, Kosowski, and Markiewicz [GKM09] and Arfaoui and
Fraigniaud [AF14], the non-signaling arguments, which are used to prove the hardness of
2-coloring in the quantum case, do not seem to be able to generalize the classical Ω(log∗n)
lower bound for 3-coloring [Lin92, Nao91] to the quantum case. To formally conﬁrm the
correctness of such an intuition, one would have to answer the following question in the
aﬃrmative, and trying to do exactly that was the starting point of our research. The raised
question is:
Can one construct a probability distribution over proper 3-colorings of the n-node ring that
is non-signaling beyond distance o(log∗n)? 2
Our ﬁrst attempt at such a construction was the uniform distribution over all proper 3-
colorings. However, as the following argument shows, the uniform distribution is highly
non-local: if one knows exactly the probability that two given nodes have the same color,
one can determine the distance d ∈{1, 2, . . . , ⌊n/2⌋} between them.
Consider a line segment of length ℓ, consisting of ℓ+ 1 nodes connected by ℓlinks. It is
easy to see that there are 3 · 2ℓproper colorings of this line segment. Let aℓand bℓdenote
the number of such proper colorings that, respectively, have and have not both endpoints
colored in the same color. By solving a simple recurrence relation a0 = 3, b0 = 0, and
aℓ= bℓ−1 and bℓ= 2aℓ−1 + bℓ−1 for ℓ≥1, one can see that
aℓ= 2ℓ+ 2(−1)ℓ
and
bℓ= 2(2ℓ−(−1)ℓ).
A properly colored n-node ring can be thought of as a properly colored line segment of
length n with both endpoints being colored in the same color. Hence, there are an proper
colorings of such a ring, and the probability that two given nodes at distance d have the
2Informally, a distribution is non-signaling beyond distance r if, for any collection of ring segments, the
marginal distributions over colorings of these segments do not depend on the mutual distances between the
segments, as long as all these distances are more than r.
3

--- Page 4 ---
same color is
adan−d
3an
= (2d + 2(−1)d)(2n−d + 2(−1)n−d)
3(2n + 2(−1)n)
= 1
3 + 2(−1)n
3
· 1 + (−2)d + (−2)n−d
2n + 2(−1)n
,
which is distinct for every d.
As a result, using non-signaling arguments along the same lines as in [GKM09], it can be
seen that achieving the uniform distribution over all proper 3-colorings is no faster than 2-
coloring. It therefore also follows that the distribution over proper 3-colorings that results
from uniformly at random assigning unique labels to nodes and then running the Cole–
Vishkin algorithm is itself not uniform. We show in Section 3 that distributions that are
non-signaling beyond a given distance r must satisfy certain linear constraints, which can
then be incorporated in a linear program to bound the maximum probability for quantum
distributed algorithms to properly 3-color the ring.
1.2
Impossibility of perfect coloring
As we discovered, looking for correlations between distances among nodes and whether those
nodes have the same color not only establishes the globality of the uniform distribution, but
also leads to certain no-go results for arbitrary distributions. Our proof that the probability
of a one-round algorithm to output a proper 3-coloring is at most (1382
1383)⌊n/16⌋is essentially
a generalization of the following observation, which right away implies that it is impossible
for a quantum single-round one-way distributed algorithm to perfectly color (i.e., without
any error) an 11-node ring.
Given a coloring of the ring of 11 nodes, consider two experiments: Experiment 1 and
Experiment 2. For e ∈{1, 2}, Experiment e starts by ﬁrst randomly choosing the distance
de, where
d1 =
(
2
w.p. 30
41,
3
w.p. 11
41,
and
d2 =
(
4
w.p. 14
41,
5
w.p. 27
41.
Then the experiment chooses uniformly at random one of 11 nodes, and compares its color
with the node distance de ahead of if, outputting Match if the colors match and Differ if
they do not.
Let us consider running these experiments on proper colorings. There are a11 = 2046
such colorings, so a simple computer program (see Appendix C) can quickly check for all
of them what is the probability of Experiments 1 and 2 each returning Match. As it turns
out, for every proper coloring, the probability of Experiment 1 returning Match is at least
by
1
451 greater that the probability of Experiment 2 returning Match.
Now suppose we had a quantum single-round one-way distributed algorithm that per-
fectly 3-colors an 11-node ring, producing some probability distribution over proper color-
ings. Due to non-causality, every two non-adjacent nodes cannot tell what is the distance
4

--- Page 5 ---
between them. Hence, the probability of them returning the same color must be indepen-
dent from the distance between them. However, the observation above implies that it is
impossible. More quantitatively, in Appendix B.1 we show that it implies that the success
probability is at most 451
452. If we additionally analyze Experiments 1 and 2 on improper
colorings, we can improve this bound to 244
245.
To prove the exponential bound (1382
1383)⌊n/16⌋, we have to use a similar observation for
line segments. In addition, we have to consider a more limited set of distributions than
non-signaling distribution, which nonetheless includes all the distributions resulting from
quantum distributed algorithms.
1.3
Linear program for bounding success probability
Probability distributions resulting from quantum r-round one-way distributed algorithms
are non-signaling beyond distance r. Hence, the maximum among success probabilities of
non-signaling distributions—the total probability weight they place on proper colorings—
upper-bounds the maximum success probability of quantum distributed algorithms.
To obtain stricter bounds on the success probability than the ones obtained along the
lines of comparing Experiments 1 and 2, we can exploit the fact that non-signaling dis-
tributions have to satisfy much more constrains than that the probability of two distant
nodes having the same color must be independent from the distance between the nodes. In
particular, we show how to express the maximum success probability of non-signaling dis-
tributions beyond distance r as a linear program. As a result, for example, for n = 11 and
a single round, r = 1, we show that the success probability is at most 32
63, highly improving
upon the bound 244
245 described above.
To prove Theorem 1, we further have to consider line segments and non-signaling dis-
tributions over their colorings. The maximum among their success probabilities can also
be expressed as a linear program.
While it might be possible that this linear program shows impossibility of perfect color-
ing for quantum one-way distributed algorithms of more than one round, computationally
solving the linear program of size large enough to witness this impossibility for r much
larger than 1 is infeasible: one has to consider the number of nodes that is at least the
inverse function of log∗in r, which is astronomically large.
Nevertheless, we hope that a closer inspection of impossibility to perfectly color line
segments—in particular, the inspection of optimal primal and dual solutions of the linear
program—could lead to a technique similar to the round elimination [Bra19], which is
the current go-to theorem for showing the Ω(log∗n) lower bound for classical randomized
distributed algorithms (see [HS21] for a pedagogical description of the technique).
5

--- Page 6 ---
1.4
Organization of the paper
The paper is organized as follows. In Section 2, we formalize some aspects of the problem
of coloring the ring and we informally introduce the model of quantum distributed algo-
rithms, leaving the formal deﬁnition of the model to the appendix. In Section 3, we deﬁne
independent and non-signaling random colorings, and provide a framework for obtaining
exponential bounds on the success probability. In Section 4, we study the linear program
for the maximum success probability of non-signaling random colorings of the ring and line
segments. Using Wolfram Mathematica, we symbolically solve the linear program for cer-
tain cases when the number of nodes is small. These solutions together with the framework
introduced in Section 3 yield our main result, Theorem 1. Independent random colorings
are more constrained that non-signaling colorings, and, in Section 5, we use them to prove
that even a 4-node ring cannot be colored perfectly in a single one-way round. However, the
optimal bounds on the success probability of independent random colorings do not seem to
be expressible as linear programs, prohibiting us from obtaining similar results for larger
number of nodes. Finally, in Section 6, we talk about potential approaches towards proving
impossibility results beyond a single round of communication and other future research.
To make the paper more accessible to readers without a background in quantum com-
puting, aside from a brief description of quantum distributed algorithms in Section 2, we
keep the main body of the text free from details of quantum computation. We describe
the model of quantum distributed computation in more detail in Appendix A, where we
also prove Lemma 3 stating that the random colorings returned by such computation are
independent at distances beyond the number of rounds of communication. In Appendix B,
we observe certain correlations between the distances among the nodes and whether they
have the same color in proper colorings of the ring and line segments. These observations
together with the framework introduced in Section 3 yield the bound (1382
1383)⌊n/16⌋, which is
weaker than Theorem 1, but the observations themselves might be of an independent inter-
est in combinatorics. In Appendix C, we provide and annotate the Wolfram Mathematica
code that we have used for analyzing the example of two experiments for the 11-node ring
described in Section 1.2. This and the rest of the Wolfram Mathematica code used for our
calculations is available online [LGR22].
2
Preliminaries
Let us start by introducing terminology and mathematical formalism that we use when
discussing the directed ring.
Deﬁnition 1. An n-node directed ring is a directed degree-1 graph with the set of vertices
V := Zn = {0, 1, . . . , n−1} and the set of arcs {(v, v+1): v ∈V}. We call v ∈V a node and
we also refer to v as the number of that node. We call arcs of the graph (communication)
links. We say that v −1 precedes v, v + 1 succeeds or follows v, and that they are both
adjacent to v. We also call v + 1 the next node of v.
6

--- Page 7 ---
In the above deﬁnition and throughout the paper, for a node v and any integer k, v + k
denotes the node number v + k mod n. Given v ∈V and D ⊆Zn, let v + D := {v + d: d ∈
D} ⊆V.
Let Σ be some ﬁxed ﬁnite set that we call the set of colors.
We call the function
φ: V →Σ a coloring, and we say that φ is proper if φ(v) ̸= φ(v + 1) for all v ∈V. For
brevity, we may also denote the set of all |Σ|n colorings by ΣV. We also consider colorings
of segments of the ring, and their properness is deﬁned analogously: every pair of adjacent
nodes must have diﬀerent colors.
For a tuple (a1, . . . , aℓ) of distinct elements, let set(a1, . . . , aℓ) := {a1, . . . , aℓ}.
Computational model.
Here we describe the computational model of quantum dis-
tributed algorithm on the directed ring. We leave the precise deﬁnition of the model to
Appendix A, where we provide the proof of Lemma 3, which is a slight adaptation3 of
the folklore fact that random colorings resulting from quantum distributed algorithms are
non-signaling. Aside from establishing Lemma 3, no other aspects of quantum computation
are used.
Each node operates its own quantum processor, executing exactly the same local al-
gorithm as all the other nodes. In addition, every node can receive quantum messages
from the node preceding it and send quantum messages to the node succeeding it. This
circular communication proceeds in synchronous rounds. We are considering the LOCAL
model [Lin92], where there is no bandwidth limitations on the size of messages. At the end
of the computation, after r rounds, each node outputs a color from Σ, and we treat the
corresponding mapping Φ from V to Σ as the coloring. Due to the probabilistic nature of
quantum computation, the output Φ is probabilistic, and we use the capital letter Φ instead
of φ to emphasize that we think of coloring Φ as a random variable taking values in ΣV.
3
Independent and Non-Signaling Random Colorings
Arfaoui and Fraigniaud [AF14] used the non-signaling property of quantum computation
when analyzing, along the lines of Ref. [GKM09], the hardness of 2-coloring the ring for
quantum distributed algorithms. Here we deﬁne non-signaling colorings and their special
case that we call independent colorings. Our deﬁnition of non-signaling colorings slightly
diﬀers from the deﬁnition of non-signaling distributions by Arfaoui and Fraigniaud. First of
all, our deﬁnition is speciﬁc to the ring graph, not a general graph, and we have also made
adaptations arising from the communication being one-way. In addition, in the distributed
model that we consider, nodes do not receive unique identiﬁers at the beginning of the
computation. However, aside from adaptations due to the communication being one-way,
3Here we take into account the one-wayness of the communication, and we also consider a special case
of non-signaling random colorings that we call independent colorings.
7

--- Page 8 ---
our deﬁnition would match that of Arfaoui and Fraigniaud if they assigned the unique
identiﬁers to the nodes uniformly at random.
We consider colorings Φ of the whole ring and colorings Ψ of segments of the ring, both
of which are random variables. Deﬁnitions and lemmas established here will let us prove
our main result, Theorem 1, in Section 4.
3.1
Frames, tableaux, and their collections
Let s ∈{1, 2, . . . , n −1}. We call the intervals of integers
{{s}} := (0, 1, . . . , s −1)
and
r{{s}} := (−r, −r + 1, . . . , s −1),
a sliding frame and a gapped sliding frame, respectively. See Figure 2 for illustrations. We
refer to s as the length of the frame and to r as the length (or width) of the gap. For nodes
v and v′ = v + s −1, we call the interval of nodes
[[v..v′]] := (v, v + 1, . . . , v′)
a ﬁxed frame of length s. Given a vertex v, let v + {{s}} := [[v..v + s −1]] and v + r{{s}} :=
[[v −r..v + s −1]] (here we assume s + r ≤n −1).
Intuitively, the goal of the above deﬁnition is to ensure the following regarding the
operation of r-round distributed algorithms. If v+ r{{s}} and v′ + r{{s′}} do not overlap, then
colors output by v + {{s}} and v′ + {{s′}} should be independent. We can think of a gap as
a buﬀer that keeps (non-gapped) sliding frames suﬃciently apart.
Given a coloring φ, let φ([[v..v′]]) be short for (φ(v), φ(v + 1), . . . , φ(v′)) ∈Σs, and we
call such a tuple of colors a tableau. We note that we cannot think of φ([[v..v′]]) as the
partial function that is the restriction of φ to the subdomain set[[v..v′]]. In particular, we
may have φ([[v..v′]]) = φ([[v + δ..v′ + δ]]) for some “shift” δ ∈Z.
Collections of frames and tableaux.
We call a t-tuple ({{s1}}, . . . , {{st}}) a collection
of sliding frames. Given a collection of sliding frames F = ({{s1}}, . . . , {{st}}), we say that
F is gap-r-placable if Pt
j=1(sj + r) ≤n. We say that a tuple ω ∈Vt is a gap-r placement
of F if for all distinct j, j′ ∈{1, . . . , t} we have
set
 ωj + r{{sj}}

∩set
 ωj′ + r{{sj′}}

= ∅.
Given a collection of sliding frames F = ({{s1}}, . . . , {{st}}) and a gap-r placement ω of
F, let
ω + F :=
 ω1 + {{s1}}, . . . , ωt + {{st}}

.
For a coloring φ, let
φ(ω + F) :=
 φ(ω1 + {{s1}}), . . . , φ(ωt + {{st}})

,
8

--- Page 9 ---
Figure 2: On the left, a sliding frame, a gap-2 gapped sliding frame, and a tableau, all of length 4,
are illustrated. Here Σ = {R, G, B}. We can think of gapped sliding frames as of something that we
can slide circularly on top of the ring (including jumping over one another), and we need to place
them so that they do not overlap. On the left, the ring of length n = 22, on which the collection
F = ({{3}}, {{3}}, {{2}}) of frames is placed by the gap-2 placement ω = (4, 16, 12). Assuming there
is some underlying coloring φ of the ring, we have revealed the colors corresponding to the sliding
frames, the (3, 3, 2)-collection of tableaux in this case being ((G, R, B), (B, B, R), (R, G)).
which is a t tuple of tableaux, with j-th tableau having length sj. We call such a tuple
an (s1, . . . , st)-collection of tableaux. We note that the order of tableaux in a collection is
ﬁxed. For example, given Σ = {R, G, B}, collections ((R, G), (G, B)) and ((G, B), (R, G))
are not the same.
3.2
Colorings of the ring
We consider random variables Φ whose values are colorings φ: V →Σ, and we refer to Φ
as a random coloring, or we might still just simply refer to it as a coloring. Let Prev: V →
V : v →v −1. We call a random coloring Φ cyclic if
Pr[Φ = φ ◦Prev] = Pr[Φ = φ],
where ◦denotes the composition.
Given a random coloring Φ, we deﬁne the random variable Φ(ω + F) accordingly:
Pr[Φ(ω + F) = (ζ1, . . . , ζt)] := Pr[Φ = φ such that φ(ω + F) = (ζ1, . . . , ζt)].
We can think of Φ(ω + F) inducing a marginal distribution over (ζ1, . . . , ζt) in the natural
way.
9

--- Page 10 ---
Deﬁnition 2. We say that a random coloring Φ is independent at distances beyond r if it is
cyclic and if for every s ≥1 there exists a probability distribution ps over Σs such that, for
every collection F = ({{s1}}, . . . , {{st}}) of sliding frames, a gap-r placement ω = (ω1, . . . , ωt)
of F, and ζj ∈Σsj for every j, we have
Pr[Φ(ω + F) = (ζ1, . . . , ζt)] = ps1(ζ1) · . . . · pst(ζt).
Deﬁnition 3. We call a random coloring Φ non-signaling at distances beyond r if it is cyclic
and if, for every gap-r-placable collection of frames F, the marginal distribution induced
by Φ(ω + F) is the same for all gap-r placements ω of F.
Note that, if Φ is non-signaling at distances beyond r1, then it is also non-signaling at
distances beyond r2 for r2 > r1. The following directly follows from Deﬁnitions 2 and 3.
Claim 2. A random coloring Φ that is independent at distances beyond r is also non-
signaling at distances beyond r.
We note that the reverse of Claim 2 is not true: there exist colorings that are non-
signaling beyond some distance but that are not independent beyond that same distance.
For example, suppose |Σ| = n, and consider Φ that is a uniform distribution over all n!
colorings φ that assign a unique color from Σ to every node. Φ is non-signaling already
beyond r = 0, but it becomes independent only beyond r ≥⌊n/2⌋.4
In Appendix A, we formalize the model of quantum distributed algorithms, adapted for
one-way communication on the ring, and we show that the output distributions of quantum
r-round one-way distributed algorithms are independent at distances beyond r.
Lemma 3. The coloring Φ produced by a quantum one-way r-round distributed algorithm
is independent at distances beyond r.
3.3
Colorings of line segments and exponential bounds
Let us consider colorings of line segments, where by a line segment we think of some interval
of nodes of the ring, not containing all of them (more precisely, at least r of them). Let
k ≥1, v ∈V, and consider interval of vertices v + {{k}} = [[v..v + k −1]]. We call a map
ψ: set[[v..v′]] →Σ a coloring of the line segment. Given a set of frames F = ({{s1}}, . . . , {{st}})
we say that a gap-r placement ω of F respects the interval [[v..v′]] if
set(ωj + {{s}}) ⊆set[[v..v′]]
for all j. Note that it is still allowed that set(ωj + r{{s}}) ̸⊆set[[v..v′]], for example, when
ωj = v.
Along the same lines as Deﬁnitions 2 and 3 for complete rings, we deﬁne independent
and non-signaling colorings for line segments.
4For r ≥⌊n/2⌋, only collections consisting of a single sliding frame are gap-r-placable.
10

--- Page 11 ---
Deﬁnition 4. We say that a random coloring Ψ of a line segment [[v..v′]] is independent
at distances beyond r if for every s ≥1 there exists a probability distribution ps over Σs
such that, for every collection F = ({{s1}}, . . . , {{st}}) of sliding frames, a gap-r placement
ω = (ω1, . . . , ωt) of F that respects [[v..v′]], and ζj ∈Σsj for every j, we have
Pr[Φ(ω + F) = (ζ1, . . . , ζt)] = ps1(ζ1) · . . . · pst(ζt).
Deﬁnition 5. We call a random coloring Ψ of a line segment [[v..v′]] non-signaling at
distances beyond r if, for every collection of frames F, the marginal distribution induced by
Ψ(ω + F) is the same for all gap-r placements ω of F that respect [[v..v′]].
Lemma 4. Suppose there exist a length k ≥2, a probability q < 1, and a node v ∈V such
that, for all random colorings Ψ of the interval [[v..v + k −1]] that are independent beyond
distance r, the success probability of Ψ is at most q. Then for every coloring Φ of the whole
ring that is independent beyond distance r the success probability of Φ is at most q⌊n/(k+r)⌋.
Proof. Suppose Φ is independent (beyond distance r), and let Ψ be its restriction to the
domain set[[v..v + k −1]]. Since Φ is independent, ﬁrst, so is Ψ, and, second, there is a
probability distribution pk over ψ ∈Σk such that
Pr[Φ([[v..v + k −1]]) = ψ] = pk(ψ).
From the assumptions of the lemma,
X
proper ψ∈Σk
pk(ψ) ≤q.
Let m := ⌊n/(k+r)⌋for brevity. Now consider the collection of frames F = ({{k}}, . . . , {{k}}),
consisting of m frames, each of length k, and consider their gap-r placement ω = (ω1, . . . , ωm)
where ωj := j(r + k). Since Φ is independent, we have
Pr[Φ(ω + F) = (ζ1, . . . , ζm)] = pk(ζ1) · . . . · pk(ζm).
As a result, the probability that for a random (ζ1, . . . , ζm) = Φ(ω + F) we have that ζj
is proper for all j ∈{1, . . . , m} is at most qm. Finally such a piece-wise properness is a
prerequisite for the whole Φ to be proper, and the probability of Φ being proper can be no
larger.
In Section 4.2, we instantiate this lemma with r = 1, k = 9, and q = 11/15, thus proving
Theorem 1.
11

--- Page 12 ---
4
Success Probability of Non-Signaling Colorings as a Linear
Program
If we inspect Deﬁnitions 3 and 5 of non-signaling colorings of the ring and the line segment,
respectively, we see that the maximum success probability among non-signaling colorings
can be computed via a linear program. In this section, we provide details of this claim by
stating the two linear programs. Using Wolfram Mathematica, we managed to symbolically
solve both linear programs for r = 1 and a large enough number of nodes so that the
maximum success probability is strictly less than 1. Here we also present those results and
their implications.
4.1
Optimal colorings for rings of up to 11 nodes
Let Φ be an arbitrary non-signaling coloring beyond distance r, and, for every coloring
φ ∈ΣV, let pφ be the probability that Φ = φ. Letting pφ ≥0 be variables that sum up to
1, the maximum success probability for 3-coloring among non-signaling colorings is given
by the linear program
maximize
X
proper φ∈ΣV
pφ
(1a)
subject to
pφ = pφ◦Prev
for all φ ∈ΣV,
(1b)
X
φ∈ΣV
∀j : φ(ωj+{{sj}})=ζj
pφ =
X
φ∈ΣV
∀j : φ(ω′
j+{{sj}})=ζj
pφ
for all F, ζ, ω, ω′,
(1c)
where the latter constraint is for all collections of gap-r-placable sliding frames F =
({{s1}}, . . . , {{st}}), all corresponding collections of tableaux ζ = (ζ1, . . . , ζt), and all pairs
of gap-r placements ω, ω′ of F. The linear program (1) is feasible for all r; for example,
consider pφ = 1/|Σ|n for all φ.
We symbolically solved (1) for r = 1 and n up to 11.5 While for n up to 9 we got
the optimal value of 1, for n = 10 and n = 11 we got 2/3 and 32/63, respectively. This
constitutes the proof that single-round one-way quantum distributed algorithms cannot
succeed with 3-coloring 10-node and 11-node rings with probabilities higher than 2/3 and
32/63, respectively. Note that, however, this by itself does not yet rule out the possibility
that for a larger number of nodes perfect coloring is again possible. For that, we have to
show a similar result for line segments.
5Our solution of the linear program was somewhat ad hoc. First, we solved the primal and the dual
problems numerically. Then, from those numerical results, we managed to get symbolic feasible solutions
for the primal and the dual with matching objective values, implying their optimality.
12

--- Page 13 ---
4.2
Impossibility of perfectly coloring the 9-node line segment
We can consider the equivalent of (1) for k-node line segments. Let us consider interval
[[w..w + k −1]], where w, the number of the initial node, is irrelevant.
The maximum
success probability among random colorings of this line segment that are non-signaling
beyond distance r can be computed via the linear program
maximize
X
proper ψ∈Σk
pψ
(2a)
subject to
X
ψ∈Σk
∀j : ψ(ωj+{{sj}})=ζj
pψ =
X
ψ∈Σk
∀j : ψ(ω′
j+{{sj}})=ζj
pψ
for all F, ζ, ω, ω′,
(2b)
where the maximization is over probability distributions p = (pψ)ψ∈Σk and where the con-
straint (2b) is for all collections of sliding frames F = ({{s1}}, . . . , {{st}}), all corresponding
collections of tableaux ζ = (ζ1, . . . , ζt), and all pairs of gap-r placements ω, ω′ of F that
respect [[w..w + k −1]].
Compared to the linear program (1) for the whole ring, now, in (2), we do not have
the symmetry introduced by the cyclicity condition (1b). This results in a less constrained
and, for the same number of nodes, slower-to-compute program. Because of the results
in Section 4.1 and the following claim, for r = 1 and for k up to 8, we do not need any
computation at all: the optimum is 1.
Claim 5. Suppose there is a random coloring of the n-node ring that is non-signaling beyond
distance r and whose success probability is q. Then its restriction to any line segment of
at most n −r nodes is a random coloring of that line segment that is non-signaling beyond
distance r and has the success probability at least q.
For r = 1 and k = 9, we symbolically solved the linear program (2) and found the
objective value to be 11/15 (Footnote 5 applies here too). Thus, as a result, since non-
signaling colorings are independent, Lemma 4 applies, and we obtain Theorem 1.
A couple of remarks are in place. First, we remark that our current results do not imply
that the maximum among success probabilities of random colorings of the n-node ring that
are non-signaling beyond distance 1 is exponentially small in n. Currently, we have such a
result only for independent colorings.
Second, while we have shown that, for r = 1 and k = 9, the success probability of (2)
is strictly below 1, it might be the case that, for any number of rounds r ≥1, there is a
length k such that the optimal solution of (2) is strictly below 1. Finding such a solution
numerically seems to be far beyond what is computationally possible. But the existence of
such a solution for every r would imply an ω(1) lower bound on the round complexity of
3-coloring via quantum distributed algorithms.
13

--- Page 14 ---
5
Impossibility of perfectly coloring the 4-node ring
Let us consider random colorings of the ring that are non-signaling beyond distance 1. If, in
addition to the non-signaling constraints, we impose that the colorings must be independent,
we can show stronger no-go results. In particular, while we managed to ﬁnd a perfect non-
signaling coloring for every n up to 9 (i.e., ﬁnd a solution of (1) of objective value 1), here we
show that a prefect independent coloring does not exist already for a much smaller number
of nodes n.
Theorem 6. There is no perfect random 3-coloring of the 4-node ring that is independent
beyond distance 1.
Proof. Let us assume the contrary: there is such a coloring Φ. There are a4 = 18 proper 3-
colorings φ of the 4-node ring, which we write below as (φ(0), φ(1), φ(2), φ(3)) ∈Σ4 where
we take Σ = {0, 1, 2} to be the set of colors.
Since Φ is cyclic, there are probabilities
p0,1, p0,2, p1,2, q0, q1, q2 such that Φ equals each
(0, 1, 0, 1), (1, 0, 1, 0)
w.p. p0,1,
(0, 2, 0, 2), (2, 0, 2, 0)
w.p. p0,2,
(1, 2, 1, 2), (2, 1, 2, 1)
w.p. p1,2,
(0, 1, 0, 2), (1, 0, 2, 0), (0, 2, 0, 1), (2, 0, 1, 0)
w.p. q0,
(1, 0, 1, 2), (0, 1, 2, 1), (1, 2, 1, 0), (2, 1, 0, 1)
w.p. q1,
(2, 0, 2, 1), (0, 2, 1, 2), (2, 1, 2, 0), (1, 2, 0, 2)
w.p. q2.
We have 2(p0,1 + p0,2 + p1,2) + 4(q0 + q1 + q2) = 1.
Given a node v and a color σ ∈Σ, let rσ be the probability that Φ(v) = σ. Note
that rσ is independent from the choice of v due to the cyclicity of Φ.
We have r0 =
p0,1 + p0,2 + 2q0 + q1 + q2, with analogous expressions for r1 and r2. From these three
expressions, we obtain
p0,1 = (r0 + r1 −r2)/2 −q0 −q1.
Given a node v, the probability that both Φ(v) = 1 and Φ(v + 2) = 2 is q0. On the other
hand, since Φ is independent beyond distance 1, Φ(v) and Φ(v +2) are independent, taking
colors 1 and 2 with probability r1 and r2, respectively. As a result, q0 = r1r2, and similarly
q1 = r0r2. Because r0 + r1 = 1 −r2, we get q0 + q1 = r2 −r2
2 and, further on,
p0,1 = (1 −r2 −r2)/2 −r2 + r2
2 =
 r2 −1 −1/
√
2
 r2 −1 + 1/
√
2

.
For p0,1 and r2 both to be probabilities, we must have r2 ≤1 −1/
√
2 < 1/3. The same
argument yields r0 < 1/3 and r1 < 1/3, which is a contradiction because r0+r1+r2 = 1.
14

--- Page 15 ---
Theorem 6 implies that already for n = 4, a single-round one-way quantum distributed
algorithm cannot 3-color perfectly. However, aside from stating that the maximum suc-
cess probability cannot be 1, the theorem does not place any other upper bound on the
probability. While, for non-signaling colorings, the maximum success probability can be
characterized by a linear program, it is likely not the case for independent colorings, making
its computation more diﬃcult.
In the next section, we brieﬂy discuss a more powerful model of quantum distributed
algorithms whose round complexity can be bounded by the maximum success probability
among non-signaling colorings, but not that among independent colorings.
6
Discussion of Future Work
Exponential bounds given unique indices.
In this paper we have considered the
model of quantum distributed algorithms where initially each node’s memory is in the
same state.
One could also consider a more powerful model where, at the start of the
computation, each node v ∈V is given a unique label i ∈Zn. Here v and i do not need
to be equal: v lets us reason about node’s location on the ring, but it is unknown to
the computation, while i can be used by the computation, but it does not reveal anything
about labels of other nodes in its vicinity. Let us suppose here that these labels are assigned
uniformly at random, there being n! diﬀerent assignments in total. In addition, we could
assume that there is an n-partite quantum state (generalizing an n-partite random bitstring
of the classical case) and that at the beginning of the computation the node labeled i receives
i-th part of this state.
Even if we give these extra resources to quantum r-round one-way distributed algo-
rithms, along the same lines as for Lemma 3, it can be shown that the resulting random
coloring Φ of the ring is non-signaling beyond distance r. Hence, the impossibility of per-
fect 3-coloring in a single-round proven for n ≥10 in Section 4 still applies to this stronger
model. However, unlike for independent colorings, it is not clear if Lemma 4 applies to
non-signaling colorings, and therefore it is not clear if the impossibility to perfectly color
constant-length line segments can be elevated to exponential bounds for coloring the whole
ring, as is done for Theorem 1. Showing that the success probability of quantum single-
round one-way distributed algorithms to 3-color when these algorithms are aided by unique
node labels and correspondingly shared quantum state is exponentially small is one problem
left opened by the current work.
Better understanding the diﬀerences between non-signaling and independent colorings
might provide a better understanding of capabilities of quantum distributed algorithms
with and without shared quantum states.
Generalization of round elimination.
The round elimination technique [Bra19], when
applied to prove the Ω(log∗n)-round lower bound for 3-coloring the ring by classical random-
15

--- Page 16 ---
ized distributed algorithms, is based essentially on the following observation. Informally
speaking, if there is an r-round randomized distributed algorithm that with high prob-
ability properly c-colors a line segment of length r + 1 (i.e., (r + 2)-node line segment),
then there is an (r −1)-round randomized distributed algorithm that with high probability
properly 2c-colors a line segment of length r. By repeatedly applying this observation, one
ﬁnally reaches the “base” case, where one reasons about the probability of properly coloring
two-node line segment without any communication.
This argument does not seem to work for non-signaling colorings because it reasons
about line segments whose length is only r+1, yet the limitations of non-signaling colorings
are due to long distance correlations. It would be interesting to see if a similar technique
to round elimination could be used for non-signaling colorings. In particular, one could
potentially seek a statement similar to the following.
Hypothesis 7 (informal). There exists an integer constant δ ≥1, representing the number
of rounds to be eliminated in one step, such that the following holds. Suppose there is a
line segment [[1..k]], a random c-coloring Ψ of this line segment that is proper with high
probability, a frame-length s, and a round-number r such that, for all gap-r placements ω of
the collection of frames F = ({{s}}, {{s}}) that respect the line segment [[1..k]], the marginal
distributions over (s, s)-collections of tableaux induced by Ψ(ω + F) are the same. Then
there exists a random 2c-coloring Ψ′ of the same line segment such that Ψ′ is proper with
high probability and, for all gap-(r −1) placements ω′ of the collection of frames F ′ =
({{s −δ}}, {{s −δ}}) that respect the line segment [[1..k]], the marginal distributions over (s−
δ, s −δ)-collections of tableaux induced by Ψ′(ω′ + F ′) are the same.
If the above hypothesis (or one similar to it) can be proven, we suspect that it might
lead to a proof that, if Φ is a random 3-coloring of an n-node ring that is both non-signaling
beyond distance r and that is proper with high probability, then r = Ω(log∗n). This would
imply the same lower bound on the round complexity of quantum distributed algorithms.
Better understanding of the linear program (2) for r = 1 and k = 9 and, in particular,
under what restricted sets of constraints its optimum is still strictly below 1, might yield
some insights towards the hypothesis above.
Acknowledgements
The authors are grateful to Sebastian Brandt for useful insights.
FLG and AR were
supported by JSPS KAKENHI Grant No. JP20H05966 and MEXT Quantum Leap Flag-
ship Program (MEXT Q-LEAP) Grants Nos. JPMXS0118067394 and JPMXS0120319794.
FLG was also supported by JSPS KAKENHI Grants Nos. JP19H04066, JP20H00579,
JP20H04139, JP21H04879.
16

--- Page 17 ---
References
[AF14]
Heger Arfaoui and Pierre Fraigniaud. What can be computed without communications?
SIGACT News, 45(3):82–104, 2014.
[BE13]
Leonid Barenboim and Michael Elkin. Distributed graph coloring: Fundamentals and
recent developments. Synthesis Lectures on Distributed Computing Theory, 4(1):1–171,
2013.
[Bra19]
Sebastian Brandt. An automatic speedup theorem for distributed problems. In Proceed-
ings of the 2019 ACM Symposium on Principles of Distributed Computing, PODC ’19,
page 379–388, New York, NY, USA, 2019. Association for Computing Machinery.
[CV86]
Richard Cole and Uzi Vishkin. Deterministic coin tossing with applications to optimal
parallel list ranking. Information and Control, 70(1):32–53, 1986.
[GKM09] Cyril Gavoille, Adrian Kosowski, and Marcin Markiewicz. What can be observed locally?
In Distributed Computing, pages 243–257, Berlin, Heidelberg, 2009. Springer Berlin Hei-
delberg.
[GPS88]
Andrew V. Goldberg, Serge A. Plotkin, and Gregory E. Shannon. Parallel symmetry-
breaking in sparse graphs. SIAM Journal on Discrete Mathematics, 1(4):434–446, 1988.
[HS21]
Juho Hirvonen and Jukka Suomela.
Distributed Algorithms 2020.
https://
jukkasuomela.fi/da2020/, 2021.
[LGR22]
François Le Gall and Ansis Rosmanis. On coloring the ring in the quantum LOCAL
model. http://rosmanis.com/research/3coloring/, 2022.
[Lin92]
Nathan Linial. Locality in distributed graph algorithms. SIAM Journal on Computing,
21(1):193–201, 1992.
[Nao91]
Moni Naor. A lower bound on probabilistic algorithms for distributive ring coloring.
SIAM Journal on Discrete Mathematics, 4(3):409–412, 1991.
[NC00]
Michael A. Nielsen and Isaac L. Chuang. Quantum Computation and Quantum Infor-
mation. Cambridge University Press, 2000.
[NS95]
Moni Naor and Larry Stockmeyer. What can be computed locally? SIAM Journal on
Computing, 24(6):1259–1277, 1995.
[Pel00]
David Peleg. Distributed Computing: A Locality-Sensitive Approach. Discrete mathe-
matics and applications. Society for Industrial and Applied Mathematics, 2000.
A
Quantum Distributed Algorithm
We assume that the reader of this section is familiar with the basics of quantum computation
(for an introductory textbook, see [NC00]).
17

--- Page 18 ---
A.1
Model of quantum one-way distributed algorithm
Let the memory of a node v ∈V be held in register Nv, which consists of two subregisters:
the workspace register Wv and the (forward) message register Mv. Let HWv, HMv, and
HNv = HWv ⊗HMv be complex Euclidean spaces corresponding to the registers Wv, Mv,
and Nv, respectively. We assume that each W0, W1, W2, . . . consists of the same number
of qubits, thus the dimensions of all HW0, HW1, HW2, . . . are the same, and similarly we
assume that each M0, M1, M2, . . . consists of the same number of qubits. We additionally
assume that all nodes run the same local computation. We may drop the subscript v when
convenient.
The collective memory of nodes is initialized to the state |0⟩⊗n, which is a pure state on
N
x∈[n] HNv; here |0⟩is the state of the register Nv with all individual qubits set to |0⟩. Let
V be the messaging unitary deﬁned by the linear extension of its action on product states
as
V :
O
v∈V
|bv, cv⟩Nv 7→
O
v∈V
|bv, cv−1⟩Nv,
where |bv⟩∈HWv and |cv⟩∈HMv. The unitary V implements one round of communication.
The local actions of every node between two communication rounds are described by a
unitary U, which acts on HN. It is the same for every node and, without loss of generality,
the same for every round.6 Likewise, the ﬁnal local projective measurement Π = {Πσ : σ ∈
Σ} is the same for every node. We permit this measurement not to be in the standard
computational basis, therefore there is no loss of generality in not applying any local unitary
after the last round of communication V .
An r-round protocol starts with the state |0⟩⊗n and then alternates between applications
of U for every node and V on the joint system. Thus, the overall ﬁnal state right before
the ﬁnal measurement is (V U⊗n)r|0⟩⊗n. Finally, each node performs the measurement Π
on its memory, outputting the result of the measurement. The joint result being random,
we treat it as a random variable Φ taking values in ΣV.
A.2
Proof of Lemma 3
Suppose we have a quantum r-round one-way distributed algorithm speciﬁed by U and Π.
Let the random coloring Φ be the output of the algorithm.
Consider s ≥1 and ζ = (σ0, . . . , σs−1) ∈Σs. Let us consider the space Ns−1
i=−r HNi,
where we label each individual instance of the space HN not with the number of a node but
with an index i in the gapped sliding frame r{{s}}. Let us deﬁne an orthogonal projector
Ξr(s, ζ) recursively for r ≥0 as follows. Intuitively, we will start with a ﬁnal measurement
6We can assume that the same unitary U is applied at every round because U can be designed so that
the node keeps a round counter in its memory and then controls its actions based on it.
18

--- Page 19 ---
operator Ξ0(s, ζ) and then run the computation in reverse for r rounds, seeing how that
operator evolves under this reverse computation. For r = 0, let
Ξ0(s, ζ) :=
s−1
O
i=0
(Πσi)Ni.
For r ≥1, ﬁrst, let
Vr+s :
s−1
O
i=−r
HNi →HW−r ⊗
s−1
O
i=−r+1
HNi ⊗HMs
be the linear isometry deﬁned as
Vr+s :
s−1
O
i=−r
|bi, ci⟩Ni 7→|b−r⟩W−r ⊗
s−1
O
i=−r+1
|bi, ci−1⟩Ni ⊗|cs−1⟩Ms.
Then, for r ≥1, we recursively deﬁne
Ξr(s, ζ) := (U−1)⊗(r+s)V−1
r+s

IW−r ⊗Ξr−1(s, ζ) ⊗IMs

Vr+sU⊗(r+s),
where I denotes the identity operator on the corresponding registers.
Given a ﬁxed s, projectors Ξr(s, ζ) are orthogonal for distinct ζ and the sum P
ζ∈Σs Ξr(s, ζ)
equals the identity operator on Ns−1
i=−r HNi. Deﬁne the probability distribution ps over Σs
as
ps(ζ) := ⟨0|⊗(r+s)Ξr(s, ζ)|0⟩⊗(r+s).
Now, given a node v, we can consider Ξr(s, ζ) to act on the space corresponding to the
interval of nodes v + r{{s}} = [[v −r..v + s −1]] by associating HNi, where i ∈r{{s}} is an
index, with HNv+i, where v + i is the number of a node. To specify that Ξr(s, ζ) acts on
the space corresponding to those nodes, we write it as (Ξr(s, ζ))Nv−r..Nv+s−1.
Consider a collection of sliding frames F = ({{s1}}, . . . , {{st}}) and, for every j ∈{1, . . . , t},
a tableau ζj ∈Σsj. Suppose ω is a gap-r placement of F. Because of the constraints on
gap-r placements, we can see that, for distinct j, the projectors (Ξr(sj, ζj))Nωj−r..Nωj+sj−1
act on spaces corresponding to disjoint sets of nodes.
Let use ﬁx ω and ζ, and let us write ζj = (ζj,0, . . . , ζj,sj−1) for every j. Let us deﬁne
p := Pr[Φ(ω + F) = (ζ1, . . . , ζt)],
that is, p is the probability that for every j ∈{1, . . . , t} and every i ∈{0, . . . , sj −1} the
node ωj + i outputs ζj,i. This probability equals
p = ∥Ξﬁnal(V U⊗n)r|0⟩⊗n∥2,
19

--- Page 20 ---
where
Ξﬁnal :=
t
O
j=1
sj−1
O
i=0
(Πζj,i)Nωj+i ⊗Irest =
t
O
j=1
(Ξ0(sj, ζj))Nωj ..Nωj+sj−1 ⊗Irest
and Irest is the identity on the joint space of the nodes not in any ωj + {{sj}}.
Let us start with the ﬁnal measurement operator Ξﬁnal and eﬀectively run the compu-
tation in reverse, obtaining the measurement operator
Ξinit := (V U⊗n)−rΞﬁnal(V U⊗n)r
on the initial state. We can write
Ξinit =
t
O
j=1
(Ξr(sj, ζj))Nωj−r..Nωj+sj−1 ⊗Irest′,
where Irest′ is the identity on the joint space of the nodes not in any ωj + r{{sj}}. The
correctness of the above expression for Ξinit can be seen inductively, using the recursive
deﬁnition of projectors Ξr.
Finally, since the initial state is a product state, we get the desired independence. More
precisely, because p = ∥Ξinit|0⟩⊗n∥2, we get that p = ps1(ζ1) · . . . · pst(ζt).
B
Bounds from Inspecting Pairs of Nodes
Here we consider single-round algorithms, and we consider probability distributions over
pairs of non-adjacent nodes, particularly focussing on whether the two nodes of the pair
have the same color. We will be interested in pairs (p, p′) of such probability distributions,
and we will be able to ﬁnd pairs that serve as witnesses that one cannot 3-color perfectly.
In Section B.1, we consider non-signaling colorings of the n-node ring and computation-
ally obtain witnesses for n = 11 and n = 13, 14, . . . , 22 that bound the success probability
strictly below 1. In Section B.2, we obtain a similar witness for the 15-node line segment,
showing that the probability of properly coloring this segment is less than 1382
1383, which then,
using Lemma 4, yields the following theorem, which is a weaker version of Theorem 1.
Theorem 8. The probability that a single-round one-way quantum distributed algorithm
properly 3-colors an n-node ring is at most (1382
1383)⌊n/16⌋.
Both sections take advantage of the fact that, since r = 1, the probability of two
non-adjacent nodes having the same color is independent from the distance between them.
Results presented here might be of an independent interest in combinatorics.
20

--- Page 21 ---
B.1
Constant bounds for certain small n
Suppose Φ is a random coloring that is non-signaling at distances beyond one.
Let us
consider the collection of frames F = ({{1}}, {{1}}). There are n(n −3) gap-one placements
ω = (v, v + d) of F, which we specify by a node v ∈V and a distance d ∈{2, 3, . . . , n −2}.
Since Φ is non-signaling, the marginal distribution induced by Φ(ω + F) = ((Φ(v)), (Φ(v +
d))) is the same for all such ω. In particular, the average probability
1
n
X
v∈V
Pr[σ1 = σ2 : σ1 = Φ(v) & σ2 = Φ(v + d)]
is some constant γ independent from d.
For every coloring φ ∈ΣV, deﬁne 1φ(v)=φ(v+d) to be 1 when φ(v) = φ(v + d) and 0
otherwise. Then deﬁne
βφ,d := 1
n
X
v∈V
1φ(v)=φ(v+d) ∈{0, 1
n, 2
n, . . . , 1},
and note that βφ,d is the probability that two randomly chosen nodes distance d apart have
the same color. Clearly βφ,d = βφ,n−d. Let us also deﬁne βφ := (βφ,2, βφ,3 . . . , βφ,n−2). We
have E[βΦ] = (γ, γ, . . . , γ).
For any probability distribution over distances p = (p2, p3, . . . , pn−2) we have
γ = p · E[βΦ] = E[p · βΦ].
Consider two such probability distributions p, p′ and a bias ∆≥0 such that p·βφ ≥∆+p′·βφ
for all proper colorings φ. Note that such p, p′, ∆always exist, as p = p′ and ∆= 0 jointly
satisfy the required condition.
The interesting cases, however, are when ∆> 0.
The
maximum value of ∆can be computed by the linear program
maximize
∆
(3a)
subject to
(p −p′) · βφ ≥∆
for all proper φ,
(3b)
where the optimization is over ∆≥0 and all probability distributions p and p′. Since
βφ,d = βφ,n−d, for the sake of aesthetics, without loss of generality we impose pd = pn−d and
p′
d = p′
n−d.7 Note that, whenever the maximum bias ∆is non-zero, probability distributions
p and p′ achieving it have disjoint supports.
We solved the linear program (3) for n up to 22 and we found the optimal ∆to be
strictly positive for n = 11 and n = 13, 14, . . . , 22. Before we elaborate on these solutions,
let us see how a non-zero ∆implies upper bounds on the success probability.
7The shapes of plots in Figure 4, representing optimal solutions of (3), are smoother this way. We could
alternatively impose pd = p′
d = 0 for d > ⌊n/2⌋, but then, for even n, the optimal solutions we found would
have p′
n/2−1 ≈2pn/2. We note that, however, when we implement (3) in Wolfram Mathematica, we do
indeed assume pd = p′
d = 0 for d > ⌊n/2⌋, because that approximately halves the number of variables.
21

--- Page 22 ---
Let −Γ ≤0 be the minimum of (p −p′) · βφ over improper colorings φ, and let εΦ :=
Pr[Φ is improper]. We have
0 = E[(p −p′) · βΦ]
=
X
proper φ∈ΣV
Pr[Φ = φ] (p −p′) · βφ +
X
improper φ∈ΣV
Pr[Φ = φ] (p −p′) · βφ
≥(1 −εΦ)∆−εΦΓ.
(4)
Hence, since Γ ≤1, we get
εΦ ≥
∆
∆+ Γ ≈∆
Γ ≥∆,
where the approximation assumes ∆≪Γ, which will be the case for the instances we
consider.
Solving the linear program.
We used Wolfram Mathematica to solve the linear pro-
gram (3) exactly (i.e., not in the ﬂoating-point arithmetic, but symbolically). The code for
this is relatively simple, only slightly building on top of the code given in Appendix C. We
have made the code available online [LGR22].
To ﬁnd the set of all distinct βφ, we run a brute force search over all proper φ ∈Σn.
For example, for n = 11, n = 16, n = 21, the number of such distinct βφ is, respectively,
21, 410, 8336.
Once we had found optimal p, p′, for values of n up to 19, we run the brute force search
over all improper colorings φ to compute Γ = −minφ (p −p′) · βφ for them. Since there are
approximately 2n proper colorings and approximately 3n improper colorings, ﬁnding Γ is
computationally slower than ﬁnding ∆.
Figure 3 shows lower bounds on the error probability of 3-coloring the ring using quan-
tum single-round one-way distributed algorithms for n = 11, 12, . . . , 22. For n = 12, this
lower bound is 0.
Figure 4 shows optimal solutions p, p′ of the linear program (3). We can see that p is
sharply concentrated around small distances (treating distances d and n−d as the minimum
between them), while p′ is more ﬂatly supported on long distances. In Figure 4 we have
plotted p, p′ for n = 13, 14, 15, 20, 21, 22, and similarly shaped plots were observed for other
values of n between 11 and 22.
We note that, if a non-zero bias could be achieved by some p and p′ that are supported
on {r +1, r +2, . . . , n−r −1}, then that would imply the impossibility of perfect 3-coloring
in r one-way rounds. However, we succeeded to ﬁnd such p and p′ only for r = 1.
B.2
Exponential bounds via Lemma 4
In a similarly fashion to the ring in Section B.1, let us now consider a line segment
[[w..w + k −1]] of k nodes. For notational convenience, let w = 1. Let Ψ be a random
22

--- Page 23 ---





















12
14
16
18
20
22
n
0.000
0.002
0.004
0.006
0.008
0.010
0.012
Figure 3: Maximum bias ∆for n = 11, 12, . . . , 22, represented by squares, as well as lower bounds
∆
∆+Γ on the error probability for n up to 19, represented by circles. (Since Γ ≤1, for n = 20, 21, 22,
we can take
∆
∆+1 ≈∆as the lower bound on the error probability.)
coloring of this segment that is independent beyond distance 1.
As before, let us con-
sider the collection of frames F = ({{1}}, {{1}}). There are (k −1)(k −2) gap-1 placements
ω = (u, v) of F that respect [[1..k]], but, due to symmetry, it suﬃces to consider only the
half of them that have u < v.
Similarly as before, for u, v ∈{1, 2, . . . , k} such that v ≥u + 2 and a coloring ψ ∈Σk
of the line segment, let βψ,u,v = 1 if ψ(u) = ψ(v), and βψ,u,v = 0 otherwise, and we extend
this deﬁnition to random Ψ. Since Ψ is non-signaling beyond distance 1, Pr[Ψ(u) = Ψ(v)]
is the same for all non-adjacent u, v, and let us denote this probability by γ. Let us consider
the vectors βψ := (βψ,u,v)u,v and probability distributions p := (pu,v)u,v over non-adjacent
nodes expressed as vectors, where the indexing is done in the same consistent manner. We
have E[βΨ] = (γ, γ, . . . , γ), and thus E[(p −p′) · βΨ] = 0.
Similarly as before, we deﬁne the maximum bias ∆as the optimal value of the linear
program
maximize
∆
(5a)
subject to
(p −p′) · βψ ≥∆
for all proper ψ.
(5b)
We note that solving the linear program (5) is more costly than (3), given the number of
nodes, k and n respectively, are equal. That is because (5) does not exploit symmetries
due to the cyclicity of the ring. In particular, up to color permutations, one can recover ψ
from βψ.
We solved the linear program (5) for increasing large values of k, and the smallest k for
which the optimum ∆is strictly positive is k = 15. For k = 15, the maximum bias is
∆=
569 800 825
2 362 818 191 739 ≈2.412 · 10−4.
23

--- Page 24 ---
p'd
pd
n=13
0
.1
.2
.3
.1
.2
p'd
pd
n=14
0
.1
.2
.3
.1
.2
p'd
pd
n=15
0
.1
.2
.3
.1
.2
p'd
pd
n=20
0
.1
.2
.3
.1
.2
p'd
pd
n=21
0
.1
.2
.3
.1
.2
p'd
pd
n=22
0
.1
.2
.3
.1
.2
Figure 4: Optimal solutions p, p′ of the linear program (3) for n = 13, 14, 15, 20, 21, 22. Probability
distributions p, p′ have disjoint supports, and we display only non-zero probabilities in them. The
horizontal axis corresponds to the distance d. The upward-pointing vertical axis corresponds to pd,
while the downward-pointing vertical axis corresponds to p′
d.
An optimal solution (p, p′) corresponding to this ∆is illustrated in Figure 5. As in Figure 4
for the whole ring, we see that p is supported on pairs (u, v) with shorter distances between
them, while p′ on pairs (u, v) with larger distances between them.
Then, for this solution (p, p′), we computed the minimum −Γ of (p −p′) · βψ over all
improper ψ, and we found
Γ = 218 333 768 903 290 121
655 639 517 480 121 198 ≈0.3330
(note that, since the solution (p, p′) is not necessarily unique, neither is Γ). Just like the
argument based on the inequality (4), this means that the success probability of Ψ is at
most
Γ
∆+Γ < 1382
1383. This together with Lemma 4 proves Theorem 8.
24

--- Page 25 ---
Figure 5: An optimal solution of (5) for the 15-node line segment. The blue dotted discs indicate
non-zero pu,v and the orange honeycombed discs indicate non-zero p′
u,v.
The probabilities are
proportional to the area of the disc, the scale being indicated by the ﬁve overlapping discs in gray.
C
Code for Witnessing Impossibility of Perfect Coloring
Here we consider the ring of n = 11 nodes, and we present a Wolfram Mathematica code
that veriﬁes that, according to arguments in Section B.1, it is impossible for a quantum
single-round one-way distributed algorithm to perfectly 3-color the ring.
Consider probability distributions p = (30
41, 11
41, 0, 0) and p′ = (0, 0, 14
41, 27
41) over distances
2, 3, 4, 5, respectively. As in Section B.1, for a coloring φ ∈ΣV, let βφ := (βφ,2, βφ,3, βφ,4, βφ,5),
where βφ,d := |{v ∈V : φ(v) = φ(v + d)}|/n. The following code returns minDelta of
1
451,
showing that (p −p′) · βφ ≥
1
451 for all proper colorings φ.
1
n = 11;
2
pp = {30, 11, -14, -27}/41;
3
minDelta = 1;
4
For[i = 0, i < 2^(n - 2), i++,
5
steps = 1 + IntegerDigits[i, 2, n - 2];
6
phi = {1, 0}~Join~Mod[Total[Take[steps, #]] & /@ Range[n - 2], 3];
7
If[Last[phi] == 1, Continue[]];
8
betaN = {};
25

--- Page 26 ---
9
For[d = 2, d <= Floor[n/2], d++, betaNd = 0;
10
For[v = 1, v <= n, v++,
11
betaNd += Boole[phi[[v]] == phi[[Mod[v + d, n, 1]]]]];
12
AppendTo[betaN, betaNd];];
13
If[pp . betaN < n minDelta, minDelta = pp . betaN/n];];
14
Print[minDelta]
Line 1 of the code is self-explanatory. In line 2, we deﬁne constant pp as p −p′. In line
3, we introduce variable minDelta that will track the minimum (p −p′) · βφ found so far,
which is clearly no more than 1. We consider the set of colors Σ = {0, 1, 2}. The For loop
of lines 4–13 goes over all proper colorings of the ring that, without loss of generality, colors
nodes v = 0 and v = 1 with colors 1 and 0, respectively. We note that not all counters i
correspond to proper colorings as about a third of them are discarded in line 7, which tests
if φ(n −1) = 1 = φ(0).
In line 5, we represent i as an n −2 bit string, and then we add 1 to all bits, getting a
string steps ∈{1, 2}n−2. After that, in line 6, we eﬀectively assign φ(j+1) := φ(j)+stepsj
mod 3 for all j from 1 to n −2. Thus φ is a proper coloring aside from, potentially, having
φ(n −1) = φ(0), which we check in line 7.
In lines 8–12, we compute βφn in the variable betaN. Here betaNd contains βφ,dn = |{v ∈
V : φ(v) = φ(v + d)}|, which is simply counted in line 11. Note that Wolfram Mathematica
indexes lists starting with index 1. Finally, in line 13, we update the minimum (p −p′) · βφ
if necessary, and print the result in line 14.
To implement the linear program (3), one only has to slightly extend the code above.
That code as well as all the other code that we have used for our computations is made
available online [LGR22].
26
