Ideas
- We sharpen the “UPA” (universally PNE-admitting under arbitrary external fields h) picture by giving: (i) an exact counting result for PNE on functional digraphs (outdegree ≤ 1) with positive directed cycles; (ii) a linear-time structural-balance checker for directed SCCs under our convention (edge i→j imposes σ_iσ_j=sign W_{ij}); (iii) a robust nonexistence certificate (dominant negative directed cycles), with a quantitative margin.

Functional digraphs: exact PNE counting and construction
Setup. Dependency arc i→j iff W_{ij}≠0; outdegree ≤1 for all i. For i with successor s(i) let w_i:=W_{i s(i)}. Utilities are u_i(x)=x_i(h_i+w_i x_{s(i)}), so player i’s best response depends only on x_{s(i)} and h_i,w_i.
Define the unary best response f_i:{±1}→{±1} by f_i(y)=sgn(h_i+w_i y). If |h_i|<|w_i| then f_i(y)=sgn(w_i)·y (strictly responsive); if |h_i|>|w_i| then f_i is constant c_i:=sgn(h_i); if |h_i|=|w_i| ties can be broken arbitrarily but we can treat f_i as constant (this only weakens uniqueness statements).

Theorem (functional, positive cycles: PNE counting). Let the functional digraph decompose into directed cycles C_1,…,C_c with in-arborescences feeding into cycle vertices. For cycle C, let σ(C):=∏_{i∈C} sgn(w_i).
(i) If σ(C)=+1 for every cycle, then for every h the game has at least one PNE. More precisely, for each C, the number κ(C) of compatible assignments on C that make all nodes on C best reply is:
- κ(C)=2 if every node on C is strictly responsive (|h_i|<|w_i| for all i∈C);
- κ(C)=1 otherwise (i.e., at least one constant map on C).
The total number of PNE equals ∏_{r=1}^c κ(C_r). Moreover, all tree nodes (off-cycle) are uniquely determined by best responses and the resulting PNE are strict whenever all involved best responses are strict.
(ii) If some cycle C has σ(C)=−1 and |h_i|<|w_i| for all i∈C, then no PNE exists (for these h) regardless of the rest of the graph.
Proof. For (i), fix a cycle C=(i_1→…→i_L→i_1) and consider the composition F_C:=f_{i_1}∘f_{i_L}∘…∘f_{i_2}:{±1}→{±1}. If at least one f_{i_k} is constant, then F_C is constant, hence has a fixed point in {±1} and thus a consistent assignment along C exists making each i∈C best respond. If all f_{i_k} are responsive, then F_C(y)=(∏_{i∈C} sgn(w_i))·y=σ(C)·y, so F_C is the identity when σ(C)=+1, hence two fixed points on C; if σ(C)=−1 then no fixed point exists, proving (ii). For each arborescence edge j→i with i already assigned, set x_j:=f_j(x_i); u_j depends only on x_{s(j)}, so this yields a best response at j. Doing this for all branches determines a unique extension. Strictness holds whenever |h_i|≠|w_i| for all i (no ties). ∎
Consequences. Within the functional class, UPA (for all h) occurs iff σ(C)=+1 for all directed cycles; the counting above refines the positive case and provides a linear-time constructor and enumerator.

Dominant negative cycles: robust obstruction
Lemma (dominant negative directed cycle). Let C be a directed cycle with sign product ∏_{(i→j)∈C} sgn(W_{ij})=−1. If for every node i on C we have |W_{i s(i)}| > |h_i| + ∑_{j≠ s(i)} |W_{ij}|, then no PNE exists.
Proof. Write S_i=h_i+∑_j W_{ij}x_j=W_{i s(i)}x_{s(i)}+R_i with |R_i|<|W_{i s(i)}|. Thus sgn S_i = sgn(W_{i s(i)}x_{s(i)}), and any best reply forces x_i=sgn(W_{i s(i)})x_{s(i)}. Multiplying around C yields x_{i_1}=(∏ sgn(W_{i s(i)}))x_{i_1}=−x_{i_1}, a contradiction. ∎
This provides an efficiently checkable nonexistence certificate for instances (robust to arbitrary extra neighbors as long as the margin holds).

Directed structural balance: linear-time checker
Claim. A directed SCC U is structurally balanced (∃σ∈{±1}^U with [σ]W_{UU}[σ]≥0) iff the constraint system σ_iσ_j=sgn(W_{ij}) is consistent for all arcs i→j in U. Equivalently: (a) for every digon {i,j} present, sgn(W_{ij})=sgn(W_{ji}); and (b) in the underlying unsigned graph, every simple undirected cycle has positive sign product.
Algorithm. For each weakly connected component in U: (1) if both i→j and j→i exist and have opposite signs, reject; else define a single undirected signed edge {i,j} with s_{ij}:= the common sign (or the sign of the single directed edge if only one exists). (2) 2-color by BFS/DFS with constraints σ_j=s_{ij}σ_i; reject upon conflict. Success returns σ.
Complexity is O(|U|+|E(U)|). If successful, [σ]W_{UU}[σ] has nonnegative entries on arcs and the SCC is unsigned, hence UPA by supermodularity for all external fields.

Two-player SCCs: complete UPA classification
Lemma. For a 2-node SCC {1,2}, UPA ⇔ W_{12}W_{21}≥0. Proof. If product <0, with h=0 the BR equations force x_1=x_2 and x_2=−x_1, impossible. If product ≥0, either unsigned (both ≥0) or switched to unsigned by σ=(1,−1) (both ≤0). ∎

Examples
- Functional positive 4-cycle with no biases: signs (+,+,−,−) so σ(C)=+1. By the counting theorem, κ(C)=2; each attached tree is uniquely determined; total PNE=2.
- Negative 3-cycle with dominance margin: W_{12}=W_{23}=W_{31}=−5, all other out-weights zero; h=0. The obstruction lemma applies: no PNE.
- Two-player digon: W_{12}=2,W_{21}=−3,h=0 has no PNE; with W_{12}=2,W_{21}=5 any h admits a PNE.

Obstacles
- Beyond the functional class, a full UPA characterization of SCCs remains open. Structural balance (via the checker above) and exact potential (symmetry) are sufficient and efficiently testable, but necessity fails in general (some asymmetric SCCs admit PNE for all h due to special weight structures).
- Handling ties (|h_i|=|w_i|) requires a tie-breaking convention; counting statements become set-valued but existence and constructions remain valid.

Next steps
- Extend counting to “almost-functional” SCCs (outdegree bounded by 2) using 2-variable compositions and identify additional UPA subclasses.
- Codify a polynomial-time pipeline: Tarjan SCCs; per SCC test symmetry or structural balance by the parity checker; else test functional-positive; otherwise, try cohesive-core constructions or output dominant-cycle obstructions; construct PNE by reverse topological order; provide pseudocode and complexity guarantees.
- Quantify robustness margins guaranteeing uniqueness and BR-convergence (strictness) in the functional-positive class (all |h_i|≠|w_i|) and integrate with the BR-stability notions in the paper.
