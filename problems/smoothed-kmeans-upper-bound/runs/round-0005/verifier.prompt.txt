--- SYSTEM ---
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (summary so far)
- output.md (rigorously proven results so far)

Guidelines:
- notes.md: should be a readable running log of interesting work. Prefer appending. Replace only if old notes are clearly misleading. Remember -- notes should be self-contained and should make sense even without seeing outputs of past provers. 
- output.md:  Think twice before you add something to this file. Everything here should be rigorous, almost publication-ready. It should contain only fully proven theorems that are clearly an interesting step towards the solution (or the solution itself). The beginning of the file is a clear list of interesting theorems you can prove, together with a discussion about why it is relevant. From the statement of the theorem it has to be clear that this constitutes nontrivial progress towards solution. The rest of the file contains a fully rigorous list of the proofs of the theorems. Keep only proven theorems with clear proofs. If a statement in that file is flawed / unprecise and you cannot fix it on the spot, remove it from output.md and instead add it to notes.md with explanation.
- Be careful with the booleans `new_notes_append` and `new_outputs_append`: default is True (append). Use False only when deliberately rewriting everything.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions. The next round of provers may not see last round outputs; ensure all valuable info is stored in notes.",
  "new_notes_md": "Markdown (KaTeX allowed). Usually appended to notes.",
  "new_notes_append": "True|False",
  "new_outputs_md": "Markdown (KaTeX allowed). Usually appended to output.md.",
  "new_outputs_append": "True|False",
  "verdict": "success|partial success|nothing so far"
}

**Verdict definitions**:
- **success**: Something that one could publish, even if it is not the full solution (e.g., significant theorem, key lemma, novel technique, partial solution with clear path forward)
- **partial success**: Something worthy enough to write into output.md (e.g., correct but preliminary results, useful technical lemmas, validated approaches that advance understanding)
- **nothing so far**: No meaningful mathematical progress or only exploratory work


--- USER ---
You receive multiple prover reports. Evaluate correctness, value, and pick promising directions. Update notes.md (append/replace) with useful ideas and update output.md (append/replace) ONLY with rigorously verified results.

Prover reports (JSON):
[{"prover_id": "01", "progress_md": "Round 0005 \u2014 Audit, small fixes, and new, checkable corollaries for global aggregation and probability\n\nSummary of audit of output.md\n- The new \u03c4\u2248m/ln L branch (Corollary 10), the min-of-three per-plateau envelope (Corollary 11), and explicit constants for C_bi=C_fix=5 (Corollary 12) are all correct and valuable. The \u201c\u22651% probability\u201d remark now uses \u03b7=0.98, c=2, which cleanly gives 1% mass up to O(1/L).\n- Minor gap to clarify: Corollary 11 explicitly restricts the third branch (m(1+ln ln L))/L to L\u22653. Corollary 12 states a min-of-three for L\u22652 without this restriction. For L=2, ln ln L<0, so the third term can be negative and should not be part of the minimum. Suggested fix: add \u201cthe third term is intended only for L\u22653; for L=2 take the minimum of the first two terms,\u201d mirroring Cor. 11.\n\nNew, checkable additions recommended for output.md\n\n1) Global min-of-three aggregation across plateaus (explicit statement)\n- Statement (Global envelope). Let [k0,2k0) be partitioned into maximal factor-2 plateaus I_j=[m_j,m_j+L_j), j=1,\u2026,J. Then for k uniform in [k0,2k0) and k-means++ randomness,\n  E_{k,++}[ALG_k/OPT_k]\n  \u2264 (1/k0) \u03a3_{j: L_j\u22652} L_j [ K0 + K1\u00b7min{ ln^+(2m_j/(L_j\u22121)), (m_j ln L_j)/L_j, (m_j(1+ln ln L_j))/L_j } ]\n    + (K2/k0) \u03a3_{j: L_j\u22652} ln m_j + (1/k0) \u03a3_{j: L_j=1} C_fix(ln m_j + O(1)).\n  For C_bi=C_fix=5, one can set K0=35, K1=10, K2=5 (as in Corollary 12). For the third term in the minimum, restrict to L_j\u22653.\n- Why useful: This directly operationalizes Corollaries 11\u201312 into a window-level bound and makes the tradeoffs transparent. Proof: average Cor. 11 over each plateau with weight L_j/k0, add the \u0394=0 endpoint contributions (as in Cor. 3), and handle L_j=1 via the fixed\u2011k bound.\n\n2) A simple bound on the endpoint-sum contribution (unweighted log term)\n- Lemma (Endpoint term cap). With notation above, (1/k0) \u03a3_{j: L_j\u22652} ln m_j \u2264 ln(2k0).\n  Proof: There are at most J\u2264k0 plateaus and each m_j\u22642k0\u22121, so \u03a3 ln m_j \u2264 J\u00b7ln(2k0) \u2264 k0\u00b7ln(2k0). Dividing by k0 yields the claim. Consequence: the unweighted endpoint term is never more than O(ln k0), matching the worst-case \u0398(ln k0) behavior already noted.\n\n3) Long-plateau constant regime \u2014 global instantiation with explicit constants\n- Corollary (Global constant under a single long plateau). Suppose there exists a plateau I=[m,m+L) with L\u2265\u03b1 m and L/k0\u2265\u03b3. Then using Corollary 5 with C_bi=5 and any L\u22653,\n  E_{k\u2208I,++}[ALG/OPT] \u2264 10\u00b7(3 + 1/(2e) + ln(2/\u03b1)) + o(1) (as L\u2192\u221e).\n  Therefore,\n  E_{k,++}[ALG/OPT] \u2264 \u03b3\u00b7O_\u03b1(1) + (1\u2212\u03b3)\u00b7[the global min-of-three bound on [k0,2k0)\\I].\n- This is an immediate corollary of Cor. 5 and the global averaging in Item 1.\n\n4) 1%-probability guarantee \u2014 explicit global mixing\n- Corollary (\u22651% mass under a long plateau). Under the same assumptions as above (L\u2265\u03b1 m, L/k0\u2265\u03b3), Corollary 9 with \u03b7=0.98 and c=2 and the Remark after Corollary 12 give\n  P_{k\u223cU([k0,2k0)),++}[ ALG/OPT \u2264 2\u00b7B_I ] \u2265 \u03b3\u00b7(1\u2212\u03b7\u2212O(1/L))\u00b7(1\u22121/2) \u2265 0.01\u00b7\u03b3 \u2212 O(\u03b3/L),\n  with B_I = 2\u00b7C_bi\u00b7(1 + 1/(\u03b1 e \u03b7)) + o(1). For C_bi=5 and \u03b1=1 this yields ALG/OPT \u2264 ~20\u00b7(1 + 1/(0.98 e)) \u2248 27.7 on at least 1%\u00b7\u03b3 of the joint (k,++) mass. This directly instantiates the alternative task objective under a simple, checkable condition.\n\nExamples and sanity checks\n- Power-law OPT: OPT_k \u221d k^{\u2212p} with p>0. Over [k0,2k0), a single factor\u20112 drop occurs, so plateau lengths satisfy L \u2248 (2^{1/p}\u22121)m = \u0398(m), i.e., \u03b1=\u0398_p(1). Global average is O_p(1) by Item 1.\n- Worst-case short plateaus: If L_j=1 for J\u2248k0 plateaus, Item 2 shows the endpoint term alone is \u0398(ln k0), so no unconditional improvement over \u0398(ln k0) is possible via plateau calculus.\n\nObstacles and open tasks\n- Constants for small L: For L=2, ensure the third branch is excluded in Corollary 12 (as already noted for Corollary 11). This avoids negative values from ln ln 2 in the minimum.\n- Heavy-coverage program: The metric-separation special case remains promising, but a fully general scale-separation-to-persistence derivation is open. Next concrete step: quantify a denominator lower bound cost_t(X) \u2265 \u03b2\u00b7U_t(H) under explicit geometric or separation assumptions, then sum conditional collision probabilities rigorously.\n\nNext steps (concrete and verifiable)\n1) Add the global min-of-three aggregation statement (Item 1) to output.md with the explicit constants option for C_bi=C_fix=5; include the L\u22653 restriction for the third branch in both Corollaries 11 and 12.\n2) Add the endpoint-sum cap lemma (Item 2) as a remark to bound the contribution of \u0394=0 endpoints globally by \u2264 ln(2k0)\u00b7K2.\n3) Include the long-plateau global corollary and the 1%-probability global instantiation (Items 3\u20134), which follow immediately from existing corollaries.\n4) Heavy-coverage: attempt a formal bound of the form E[U_{t+1}(H) | F_t, sample outside H] \u2265 (1\u2212\u03b5/R)\u00b7U_t(H) under a scale separation R\u2265k^C plus a mild geometric regularity, then proceed to an expected-collisions bound via conditional probability summation.\n\nWhy these are incremental and auditable\n- All additions are direct aggregations or instantiations of existing per-plateau results, with short proofs and explicit constants.\n- The minor fix in Corollary 12 (L\u22653 restriction for the third term) is precise and prevents a small edge-case pitfall.\n- The probability corollary provides a clean \u22651% guarantee meeting the alternative task statement under transparent conditions.\n"}, {"prover_id": "02", "progress_md": "## Quick audit of output.md (this round)\n- The new \u03c4\u2248m/ln L branch (Corollary 10) is stated correctly with L\u22653 and uses the previously recorded remark L\u2264m on [k0,2k0). The inequalities \u03c4\u2265m/ln L\u22121 \u21d2 ln(2m/\u03c4)\u2264ln(4 ln L), \u03c4/(L\u22121)\u2264m/((L\u22121) ln L), and H_{L\u22122}\u2212H_{\u03c4\u22121}\u22641+ln ln L are valid and inserted properly.\n- The min-of-three envelope (Corollary 11) logically follows by taking the minimum of the three explicit instantiations and absorbing additive terms. The explicit-constant version for C_bi=C_fix=5 (Corollary 12) is conservative and sound. A minor constant improvement is possible (see below), but not necessary for asymptotics.\n- The probability remark now uses \u03b7=0.98 and c=2 to ensure an unconditional \u22651% mass (up to O(1/L)), which fixes the earlier 0.0099 issue.\n\nI found no correctness errors; the presentation is coherent and self-contained for the plateau calculus.\n\n## New, checkable contributions\n\n### Lemma 1 (Global worst-case aggregation recovers O(log k0))\nStatement. Let [k0,2k0) be partitioned into maximal factor-2 plateaus I_j=[m_j,m_j+L_j) with \u2211_j L_j=k0. Using the pure-log branch from Corollary 7 (and the fixed-k bound for L_j=1), we have the unconditional bound\nE_{k\u223cU([k0,2k0)),++}[ALG_k/OPT_k] \u2264 K\u2032 + K\u2033\u00b7ln(2k0),\nfor absolute constants K\u2032,K\u2033 depending only on C_bi,C_fix.\nWhy useful. This shows our framework unconditionally matches the \u0398(log k0) baseline, validating that improvements necessarily require structural information on plateaus.\nSketch proof (fully checkable). For L_j\u22652,\n(1/k0)\u00b7L_j\u00b7ln^+(2m_j/(L_j\u22121)) \u2264 (1/k0)\u00b7L_j(ln 2 + ln m_j) \u2212 (1/k0)\u00b7L_j\u00b7ln(L_j\u22121).\nSumming over j and using L_j\u22121\u22651 so the last term is \u22640, we get\n(1/k0)\u2211_{j:L_j\u22652} L_j ln^+(2m_j/(L_j\u22121)) \u2264 ln 2 + (1/k0)\u2211_{j:L_j\u22652} L_j ln m_j.\nNow, for every k\u2208I_j, m_j\u2264k, hence ln m_j \u2264 ln k. Therefore,\n(1/k0)\u2211_{j:L_j\u22652} L_j ln m_j \u2264 (1/k0)\u2211_{k=k0}^{2k0\u22121} ln k \u2264 ln(2k0) \u2212 1 + o(1).\nAdd the endpoint terms (1/k0)\u2211_{j:L_j\u22652} A2 ln m_j \u2264 A2 ln(2k0) and the L_j=1 contribution (bounded by C_fix(ln(2k0)+O(1)) per index). Multiplying by the fixed absolute coefficients from Corollaries 2 and 7 and absorbing constants yields the displayed K\u2032+K\u2033 ln(2k0) bound.\n\n### Corollary 1 (Mixture bound with a long-plateau mass)\nStatement. Suppose the set J_long of plateaus satisfying L_j \u2265 \u03b1 m_j covers a \u03b3-fraction of [k0,2k0), i.e., \u2211_{j\u2208J_long} L_j \u2265 \u03b3 k0, where \u03b1,\u03b3\u2208(0,1]. Then\nE_{k}[ALG/OPT] \u2264 \u03b3\u00b7B_long(\u03b1) + (1\u2212\u03b3)\u00b7(K\u2032 + K\u2033\u00b7ln(2k0)) + O((1/k0)\u2211_j ln m_j),\nwith B_long(\u03b1) = 2\u00b7C_bi\u00b7(a+1+ln(2/\u03b1)) (cf. Corollary 5) and absolute K\u2032,K\u2033 from Lemma 1.\nWhy useful. This gives a clean, global interpolation: any nontrivial mass \u03b3 of long plateaus pushes the average below the \u0398(log k0) worst case by an additive \u03b3\u00b7O(1), with explicit constants.\nProof sketch. Average Corollary 5 over j\u2208J_long with weights L_j/k0 (giving \u2264\u03b3\u00b7B_long(\u03b1)+o(1)), and use Lemma 1 on the complement. The endpoint O((ln m_j)/L_j) terms aggregate into O((1/k0)\u2211_j ln m_j) \u2264 O(ln(2k0)).\n\n### Corollary 2 (Global \u22651% probability guarantee under a single long plateau)\nStatement. If some plateau I=[m,m+L) satisfies L \u2265 \u03b1 m and covers a \u03b3-fraction of [k0,2k0), then for k uniform on [k0,2k0) and ++ randomness,\nP[ ALG_k/OPT_k \u2264 2\u00b7B_I ] \u2265 \u03b3\u00b7(0.5\u2212O(1/L))\u00b70.5 \u2265 0.01\u2212o(1)\nfor parameters \u03b7=0.98, c=2 in Corollary 9, with B_I=2\u00b7C_bi\u00b7(1 + 1/(\u03b1 e \u03b7)) + O(1/L).\nWhy useful. This is a global, fully explicit \u22651% probability guarantee under a single structural condition on OPT(\u00b7), mirroring the task\u2019s alternative objective.\nProof. Directly apply Corollary 9 on I (with \u03b7=0.98, c=2) and mix with \u03b3.\n\n### Minor constant refinements (optional)\n- In Corollary 12 with C_bi=C_fix=5, 2\u00b7C_bi\u00b7(a+1)=10\u00b7(3+1/(2e))\u224831.84. One can safely state 33 instead of 35 if desired by allocating at most 1.16 to the endpoint O(1/L) term; this is purely cosmetic.\n\n## Examples and sanity checks\n- Worst-case pattern: Taking all plateaus of length 1 (i.e., OPT changes at every k) yields E_k,++[ALG/OPT] = \u0398(log k0), matched by Lemma 1.\n- Single dyadic-long plateau: If OPT halves once across the window (L\u2248m), then B_long(1) \u2264 2\u00b7C_bi\u00b7(a+1+ln 2) and the average is constant; Corollary 2 then gives a concrete \u22651% bound with an explicit constant factor.\n\n## Heavy-coverage program: a clean conditional collision bound (clarified)\nWe crystallize a conditional, pathwise statement that reduces the heavy-collision analysis to two verifiable parameters.\n\nLemma 2 (Heavy-collision bound under dominance and covered-cost control).\nLet H be a set of k1 \u201cheavy\u201d optimal clusters (in the k-clustering P). Assume that up to the stopping time \u03c4 when all heavy clusters are first covered, for every t<\u03c4,\n- Dominance: U_t(H) \u2265 \u03b2 \u00b7 ( H_t(all) + U_t(L) ) for some \u03b2>0; and\n- Covered-heavy control: H_t(H) \u2264 \u03b1 \u00b7 S_H, where S_H := \u2211_{P\u2208H} OPT1(P), \u03b1\u22651 is an absolute constant (\u03b1=5 suffices in expectation via the MRS Lemma 4.1; pathwise we can enforce H_t(H) \u2264 eH_t(H) \u2264 5 S_H). \nThen the expected number of times k-means++ samples a point from a covered heavy cluster before \u03c4 is at most k1 \u00b7 ( \u03b1/(\u03b2+1) ) \u00b7 (S_H/inf_{t<\u03c4} U_t(H)). In particular, if inf_{t<\u03c4} U_t(H) \u2265 S_H (a strong persistence condition), then E[# heavy-collisions] \u2264 k1\u00b7\u03b1/(\u03b2+1).\nWhy useful. This isolates the role of a quantitative persistence lower bound on U_t(H) and converts it into an explicit expected-collisions bound. It also cleanly uses the pathwise inequality H_t(H) \u2264 eH_t(H) and the supermartingale eH_t.\nProof sketch. At step t<\u03c4, conditional collision probability is p_t := H_t(H)/cost_t(X). By dominance, cost_t(X) = U_t(H) + (H_t(all)+U_t(L)) \u2264 U_t(H)\u00b7(1 + 1/\u03b2). Hence p_t \u2264 (\u03b1 S_H)/((1+1/\u03b2) U_t(H)). Each sample that lands in heavy either covers a new heavy cluster or collides. Summing per-step collision probabilities over the at most k1 heavy hits and lower-bounding U_t(H) by inf_{t<\u03c4} U_t(H) yields the bound.\nNext step. Derive a sufficient condition (in terms of OPT-scale separation and/or geometric separation) implying inf_{t<\u03c4} U_t(H) \u2265 c\u00b7S_H with c>0 and \u03b2=poly(1), then lift expectation to high probability by Freedman\u2019s inequality for supermartingales.\n\n## Obstacles and open items\n- Unconditional improvement barrier. Lemma 1 confirms that without structural constraints, the average cannot beat \u0398(log k0), aligning with the fixed-k lower bounds.\n- Heavy-coverage derivation from OPT-separation. The key missing piece remains a principled lower bound on U_t(H) in terms of S_H under a scale-separation hypothesis (e.g., OPT_{k1} \u226b OPT_k). We need to quantify how much sampling outside H can decrease U_t(H) before heavy clusters are hit; this likely requires a refined use of the eH_t supermartingale and per-cluster contributions.\n\n## Next steps (concrete, verifiable)\n1) Curate Lemma 1 and Corollary 1 into output.md to document unconditional aggregation and explicit mixture with long plateau mass.\n2) Add Corollary 2 as a global \u22651% probability statement (with \u03b7=0.98, c=2) and explicit constants, referencing Corollary 9.\n3) Optionally tighten Corollary 12\u2019s leading constant from 35 to 33, or annotate why 35 is a conservative rounding.\n4) For heavy-coverage, formalize Lemma 2 in output.md only after we pin down a verifiable persistence condition; in the meantime, attempt to prove inf_{t<\u03c4} U_t(H) \u2265 c\u00b7S_H and \u03b2=\u03a9(1) under a clean geometric or OPT separation hypothesis.\n5) Provide a compact \u201cregime chart\u201d illustrating which of the three branches dominates as a function of L/m, to guide users of the envelope (purely expository, no new math).\n"}]

Current notes.md:
Problem and notation
- X ⊂ R^d finite dataset; cost(C) = ∑_{x∈X} min_{c∈C} ||x−c||^2.
- OPT_k := min_{|C|=k} cost(C), nonincreasing in k.
- ALG_k := cost of k-means++ after k centers; E_++[·] denotes expectation over its randomness.
- We study E_{k∼U({k0,…,2k0−1})} E_++[ ALG_k / OPT_k ].

Key external input (Makarychev–Reddy–Shan 2020)
- There is an absolute constant C_bi (quoted as 5 in MRS) such that for any r≥1, Δ≥1,
  E_++[cost after r+Δ centers] ≤ C_bi · min{ 2 + 1/(2e) + ln(2r/Δ), 1 + r/(e(Δ−1)) } · OPT_r.
- For Δ=0 (fixed-k), there is an absolute constant C_fix (also ≲5 in MRS) with E_++[ALG_k] ≤ C_fix · (ln k + O(1)) · OPT_k.

Per-k oversampling bound (robust to s-misalignment)
- For any k, define s(k) := min{ s∈{1,…,k} : OPT_s ≤ 2·OPT_k }. Let Δ(k)=k−s(k).
- If Δ(k)≥1, then
  E_++[ALG_k] ≤ 2·C_bi · min{ 2 + 1/(2e) + ln(2 s(k)/Δ(k)), 1 + s(k)/(e(Δ(k)−1)) } · OPT_k.
- If Δ(k)=0, fall back to E_++[ALG_k] ≤ C_fix · (ln k + O(1)) · OPT_k.
Note: On any factor-2 plateau I=[m,m+L) (i.e., OPT_k∈(OPT_m/2,OPT_m] for k∈I), we have s(k)≤m and Δ(k)≥k−m; since the MRS bound is monotone in (s,Δ), replacing (s(k),Δ(k)) by (m,k−m) yields a valid upper bound.

Per-plateau averaging and Stirling control
- For a factor-2 plateau I=[m,m+L), L≥2, uniform k over I gives
  E_{k,++}[ALG_k/OPT_k] ≤ 2·C_bi · (2 + 1/(2e) + (1/(L−1))∑_{Δ=1}^{L−1} ln(2m/Δ)) + (C_fix(ln m + O(1)))/L.
- Using ln(n!) ≥ n ln n − n + 1 (n≥1),
  (1/(L−1))∑_{Δ=1}^{L−1} ln(2m/Δ) = ln(2m) − ln((L−1)!)/(L−1) ≤ 1 + ln(2m/(L−1)).
- Hence E_{k,++}[ALG_k/OPT_k] ≤ const + const·ln^+(2m/(L−1)) + O((ln m)/L), where ln^+(x)=max{ln x,0} and all const’s are absolute.

Decomposition over [k0,2k0)
- Partition [k0,2k0) into maximal factor-2 plateaus I_j=[m_j, m_j+L_j). For L_j≥2, the per-plateau average is bounded as above. For L_j=1, the single k in I_j contributes ≤ C_fix(ln m_j + O(1)). Averaging with weights L_j/k0 yields a global bound explicitly in terms of {(m_j,L_j)}; in the worst case many L_j=1 plateaus can force Θ(log k0).

Consequences and regimes
- Long plateaus: If some I=[m,m+L) satisfies L ≥ m/polylog(k0), then E_{k∈I,++}[ALG/OPT] = O(log log k0). If a constant fraction of [k0,2k0) is covered by such plateaus, the global average is O(log log k0).
- Worst case without structure: If many plateaus are short (e.g., L_j=1), the global average can be Θ(log k0), aligning with classic worst-case fixed-k behavior.

Open directions
- Structural conditions on OPT(·) implying many long plateaus (e.g., bounded discrete derivative decay, quasiconvexity/regularity of k·OPT_k) to get unconditional O(log log k0).
- Heavy-coverage lemma (conjectural): under strong scale separation OPT_{k1} ≫ OPT_k, show k-means++ hits all k1 heavy clusters w.h.p. before collisions, then apply bi-criteria on the remaining part.
- Lower bounds: Construct instances with Δ(k)=1 for a 1−o(1) fraction of k in [k0,2k0), giving an Ω(log k0) average and clarifying optimality of random-k smoothing.
Refinements and corrections for plateau averaging and monotonicity

- Monotonicity of the MRS bi-criteria bound. Define for integers s≥1 and Δ≥1 (interpreting the second branch only for Δ≥2):
  f(s,Δ) := min{ a + ln(2s/Δ), 1 + s/(e(Δ−1)) }, where a := 2 + 1/(2e).
  Then f is nondecreasing in s and nonincreasing in Δ. Consequently, on any factor-2 plateau I=[m,m+L) and for k=m+Δ with Δ≥1, the per-k bound from Theorem 1 satisfies
  f(s(k),Δ(k)) ≤ f(m,Δ), so we may safely replace (s(k),Δ(k)) by (m,Δ) in upper bounds.

- Correct τ-split averaging (fixing Proposition B). On a factor-2 plateau I=[m,m+L) with L≥2, for any integer τ∈{1,…,L−1}:
  (1/(L−1)) ∑_{Δ=1}^{L−1} min{ a+ln(2m/Δ), 1 + m/(e(Δ−1)) } (with the second term read only for Δ≥2)
  ≤ (τ/(L−1)) [ a + 1 + ln(2m/τ) ]
    + ((L−1−τ)/(L−1))
    + (m/(e(L−1))) · (H_{L−2} − H_{τ−1}).
  Proof sketch: Split the sum at τ and use Stirling ln(τ!) ≥ τ ln τ − τ + 1 to bound ∑_{Δ≤τ} ln(2m/Δ) ≤ τ(1+ln(2m/τ)). For the tail, sum 1/(Δ−1) as H_{L−2}−H_{τ−1}. This corrects two issues in earlier drafts: (i) the constant a must be multiplied by τ/(L−1), and (ii) ln(2m/Δ) cannot be upper bounded by ln(2m/τ) when Δ≤τ.

- Hybrid extremes recovered from the τ-split:
  • Choosing τ=L−1 gives the pure-logarithmic average a+1+ln(2m/(L−1)).
  • Choosing τ=1 gives the “hybrid extreme” 1 + (a+ln(2m))/(L−1) + (m/(e(L−1))) H_{L−2}.
  Hence we may take the minimum of these two regimes for a tighter bound, plateau by plateau.

- Long-plateau corollary. If L≥α m with α∈(0,1], then a+1+ln(2m/(L−1)) ≤ a+1+ln(2/α)+O(1/L), so the plateau-average is O(1) up to the endpoint term of order (ln m)/L.

- Quantile-in-Δ bound (careful threshold). For any η∈(0,1), let T := max{2, ⌈η(L−1)⌉+1}. Then, for all Δ≥T, by the large-Δ branch
  E_++[ALG_{m+Δ}/OPT_{m+Δ}] ≤ 2·C_bi·(1 + m/(e(T−1))).
  The fraction of k∈I with Δ≥T is (L−T+1)/L = 1 − η − O(1/L). This yields a rigorous “with probability ≥ 1−η−O(1/L) over k uniform on the plateau” expected-ratio bound; Markov then converts it into a constant-factor joint (k,++) probability if desired.

- Global decomposition improvement. Using the τ-split per plateau and optimizing τ as a function of (m,L) leads to a refined global bound that, informally, scales like
  K0 + K1 · min{ ln^+(2m/(L−1)), (m ln L)/L } + K2 · (ln m)/L,
  up to absolute constants K0,K1,K2. Formalizing this from Theorem 3 is a next step.

Open directions and next steps
- Optimize τ in the τ-split bound and write a clean, closed-form per-plateau bound. Then aggregate over plateaus to strengthen Corollary 3.
- Probability guarantees: phrase clean conditions under which at least a 1% measure of k (in [k0,2k0) or on a specific plateau) yields a constant expected ratio, and apply Markov to obtain joint (k,++) probability.
- Heavy-coverage: formalize the supermartingale for heavy uncovered mass (precise citation from MRS), bound expected heavy-collisions by O(k1/R), and lift to high probability via Freedman/Azuma with a stopping time.
- Lower bounds: construct OPT(·) with OPT_{k−1}/OPT_k ≈ 1 − Θ(1/ln k0) for most k to force Δ(k)=1 on a 1−o(1) fraction of the window, yielding an Ω(log k0) average.
Additions and clarifications

- Geometric constraint on plateau length within the window. If a factor-2 plateau I=[m,m+L) is contained in [k0,2k0), then L ≤ 2k0−m ≤ m. In particular, for L≥2 we have m/(L−1) ≥ 1. This prevents sign errors when simplifying expressions involving m/(L−1).

- Min-of-extremes and an upper envelope. From Theorem 3 and Corollary 4 we can (and will) use the minimum of the two extreme instantiations τ=L−1 (pure log) and τ=1 (hybrid extreme). Using H_q ≤ ln q + 1, this yields a clean per-plateau upper envelope of the form
  E_{k∈I} E_++[ALG_k/OPT_k] ≤ K0 + K1 · min{ ln^+(2m/(L−1)), (m ln L)/L } + K2 · (ln m)/L,
for absolute constants K0,K1,K2 depending only on C_bi,C_fix. This is the regime split we will use in global aggregation: the log term dominates when L≪m, while the (m ln L)/L term is O(1) when L is a constant fraction of m.

- Safe balanced-split (τ=⌊L/2⌋) template (optional). The following uniform bounds hold for L≥3 and τ=⌊L/2⌋:
  • τ/(L−1) ≤ 2/3 and (L−1−τ)/(L−1) ≤ 1/2.
  • ln(2m/τ) ≤ ln(4m/(L−1)).
  • H_{L−2} − H_{τ−1} ≤ ln 3 + 1 (with small-L cases checked directly).
Plugging these into Theorem 3 yields the rigorous estimate
  E_{k∈I} E_++[ALG_k/OPT_k]
  ≤ 2C_bi [ (2/3)(a + 1 + ln(4m/(L−1))) + 1/2 + (m/(e(L−1)))(ln 3 + 1) ]
    + (C_fix(\ln m + O(1)))/L.
This improves the (m ln L)/L term to a pure (m/L) term at the expense of a larger coefficient on the logarithmic piece. It may be tighter than the min-of-extremes envelope in intermediate regimes. If used, constants must be kept as above (1/2 is not a safe coefficient for τ/(L−1) when L is even).

- Probability ≥ 1% guarantees under a long-plateau condition. From Corollary 6: fix η∈(0,1) and define T := max{2, ⌈η(L−1)⌉+1}. For at least a (1−η−O(1/L)) fraction of k∈I we have
  E_++[ALG_k/OPT_k] ≤ 2C_bi (1 + m/(e(T−1))).
By Markov, for any c≥1,
  P_{++}[ ALG_k/OPT_k ≤ c · 2C_bi (1 + m/(e(T−1))) ] ≥ 1 − 1/c
for each such k. Therefore, jointly over k uniform on I and ++ randomness,
  P[ ALG_k/OPT_k ≤ c · 2C_bi (1 + m/(e(T−1))) ] ≥ (1−η−O(1/L))(1−1/c).
If L ≥ α m, then m/(T−1) ≤ 1/(α η) up to 1+O(1/L) factors, giving an explicit constant bound. If the plateau covers a γ-fraction of [k0,2k0), the global probability is ≥ γ times the RHS. Example: with C_bi=5, α=1, η=0.99, c=100, we get a ≥1% guarantee with a factor ≤ 100·2·5·(1 + 1/(0.99 e)).

- Heavy-coverage program (caveats and plan). Any per-step “collision within heavy” probability bound must be stated conditionally on the current filtration F_t: under D^2 sampling,
  P[collision in H at step t | F_t] = cost_t(covered H) / cost_t(all).
Avoid ratio-of-expectations. A plausible route is to bound cost_t(covered H) in terms of the uncovered heavy mass U_t(H) via the MRS eH_t supermartingale (in expectation and eventually with concentration), while lower bounding cost_t(all) by U_t(H) + U_t(L). To obtain a β-persistence-type condition from scale separation, quantify the expected reduction of U_t(H) when sampling outside H and show it is o(U_t(H)) under strong separation (e.g., OPT_{k1} ≥ k^C · OPT_k). With these in place, the expected number of heavy collisions can be bounded by summing the conditional probabilities until all heavy clusters are hit, and then lifted to high probability by Freedman/Azuma.

- Lower bounds. To show random-k smoothing cannot beat Θ(log k0) in general, aim for an instance where Δ(k)=1 for a 1−o(1) fraction of k in [k0,2k0). Concretely, calibrate radii so OPT_{k−1}/OPT_k ≈ 1 + Θ(1/ln k0) across most of the window, ensuring s(k)=k−1 on most k. Then adapt Arthur–Vassilvitskii’s lower-bound calculation to the averaged setting.
New per-plateau refinement: τ≈m/ln L branch and an updated envelope

- Additional τ-instantiation. On a factor-2 plateau I=[m,m+L) with L≥3, choose τ*:=min{L−1, ⌊m/ln L⌋}. Then Theorem 3 yields
  E_{k∈I} E_++[ALG/OPT]
  ≤ 2C_bi [ (τ*/(L−1))(a+1+ln(2m/τ*)) + ((L−1−τ*)/(L−1)) + (m/(e(L−1)))(H_{L−2} − H_{τ*−1}) ]
    + (C_fix(\ln m + O(1)))/L,
  where a:=2+1/(2e).
  In the subcase m ≤ (L−1) ln L (hence τ*=⌊m/ln L⌋) and assuming m≥L (which holds for plateaus contained in [k0,2k0)), we can bound
  • ln(2m/τ*) ≤ ln(4 ln L)
  • τ*/(L−1) ≤ m/((L−1) ln L)
  • H_{L−2} − H_{τ*−1} ≤ 1 + ln ln L
  to conclude
  E_{k∈I} E_++[ALG/OPT]
  ≤ 2C_bi [ 1 + (m/((L−1) ln L))(a+1+\ln(4\ln L)) + (m/(e(L−1)))(1 + \ln\ln L) ]
    + (C_fix(\ln m + O(1)))/L.
  This improves the (m\ln L)/L tail from the τ=1 branch to ≈ (m/L)(1+\ln\ln L).

- Updated min-of-three envelope (plateau-wise). Together with the τ=L−1 (pure-log) and τ=1 (hybrid) instantiations, we may use
  E_{k∈I} E_++[ALG/OPT] ≤ K0 + K1·min{ ln^+(2m/(L−1)), (m\ln L)/L, (m(1+\ln\ln L))/L } + K2·(\ln m)/L,
  for absolute constants K0,K1,K2 depending only on C_bi,C_fix. This strictly strengthens the previous min-of-two envelope in regimes where ln ln L ≪ ln L.

- Global aggregation (window-wise). For the maximal factor-2 plateau partition [k0,2k0)=\bigsqcup_j I_j with I_j=[m_j,m_j+L_j), one may take, plateau by plateau, the minimum of the three branches above (with the third used for L_j≥3), and sum with weights L_j/k0:
  E_{k\sim U([k0,2k0))} E_++[ALG/OPT]
  ≤ (1/k0) \sum_j L_j [ K0 + K1·min{ ln^+(2m_j/(L_j−1)), (m_j\ln L_j)/L_j, (m_j(1+\ln\ln L_j))/L_j } ]
    + (K2/k0) \sum_j \ln m_j.

- Balanced split reminder. The τ=⌊L/2⌋ instantiation yields
  E_{k∈I} E_++[ALG/OPT]
  ≤ 2C_bi [ (2/3)(a+1+\ln(4m/(L−1))) + 1/2 + (m/(e(L−1)))(\ln 3 + 1) ] + (C_fix(\ln m + O(1)))/L,
  valid for all L≥3. This removes the ln L factor in the tail at the expense of a larger constant on the log piece.

- Probabilistic 1% instantiation (correction). From Corollary 9, for any η∈(0,1) and c≥1,
  P_{k∈I,++}[ ALG/OPT ≤ c·B_I ] ≥ (1−η−O(1/L))(1−1/c), with B_I=2C_bi(1 + m/(e(T−1))), T=\max\{2,\lceil η(L−1)\rceil+1\}.
  To guarantee at least 1% mass uniformly (up to O(1/L)), take η=0.98 and c=2, giving (1−η)(1−1/c)=0.02·0.5=0.01. If, in addition, L≥α m, then B_I ≤ 2C_bi(1 + 1/(α e η)) up to O(1/L).

Caveat on heavy-coverage sketches. The pathwise control and metric-separation heuristics are promising but currently lack fully rigorous denominators: one must explicitly quantify cost_t(X) in terms of U_t(H) under precise conditions, and avoid uncontrolled uses of triangle inequality against existing centers outside H. These ideas remain in-development items in notes, not yet suitable for output.


Current output.md (if any):
Theorems curated in this file depend on the following standard notation and external input.
- For a finite dataset X⊂R^d, write OPT_k for the optimal k-means cost with k centers, and ALG_k for the cost produced by k-means++ after k centers; E_++[·] is expectation over the algorithm’s randomness.
- External input (Makarychev–Reddy–Shan, 2020): There exists an absolute constant C_bi such that for all integers r≥1 and Δ≥1,
  E_++[cost after r+Δ centers] ≤ C_bi · min{ 2 + 1/(2e) + ln(2r/Δ), 1 + r/(e(Δ−1)) } · OPT_r.
  There is also an absolute constant C_fix with E_++[ALG_k] ≤ C_fix·(ln k + O(1))·OPT_k for all k (the fixed-k bound). We treat C_bi and C_fix as absolute numerical constants.

Theorem 1 (Per-k oversampling bound via a 2-approximate anchor).
Fix k≥1 and define
  s(k) := min{ s∈{1,…,k} : OPT_s ≤ 2·OPT_k },    Δ(k) := k − s(k).
Then:
- If Δ(k) ≥ 1, we have
  E_++[ALG_k] ≤ 2·C_bi · min{ 2 + 1/(2e) + ln(2 s(k)/Δ(k)), 1 + s(k)/(e(Δ(k)−1)) } · OPT_k.
- If Δ(k) = 0, we have E_++[ALG_k] ≤ C_fix·(ln k + O(1))·OPT_k.
Proof.
For Δ(k)≥1, apply the MRS bi-criteria inequality with r = s(k) and Δ = k−s(k):
  E_++[ALG_k] = E_++[cost after s(k)+Δ(k) centers]
  ≤ C_bi · min{ 2 + 1/(2e) + ln(2 s(k)/Δ(k)), 1 + s(k)/(e(Δ(k)−1)) } · OPT_{s(k)}.
By definition of s(k), OPT_{s(k)} ≤ 2·OPT_k, giving the stated bound. For Δ(k)=0 the fixed-k bound yields the second claim. ∎

Theorem 2 (Averaging over a factor-2 plateau).
Let I = {m, m+1, …, m+L−1} with L≥2 and assume OPT_k ∈ (OPT_m/2, OPT_m] for all k∈I. Then for k uniform in I and over the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ] ≤ A0 + A1 · ln^+( 2m/(L−1) ) + (A2 · ln m)/L,
where ln^+(x) := max{ln x,0} and A0,A1,A2 are absolute constants depending only on C_bi,C_fix.
Proof.
Average the bound from Theorem 1 over k∈I. For Δ:=k−m≥1, we may upper bound s(k) by m and lower bound Δ(k) by Δ (since s(k)≤m and Δ(k)≥Δ on a factor-2 plateau), and use only the logarithmic branch of MRS to get
  E_++[ALG_{m+Δ}/OPT_{m+Δ}] ≤ 2·C_bi · ( 2 + 1/(2e) + ln(2m/Δ) ).
Averaging Δ from 1 to L−1 gives
  (1/(L−1))∑_{Δ=1}^{L−1} ln(2m/Δ) = ln(2m) − ln((L−1)!)/(L−1) ≤ 1 + ln(2m/(L−1)),
where we used ln(n!) ≥ n ln n − n + 1 for n=L−1≥1. Multiplying by (L−1)/L and adding the Δ=0 endpoint contribution C_fix(ln m + O(1))/L yields the claim with suitable absolute constants A0,A1,A2. Replacing ln by ln^+ only weakens the bound. ∎

Corollary 3 (Decomposition across [k0,2k0)).
Partition the integer interval [k0,2k0) into maximal factor-2 plateaus I_j = [m_j, m_j+L_j), j=1,…,J, so OPT_k ∈ (OPT_{m_j}/2, OPT_{m_j}] for k∈I_j, and ∑_j L_j = k0. Then, for k uniform on [k0,2k0),
  E_k E_++[ ALG_k / OPT_k ]
  ≤ (1/k0) ∑_{j : L_j≥2} L_j [ A0 + A1 · ln^+( 2 m_j/(L_j−1) ) ]
    + (1/k0) ∑_{j : L_j≥2} A2 · ln m_j
    + (1/k0) ∑_{j : L_j=1} C_fix · (ln m_j + O(1)).
In particular, if a constant fraction of [k0,2k0) is covered by plateaus satisfying L_j ≥ m_j / polylog(k0), then the contribution of those plateaus is O(log log k0), and the remaining fraction must be controlled separately; in the worst case with many L_j=1 plateaus the global average can be Θ(log k0).
Proof.
Average the bound of Theorem 2 over plateaus with weights L_j/k0, and handle L_j=1 plateaus by the fixed-k bound. ∎
Lemma (Monotonicity of the MRS bi-criteria bound).
Let a := 2 + 1/(2e), and for integers s≥1, Δ≥1 define
  F(s,Δ) := min{ a + ln(2s/Δ), 1 + s/(e(Δ−1)) },
where the second term is interpreted only for Δ≥2 (or taken as +∞ for Δ=1). Then:
- For fixed Δ, F is nondecreasing in s.
- For fixed s, F is nonincreasing in Δ (for all Δ≥1 in the above interpretation).
Proof.
For Δ≥2, both functions s ↦ a + ln(2s/Δ) and s ↦ 1 + s/(e(Δ−1)) are nondecreasing in s, hence their pointwise minimum is nondecreasing. For Δ≥2, both functions Δ ↦ a + ln(2s/Δ) and Δ ↦ 1 + s/(e(Δ−1)) are nonincreasing in Δ, hence the minimum is nonincreasing. For the transition from Δ=1 to Δ=2, note that F(s,1) = a + ln(2s) ≥ a + ln(s) ≥ a + ln(2s/2) ≥ F(s,2), since the logarithmic branch decreases with Δ and adding the second branch at Δ=2 can only decrease the minimum. Thus F is nonincreasing in Δ for all Δ≥1. ∎

Theorem 3 (Plateau averaging with a tunable split of the two MRS branches).
Let I = {m, m+1, …, m+L−1} be a factor-2 plateau (i.e., OPT_k ∈ (OPT_m/2, OPT_m] for k∈I) with L≥2. For any integer τ with 1≤τ≤L−1, for k uniform on I and over k-means++ randomness we have
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ (τ/(L−1)) · ( a + 1 + ln(2m/τ) )
                + ((L−1−τ)/(L−1))
                + (m/(e(L−1))) · ( H_{L−2} − H_{τ−1} ) ]
    + (C_fix · (ln m + O(1)))/L,
where H_r denotes the r-th harmonic number (H_0:=0).
Proof.
Fix k=m+Δ with Δ∈{1,…,L−1}. By Theorem 1, and Lemma (monotonicity),
  E_++[ALG_{m+Δ}/OPT_{m+Δ}] ≤ 2·C_bi · min{ a + ln(2m/Δ), 1 + m/(e(Δ−1)) },
with the second branch applicable for Δ≥2. Averaging Δ uniformly over {1,…,L−1}, split the sum at τ:
  (1/(L−1)) ∑_{Δ=1}^{L−1} min{…}
  ≤ (1/(L−1)) ∑_{Δ=1}^{τ} [ a + ln(2m/Δ) ]
    + (1/(L−1)) ∑_{Δ=τ+1}^{L−1} [ 1 + m/(e(Δ−1)) ].
For the first sum, use ∑_{Δ=1}^{τ} ln(2m/Δ) = τ ln(2m) − ln(τ!) ≤ τ[1 + ln(2m/τ)] by ln(τ!) ≥ τ ln τ − τ. For the second, ∑_{Δ=τ+1}^{L−1} 1 = L−1−τ and ∑_{Δ=τ+1}^{L−1} 1/(Δ−1) = H_{L−2} − H_{τ−1}. This yields the displayed bound. Finally, incorporate the Δ=0 endpoint k=m which has probability 1/L and contributes at most C_fix·(ln m + O(1))/L by the fixed-k bound. ∎

Corollary 4 (Hybrid extremes recovered; strengthening Theorem 2).
In the setting of Theorem 3:
- Choosing τ = L−1 gives
  E_{k∈I} E_++[ ALG_k / OPT_k ] ≤ 2·C_bi · ( a + 1 + ln(2m/(L−1)) ) + (C_fix · (ln m + O(1)))/L.
  This recovers Theorem 2 (up to constant reparameterization by a and the explicit +1 from Stirling).
- Choosing τ = 1 gives
  E_{k∈I} E_++[ ALG_k / OPT_k ] ≤ 2·C_bi · ( 1 + (a+ln(2m))/(L−1) + (m/(e(L−1))) · H_{L−2} )
    + (C_fix · (ln m + O(1)))/L.
Using H_q ≤ ln q + 1, this yields a complementary regime where the bound scales like 1 + O((ln m)/L) + O((m ln L)/L).
Proof.
Both bounds are immediate from Theorem 3 with the specified τ and the inequality H_q ≤ ln q + 1 for q≥1. ∎

Corollary 5 (Explicit constants on long plateaus).
If L ≥ α m for some fixed α∈(0,1], then for k uniform on I,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · ( a + 1 + ln(2/α) ) + (C_fix · (ln m + O(1)))/L.
Proof.
Apply Corollary 4 with τ=L−1 and use ln(2m/(L−1)) ≤ ln(2/α) + O(1/L). The endpoint term is unchanged. ∎

Corollary 6 (Quantile-in-Δ guarantee on a plateau).
Fix η∈(0,1) and let T := max{2, ⌈η(L−1)⌉+1}. Then for all Δ∈{T,…,L−1},
  E_++[ ALG_{m+Δ} / OPT_{m+Δ} ] ≤ 2·C_bi · ( 1 + m/( e (T−1) ) ).
Consequently, for k uniform on I, the fraction of k for which the above inequality holds is at least (L−T+1)/L = 1 − η − O(1/L).
Proof.
For Δ≥T, the large-Δ branch gives 1 + m/(e(Δ−1)) ≤ 1 + m/(e(T−1)). Combine with Theorem 1 and monotonicity, and note that the set {k: Δ(k)≥T} has size L−T+1 among the L indices in I. ∎
Remark (Plateau length within [k0,2k0)).
Let I = [m,m+L) be a factor-2 plateau contained in [k0,2k0). Then L ≤ 2k0 − m ≤ m. In particular, for L≥2 we have m/(L−1) ≥ 1.
Proof.
Since m+L−1 ≤ 2k0−1, we have L ≤ 2k0−m. As m ≥ k0, it follows that 2k0−m ≤ m. The final claim is immediate. ∎

Corollary 7 (Min-of-extremes plateau bound).
In the setting of Theorem 3 with L≥2, for k uniform on I and the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ min{ B_log, B_hyb } + (C_fix · (ln m + O(1)))/L,
where
  B_log := 2·C_bi · ( a + 1 + ln^+( 2m/(L−1) ) ),
  B_hyb := 2·C_bi · ( 1 + (a+\ln(2m))/(L−1) + (m/(e(L−1))) · H_{L−2} ),
and a := 2 + 1/(2e), H_q denotes the q-th harmonic number with H_0:=0, and ln^+(x):=max{ln x,0}.
Proof.
Take τ=L−1 and τ=1 in Theorem 3 to obtain the two bounds (cf. Corollary 4). Replacing ln by ln^+ only increases the RHS. Taking the minimum preserves validity. ∎

Corollary 8 (Upper envelope from the min-of-extremes).
In the setting of Corollary 7, there exist absolute constants K0,K1,K2 (depending only on C_bi and C_fix) such that
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ K0 + K1 · min{ ln^+( 2m/(L−1) ), (m ln L)/L } + K2 · (\ln m)/L.
Proof.
From Corollary 7 with the logarithmic extreme,
  E ≤ 2·C_bi·(a+1) + 2·C_bi·ln^+(2m/(L−1)) + (C_fix·(\ln m + O(1)))/L.
From the hybrid extreme and H_{L−2} ≤ ln(L−2)+1 ≤ ln L + 1,
  E ≤ 2·C_bi·\Big( 1 + (a+\ln(2m))/(L−1) + (m/(e(L−1))) (\ln L + 1) \Big)
    + (C_fix·(\ln m + O(1)))/L.
Absorb constants into K0 and the terms (ln m)/(L−1), (m/(L−1)) into K2·(\ln m)/L and K1·(m ln L)/L, respectively, using L−1≈L up to absolute factors for L≥2. Taking the minimum of the two displays yields the claim. ∎

Corollary 9 (Plateau-level probability guarantee via quantiles and Markov; global mixing).
Let I=[m,m+L) be a factor-2 plateau with L≥2 and fix η∈(0,1). Define T := max{2, ⌈η(L−1)⌉+1}. Then for at least a (1−η−O(1/L)) fraction of k∈I we have
  E_++[ ALG_k / OPT_k ] ≤ B_I := 2·C_bi · ( 1 + m/( e (T−1) ) ).
Consequently, for any c≥1,
  P_{k\sim U(I),\,++}\big[ ALG_k/OPT_k ≤ c · B_I \big] ≥ (1−η−O(1/L)) · (1 − 1/c).
If, moreover, L ≥ α m for some α∈(0,1], then B_I ≤ 2·C_bi · (1 + 1/(α e η)) + O(1/L). If a plateau I covers a γ-fraction of [k0,2k0) (i.e., L/k0 ≥ γ), then for k uniform on [k0,2k0) and the ++ randomness,
  P\big[ ALG_k/OPT_k ≤ c · B_I \big] ≥ γ · (1−η−O(1/L)) · (1 − 1/c).
Proof.
The first assertion is Corollary 6: a (1−η−O(1/L)) fraction of k satisfy the displayed per-k bound with Δ≥T, hence with E_++ bounded by B_I. For any such k, Markov’s inequality gives P_{++}[ALG_k/OPT_k ≤ c·B_I] ≥ 1−1/c. Averaging uniformly over k on I yields the claim. If L ≥ α m, then T−1 ≥ η(L−1) ≥ η(α m−1), which implies m/(T−1) ≤ 1/(α η) + O(1/L). The global bound follows by restricting to k in I, which occurs with probability ≥ γ. ∎
Corollary 10 (A τ≈m/ln L branch on a plateau).
Let I=[m,m+L) be a factor-2 plateau with L≥3. Define τ*:=min{L−1, ⌊m/ln L⌋}. Then for k uniform on I and over the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ (τ*/(L−1)) · ( a + 1 + ln(2m/τ*) )
                + ((L−1−τ*)/(L−1))
                + (m/(e(L−1))) · ( H_{L−2} − H_{τ*−1} ) ]
    + (C_fix · (ln m + O(1)))/L,
where a:=2 + 1/(2e), and H_r is the r-th harmonic number (H_0:=0). In particular, if m ≤ (L−1) ln L and (as is the case for plateaus inside [k0,2k0)) m≥L, then
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ 1 + (m/((L−1) ln L)) · ( a + 1 + ln(4 ln L) )
                + (m/(e(L−1))) · ( 1 + ln ln L ) ]
    + (C_fix · (ln m + O(1)))/L.
Proof.
Apply Theorem 3 with τ=τ*. The displayed inequality is just Theorem 3. In the subcase m ≤ (L−1) ln L, τ*=⌊m/ln L⌋ satisfies τ* ≥ m/ln L − 1, hence 2m/τ* ≤ 4 ln L and ln(2m/τ*) ≤ ln(4 ln L). Also τ*/(L−1) ≤ m/((L−1) ln L). Finally, H_{L−2} − H_{τ*−1} ≤ ln(L/τ*) + 1 ≤ ln((L ln L)/m) + 1 ≤ 1 + ln ln L, using m≥L. Substituting these bounds into Theorem 3 yields the “in particular” display. ∎

Corollary 11 (Updated per-plateau upper envelope: min-of-three).
In the setting of Corollary 7, there exist absolute constants K0,K1,K2 (depending only on C_bi and C_fix) such that for k uniform on I=[m,m+L) with L≥2,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ K0 + K1 · min{ ln^+( 2m/(L−1) ), (m ln L)/L, (m(1 + ln ln L))/L } + K2 · (\ln m)/L.
Here ln^+(x):=max{ln x,0}. The third term in the minimum is intended for L≥3; when L=2 the minimum of the first two terms suffices. 
Proof.
Combine: (i) the logarithmic extreme τ=L−1 (Corollary 4), (ii) the τ=1 hybrid extreme (Corollary 4 with H_{L−2}≤ln L+1), and (iii) Corollary 10 in the subcase τ*=⌊m/ln L⌋ (which holds exactly when m ≤ (L−1) ln L). In case (iii), the two m-dependent contributions are bounded by a constant multiple of (m/L)(1+ln ln L), since (m/((L−1) ln L))(a+1+ln(4 ln L)) ≤ (const)·(m/L) and (m/(e(L−1)))(1+ln ln L) ≤ (const)·(m/L)(1+ln ln L), with all constants depending only on C_bi. Absorb all additive O(1) and O((\ln m)/L) terms into K0 and K2. Taking the minimum of the three displays yields the claim. ∎

Corollary 12 (Explicit constants for the envelope when C_bi=C_fix=5).
Assume C_bi=C_fix=5 and L≥2. Then for k uniform on I=[m,m+L),
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 35 + 10 · min{ ln^+(2m/(L−1)), (m ln L)/L, (m(1+\ln\ln L))/L } + 5 · (\ln m)/L.
Proof.
From Corollary 7 (logarithmic extreme), E ≤ 2·C_bi·(a+1) + 2·C_bi·ln^+(2m/(L−1)) + (C_fix·(\ln m + O(1)))/L. With a=2+1/(2e) and C_bi=C_fix=5, 2·C_bi·(a+1) ≈ 31.84; round up to 35 to absorb the endpoint O(1/L) terms. The coefficient in front of ln^+(·) is 2·C_bi=10. For the τ=1 branch, the (m ln L)/L contribution carries a factor 2·C_bi/e ≤ 10/e < 10; rounding up to 10 is safe after replacing L−1 by L. For the τ≈m/ln L branch (Corollary 10), the m-dependent part is ≤ const·(m/L)(1+\ln\ln L) with const depending only on C_bi; choosing 10 dominates those constants as well. The endpoint term is ≤ 5·(\ln m + 2)/L and we keep 5·(\ln m)/L after absorbing the additive 10/L into 35. Taking the minimum of the three candidate bounds proves the display. ∎

Remark (Numerical 1% probability instantiation on a single plateau).
In Corollary 9, choose η=0.98 and c=2. Then for k uniform on I and ++ randomness,
  P[ ALG_k/OPT_k ≤ 2 · B_I ] ≥ (1−η−O(1/L)) · (1 − 1/2) = (0.02−O(1/L)) · 0.5 ≥ 0.01 − O(1/L),
with B_I = 2·C_bi·(1 + m/(e(T−1))) and T = max{2, ⌈0.98(L−1)⌉+1}. If additionally L ≥ α m, then B_I ≤ 2·C_bi·(1 + 1/(α e · 0.98)) + O(1/L), giving a fully explicit constant-factor guarantee at ≥1% mass (up to O(1/L)).

