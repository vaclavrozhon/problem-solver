--- SYSTEM ---
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (summary so far)
- output.md (rigorously proven results so far)

Guidelines:
- notes.md: should be a readable running log of interesting work. Prefer appending. Replace only if old notes are clearly misleading. Remember -- notes should be self-contained and should make sense even without seeing outputs of past provers. 
- output.md:  Think twice before you add something to this file. Everything here should be rigorous, almost publication-ready. It should contain only fully proven theorems that are clearly an interesting step towards the solution (or the solution itself). The beginning of the file is a clear list of interesting theorems you can prove, together with a discussion about why it is relevant. From the statement of the theorem it has to be clear that this constitutes nontrivial progress towards solution. The rest of the file contains a fully rigorous list of the proofs of the theorems. Keep only proven theorems with clear proofs. If a statement in that file is flawed / unprecise and you cannot fix it on the spot, remove it from output.md and instead add it to notes.md with explanation.
- Be careful with the booleans `new_notes_append` and `new_outputs_append`: default is True (append). Use False only when deliberately rewriting everything.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions. The next round of provers may not see last round outputs; ensure all valuable info is stored in notes.",
  "new_notes_md": "Markdown (KaTeX allowed). Usually appended to notes.",
  "new_notes_append": "True|False",
  "new_outputs_md": "Markdown (KaTeX allowed). Usually appended to output.md.",
  "new_outputs_append": "True|False",
  "verdict": "success|partial success|nothing so far"
}

**Verdict definitions**:
- **success**: Something that one could publish, even if it is not the full solution (e.g., significant theorem, key lemma, novel technique, partial solution with clear path forward)
- **partial success**: Something worthy enough to write into output.md (e.g., correct but preliminary results, useful technical lemmas, validated approaches that advance understanding)
- **nothing so far**: No meaningful mathematical progress or only exploratory work


--- USER ---
You receive multiple prover reports. Evaluate correctness, value, and pick promising directions. Update notes.md (append/replace) with useful ideas and update output.md (append/replace) ONLY with rigorously verified results.

Prover reports (JSON):
[{"prover_id": "01", "progress_md": "Round 0007 \u2014 New probability guarantees (two-level Markov), explicit global constants, and audit notes\n\nSummary\n- I propose a simple, unconditional probability bound that holds on the whole window [k0,2k0): a two-level Markov argument yields a constant-mass guarantee that ALG/OPT is O(log k0) with explicit constants. This meets the \u201c\u22650.01 probability\u201d alternative formulation and is stronger (gives \u226525% mass) without any structural assumptions on OPT(\u00b7).\n- I also instantiate the resulting threshold explicitly when C_bi=C_fix=5, giving a clean numeric bound. The proof only uses the already curated plateau average bounds (Corollary 11/12) and Markov\u2019s inequality.\n- Minor audit: I see no correctness issues in output.md. I point out one easy-to-curate addition (the two-level Markov corollary) and provide all steps and constants needed.\n\nIdea \u2014 Two-level Markov to get constant joint (k,++) probability\n- Setting. For each maximal factor-2 plateau I_j=[m_j,m_j+L_j) with L_j\u22652, let\n  B_j := K0 + K1\u00b7min{ ln^+(2m_j/(L_j\u22121)), (m_j ln L_j)/L_j, (m_j(1+ln ln L_j))/L_j } + K2\u00b7(ln m_j)/L_j\n  be the per-plateau envelope from Corollary 11. For L_j=1, use the fixed-k bound D_j := C_fix(ln m_j+O(1)). Let\n  B_max := max{ max_{j:L_j\u22652} B_j,  max_{j:L_j=1} D_j }.\n- Two-level Markov (plateau-agnostic). For each k in [k0,2k0), define Y_k := E_++[ALG_k/OPT_k | k]. From Corollary 11 and the fixed-k bound, Y_k \u2264 B_{plateau(k)} \u2264 B_max. Then for any c\u22651:\n  1) Over k, Markov gives P_k[Y_k \u2264 c\u00b7B_max] \u2265 1 \u2212 1/c.\n  2) Conditional on any such k, Markov over ++ gives P_{++}[ ALG_k/OPT_k \u2264 c\u00b7Y_k ] \u2265 1 \u2212 1/c.\n  Combining and using c\u00b7Y_k \u2264 c\u00b7(c\u00b7B_max) = c^2\u00b7B_max yields the joint bound\n  P_{k,++}[ ALG_k/OPT_k \u2264 c^2 \u00b7 B_max ] \u2265 (1 \u2212 1/c)^2.\n- Consequence (take c=2). With probability at least 1/4 over the joint (k,++) randomness,\n  ALG_k/OPT_k \u2264 4\u00b7B_max.\n- This requires no structural conditions on OPT(\u00b7) (no long plateaus, etc.) and directly addresses the alternative task statement (probability \u2265 0.01) with \u2265 0.25.\n\nExplicit global bound on B_max\n- For L_j\u22652, min{\u00b7} \u2264 ln^+(2m_j/(L_j\u22121)) \u2264 ln(2\u00b7(2k0)/1) = ln(4k0), and (ln m_j)/L_j \u2264 (ln(2k0))/2. Hence for L_j\u22652,\n  B_j \u2264 K0 + K1\u00b7ln(4k0) + (K2/2)\u00b7ln(2k0).\n- For L_j=1, D_j \u2264 C_fix(ln(2k0)+O(1)). Thus\n  B_max \u2264 max{ K0 + K1\u00b7ln(4k0) + (K2/2)\u00b7ln(2k0),  C_fix(ln(2k0)+O(1)) }.\n- Instantiation when C_bi=C_fix=5 and K0=35, K1=10, K2=5 (from Corollary 12):\n  \u2022 L_j\u22652: 35 + 10\u00b7ln(4k0) + (5/2)\u00b7ln(2k0) = 35 + 10 ln 4 + 2.5 ln 2 + 12.5 ln k0 \u2248 50.6 + 12.5 ln k0.\n  \u2022 L_j=1: 5(ln(2k0)+O(1)) \u2264 10 + 5 ln(2k0).\n  For k0 large, the first dominates; a safe uniform bound is\n    B_max \u2264 45 + 12.5\u00b7ln(2k0)   (conservative; absorbs the O(1) from the L=1 case).\n\nNew corollary (proposed for output.md): Unconditional \u226525% probability bound\n- Statement. For k uniform on [k0,2k0) and k-means++ randomness, and with B_max as above,\n  P[ ALG_k/OPT_k \u2264 4\u00b7B_max ] \u2265 1/4.\n  In particular, if C_bi=C_fix=5, then for all k0\u22652,\n  P[ ALG_k/OPT_k \u2264 4(45 + 12.5\u00b7ln(2k0)) ] \u2265 1/4,\n  i.e., P[ ALG_k/OPT_k \u2264 180 + 50\u00b7ln(2k0) ] \u2265 1/4.\n- Proof. Immediate from the two-level Markov argument with c=2 and the bound on B_max above. (For small k0 the additive constants can be slightly tightened; the stated numbers are conservative and uniform.)\n- Parametric variant. For any c\u22651,\n  P[ ALG_k/OPT_k \u2264 c^2\u00b7B_max ] \u2265 (1 \u2212 1/c)^2.\n  This yields a continuum of tradeoffs; e.g., c=10 gives probability \u22650.81 for a threshold 100\u00b7B_max.\n\nWhy this is useful\n- It gives a clean, structure-free probability guarantee for the alternative task goal (\u201cbound attained with probability \u22650.01\u201d), actually with 25% mass and explicit O(log k0) thresholds.\n- It complements Corollary 16/18 (which give stronger constants on long plateaus) by providing a baseline bound even when no plateau is long.\n- It is derived entirely from existing curated statements (Corollary 11/12 and the fixed\u2011k bound), and thus is easy to verify and insert.\n\nExamples and sanity checks\n- Worst-case short plateaus (L_j=1 for almost all j): B_max is governed by the fixed-k term 5(ln(2k0)+O(1)), hence the corollary still yields an O(log k0) threshold at \u226525% mass.\n- Single long plateau (L\u2248m): B_max is O(1) (Corollary 5), so the same two-level Markov gives an O(1) threshold with \u226525% mass, consistent with Corollary 16\u2019s stronger constants for \u22651% mass.\n\nMinor audit of output.md (this round)\n- The min-of-three per-plateau bound (Corollary 11) and its explicit-constant instantiation (Corollary 12) are correctly stated, including the L\u22653 caveat for the third branch.\n- Global aggregation (Corollary 13), unconditional O(log k0) (Corollary 14), long-plateau mixture (Corollary 15), and multi-plateau probability (Corollary 18) are coherent. Endpoint-sum control (Lemma 1) is clean and used properly. I see no correctness issues.\n\nNext steps (curation-ready)\n1) Add the \u201cTwo-level Markov\u201d corollary above to output.md (plateau-agnostic \u226525% probability bound), with the parametric c\u22651 version. Include the explicit numeric instantiation for C_bi=C_fix=5.\n2) Optionally note (as a remark) that for any target probability p\u2208(0,1), choosing c=(1\u2212\u221ap)^{-1} gives P\u2265p at threshold c^2\u00b7B_max, making the tradeoff explicit.\n3) If desired, very slightly tighten the numeric constant in B_max (e.g., B_max \u2264 42 + 12.5 ln(2k0) as argued in-line); the current 45 + 12.5 ln(2k0) statement is safe and simple.\n\nObstacles and open items\n- Heavy coverage under scale separation: the key \u201cpersistence\u201d denominator (cost_t(all) \u2265 (\u03b2+1)\u00b7U_t(H) before heavy coverage completes) remains to be established under clean separation hypotheses. Once proved, the expected-collisions bound can follow by summing conditional probabilities; then Freedman\u2019s inequality can lift to high probability.\n- Lower bounds under random-k smoothing: constructing a single dataset producing \u03a9(log k0) average (or comparable \u2265p probability) across the entire window remains open; existing fixed\u2011k lower bounds depend on k.\n"}, {"prover_id": "02", "progress_md": "Round 0007 \u2014 Audit, new structural corollaries, and probability refinements\n\nOverview and quick audit of output.md\n- The current file is coherent and self-contained for the plateau calculus. The new branches (\u03c4=\u230am/ln L\u230b, balanced split \u03c4=\u230aL/2\u230b), the global min-of-three envelope, and the multi-plateau probability mixing are all correctly stated with safe constants. I see no blocking correctness errors.\n- Small opportunity: Corollary 9 already yields a family of quantile/probability statements for any \u03b7\u2208(0,1). It may be valuable to explicitly record the \u201cmedian\u201d instantiation (\u03b7=1/2) yielding a 25% plateau-level probability, alongside the existing 1% instantiation, for ease of use.\n\nNew, checkable additions (proposed to curate)\n\n1) Power-law profile corollary (constant average and explicit constants)\n- Statement. Suppose on a window [m,2m) we have \n  OPT_k \u2208 [C_1 k^{\u2212p}, C_2 k^{\u2212p}] for some p>0 and constants C_1,C_2>0.\n  Then the maximal factor-2 plateau I\u2286[m,2m) starting at m has length L\u2265(2^{1/p}\u22121)m and hence, by Corollary 5, for k uniform on I,\n  E_{k\u2208I} E_++[ALG/OPT] \u2264 2 C_bi (a+1+ln(2/\u03b1)) + o(1), with \u03b1:=2^{1/p}\u22121 and a:=2+1/(2e).\n  Consequently, averaging over [m,2m) yields a constant bound depending only on p and C_bi, uniformly for large m.\n- Proof sketch (checkable). For k\u2208[m, m+L), OPT_{m+L} \u2265 OPT_m/2 is equivalent to ((m+L)/m)^p \u2264 2, i.e., L \u2264 (2^{1/p}\u22121)m. Hence the factor-2 plateau starting at m has length at least \u03b1 m with \u03b1=2^{1/p}\u22121. Apply Corollary 5 with this \u03b1 and note the endpoint term is o(1) as L\u2192\u221e.\n- Why useful. Captures a broad and natural regime (polynomial decay) where random-k smoothing gives a constant bound with explicit dependence on p. This can be turned into explicit numeric constants by plugging C_bi (e.g., 5) and p (examples below).\n- Example. For p=1 and C_bi=5, \u03b1=1 and the plateau average is \u2264 10(3+1/(2e)+ln 2)+o(1) \u2248 38.8.\n\n2) Median (25%) plateau-level probability guarantee (simple instantiation of Corollary 9)\n- Statement. In Corollary 9, choosing \u03b7=1/2 and c=2 yields, for k uniform over any plateau I=[m,m+L) with L\u22652,\n  P_{k,++}[ ALG/OPT \u2264 2\u00b7B_I ] \u2265 (1\u22121/2\u2212O(1/L))\u00b7(1\u22121/2) = 1/4 \u2212 O(1/L),\n  where B_I = 2 C_bi (1 + m/(e(T\u22121))) and T = max{2, \u2308(L\u22121)/2\u2309+1}. If L \u2265 \u03b1 m, then B_I \u2264 2 C_bi (1 + 2/(\u03b1 e)) + O(1/L).\n- Why useful. Complements the 1% probability remark with a clean, stronger (\u224825%) option under the same framework; particularly handy when downstream needs favor a larger success probability, albeit with a larger constant than one might get by tuning \u03b7.\n\n3) Discrete 1/k-smoothness across the window \u21d2 O_A(1) average (global structural corollary)\n- Hypothesis. Suppose for all k\u2208[k0,2k0) we have\n  ln(OPT_{k\u22121}/OPT_k) \u2264 A/k\n  for some A>0. (Equivalently, OPT_{k\u22121} \u2264 (1 + A/k) OPT_k.)\n- Lemma (plateau length and count). On any factor-2 plateau starting at m within the window, the length satisfies L \u2265 (ln 2)\u00b7m/A (by Lemma 2 with \u03b4=A/m). Moreover, the starting indices m_j of consecutive plateaus grow multiplicatively by at least (1 + (ln 2)/A). Hence the number of plateaus J across [k0,2k0) is at most \u2308 ln 2 / ln(1 + (ln 2)/A) \u2309 \u2264 \u2308 (1 + (ln 2)/A)\u00b7A/ln 2 \u2309 = O(A).\n  A safe bound is J \u2264 \u2308 (A + ln 2)/ln 2 \u2309.\n- Corollary (global average). Applying Corollary 5 on each plateau and Corollary 13 for aggregation,\n  E_{k\u223cU([k0,2k0)),++}[ALG/OPT]\n  \u2264 2 C_bi (a+1+ln(2/\u03b1)) + (C_fix/k0)\u2211_{j=1}^{J} ln m_j,\n  with \u03b1=(ln 2)/A. Since J=O(A) and m_j\u22642k0, the endpoint term is \u2264 C_fix\u00b7J\u00b7ln(2k0)/k0 = o(1). Therefore,\n  E[ALG/OPT] \u2264 2 C_bi (a+1+ln(2A/ln 2)) + o(1),\n  i.e., an O_A(1) bound uniformly over the window for large k0.\n- Proof sketch (checkable). The length bound is Lemma 2 with \u03b4=A/m. For the count, m_{j+1} \u2265 m_j + (ln 2)m_j/A = (1 + (ln 2)/A)m_j; iterating till we exceed 2k0 gives the stated J bound. Aggregation then applies Corollary 5 per plateau and shows the endpoint-sum is negligible because J\u226ak0.\n- Why useful. This supplies a transparent, data-agnostic smoothness condition that forces long plateaus throughout the window and yields a global O(1) average (as a function of A), sharpening the unconditional O(log k0) bound under a verifiable regularity premise.\n\n4) Global mixture corollary from power-law or 1/k-smoothness (explicit probability)\n- If the entire window [k0,2k0) satisfies the power-law or 1/k-smoothness hypotheses (items 1\u20133), then \u03b3=1 in Corollary 16 and in the \u201c25%\u201d remark above. Consequently,\n  P_{k,++}[ ALG/OPT \u2264 2\u00b7B_I ] \u2265 1/4 \u2212 o(1),\n  with B_I \u2264 2 C_bi (1 + const) depending only on p (power law) or A (smoothness). This offers a straightforward probability \u2265 0.25 guarantee meeting the alternative task objective with fully explicit constants.\n\nWhy these additions are useful here\n- They convert common, checkable structural properties of OPT(\u00b7) (polynomial decay; bounded discrete derivative) into clean, global O(1) averages and explicit constant-probability statements, strengthening the \u201cwhy randomizing k helps\u201d narrative beyond single-plateau assumptions.\n- All statements are direct instantiations of existing machinery (Lemma 2, Corollary 5, Corollary 9, Corollary 13) and require only short algebraic verifications.\n\nExamples and sanity checks\n- Power-law p=1. On [m,2m), \u03b1=1; by item 1 with C_bi=5, the plateau average is \u2264 10(3+1/(2e)+ln 2)+o(1) \u2248 38.8; by item 2 with \u03b1=1, B_I \u2264 2\u00b75\u00b7(1+2/e) \u2248 18.7, giving a 25% probability threshold \u2264 37.4.\n- Smoothness A=2. Then \u03b1=(ln 2)/2\u22480.346; the global average is \u2264 2 C_bi (a+1+ln(2A/ln 2)) + o(1) \u2248 10(3+1/(2e)+ln(2\u00b72/ln 2)) \u2248 10(3.183 + 1.060) \u2248 42.4 (with C_bi=5), plus o(1).\n\nObstacles and gaps\n- Heavy-coverage program. The main missing piece remains a rigorous persistence denominator: a deterministic or high-probability lower bound of the form cost_t(all) \u2265 (\u03b2+1)\u00b7U_t(H) prior to covering all heavy clusters, derivable from a clean separation hypothesis. Once established, summing conditional collision probabilities becomes straightforward.\n- Constants for the median probability. The \u03b7=1/2 choice is general but not constant-optimal. Users may tune \u03b7 to trade off between success probability and threshold; documenting \u03b7=1/2 offers a simple default.\n\nNext steps (actionable)\n1) Add the \u201cPower-law profile\u201d corollary (item 1) to output.md with explicit constants and a short proof (one-liner invoking Corollary 5 with \u03b1=2^{1/p}\u22121).\n2) Add a one-line \u201c25% probability\u201d remark (\u03b7=1/2, c=2) next to the 1% instantiation.\n3) Curate the \u201cglobal smoothness \u21d2 O_A(1) average\u201d corollary (item 3) including the plateau-count bound J=O(A) and the endpoint-term o(1) argument.\n4) For heavy coverage, target a clean geometric hypothesis and prove cost_t(all) \u2265 (\u03b2+1)\u00b7U_t(H) before completing coverage of H; then combine with the eH_t supermartingale to bound expected heavy-collisions and lift to high probability.\n"}]

Current notes.md:
Problem and notation
- X ⊂ R^d finite dataset; cost(C) = ∑_{x∈X} min_{c∈C} ||x−c||^2.
- OPT_k := min_{|C|=k} cost(C), nonincreasing in k.
- ALG_k := cost of k-means++ after k centers; E_++[·] denotes expectation over its randomness.
- We study E_{k∼U({k0,…,2k0−1})} E_++[ ALG_k / OPT_k ].

Key external input (Makarychev–Reddy–Shan 2020)
- There is an absolute constant C_bi (quoted as 5 in MRS) such that for any r≥1, Δ≥1,
  E_++[cost after r+Δ centers] ≤ C_bi · min{ 2 + 1/(2e) + ln(2r/Δ), 1 + r/(e(Δ−1)) } · OPT_r.
- For Δ=0 (fixed-k), there is an absolute constant C_fix (also ≲5 in MRS) with E_++[ALG_k] ≤ C_fix · (ln k + O(1)) · OPT_k.

Per-k oversampling bound (robust to s-misalignment)
- For any k, define s(k) := min{ s∈{1,…,k} : OPT_s ≤ 2·OPT_k }. Let Δ(k)=k−s(k).
- If Δ(k)≥1, then
  E_++[ALG_k] ≤ 2·C_bi · min{ 2 + 1/(2e) + ln(2 s(k)/Δ(k)), 1 + s(k)/(e(Δ(k)−1)) } · OPT_k.
- If Δ(k)=0, fall back to E_++[ALG_k] ≤ C_fix · (ln k + O(1)) · OPT_k.
Note: On any factor-2 plateau I=[m,m+L) (i.e., OPT_k∈(OPT_m/2,OPT_m] for k∈I), we have s(k)≤m and Δ(k)≥k−m; since the MRS bound is monotone in (s,Δ), replacing (s(k),Δ(k)) by (m,k−m) yields a valid upper bound.

Per-plateau averaging and Stirling control
- For a factor-2 plateau I=[m,m+L), L≥2, uniform k over I gives
  E_{k,++}[ALG_k/OPT_k] ≤ 2·C_bi · (2 + 1/(2e) + (1/(L−1))∑_{Δ=1}^{L−1} ln(2m/Δ)) + (C_fix(ln m + O(1)))/L.
- Using ln(n!) ≥ n ln n − n + 1 (n≥1),
  (1/(L−1))∑_{Δ=1}^{L−1} ln(2m/Δ) = ln(2m) − ln((L−1)!)/(L−1) ≤ 1 + ln(2m/(L−1)).
- Hence E_{k,++}[ALG_k/OPT_k] ≤ const + const·ln^+(2m/(L−1)) + O((ln m)/L), where ln^+(x)=max{ln x,0} and all const’s are absolute.

Decomposition over [k0,2k0)
- Partition [k0,2k0) into maximal factor-2 plateaus I_j=[m_j, m_j+L_j). For L_j≥2, the per-plateau average is bounded as above. For L_j=1, the single k in I_j contributes ≤ C_fix(ln m_j + O(1)). Averaging with weights L_j/k0 yields a global bound explicitly in terms of {(m_j,L_j)}; in the worst case many L_j=1 plateaus can force Θ(log k0).

Consequences and regimes
- Long plateaus: If some I=[m,m+L) satisfies L ≥ m/polylog(k0), then E_{k∈I,++}[ALG/OPT] = O(log log k0). If a constant fraction of [k0,2k0) is covered by such plateaus, the global average is O(log log k0).
- Worst case without structure: If many plateaus are short (e.g., L_j=1), the global average can be Θ(log k0), aligning with classic worst-case fixed-k behavior.

Open directions
- Structural conditions on OPT(·) implying many long plateaus (e.g., bounded discrete derivative decay, quasiconvexity/regularity of k·OPT_k) to get unconditional O(log log k0).
- Heavy-coverage lemma (conjectural): under strong scale separation OPT_{k1} ≫ OPT_k, show k-means++ hits all k1 heavy clusters w.h.p. before collisions, then apply bi-criteria on the remaining part.
- Lower bounds: Construct instances with Δ(k)=1 for a 1−o(1) fraction of k in [k0,2k0), giving an Ω(log k0) average and clarifying optimality of random-k smoothing.
Refinements and corrections for plateau averaging and monotonicity

- Monotonicity of the MRS bi-criteria bound. Define for integers s≥1 and Δ≥1 (interpreting the second branch only for Δ≥2):
  f(s,Δ) := min{ a + ln(2s/Δ), 1 + s/(e(Δ−1)) }, where a := 2 + 1/(2e).
  Then f is nondecreasing in s and nonincreasing in Δ. Consequently, on any factor-2 plateau I=[m,m+L) and for k=m+Δ with Δ≥1, the per-k bound from Theorem 1 satisfies
  f(s(k),Δ(k)) ≤ f(m,Δ), so we may safely replace (s(k),Δ(k)) by (m,Δ) in upper bounds.

- Correct τ-split averaging (fixing Proposition B). On a factor-2 plateau I=[m,m+L) with L≥2, for any integer τ∈{1,…,L−1}:
  (1/(L−1)) ∑_{Δ=1}^{L−1} min{ a+ln(2m/Δ), 1 + m/(e(Δ−1)) } (with the second term read only for Δ≥2)
  ≤ (τ/(L−1)) [ a + 1 + ln(2m/τ) ]
    + ((L−1−τ)/(L−1))
    + (m/(e(L−1))) · (H_{L−2} − H_{τ−1}).
  Proof sketch: Split the sum at τ and use Stirling ln(τ!) ≥ τ ln τ − τ + 1 to bound ∑_{Δ≤τ} ln(2m/Δ) ≤ τ(1+ln(2m/τ)). For the tail, sum 1/(Δ−1) as H_{L−2}−H_{τ−1}. This corrects two issues in earlier drafts: (i) the constant a must be multiplied by τ/(L−1), and (ii) ln(2m/Δ) cannot be upper bounded by ln(2m/τ) when Δ≤τ.

- Hybrid extremes recovered from the τ-split:
  • Choosing τ=L−1 gives the pure-logarithmic average a+1+ln(2m/(L−1)).
  • Choosing τ=1 gives the “hybrid extreme” 1 + (a+ln(2m))/(L−1) + (m/(e(L−1))) H_{L−2}.
  Hence we may take the minimum of these two regimes for a tighter bound, plateau by plateau.

- Long-plateau corollary. If L≥α m with α∈(0,1], then a+1+ln(2m/(L−1)) ≤ a+1+ln(2/α)+O(1/L), so the plateau-average is O(1) up to the endpoint term of order (ln m)/L.

- Quantile-in-Δ bound (careful threshold). For any η∈(0,1), let T := max{2, ⌈η(L−1)⌉+1}. Then, for all Δ≥T, by the large-Δ branch
  E_++[ALG_{m+Δ}/OPT_{m+Δ}] ≤ 2·C_bi·(1 + m/(e(T−1))).
  The fraction of k∈I with Δ≥T is (L−T+1)/L = 1 − η − O(1/L). This yields a rigorous “with probability ≥ 1−η−O(1/L) over k uniform on the plateau” expected-ratio bound; Markov then converts it into a constant-factor joint (k,++) probability if desired.

- Global decomposition improvement. Using the τ-split per plateau and optimizing τ as a function of (m,L) leads to a refined global bound that, informally, scales like
  K0 + K1 · min{ ln^+(2m/(L−1)), (m ln L)/L } + K2 · (ln m)/L,
  up to absolute constants K0,K1,K2. Formalizing this from Theorem 3 is a next step.

Open directions and next steps
- Optimize τ in the τ-split bound and write a clean, closed-form per-plateau bound. Then aggregate over plateaus to strengthen Corollary 3.
- Probability guarantees: phrase clean conditions under which at least a 1% measure of k (in [k0,2k0) or on a specific plateau) yields a constant expected ratio, and apply Markov to obtain joint (k,++) probability.
- Heavy-coverage: formalize the supermartingale for heavy uncovered mass (precise citation from MRS), bound expected heavy-collisions by O(k1/R), and lift to high probability via Freedman/Azuma with a stopping time.
- Lower bounds: construct OPT(·) with OPT_{k−1}/OPT_k ≈ 1 − Θ(1/ln k0) for most k to force Δ(k)=1 on a 1−o(1) fraction of the window, yielding an Ω(log k0) average.
Additions and clarifications

- Geometric constraint on plateau length within the window. If a factor-2 plateau I=[m,m+L) is contained in [k0,2k0), then L ≤ 2k0−m ≤ m. In particular, for L≥2 we have m/(L−1) ≥ 1. This prevents sign errors when simplifying expressions involving m/(L−1).

- Min-of-extremes and an upper envelope. From Theorem 3 and Corollary 4 we can (and will) use the minimum of the two extreme instantiations τ=L−1 (pure log) and τ=1 (hybrid extreme). Using H_q ≤ ln q + 1, this yields a clean per-plateau upper envelope of the form
  E_{k∈I} E_++[ALG_k/OPT_k] ≤ K0 + K1 · min{ ln^+(2m/(L−1)), (m ln L)/L } + K2 · (ln m)/L,
for absolute constants K0,K1,K2 depending only on C_bi,C_fix. This is the regime split we will use in global aggregation: the log term dominates when L≪m, while the (m ln L)/L term is O(1) when L is a constant fraction of m.

- Safe balanced-split (τ=⌊L/2⌋) template (optional). The following uniform bounds hold for L≥3 and τ=⌊L/2⌋:
  • τ/(L−1) ≤ 2/3 and (L−1−τ)/(L−1) ≤ 1/2.
  • ln(2m/τ) ≤ ln(4m/(L−1)).
  • H_{L−2} − H_{τ−1} ≤ ln 3 + 1 (with small-L cases checked directly).
Plugging these into Theorem 3 yields the rigorous estimate
  E_{k∈I} E_++[ALG_k/OPT_k]
  ≤ 2C_bi [ (2/3)(a + 1 + ln(4m/(L−1))) + 1/2 + (m/(e(L−1)))(ln 3 + 1) ]
    + (C_fix(\ln m + O(1)))/L.
This improves the (m ln L)/L term to a pure (m/L) term at the expense of a larger coefficient on the logarithmic piece. It may be tighter than the min-of-extremes envelope in intermediate regimes. If used, constants must be kept as above (1/2 is not a safe coefficient for τ/(L−1) when L is even).

- Probability ≥ 1% guarantees under a long-plateau condition. From Corollary 6: fix η∈(0,1) and define T := max{2, ⌈η(L−1)⌉+1}. For at least a (1−η−O(1/L)) fraction of k∈I we have
  E_++[ALG_k/OPT_k] ≤ 2C_bi (1 + m/(e(T−1))).
By Markov, for any c≥1,
  P_{++}[ ALG_k/OPT_k ≤ c · 2C_bi (1 + m/(e(T−1))) ] ≥ 1 − 1/c
for each such k. Therefore, jointly over k uniform on I and ++ randomness,
  P[ ALG_k/OPT_k ≤ c · 2C_bi (1 + m/(e(T−1))) ] ≥ (1−η−O(1/L))(1−1/c).
If L ≥ α m, then m/(T−1) ≤ 1/(α η) up to 1+O(1/L) factors, giving an explicit constant bound. If the plateau covers a γ-fraction of [k0,2k0), the global probability is ≥ γ times the RHS. Example: with C_bi=5, α=1, η=0.99, c=100, we get a ≥1% guarantee with a factor ≤ 100·2·5·(1 + 1/(0.99 e)).

- Heavy-coverage program (caveats and plan). Any per-step “collision within heavy” probability bound must be stated conditionally on the current filtration F_t: under D^2 sampling,
  P[collision in H at step t | F_t] = cost_t(covered H) / cost_t(all).
Avoid ratio-of-expectations. A plausible route is to bound cost_t(covered H) in terms of the uncovered heavy mass U_t(H) via the MRS eH_t supermartingale (in expectation and eventually with concentration), while lower bounding cost_t(all) by U_t(H) + U_t(L). To obtain a β-persistence-type condition from scale separation, quantify the expected reduction of U_t(H) when sampling outside H and show it is o(U_t(H)) under strong separation (e.g., OPT_{k1} ≥ k^C · OPT_k). With these in place, the expected number of heavy collisions can be bounded by summing the conditional probabilities until all heavy clusters are hit, and then lifted to high probability by Freedman/Azuma.

- Lower bounds. To show random-k smoothing cannot beat Θ(log k0) in general, aim for an instance where Δ(k)=1 for a 1−o(1) fraction of k in [k0,2k0). Concretely, calibrate radii so OPT_{k−1}/OPT_k ≈ 1 + Θ(1/ln k0) across most of the window, ensuring s(k)=k−1 on most k. Then adapt Arthur–Vassilvitskii’s lower-bound calculation to the averaged setting.
New per-plateau refinement: τ≈m/ln L branch and an updated envelope

- Additional τ-instantiation. On a factor-2 plateau I=[m,m+L) with L≥3, choose τ*:=min{L−1, ⌊m/ln L⌋}. Then Theorem 3 yields
  E_{k∈I} E_++[ALG/OPT]
  ≤ 2C_bi [ (τ*/(L−1))(a+1+ln(2m/τ*)) + ((L−1−τ*)/(L−1)) + (m/(e(L−1)))(H_{L−2} − H_{τ*−1}) ]
    + (C_fix(\ln m + O(1)))/L,
  where a:=2+1/(2e).
  In the subcase m ≤ (L−1) ln L (hence τ*=⌊m/ln L⌋) and assuming m≥L (which holds for plateaus contained in [k0,2k0)), we can bound
  • ln(2m/τ*) ≤ ln(4 ln L)
  • τ*/(L−1) ≤ m/((L−1) ln L)
  • H_{L−2} − H_{τ*−1} ≤ 1 + ln ln L
  to conclude
  E_{k∈I} E_++[ALG/OPT]
  ≤ 2C_bi [ 1 + (m/((L−1) ln L))(a+1+\ln(4\ln L)) + (m/(e(L−1)))(1 + \ln\ln L) ]
    + (C_fix(\ln m + O(1)))/L.
  This improves the (m\ln L)/L tail from the τ=1 branch to ≈ (m/L)(1+\ln\ln L).

- Updated min-of-three envelope (plateau-wise). Together with the τ=L−1 (pure-log) and τ=1 (hybrid) instantiations, we may use
  E_{k∈I} E_++[ALG/OPT] ≤ K0 + K1·min{ ln^+(2m/(L−1)), (m\ln L)/L, (m(1+\ln\ln L))/L } + K2·(\ln m)/L,
  for absolute constants K0,K1,K2 depending only on C_bi,C_fix. This strictly strengthens the previous min-of-two envelope in regimes where ln ln L ≪ ln L.

- Global aggregation (window-wise). For the maximal factor-2 plateau partition [k0,2k0)=\bigsqcup_j I_j with I_j=[m_j,m_j+L_j), one may take, plateau by plateau, the minimum of the three branches above (with the third used for L_j≥3), and sum with weights L_j/k0:
  E_{k\sim U([k0,2k0))} E_++[ALG/OPT]
  ≤ (1/k0) \sum_j L_j [ K0 + K1·min{ ln^+(2m_j/(L_j−1)), (m_j\ln L_j)/L_j, (m_j(1+\ln\ln L_j))/L_j } ]
    + (K2/k0) \sum_j \ln m_j.

- Balanced split reminder. The τ=⌊L/2⌋ instantiation yields
  E_{k∈I} E_++[ALG/OPT]
  ≤ 2C_bi [ (2/3)(a+1+\ln(4m/(L−1))) + 1/2 + (m/(e(L−1)))(\ln 3 + 1) ] + (C_fix(\ln m + O(1)))/L,
  valid for all L≥3. This removes the ln L factor in the tail at the expense of a larger constant on the log piece.

- Probabilistic 1% instantiation (correction). From Corollary 9, for any η∈(0,1) and c≥1,
  P_{k∈I,++}[ ALG/OPT ≤ c·B_I ] ≥ (1−η−O(1/L))(1−1/c), with B_I=2C_bi(1 + m/(e(T−1))), T=\max\{2,\lceil η(L−1)\rceil+1\}.
  To guarantee at least 1% mass uniformly (up to O(1/L)), take η=0.98 and c=2, giving (1−η)(1−1/c)=0.02·0.5=0.01. If, in addition, L≥α m, then B_I ≤ 2C_bi(1 + 1/(α e η)) up to O(1/L).

Caveat on heavy-coverage sketches. The pathwise control and metric-separation heuristics are promising but currently lack fully rigorous denominators: one must explicitly quantify cost_t(X) in terms of U_t(H) under precise conditions, and avoid uncontrolled uses of triangle inequality against existing centers outside H. These ideas remain in-development items in notes, not yet suitable for output.
Global aggregation and probability instantiations (added)

- Global min-of-three aggregator. From Corollary 11 (per-plateau min-of-three) and linearity, we can average over the maximal factor-2 plateau partition [k0,2k0)=⊔_j I_j=[m_j,m_j+L_j). For L_j≥2 each plateau contributes its per-plateau bound with weight L_j/k0, and L_j=1 plateaus contribute via the fixed-k bound. This yields a clean, explicit global formula with constants K0,K1,K2 depending only on C_bi,C_fix. When C_bi=C_fix=5, one can set K0=35, K1=10, K2=5. The third branch (m(1+ln ln L))/L is to be read only for L≥3.

- Endpoint-sum control. The unweighted endpoint contribution aggregates as (K2/k0)∑_{j:L_j≥2} ln m_j. This is always ≤ K2·ln(2k0) since there are ≤k0 plateaus and m_j≤2k0−1 for all j. Thus endpoint terms never exceed O(ln k0).

- Unconditional aggregation bound. Using only the pure-log branch and the easy inequality ln m_j ≤ ln k for k∈I_j, we recover E_{k∼U([k0,2k0)),++}[ALG/OPT] ≤ K′ + K″·ln(2k0) for absolute K′,K″. This validates that, without structural information (e.g., long plateaus), the Θ(log k0) behavior is unavoidable.

- Long-plateau mixture. If a γ-fraction of the window is covered by plateaus with L≥α m, then that portion contributes γ·O_α(1) (by Corollary 5), while the rest is ≤ (1−γ)·O(ln k0). This gives a transparent global interpolation.

- ≥1% global probability under a single long plateau. If I=[m,m+L) with L≥α m covers a γ-fraction of the window, then by Corollary 9 with η=0.98 and c=2 we get P_{k,++}[ALG/OPT ≤ 2·B_I] ≥ γ·(1−η−O(1/L))·(1−1/2) = 0.01·γ − O(γ/L), where B_I = 2·C_bi·(1 + m/(e(T−1))) and T = max{2,⌈0.98(L−1)⌉+1}. If L≥α m then B_I ≤ 2·C_bi(1 + 1/(α e·0.98)) + O(1/L).

Caveat and next steps for heavy-coverage

- The pathwise heavy-collision lemma remains a program: define U_t(H) (uncovered heavy mass), H_t(H) (covered heavy mass), and the stopping time τ when all heavy clusters are covered. A key missing ingredient is a quantitative persistence lower bound inf_{t<τ} U_t(H) ≥ c·S_H (S_H is the sum of single-cluster OPT costs over H) under an explicit separation hypothesis (e.g., OPT_{k1} ≫ OPT_k or geometric separation). Once such a bound and a dominance parameter β>0 (U_t(H) ≥ β·(H_t(all)+U_t(L))) are established, summing conditional collision probabilities gives an expected-collisions bound, which can then be upgraded to high probability via Freedman’s inequality. We should avoid any pathwise inequality that is only justified in expectation (e.g., eH_t supermartingale bounds) without a concentration argument.
Round 0006 updates: audits, fixes, and new curated directions

1) Balanced split (τ=⌊L/2⌋) is safe and useful
- For L≥3 and τ=⌊L/2⌋ we have the uniform bounds: τ/(L−1)≤2/3, (L−1−τ)/(L−1)≤1/2, ln(2m/τ)≤ln(4m/(L−1)), and H_{L−2}−H_{τ−1}≤ln 3+1 (check L=3,4 directly; for larger L use H_n−H_m≤ln((n+1)/(m+1))≤ln 3). Plugging these into Theorem 3 produces a clean O(m/L) tail with explicit constants. We will curate this to output.md.

2) “Constant-tail split” (τ≈(L−1)/e): caution on constants
- With τ=⌊(L−1)/e⌋, τ≥1 only when L≥4. The bound H_{L−2}−H_{τ−1}≤2 is false at L=6 (H_4≈2.083). A rigorous statement should either (i) retain the form H_{L−2}−H_{τ−1}≤1+ln((L−1)/τ), or (ii) give a safe constant (e.g., ≤3 or ≤4) uniformly for L≥4. Until this is adjusted, we will not add this branch to output.md.

3) Multi-plateau ≥1% probability (mixing)
- If a disjoint family of long plateaus {I_j=[m_j,m_j+L_j)} with L_j≥α m_j covers a γ-fraction of [k0,2k0), then by Corollary 9 with η=0.98 and c=2,
  P[ALG/OPT ≤ 2·B_j on the event k∈I_j for some j] ≥ γ·(1−η)·(1−1/2) − O(γ/\min_j L_j) = 0.01·γ − O(γ/\min_j L_j),
  where B_j=2C_bi(1+m_j/(e(T_j−1))), T_j=max{2,⌈η(L_j−1)⌉+1}, and hence B_j≤2C_bi(1+1/(α e η))+O(1/L_j). We will add this global mixing corollary to output.md.

4) Quantified O(log log k0) mixture under polylog-long plateaus
- Let S be the set of plateaus with L_j≥m_j/(ln k0)^σ for some σ≥1 and suppose ∑_{j∈S} L_j≥γ k0. Then
  E[ALG/OPT] ≤ γ·[2C_bi(a+1+ln(const)+σ ln ln k0)] + (1−γ)·[K′+K″ ln(2k0)] + o(1),
  where const is an absolute constant (2 or 4; absorbed into O(1)). The o(1) comes from endpoint terms: their contribution over S is (C_fix/k0)∑_{j∈S} ln m_j ≤ C_fix·|S|·ln(2k0)/k0 = O(γ (ln k0)^σ ln k0/k0)→0, since |S|≤(γ k0)/min_j L_j and min_j L_j≥k0/(ln k0)^σ. We will curate a precise corollary to output.md.

5) Discrete smoothness ⇒ long plateaus (corrected rounding)
- Lemma (sequence form). If (v_k) is nonincreasing and for all k in {m+1,…,m+L−1} we have v_{k−1}≤(1+δ) v_k, then v_{m+L−1}≥v_m/(1+δ)^{L−1}. Hence a factor-2 drop within [m,m+L) requires L≥1+⌈ln 2/ln(1+δ)⌉. Using ln(1+δ)≤δ, it suffices that L≥1+⌈(ln 2)/δ⌉.
- Corollary (1/m-type smoothness on [m,2m)). If v_{k−1}≤(1+A/m) v_k for all k∈[m+1,2m−1], then any factor-2 drop within [m,2m) requires L≥1+⌈(ln 2) m/A⌉. Thus: if A≥ln 2, then L≥((ln 2)/A)·m up to lower-order terms; if A<ln 2, then a factor-2 drop cannot occur within the window, so the whole [m,2m) is one plateau (L=m). This cleanly connects “discrete smoothness” to long plateaus.

6) Heavy-coverage program: rigor requirements
- To bound the expected number of heavy-collisions, one must avoid ratio-of-expectations. Work with p_t^{ch}=cost_t(covered heavy)/cost_t(all) conditioned on the filtration. A usable inequality is p_t^{ch}≤H_t(H_cov)/((β+1)U_t(H)) once we have a deterministic persistence bound cost_t(all)≥(β+1)U_t(H). Then ∑_{t<τ}E[p_t^{ch}|F_t]≤(1/(β+1))·∑_{t<τ}E[H_t(H_cov)/U_t(H)], which still needs (a) a deterministic or high-prob lower bound on U_t(H) until τ, and (b) control of H_t(H_cov) (e.g., via a supermartingale with concentration). These should be established under explicit separation assumptions before drawing collision bounds.

Next steps
- Curate to output.md: (i) balanced split corollary; (ii) multi-plateau 1% mixing; (iii) quantified O(log log k0) mixture; (iv) discrete-smoothness lemma and corollary.
- Either repair or defer the τ≈(L−1)/e branch.
- For heavy coverage: prove a persistence inequality cost_t(all)≥(β+1)U_t(H) under a clean separation hypothesis; then bound expected collisions; then lift to high probability via Freedman.


Current output.md (if any):
Theorems curated in this file depend on the following standard notation and external input.
- For a finite dataset X⊂R^d, write OPT_k for the optimal k-means cost with k centers, and ALG_k for the cost produced by k-means++ after k centers; E_++[·] is expectation over the algorithm’s randomness.
- External input (Makarychev–Reddy–Shan, 2020): There exists an absolute constant C_bi such that for all integers r≥1 and Δ≥1,
  E_++[cost after r+Δ centers] ≤ C_bi · min{ 2 + 1/(2e) + ln(2r/Δ), 1 + r/(e(Δ−1)) } · OPT_r.
  There is also an absolute constant C_fix with E_++[ALG_k] ≤ C_fix·(ln k + O(1))·OPT_k for all k (the fixed-k bound). We treat C_bi and C_fix as absolute numerical constants.

Theorem 1 (Per-k oversampling bound via a 2-approximate anchor).
Fix k≥1 and define
  s(k) := min{ s∈{1,…,k} : OPT_s ≤ 2·OPT_k },    Δ(k) := k − s(k).
Then:
- If Δ(k) ≥ 1, we have
  E_++[ALG_k] ≤ 2·C_bi · min{ 2 + 1/(2e) + ln(2 s(k)/Δ(k)), 1 + s(k)/(e(Δ(k)−1)) } · OPT_k.
- If Δ(k) = 0, we have E_++[ALG_k] ≤ C_fix·(ln k + O(1))·OPT_k.
Proof.
For Δ(k)≥1, apply the MRS bi-criteria inequality with r = s(k) and Δ = k−s(k):
  E_++[ALG_k] = E_++[cost after s(k)+Δ(k) centers]
  ≤ C_bi · min{ 2 + 1/(2e) + ln(2 s(k)/Δ(k)), 1 + s(k)/(e(Δ(k)−1)) } · OPT_{s(k)}.
By definition of s(k), OPT_{s(k)} ≤ 2·OPT_k, giving the stated bound. For Δ(k)=0 the fixed-k bound yields the second claim. ∎

Theorem 2 (Averaging over a factor-2 plateau).
Let I = {m, m+1, …, m+L−1} with L≥2 and assume OPT_k ∈ (OPT_m/2, OPT_m] for all k∈I. Then for k uniform in I and over the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ] ≤ A0 + A1 · ln^+( 2m/(L−1) ) + (A2 · ln m)/L,
where ln^+(x) := max{ln x,0} and A0,A1,A2 are absolute constants depending only on C_bi,C_fix.
Proof.
Average the bound from Theorem 1 over k∈I. For Δ:=k−m≥1, we may upper bound s(k) by m and lower bound Δ(k) by Δ (since s(k)≤m and Δ(k)≥Δ on a factor-2 plateau), and use only the logarithmic branch of MRS to get
  E_++[ALG_{m+Δ}/OPT_{m+Δ}] ≤ 2·C_bi · ( 2 + 1/(2e) + ln(2m/Δ) ).
Averaging Δ from 1 to L−1 gives
  (1/(L−1))∑_{Δ=1}^{L−1} ln(2m/Δ) = ln(2m) − ln((L−1)!)/(L−1) ≤ 1 + ln(2m/(L−1)),
where we used ln(n!) ≥ n ln n − n + 1 for n=L−1≥1. Multiplying by (L−1)/L and adding the Δ=0 endpoint contribution C_fix(ln m + O(1))/L yields the claim with suitable absolute constants A0,A1,A2. Replacing ln by ln^+ only weakens the bound. ∎

Corollary 3 (Decomposition across [k0,2k0)).
Partition the integer interval [k0,2k0) into maximal factor-2 plateaus I_j = [m_j, m_j+L_j), j=1,…,J, so OPT_k ∈ (OPT_{m_j}/2, OPT_{m_j}] for k∈I_j, and ∑_j L_j = k0. Then, for k uniform on [k0,2k0),
  E_k E_++[ ALG_k / OPT_k ]
  ≤ (1/k0) ∑_{j : L_j≥2} L_j [ A0 + A1 · ln^+( 2 m_j/(L_j−1) ) ]
    + (1/k0) ∑_{j : L_j≥2} A2 · ln m_j
    + (1/k0) ∑_{j : L_j=1} C_fix · (ln m_j + O(1)).
In particular, if a constant fraction of [k0,2k0) is covered by plateaus satisfying L_j ≥ m_j / polylog(k0), then the contribution of those plateaus is O(log log k0), and the remaining fraction must be controlled separately; in the worst case with many L_j=1 plateaus the global average can be Θ(log k0).
Proof.
Average the bound of Theorem 2 over plateaus with weights L_j/k0, and handle L_j=1 plateaus by the fixed-k bound. ∎
Lemma (Monotonicity of the MRS bi-criteria bound).
Let a := 2 + 1/(2e), and for integers s≥1, Δ≥1 define
  F(s,Δ) := min{ a + ln(2s/Δ), 1 + s/(e(Δ−1)) },
where the second term is interpreted only for Δ≥2 (or taken as +∞ for Δ=1). Then:
- For fixed Δ, F is nondecreasing in s.
- For fixed s, F is nonincreasing in Δ (for all Δ≥1 in the above interpretation).
Proof.
For Δ≥2, both functions s ↦ a + ln(2s/Δ) and s ↦ 1 + s/(e(Δ−1)) are nondecreasing in s, hence their pointwise minimum is nondecreasing. For Δ≥2, both functions Δ ↦ a + ln(2s/Δ) and Δ ↦ 1 + s/(e(Δ−1)) are nonincreasing in Δ, hence the minimum is nonincreasing. For the transition from Δ=1 to Δ=2, note that F(s,1) = a + ln(2s) ≥ a + ln(s) ≥ a + ln(2s/2) ≥ F(s,2), since the logarithmic branch decreases with Δ and adding the second branch at Δ=2 can only decrease the minimum. Thus F is nonincreasing in Δ for all Δ≥1. ∎

Theorem 3 (Plateau averaging with a tunable split of the two MRS branches).
Let I = {m, m+1, …, m+L−1} be a factor-2 plateau (i.e., OPT_k ∈ (OPT_m/2, OPT_m] for k∈I) with L≥2. For any integer τ with 1≤τ≤L−1, for k uniform on I and over k-means++ randomness we have
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ (τ/(L−1)) · ( a + 1 + ln(2m/τ) )
                + ((L−1−τ)/(L−1))
                + (m/(e(L−1))) · ( H_{L−2} − H_{τ−1} ) ]
    + (C_fix · (ln m + O(1)))/L,
where H_r denotes the r-th harmonic number (H_0:=0).
Proof.
Fix k=m+Δ with Δ∈{1,…,L−1}. By Theorem 1, and Lemma (monotonicity),
  E_++[ALG_{m+Δ}/OPT_{m+Δ}] ≤ 2·C_bi · min{ a + ln(2m/Δ), 1 + m/(e(Δ−1)) },
with the second branch applicable for Δ≥2. Averaging Δ uniformly over {1,…,L−1}, split the sum at τ:
  (1/(L−1)) ∑_{Δ=1}^{L−1} min{…}
  ≤ (1/(L−1)) ∑_{Δ=1}^{τ} [ a + ln(2m/Δ) ]
    + (1/(L−1)) ∑_{Δ=τ+1}^{L−1} [ 1 + m/(e(Δ−1)) ].
For the first sum, use ∑_{Δ=1}^{τ} ln(2m/Δ) = τ ln(2m) − ln(τ!) ≤ τ[1 + ln(2m/τ)] by ln(τ!) ≥ τ ln τ − τ. For the second, ∑_{Δ=τ+1}^{L−1} 1 = L−1−τ and ∑_{Δ=τ+1}^{L−1} 1/(Δ−1) = H_{L−2} − H_{τ−1}. This yields the displayed bound. Finally, incorporate the Δ=0 endpoint k=m which has probability 1/L and contributes at most C_fix·(ln m + O(1))/L by the fixed-k bound. ∎

Corollary 4 (Hybrid extremes recovered; strengthening Theorem 2).
In the setting of Theorem 3:
- Choosing τ = L−1 gives
  E_{k∈I} E_++[ ALG_k / OPT_k ] ≤ 2·C_bi · ( a + 1 + ln(2m/(L−1)) ) + (C_fix · (ln m + O(1)))/L.
  This recovers Theorem 2 (up to constant reparameterization by a and the explicit +1 from Stirling).
- Choosing τ = 1 gives
  E_{k∈I} E_++[ ALG_k / OPT_k ] ≤ 2·C_bi · ( 1 + (a+ln(2m))/(L−1) + (m/(e(L−1))) · H_{L−2} )
    + (C_fix · (ln m + O(1)))/L.
Using H_q ≤ ln q + 1, this yields a complementary regime where the bound scales like 1 + O((ln m)/L) + O((m ln L)/L).
Proof.
Both bounds are immediate from Theorem 3 with the specified τ and the inequality H_q ≤ ln q + 1 for q≥1. ∎

Corollary 5 (Explicit constants on long plateaus).
If L ≥ α m for some fixed α∈(0,1], then for k uniform on I,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · ( a + 1 + ln(2/α) ) + (C_fix · (ln m + O(1)))/L.
Proof.
Apply Corollary 4 with τ=L−1 and use ln(2m/(L−1)) ≤ ln(2/α) + O(1/L). The endpoint term is unchanged. ∎

Corollary 6 (Quantile-in-Δ guarantee on a plateau).
Fix η∈(0,1) and let T := max{2, ⌈η(L−1)⌉+1}. Then for all Δ∈{T,…,L−1},
  E_++[ ALG_{m+Δ} / OPT_{m+Δ} ] ≤ 2·C_bi · ( 1 + m/( e (T−1) ) ).
Consequently, for k uniform on I, the fraction of k for which the above inequality holds is at least (L−T+1)/L = 1 − η − O(1/L).
Proof.
For Δ≥T, the large-Δ branch gives 1 + m/(e(Δ−1)) ≤ 1 + m/(e(T−1)). Combine with Theorem 1 and monotonicity, and note that the set {k: Δ(k)≥T} has size L−T+1 among the L indices in I. ∎
Remark (Plateau length within [k0,2k0)).
Let I = [m,m+L) be a factor-2 plateau contained in [k0,2k0). Then L ≤ 2k0 − m ≤ m. In particular, for L≥2 we have m/(L−1) ≥ 1.
Proof.
Since m+L−1 ≤ 2k0−1, we have L ≤ 2k0−m. As m ≥ k0, it follows that 2k0−m ≤ m. The final claim is immediate. ∎

Corollary 7 (Min-of-extremes plateau bound).
In the setting of Theorem 3 with L≥2, for k uniform on I and the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ min{ B_log, B_hyb } + (C_fix · (ln m + O(1)))/L,
where
  B_log := 2·C_bi · ( a + 1 + ln^+( 2m/(L−1) ) ),
  B_hyb := 2·C_bi · ( 1 + (a+\ln(2m))/(L−1) + (m/(e(L−1))) · H_{L−2} ),
and a := 2 + 1/(2e), H_q denotes the q-th harmonic number with H_0:=0, and ln^+(x):=max{ln x,0}.
Proof.
Take τ=L−1 and τ=1 in Theorem 3 to obtain the two bounds (cf. Corollary 4). Replacing ln by ln^+ only increases the RHS. Taking the minimum preserves validity. ∎

Corollary 8 (Upper envelope from the min-of-extremes).
In the setting of Corollary 7, there exist absolute constants K0,K1,K2 (depending only on C_bi and C_fix) such that
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ K0 + K1 · min{ ln^+( 2m/(L−1) ), (m ln L)/L } + K2 · (\ln m)/L.
Proof.
From Corollary 7 with the logarithmic extreme,
  E ≤ 2·C_bi·(a+1) + 2·C_bi·ln^+(2m/(L−1)) + (C_fix·(\ln m + O(1)))/L.
From the hybrid extreme and H_{L−2} ≤ ln(L−2)+1 ≤ ln L + 1,
  E ≤ 2·C_bi·\Big( 1 + (a+\ln(2m))/(L−1) + (m/(e(L−1))) (\ln L + 1) \Big)
    + (C_fix·(\ln m + O(1)))/L.
Absorb constants into K0 and the terms (ln m)/(L−1), (m/(L−1)) into K2·(\ln m)/L and K1·(m ln L)/L, respectively, using L−1≈L up to absolute factors for L≥2. Taking the minimum of the two displays yields the claim. ∎

Corollary 9 (Plateau-level probability guarantee via quantiles and Markov; global mixing).
Let I=[m,m+L) be a factor-2 plateau with L≥2 and fix η∈(0,1). Define T := max{2, ⌈η(L−1)⌉+1}. Then for at least a (1−η−O(1/L)) fraction of k∈I we have
  E_++[ ALG_k / OPT_k ] ≤ B_I := 2·C_bi · ( 1 + m/( e (T−1) ) ).
Consequently, for any c≥1,
  P_{k\sim U(I),\,++}\big[ ALG_k/OPT_k ≤ c · B_I \big] ≥ (1−η−O(1/L)) · (1 − 1/c).
If, moreover, L ≥ α m for some α∈(0,1], then B_I ≤ 2·C_bi · (1 + 1/(α e η)) + O(1/L). If a plateau I covers a γ-fraction of [k0,2k0) (i.e., L/k0 ≥ γ), then for k uniform on [k0,2k0) and the ++ randomness,
  P\big[ ALG_k/OPT_k ≤ c · B_I \big] ≥ γ · (1−η−O(1/L)) · (1 − 1/c).
Proof.
The first assertion is Corollary 6: a (1−η−O(1/L)) fraction of k satisfy the displayed per-k bound with Δ≥T, hence with E_++ bounded by B_I. For any such k, Markov’s inequality gives P_{++}[ALG_k/OPT_k ≤ c·B_I] ≥ 1−1/c. Averaging uniformly over k on I yields the claim. If L ≥ α m, then T−1 ≥ η(L−1) ≥ η(α m−1), which implies m/(T−1) ≤ 1/(α η) + O(1/L). The global bound follows by restricting to k in I, which occurs with probability ≥ γ. ∎
Corollary 10 (A τ≈m/ln L branch on a plateau).
Let I=[m,m+L) be a factor-2 plateau with L≥3. Define τ*:=min{L−1, ⌊m/ln L⌋}. Then for k uniform on I and over the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ (τ*/(L−1)) · ( a + 1 + ln(2m/τ*) )
                + ((L−1−τ*)/(L−1))
                + (m/(e(L−1))) · ( H_{L−2} − H_{τ*−1} ) ]
    + (C_fix · (ln m + O(1)))/L,
where a:=2 + 1/(2e), and H_r is the r-th harmonic number (H_0:=0). In particular, if m ≤ (L−1) ln L and (as is the case for plateaus inside [k0,2k0)) m≥L, then
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ 1 + (m/((L−1) ln L)) · ( a + 1 + ln(4 ln L) )
                + (m/(e(L−1))) · ( 1 + ln ln L ) ]
    + (C_fix · (ln m + O(1)))/L.
Proof.
Apply Theorem 3 with τ=τ*. The displayed inequality is just Theorem 3. In the subcase m ≤ (L−1) ln L, τ*=⌊m/ln L⌋ satisfies τ* ≥ m/ln L − 1, hence 2m/τ* ≤ 4 ln L and ln(2m/τ*) ≤ ln(4 ln L). Also τ*/(L−1) ≤ m/((L−1) ln L). Finally, H_{L−2} − H_{τ*−1} ≤ ln(L/τ*) + 1 ≤ ln((L ln L)/m) + 1 ≤ 1 + ln ln L, using m≥L. Substituting these bounds into Theorem 3 yields the “in particular” display. ∎

Corollary 11 (Updated per-plateau upper envelope: min-of-three).
In the setting of Corollary 7, there exist absolute constants K0,K1,K2 (depending only on C_bi and C_fix) such that for k uniform on I=[m,m+L) with L≥2,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ K0 + K1 · min{ ln^+( 2m/(L−1) ), (m ln L)/L, (m(1 + ln ln L))/L } + K2 · (\ln m)/L.
Here ln^+(x):=max{ln x,0}. The third term in the minimum is intended for L≥3; when L=2 the minimum of the first two terms suffices. 
Proof.
Combine: (i) the logarithmic extreme τ=L−1 (Corollary 4), (ii) the τ=1 hybrid extreme (Corollary 4 with H_{L−2}≤ln L+1), and (iii) Corollary 10 in the subcase τ*=⌊m/ln L⌋ (which holds exactly when m ≤ (L−1) ln L). In case (iii), the two m-dependent contributions are bounded by a constant multiple of (m/L)(1+ln ln L), since (m/((L−1) ln L))(a+1+ln(4 ln L)) ≤ (const)·(m/L) and (m/(e(L−1)))(1+ln ln L) ≤ (const)·(m/L)(1+ln ln L), with all constants depending only on C_bi. Absorb all additive O(1) and O((\ln m)/L) terms into K0 and K2. Taking the minimum of the three displays yields the claim. ∎

Corollary 12 (Explicit constants for the envelope when C_bi=C_fix=5).
Assume C_bi=C_fix=5 and L≥2. Then for k uniform on I=[m,m+L),
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 35 + 10 · min{ ln^+(2m/(L−1)), (m ln L)/L, (m(1+\ln\ln L))/L } + 5 · (\ln m)/L.
Proof.
From Corollary 7 (logarithmic extreme), E ≤ 2·C_bi·(a+1) + 2·C_bi·ln^+(2m/(L−1)) + (C_fix·(\ln m + O(1)))/L. With a=2+1/(2e) and C_bi=C_fix=5, 2·C_bi·(a+1) ≈ 31.84; round up to 35 to absorb the endpoint O(1/L) terms. The coefficient in front of ln^+(·) is 2·C_bi=10. For the τ=1 branch, the (m ln L)/L contribution carries a factor 2·C_bi/e ≤ 10/e < 10; rounding up to 10 is safe after replacing L−1 by L. For the τ≈m/ln L branch (Corollary 10), the m-dependent part is ≤ const·(m/L)(1+\ln\ln L) with const depending only on C_bi; choosing 10 dominates those constants as well. The endpoint term is ≤ 5·(\ln m + 2)/L and we keep 5·(\ln m)/L after absorbing the additive 10/L into 35. Taking the minimum of the three candidate bounds proves the display. ∎

Remark (Numerical 1% probability instantiation on a single plateau).
In Corollary 9, choose η=0.98 and c=2. Then for k uniform on I and ++ randomness,
  P[ ALG_k/OPT_k ≤ 2 · B_I ] ≥ (1−η−O(1/L)) · (1 − 1/2) = (0.02−O(1/L)) · 0.5 ≥ 0.01 − O(1/L),
with B_I = 2·C_bi·(1 + m/(e(T−1))) and T = max{2, ⌈0.98(L−1)⌉+1}. If additionally L ≥ α m, then B_I ≤ 2·C_bi·(1 + 1/(α e · 0.98)) + O(1/L), giving a fully explicit constant-factor guarantee at ≥1% mass (up to O(1/L)).
Remark (Clarification on Corollary 12).
In Corollary 12 the third term inside the minimum, (m(1+ln ln L))/L, is intended only for L≥3. For L=2, take the minimum of the first two terms. This mirrors the restriction stated in Corollary 11 and avoids using ln ln 2<0.

Corollary 13 (Global min-of-three aggregation across plateaus; explicit constants available).
Partition [k0,2k0) into maximal factor-2 plateaus I_j=[m_j,m_j+L_j), j=1,…,J, so that ∑_j L_j=k0. Then, for k uniform in [k0,2k0) and the k-means++ randomness,
  E_{k,++}[ ALG_k / OPT_k ]
  ≤ (1/k0) ∑_{j:L_j≥2} L_j · [ K0 + K1 · min{ ln^+(2m_j/(L_j−1)), (m_j ln L_j)/L_j, (m_j(1+ln ln L_j))/L_j } ]
    + (K2/k0) ∑_{j:L_j≥2} ln m_j
    + (1/k0) ∑_{j:L_j=1} C_fix · (ln m_j + O(1)),
where ln^+(x):=max{ln x,0}. The third term in the minimum is to be used only for L_j≥3. Here K0,K1,K2 are absolute constants depending only on C_bi,C_fix. In the numerical case C_bi=C_fix=5 one may take K0=35, K1=10, K2=5.
Proof.
For each j with L_j≥2, apply Corollary 11 to I_j and weight by L_j/k0. For L_j=1, use the fixed-k bound with weight 1/k0. Sum over j. The constants K0,K1,K2 come directly from Corollaries 11–12. ∎

Lemma 1 (Endpoint term cap).
With the notation of Corollary 13,
  (1/k0) ∑_{j:L_j≥2} ln m_j ≤ ln(2k0).
Proof.
There are at most J≤k0 plateaus and for all j we have m_j≤2k0−1. Thus ∑_{j:L_j≥2} ln m_j ≤ ∑_{j=1}^{J} ln(2k0) ≤ k0·ln(2k0). Divide by k0. ∎

Corollary 14 (Unconditional global O(log k0) bound).
There exist absolute constants K′,K″ (depending only on C_bi,C_fix) such that for k uniform on [k0,2k0) and ++ randomness,
  E_{k,++}[ ALG_k / OPT_k ] ≤ K′ + K″ · ln(2k0).
Proof.
Use Theorem 2 (or Corollary 7 with τ=L−1) on each plateau with L_j≥2 and average with weights L_j/k0, and handle L_j=1 via the fixed-k bound. For L_j≥2,
  (1/k0)∑_j L_j · ln^+(2m_j/(L_j−1)) ≤ (1/k0)∑_j L_j · ln(2m_j)
  = ln 2 + (1/k0)∑_j L_j ln m_j.
Since for every k∈I_j we have m_j≤k, ∑_j L_j ln m_j ≤ ∑_{k=k0}^{2k0−1} ln k ≤ k0·ln(2k0), giving a contribution ≤ ln(2k0). The endpoint term is bounded by Lemma 1 up to a constant factor, and the L_j=1 part contributes ≤ C_fix·(ln(2k0)+O(1)). Absorb all absolute factors into K′,K″. ∎

Corollary 15 (Global constant under a single long plateau; explicit constants).
Suppose there exists a plateau I=[m,m+L) contained in [k0,2k0) with L ≥ α m for some α∈(0,1] and covering a γ-fraction of the window (i.e., L/k0 ≥ γ). Then
  E_{k,++}[ ALG_k / OPT_k ]
  ≤ γ · [ 2·C_bi · ( a + 1 + ln(2/α) ) + (C_fix · (\ln m + O(1)))/L ]
    + (1−γ) · [ K′ + K″ · ln(2k0) ],
where a:=2+1/(2e) and K′,K″ are the constants from Corollary 14. In particular, as L→∞ the term (C_fix·(\ln m))/L=o(1), so the γ-contribution is O_α(1).
Proof.
Average Corollary 5 over I (weight L/k0=γ) and use Corollary 14 on the complement fraction 1−γ. ∎

Corollary 16 (Global ≥1% probability under a single long plateau; explicit constants).
Under the assumptions of Corollary 15, let η=0.98, c=2, and define T:=max{2,⌈η(L−1)⌉+1} and
  B_I := 2·C_bi · ( 1 + m / ( e (T−1) ) ).
Then, for k uniform on [k0,2k0) and ++ randomness,
  P[ ALG_k / OPT_k ≤ c · B_I ] ≥ γ · (1−η−O(1/L)) · (1 − 1/c) = 0.01·γ − O(γ/L).
If moreover L ≥ α m, then B_I ≤ 2·C_bi · (1 + 1/(α e η)) + O(1/L). For C_bi=5 and α=1, this yields the explicit threshold c·B_I ≤ 20 · (1 + 1/(0.98 e)) ≈ 27.7 on at least 1%·γ − O(γ/L) of the joint (k,++) mass.
Proof.
Apply Corollary 9 on I (giving a per-k bound with probability ≥(1−η−O(1/L)) and then Markov with c=2, hence factor (1−1/2)), and multiply by the mixing weight L/k0=γ. The long-plateau simplification of B_I follows from m/(T−1) ≤ 1/(α η) + O(1/L). ∎
Corollary 17 (Balanced split τ=⌊L/2⌋: an O(m/L) tail with explicit constants).
Let I=[m,m+L) be a factor-2 plateau with L≥3. Set τ:=⌊L/2⌋. Then, for k uniform on I and over the k-means++ randomness,
  E_{k∈I} E_++[ ALG_k / OPT_k ]
  ≤ 2·C_bi · [ (2/3)·( a + 1 + ln( 4m/(L−1) ) ) + 1/2 + (m/(e(L−1)))·( ln 3 + 1 ) ]
    + (C_fix · (ln m + O(1)))/L,
where a:=2 + 1/(2e).
Proof.
Apply Theorem 3 with τ=⌊L/2⌋ and use the uniform bounds for L≥3: τ/(L−1)≤2/3; (L−1−τ)/(L−1)≤1/2; ln(2m/τ)≤ln(4m/(L−1)); and H_{L−2}−H_{τ−1}≤ln 3 + 1 (verified directly for L=3,4 and by monotonicity of H_n−H_m thereafter). Substitute these into Theorem 3. The endpoint term is unchanged. ∎

Corollary 18 (Multi-plateau ≥1% probability guarantee by mixing).
Let {I_j=[m_j,m_j+L_j)} be disjoint factor-2 plateaus with L_j≥α m_j for all j in some index set J, and let their total coverage be γ:= (1/k0)∑_{j∈J} L_j. Fix η∈(0,1) and c≥1. For each j set T_j:=max{2, ⌈η(L_j−1)⌉+1} and B_j:=2·C_bi·(1 + m_j/(e(T_j−1))). Then, for k uniform on [k0,2k0) and over the ++ randomness,
  P\big[ ALG_k/OPT_k ≤ c · B_j for the unique j with k∈I_j \big]
  ≥ γ · (1−η) · (1 − 1/c) − O( γ / L_{\min} ),
where L_{\min}:=\min_{j∈J} L_j. In particular, with η=0.98 and c=2 this gives
  P[ ALG_k/OPT_k ≤ 2·B_j for the unique j with k∈I_j ] ≥ 0.01·γ − O(γ/L_{\min}).
Moreover, if L_j≥α m_j for all j, then B_j ≤ 2·C_bi·(1 + 1/(α e η)) + O(1/L_j), so a uniform threshold B_*=2·C_bi·(1 + 1/(α e η)) + o(1) can be used.
Proof.
Apply Corollary 9 on each plateau I_j with the same (η,c), yielding for k uniform on I_j the bound E_++[ALG_k/OPT_k]≤B_j on a (1−η−O(1/L_j)) fraction of k. For any such k, Markov gives P_{++}[ALG_k/OPT_k ≤ c·B_j]≥1−1/c. Weighting by L_j/k0 and summing over j∈J produces the stated lower bound. The O(·) term is ∑_j (L_j/k0)·O(1/L_j)=O(|J|/k0)=O(γ/L_{\min}). The long-plateau simplification of B_j follows from m_j/(T_j−1)≤1/(α η)+O(1/L_j). ∎

Lemma 2 (Discrete smoothness implies long plateaus).
Let (v_k)_{k≥1} be a nonincreasing positive sequence. Fix integers m≥1 and L≥2. Suppose that for all k∈{m+1,…,m+L−1} we have
  v_{k−1} ≤ (1+δ)·v_k
for some δ∈(0,1). Then
  v_{m+L−1} ≥ v_m / (1+δ)^{L−1}.
Consequently, if a factor-2 drop occurs within [m,m+L) (i.e., v_{m+L−1} ≤ v_m/2), then necessarily
  L ≥ 1 + ⌈ ln 2 / ln(1+δ) ⌉ ≥ 1 + ⌈ (\ln 2)/δ ⌉.
Proof.
Iterating the inequality gives v_{m+t} ≥ v_m/(1+δ)^t for 0≤t≤L−1. If v_{m+L−1}≤v_m/2, then (1+δ)^{L−1}≥2, which is equivalent to L≥1+⌈ln 2/ln(1+δ)⌉. Since ln(1+δ)≤δ, the second inequality follows. ∎

Corollary 19 (1/m-type discrete smoothness on [m,2m) forces long plateaus).
Let (v_k) be nonincreasing and assume that for some absolute A>0 and all k∈{m+1,…,2m−1},
  v_{k−1} ≤ (1 + A/m)·v_k.
Then any factor-2 drop within [m,2m) requires
  L ≥ 1 + ⌈ (\ln 2)·m / A ⌉.
In particular: if A≥\ln 2 then L ≥ ((\ln 2)/A)·m up to +1 rounding; if A<\ln 2, then a factor-2 drop cannot occur within the window and the entire [m,2m) is one plateau (L=m).
Proof.
Apply Lemma 2 with δ=A/m and note that the window has at most m steps, so if 1+⌈(\ln 2)·m/A⌉>m then the drop cannot happen within [m,2m). ∎

Corollary 20 (Quantified O(log log k0) mixture under polylog-long plateaus).
Fix σ≥1 and let S be the set of plateaus I_j=[m_j,m_j+L_j) with L_j ≥ m_j/(\ln k0)^σ. Suppose these plateaus cover a γ-fraction of [k0,2k0), i.e., ∑_{j∈S} L_j ≥ γ k0. Then, for k uniform on [k0,2k0) and ++ randomness,
  E_{k,++}[ ALG_k / OPT_k ]
  ≤ γ · [ 2·C_bi · ( a + 1 + ln 2 + σ·\ln\ln k0 ) ]
    + (1−γ) · [ K′ + K″·\ln(2k0) ]
    + o(1),
where a:=2+1/(2e) and K′,K″ are the constants from Corollary 14. The o(1) term can be taken as O( (\ln(2k0)) (\ln k0)^σ / k0 ).
Proof.
On each I_j∈S, Corollary 5 with α=1/(\ln k0)^σ yields E_{k∈I_j,++}[ALG/OPT] ≤ 2·C_bi·(a+1+\ln(2/α)) + (C_fix·\ln m_j)/L_j. Since \ln(2/α)=\ln 2 + σ·\ln\ln k0, the first term equals the bracket. Weighting by L_j/k0 and summing over j∈S gives γ times the bracket plus (C_fix/k0)∑_{j∈S}\ln m_j. Now |S|≤(∑_{j∈S} L_j)/\min_{j∈S} L_j ≤ γ k0 / (k0/(\ln k0)^σ) = γ (\ln k0)^σ, so (C_fix/k0)∑_{j∈S}\ln m_j ≤ C_fix·|S|·\ln(2k0)/k0 = O( (\ln(2k0))(\ln k0)^σ / k0 ) = o(1). The complement fraction 1−γ is bounded by Corollary 14. ∎

