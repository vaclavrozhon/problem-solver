{
  "progress_md": "Headlines\n- New rigorous, step-local identities for how B_j changes: an exact toggle-count formula restricted to the set S of the at-most-3-per-pair indices whose adjacency actually changes. Two immediate corollaries quantify how much B_j can decrease (or increase) in terms of how many of these changed indices hit current j-boundaries. These identities are clean, model-agnostic, and ready to be curated.\n- Clarification: The \u201cuseful boundary adjacency\u201d heuristic is invalid in general (as already noted in notes.md). The correct locality is at the changed indices S only; nothing else can contribute in a step.\n- Programmatic next step: Use the toggle-count identity plus the dyadic alignment structure of A_0 to lower bound the necessary \u201ccentral hits\u201d at many levels at once. I outline a restricted (equal-scale, grid-aligned) special case that can likely be proved fully and would yield an \u03a9(log^2 n) bound for that restricted class.\n\nFormal statements and proofs (new, ready to curate)\n1) Lemma (toggle-locality identity and signed change at level j).\n- Setup. Let A\u2192A\u2032 be any single PBT step, and S\u2286{1,\u2026,n\u22121} be the set of indices whose adjacency changes in this step (i.e., the three indices around each matched pair: left outer, inner, right outer). For j\u2208{0,\u2026,d\u22121}, let T_j(A) be the set of j-run boundary indices of A.\n- Claim. For every j,\n  B_j(A\u2032) \u2212 B_j(A) = |T_j(A\u2032) \u2229 S| \u2212 |T_j(A) \u2229 S|.\n- Proof. By definition, all adjacencies outside S are identical in A and A\u2032, hence their membership in T_j(\u00b7) is unchanged. Thus T_j(A\u2032) \u0394 T_j(A)\u2286S, and\n  |T_j(A\u2032)| \u2212 |T_j(A)| = |T_j(A\u2032)\u2229S| \u2212 |T_j(A)\u2229S|.\nSince B_j(\u00b7)=|T_j(\u00b7)|+1, the identity follows. \u220e\n\nCorollary 1.1 (one-sided bounds per level).\n- For every j,\n  Decrease_j := max{0, B_j(A) \u2212 B_j(A\u2032)} \u2264 |T_j(A) \u2229 S|,\n  Increase_j := max{0, B_j(A\u2032) \u2212 B_j(A)} \u2264 |S\\T_j(A)|.\n- Proof. From the identity, B_j(A) \u2212 B_j(A\u2032) = |T_j(A)\u2229S| \u2212 |T_j(A\u2032)\u2229S| \u2264 |T_j(A)\u2229S|, and similarly for increases. \u220e\n\nRemarks on usefulness.\n- This exposes the exact \u201cdemand\u201d: shrinking B_j by \u0394 forces at least \u0394 of the changed indices to land on T_j(A). For A=A_0 (bit-reversal), T_j(A)=G_j are dyadic arithmetic progressions, so we can quantify how often a single changed index can service many levels via v_2(i).\n- It also yields the previously curated factor-4 cap as a very special (and weaker) consequence when combined with the disjointness-of-unions argument (only O(B_j) pairs can intersect T_j(A)). More importantly, it is sharp enough to support cross-level trade-off inequalities.\n\n2) Lemma (alignment counting at A_0, restated with weights).\nLet A=A_0 and G_j be the j-boundary set at A_0. For any set of changed indices S (from an arbitrary step):\n  \u03a3_{j=0}^{d\u22121} |S \u2229 G_j| = \u03a3_{i\u2208S} (1+v_2(i)).\nIn particular, for any weights a_j\u22650,\n  \u03a3_j a_j\u00b7|S\u2229G_j| = \u03a3_{i\u2208S} \u03a3_{j: 2^{d\u22121\u2212j}|i} a_j.\n- Proof. As in Theorem 4 of output.md; I include the flexible weighted form since we will need to choose tailored a_j.\n\nImmediate consequences and their limits\n- Using Cor. 1.1 with A=A_0 gives \u03a3_j Decrease_j \u2264 \u03a3_j |S\u2229G_j| = \u03a3_{i\u2208S}(1+v_2(i)). This shows that the total number of j-boundaries removed in a single step is at most the \u201calignment budget\u201d \u03a3_i(1+v_2(i)). Since 1+v_2(i) \u2264 1+\u230alog_2(n\u22121)\u230b, we get the coarse bound \u03a3_j Decrease_j \u2264 |S|\u00b7O(log n).\n- This is not yet strong enough to force an O(1) drop of the log-gap potential per step (the step may create increases elsewhere, and |S| can be \u0398(n)), but it is the right necessary-condition inequality to drive sharper cross-level trade-offs (see Next steps).\n\nRestricted special case towards cross-level scarcity (equal-scale, grid-aligned)\n- Definition (equal-scale, grid-aligned step). Fix L a power of two. A step is L-aligned if (i) every matched pair consists of two adjacent intervals each of length in [L,2L), and (ii) all inner boundaries of matched pairs occur at indices divisible by L (i.e., central cuts lie on the L-grid). This is a strong but natural restriction; many plausible blockwise algorithms satisfy it in phases.\n- Claim (to be proved next; sketch here). In an L-aligned step from A_0, at most O(1) bit-levels j with 2^{d\u22121\u2212j}\u2208[L/2,2L] can shrink B_j by a constant factor; all other levels change by at most o(B_j). Outline:\n  \u2022 By Cor. 1.1, to reduce B_j by \u03b8\u00b7B_j we need |S\u2229G_j| \u2265 \u03b8\u00b7B_j \u2212 |S\\G_j|. Since all inner boundaries lie on the L-grid and all outer boundaries are spaced by at least L (due to equal-scale blocks), |S\u2229G_j| is \u0398(#pairs) if and only if the two grids (L and 2^{d\u22121\u2212j}) are commensurate: specifically, if 2^{d\u22121\u2212j}\u2208[L/2,2L]. Otherwise |S\u2229G_j|/B_j=O(2^{d\u22121\u2212j}/L) or O(L/2^{d\u22121\u2212j}), which is o(1), precluding constant-factor change by Lemma 1.\n  \u2022 Moreover, only O(1) consecutive j satisfy 2^{d\u22121\u2212j}\u2208[L/2,2L]. Thus per step only O(1) \u201cactive levels\u201d can reduce by a constant factor. Combining with the per-level factor cap (Theorem 3) bounds the per-step drop of \u03a3_j |log_2 B_j \u2212 (d\u2212j)| by O(1) in this restricted regime.\n- Status: The combinatorics of outer-boundary contributions needs a careful bound to ensure |S\\G_j| does not swamp the inequality; but because outer boundaries per pair are only 2 and lie on the same L-grid offsets, the o(B_j) estimate for off-scale j is achievable. I will write this rigorously next.\n\nWhy the \u201cuseful-boundary\u201d heuristic fails and how the new lemma fixes the issue\n- Earlier \u201cU_j\u201d (indices adjacent to boundaries) is not a certificate. A changed index far from T_j(A) can certainly toggle membership at j depending on the imported endpoints. The correct locality is: only the indices whose adjacencies change (S) can flip membership; among them, a decrease of B_j can only occur on those that were in T_j(A) (Cor. 1.1). This is the precise and minimal condition we need.\n\nA small but precise trade-off for A_0 (weighted decreases)\n- For A=A_0 and any step, Cor. 1.1 plus weighted alignment gives\n  \u03a3_{j=0}^{d\u22121} 2^{\u2212(j+1)}\u00b7Decrease_j \u2264 \u03a3_{i\u2208S} \u03a3_{j: i\u2208G_j} 2^{\u2212(j+1)}.\nFor i with v_2(i)=t, the inner sum equals \u03a3_{j\u2265d\u22121\u2212t} 2^{\u2212(j+1)} = 2^{\u2212(d\u2212t)}(1\u22122^{\u2212(t+1)}) \u2264 2^{\u2212d+t}.\nTherefore \u03a3_j 2^{\u2212(j+1)}\u00b7Decrease_j \u2264 \u03a3_{i\u2208S} 2^{\u2212d+v_2(i)}.\n- Crude bound: since v_2(i) \u2264 \u230alog_2 i\u230b \u2264 d\u22121, the RHS \u2264 |S|/2. This is not strong enough by itself, but it is an exact accounting that we can pair, in the equal-scale regime, with commensurability to limit |S\u2229G_j| where it matters.\n\nChecks on small n\n- For n=8 (A_0=[0,4,2,6,1,5,3,7]), Cor. 1.1 predicts that B_0 can decrease only if S contains the unique G_0 index (the middle cut); indeed, experiments confirm B_0 changes by at most O(1) per step. For B_1, G_1 are indices 2,4,6; placing inner boundaries on these is necessary for noticeable decrease; changing other indices primarily increases B_1.\n\nGaps in output.md\n- The current output.md includes Theorem 3 (factor-4 cap) proved by bounding |\u0394B_j| via the number of pairs that intersect T_j(A). This is correct as written. However, for subsequent stronger trade-offs we need the toggle-locality identity (new Lemma 1) and its corollary as they cleanly separate (i) where decreases can happen (only at S\u2229T_j(A)) from (ii) where increases can happen (only at S\\T_j(A)). I recommend curating Lemma 1 and Cor. 1.1 next.\n\nObstacles and what failed (crisp)\n- A previously sketched \u201csize lemma\u201d \u0394_j \u2264 C\u00b7\u03a3_p min{1, s(p)/L_j} is false; changed adjacencies are only three per pair and independent of s(p).\n- Cross-level scarcity in full generality cannot rely purely on counting |S|, because each changed index can be \u201crelevant\u201d to O(log n) levels at A_0 (via v_2(i)), and |S| can be \u0398(n).\n- Weighting arguments that sum \u0394B_j/B_j(A_0) over j yield bounds of order |S| (too large) unless we impose structural constraints (equal-scale, grid alignment) to force commensurability conflicts.\n\nNext steps (concrete, testable)\n1) Curate Lemma 1 (toggle-locality identity) and Cor. 1.1. These are simple, exact, and will be repeatedly used.\n2) Prove the equal-scale, grid-aligned cross-level scarcity claimed above. The key is to bound |S\u2229G_j|/B_j for off-scale j by o(1) using simple arithmetic progression intersection counts and the fact that inner cuts lie on the L-grid, while outer cuts contribute only O(#pairs) uniformly spread on that grid.\n3) Generalize from exact alignment to \u201cnear alignment\u201d: pairs with lengths in [L,2L) but inner boundaries allowed to drift; show via a pigeonhole/averaging over residues modulo L that one residue class captures a constant fraction, hence we can apply the aligned argument to that fraction, obtaining the same O(1) active-level cap (up to constants).\n4) Experiments for n=64,128: enumerate random equal-scale partitions for several L and measure, per step, the number of j with B_j reduced by \u22651/2. We expect this number to be O(1) near levels with 2^{d\u22121\u2212j}\u2248L and near zero for others. Record distributions to calibrate constants.\n5) With the scarcity lemma in hand for each equal-scale phase, layer phases across L=1,2,4,\u2026 to argue that \u03a3_j |log_2 B_j \u2212 (d\u2212j)| drops by at most O(1) per phase. This would yield \u03a9(log^2 n) steps for any algorithm restricted to equal-scale phases. Later, try to remove the restriction by decomposing an arbitrary step into O(1) \u201cscale bins\u201d (pigeonhole) and charging the potential drop to those bins.\n\nWhy this is promising\n- The toggle-locality identity provides the right \u201cdemand certificate\u201d per level j in terms of S\u2229T_j(A). In the A_0 regime, T_j(A) are dyadic grids, and equal-scale steps naturally constrain S to near-periodic grids; this sets up an arithmetic progressions intersection framework that is well suited to proving the desired O(1) active-level cap per step.\n"
}