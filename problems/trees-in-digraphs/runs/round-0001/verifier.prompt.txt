=== SYSTEM ===
You are a strict mathematical verifier & research manager.

You are being run in a loop with provers. Your tasks:
- Audit their ideas for correctness and rigor.
- Curate files (notes.md, proofs.md, and output.md).
- Suggest the next steps.

Inputs: 
- task statement
- outputs of provers
- notes.md (informal progress & exploratory work so far)
- proofs.md (rigorous proofs & detailed mathematics so far)
- output.md (main results summary so far)

**Three-tier file system guidelines**:
- **notes.md**: Readable running log of exploratory work, intuitions, failed attempts, ideas. Prefer appending. Replace only if old notes are clearly misleading. Should be self-contained.
- **proofs.md**: Complete rigorous mathematical proofs with full details. Contains proven lemmas, theorems, and detailed derivations. Only add mathematically verified content here.
- **output.md**: ONLY the main problem results. Think twice before adding anything. Should contain a concise summary of the most important theorems that directly advance the main problem. Extremely selective.

Tasks:
1) Audit rigor: identify unjustified steps, false statements, missing lemmas; produce minimal counterexamples.
2) Triage value: separate genuine progress from noise.
3) Guide next steps: propose what provers should try next.

**Return strictly JSON**:
{
  "feedback_md": "Detailed critique of prover outputs (≥200 words). Include concrete next-step suggestions.",
  "summary_md": "Concise summary of this round's work for summarizer.",
  "verdict": "promising|uncertain|unlikely",
  "blocking_issues": ["List of issues preventing progress"],
  "per_prover": [{"prover_id": "01", "brief_feedback": "feedback", "score": "promising|uncertain|unlikely"}],
  "notes_update": {"action": "append|replace", "content": "Markdown for notes.md"},
  "proofs_update": {"action": "append|replace", "content": "Markdown for proofs.md"}, 
  "output_update": {"action": "append|replace", "content": "Markdown for output.md"}
}

**Verdict definitions**:
- **promising**: Significant mathematical progress, publishable results, or clear path to solution
- **uncertain**: Some progress but with unresolved issues or incomplete reasoning  
- **unlikely**: No meaningful progress, fundamentally flawed approaches, or just exploratory work

**Update guidelines**:
- Use null for any update field you don't want to modify
- notes_update: Include informal reasoning, failed attempts, intuitions, exploratory work
- proofs_update: Only include complete, rigorous proofs that you have verified
- output_update: Only include main problem results that directly advance toward the solution


=== USER ===
=== Task (txt) ===

Try to improve upon the results proven in the attached paper. 


=== Notes ===

# Research Notes




=== Current Output ===

# Main Results




=== Prover 1 Output ===

Ideas

- Improve Theorem 3.7 (outstar-with-leaves property) by optimizing the “reservoir” thresholds. Replace the uniform threshold 2ℓ^k at every level by the sharp constant T* = ceil(ℓ^k · ℓ/(ℓ−1)), which is tight for the bottleneck step i = k−1. This lowers the additive overhead from 2kℓ^k to k·ceil(ℓ^k · ℓ/(ℓ−1)).
- Improve the h-parameter in Theorem 3.6 (supergraph_of_normalized). The greedy ray-selection only needs h ≥ |V(B^+_{k,ℓ})| + kℓ·|L| + ℓ = (ℓ^{k+1}−1)/(ℓ−1) + kℓ^{k+1} + ℓ, not 3kℓ^{k+1}.
- Slightly improve the k=2 “giant spider” bound by counting directed 2-walks instead of 2-paths. This yields a strictly better bound for small ℓ (e.g. δ^+ ≥ 6 suffices for ℓ=2), while asymptotically the constant tends to (3+√17)/2.

Results and proofs

1) A sharper outstar-with-leaves property

Theorem A (refinement of Theorem 3.7). Let Π be a δ^+-common property, k ≥ 1 and ℓ ≥ 2. Set
T* = ⌈ℓ^k · ℓ/(ℓ−1)⌉.
If G is a digraph with δ^+(G) ≥ d(Π) + k·T*, then G contains a copy B of B^+_{k,ℓ} such that all leaves of B satisfy Π in G.

Why useful here. This replaces the additive margin 2kℓ^k by k·T*; for ℓ ≥ 3 this is a factor improvement from 2 to ℓ/(ℓ−1) = 1 + 1/(ℓ−1).

Sketch of proof. Redefine Γ(0) = {v: v has Π} and, for i ≥ 1,
Γ(i) = {v : deg^+_{Γ(i−1)}(v) ≥ T*}.
The lexicographic-minimum-vector argument proving Γ(k) ≠ ∅ goes through verbatim with thresholds T* (the only change is that we now assume δ^+(G) ≥ d(Π) + ∑_i T* = d(Π) + k·T*).
From v ∈ Γ(k) build B iteratively. Suppose we have B_i ≅ B^+_{i,ℓ} with leaves L_i (|L_i| = ℓ^i) and |V(B_i)| = (ℓ^{i+1}−1)/(ℓ−1). To extend each leaf w ∈ L_i, we must choose ℓ new children in Γ(k−i−1), disjoint from V(B_i) and disjoint across different leaves. The total number of forbidden vertices when choosing for the j-th leaf is at most |V(B_i)| + ℓ(j−1). Thus it suffices that every w has at least M_i := |V(B_i)| + ℓ|L_i| available out-neighbours in Γ(k−i−1). A simple bound gives
M_i = (ℓ^{i+1}−1)/(ℓ−1) + ℓ^{i+1} ≤ ℓ^{i+1} · ℓ/(ℓ−1) ≤ ℓ^k · ℓ/(ℓ−1) ≤ T*.
Greedy choice works and yields B_{i+1} with leaves in Γ(k−i−1). At the end we obtain B = B_k with all leaves in Γ(0), i.e., all leaves satisfy Π.

2) A better h in Theorem 3.6

Lemma B (disjoint rays selection). Let L be a set of ℓ^k leaves, and for each w ∈ L let S(w) be a copy of S^-_{k,h} centred at w. If
h ≥ |V(B)| + kℓ·|L| + ℓ,
then one can choose, for every w ∈ L, a subgraph S′(w) ≅ S^-_{k,ℓ} such that all S′(w) are pairwise vertex-disjoint and each S′(w) is disjoint from B except at its centre w.

Proof. Order L arbitrarily. Let U be the union of B and all previously chosen S′. When choosing S′(w), each vertex of U\{w} lies on at most one ray of S(w), so at most |U|−1 rays are blocked. If h ≥ |U|−1 + ℓ, we can pick ℓ unblocked rays. Since |U| ≤ |V(B)| + kℓ·|L| at all steps, the stated bound on h suffices.

Corollary C (refined version of Theorem 3.6). Let k ≥ 1, ℓ ≥ 2 and put
h0 := (ℓ^{k+1}−1)/(ℓ−1) + kℓ^{k+1} + ℓ.
If δ^+(G) ≥ f(k,h0) + k·⌈ℓ^k · ℓ/(ℓ−1)⌉, then G contains T(k,ℓ) as a subgraph.

Proof. Apply Theorem A with Π = “is a centre of S^-_{k,h0}” (δ^+-common by Proposition 3.5), obtaining B ≅ B^+_{k,ℓ} whose leaves L are centres of S^-_{k,h0}. Use Lemma B with |V(B)| = (ℓ^{k+1}−1)/(ℓ−1) and |L| = ℓ^k to extract the required disjoint S′(w), w ∈ L.

Remarks.
- The original proof used T = 2ℓ^k (sum 2kℓ^k) and h = 3kℓ^{k+1}. The present bounds improve both constants to k·ℓ^k·ℓ/(ℓ−1) and kℓ^{k+1} + O(ℓ^k), respectively. As f(k,·) from [1] grows quickly in its second argument, halving the leading constant in h transfers into an exponential improvement in the δ^+ threshold implicit in f.
- For ℓ = 2 we have ℓ/(ℓ−1) = 2, so the T-part matches the original; for ℓ ≥ 3 we obtain a genuine reduction.

3) Improved linear bound for S^-_{2,ℓ}

Theorem D (refines Theorem 1.4 for small ℓ). For every ℓ ≥ 1, any digraph G with minimum out-degree d satisfying

d > d_*(ℓ) := ( (3ℓ−1) + √(17ℓ^2 − 10ℓ + 1) ) / 2
contains S^-_{2,ℓ} as a subgraph.

Proof. Repeat the proof of Theorem 1.4 but count directed 2-walks instead of directed 2-paths. Partition V = A ⊔ B by A := {v : deg^−(v) ≥ 2ℓ}, B := {v : deg^−(v) < 2ℓ}. After handling the “easy” case deg^−_A(r) ≥ 2ℓ as in the paper, assume deg^−_A(v) ≤ 2ℓ−1 for all v ∈ A and, by deleting edges if necessary, deg^+(v) = d for all v.
Let X ⇒ Y ⇒ Z denote the set of directed 2-walks with middle in Y and end in Z. Then
|V ⇒ B ⇒ A| = |A ⇒ V ⇒ V| − |A ⇒ A ⇒ V| + |B ⇒ B ⇒ V| − |V ⇒ B ⇒ B|.
Using deg^+(·) = d and deg^−(y) ≤ 2ℓ−1 for y ∈ B,
|A ⇒ V ⇒ V| = |A| d^2,
|A ⇒ A ⇒ V| ≤ e(G[A]) d ≤ (2ℓ−1) d |A|,
|B ⇒ B ⇒ V| = e(G[B]) d,
|V ⇒ B ⇒ B| ≤ e(G[B]) (2ℓ−1).
Hence |V ⇒ B ⇒ A| ≥ |A| d(d−2ℓ+1). Averaging gives a ∈ A with |V ⇒ B ⇒ {a}| ≥ d(d−2ℓ+1). Let s be the maximum number of pairwise vertex-disjoint 2-walks of the form q_i → b_i → a with b_i ∈ B and all q_i distinct. Then the number of such 2-walks using b_i in S := {b_1,…,b_s} is at most (2ℓ−1)s, and by maximality every 2-walk to a through B\S starts in Q := {q_1,…,q_s}, giving d s ≥ d(d−2ℓ+1) − (2ℓ−1)s. Thus
s ≥ d(d−2ℓ+1)/(d+2ℓ−1).
If s ≥ ℓ we obtain S^-_{2,ℓ}. Solving s ≥ ℓ for d yields d > d_*(ℓ), as claimed.

Numerics. The improvement is strict for each fixed ℓ; e.g. ℓ=2 gives d ≥ 6 (old bound ≈ 7.12), ℓ=3 gives d ≥ 10 (old bound ≈ 10.68), ℓ=4 gives d ≥ 14 (old bound ≈ 14.24). As ℓ → ∞ the constant approaches (3+√17)/2, matching the asymptotics of the original proof.

Obstacles and limitations

- The walk-based refinement in Theorem D cannot (by this method) beat the asymptotic constant (3+√17)/2, because the bottleneck is the unavoidable subtraction of contributions with small in-degree in B and the trivial per-source bound d.
- For Theorem A the uniform threshold T* is essentially sharp for the greedy extension step: at i = k−1 one must accommodate simultaneously |V(B_{k−1})| + ℓ|L_{k−1}| ≈ ℓ^k · ℓ/(ℓ−1) forbidden vertices. Any further reduction would require a non-greedy (e.g. matching/nibble) selection across all leaves at once, which introduces codegree issues hard to control without extra structure.

Next steps

- Try a simultaneous (global) selection of children for all leaves using bipartite edge-coloring or the Rödl nibble, aiming to replace T* by (1+o(1))ℓ^k and reduce the additive overhead from k·ℓ^k·ℓ/(ℓ−1) to (1+o(1))kℓ^k.
- Improve h further by a global packing of rays across all S(w), potentially lowering h from kℓ^{k+1} + O(ℓ^k) to (1+o(1))kℓ^{k+1}.
- For k=2 explore hybrid arguments that exploit the distribution of deg^− on B to lower the constant toward 3, e.g. via a dyadic decomposition of B by in-degree and a refined double-counting across levels.

References

[1] Aboulker, Cohen, Havet, Lochet, Moura, Thomassé (2016). Subdivisions in digraphs of large out-degree.



=== Prover 2 Output ===

# Ideas

- Quantitative refinement of Theorem 2.5 (Theorem 3 in the paper): replace the uniform threshold 2k\ell^k by a level-dependent schedule whose sum is O(\ell^k) (independent of k up to a multiplicative constant depending only on \ell). This substantially improves the additive term in Theorem 2.6 (Theorem 4 in the paper).
- Sharpen the “disjoint rays” extraction used in Theorem 2.6 to reduce h in the property “centre of S^-_{k,h}” from 3k\ell^{k+1} to k\ell^{k+1}+2\ell^k+\ell.
- Comment on possible improvements to the linear bound for S^-_{2,\ell}; outline why the present counting route seems near its limit without a new idea.

# A refined “out-arborescence with prescribed leaves” theorem

We adapt Theorem 2.5 by using non-uniform thresholds. Let \(\mathcal P\) be a \(\delta^+\)-common property. Fix integers \(k\ge 1\) and \(\ell\ge 2\). Define sets \(\Gamma(i)\subseteq V(G)\) by
- \(\Gamma(0)=\{v:\ v\text{ satisfies }\mathcal P\}\),
- for \(1\le i\le k\), \(\Gamma(i)=\{v:\ \deg^+_{\Gamma(i-1)}(v)\ge t_i\}\),
with thresholds
\[
 t_k:=\ell,\qquad t_{k-i}:=\ell^{i+1}+\Big\lceil\frac{\ell^{i+1}-1}{\ell-1}\Big\rceil\quad (1\le i\le k-1).
\]

The new thresholds are tailored to the combinatorics of the greedy construction at depth \(i\): the term \(\ell^{i+1}\) pays for simultaneously assigning \(\ell\) new children to each of the \(\ell^i\) current leaves, and the term \(\lceil(\ell^{i+1}-1)/(\ell-1)\rceil\) upper-bounds the number of vertices already used before reaching that depth.

Define the sum
\[
 S_{k,\ell}:=\sum_{i=1}^k t_i=\ell+\sum_{i=1}^{k-1}\left(\ell^{i+1}+\Big\lceil\tfrac{\ell^{i+1}-1}{\ell-1}\Big\rceil\right).
\]
A convenient explicit upper bound is
\[
 S_{k,\ell}\le \frac{\ell^{k+1}-\ell}{\ell-1}+\frac{\ell^{k+1}-\ell}{\ell-1}+\ell=\frac{2(\ell^{k+1}-\ell)}{\ell-1}+\ell\le \frac{2\ell}{\ell-1}\,\ell^k+\ell.
\]
In particular, \(S_{k,2}\le 4\cdot 2^{k}-4+2<4\cdot 2^k\), and for fixed \(\ell\) the sum is \(\Theta(\ell^k)\) (independent of \(k\) up to a constant depending only on \(\ell\)).

The proof follows the structure of Theorem 2.5, with two changes: (i) the “level-set” contradiction uses the variable thresholds \(t_i\), and (ii) the greedy extension at depth \(i\) uses the sharper accounting of pre-used vertices.


Claim 1 (Level-set contradiction with variable thresholds). If \(\delta^+(G)\ge d(\mathcal P)+\sum_{i=1}^k t_i\), then \(\Gamma(k)\neq\emptyset\).

Sketch. Repeat the lex-order argument verbatim, but with \(t_i\) in place of the constant bound \(2\ell^k\). If \(\Gamma(k)=\emptyset\), let \(z\) be the minimal (under lex order) nonempty class, set \(X:=V_{\vec 0}\) and \(W:=\bigcup_{i: z_{i+1}=0}\Gamma(i)\). For any \(v\in V_z\), the inequality \(\deg^+_W(v)<\sum_{i: z_{i+1}=0} t_{i+1}\) holds by definition of the \(\Gamma(i)\). If \(z\ne\vec 0\), this contradicts \(\delta^+(G)\). If \(z=\vec 0\), then \(\delta^+(G[X])\ge \delta^+(G)-\sum_i t_i\ge d(\mathcal P)\), so some \(x\in X\) satisfies \(\mathcal P\) in \(G\), hence \(x\in \Gamma(0)\), contradicting \(x\in X\). ∎

Claim 2 (Greedy construction with the new thresholds). From any \(v\in\Gamma(k)\) we can build a copy \(B\) of \(B^+_{k,\ell}\) rooted at \(v\) so that the leaves of the depth-\(i\) tree \(B_i\) lie in \(\Gamma(k-i)\), for \(i=0,1,\dots,k\).

Proof. The base step uses \(t_k=\ell\). For the induction step from depth \(i\) to \(i+1\), let \(L\) be the (\(\ell^i\) many) leaves of \(B_i\). The number of vertices used so far is \(|V(B_i)|=\sum_{j=0}^{i}\ell^j=(\ell^{i+1}-1)/(\ell-1)\). For each \(w\in L\), since \(w\in \Gamma(k-i)\), we have
\[
 \deg^+_{\Gamma(k-i-1)}(w)\ge t_{k-i}=\ell^{i+1}+\Big\lceil\frac{\ell^{i+1}-1}{\ell-1}\Big\rceil.
\]
Deleting the already used vertices can remove at most \((\ell^{i+1}-1)/(\ell-1)\) of these neighbours, leaving every \(w\) with at least \(\ell^{i+1}\) candidates in \(\Gamma(k-i-1)\). Now process the leaves one by one; by the time we reach the \(j\)-th leaf we have used at most \(\ell(j-1)\) new vertices at this depth. Since \(\ell(j-1)\le \ell^{i+1}-\ell\), there still remain at least \(\ell\) candidates for the current leaf. Hence we can assign \(\ell\) distinct children to every leaf, obtaining \(B_{i+1}\). ∎

Combining the two claims yields:

Theorem A (Refinement of Theorem 2.5). Let \(\mathcal P\) be \(\delta^+\)-common, and \(k\ge 1,\ \ell\ge 2\). If
\[
 \delta^+(G)\ \ge\ d(\mathcal P)+S_{k,\ell},
\]
then \(G\) contains a copy \(B\) of \(B^+_{k,\ell}\) whose leaves all satisfy \(\mathcal P\).

Compared to \(d(\mathcal P)+2k\ell^k\) in Theorem 2.5, the new additive term is
\(S_{k,\ell}=\Theta(\ell^k)\), independent of \(k\) up to a constant depending only on \(\ell\).

# A sharper h for attaching the in-spiders

In Theorem 2.6 the choice \(h=3k\ell^{k+1}\) is used to greedily extract disjoint copies \(S'(w)\cong S^-_{k,\ell}\) from \(S(w)\cong S^-_{k,h}\) at each leaf \(w\) of \(B\). A tighter bookkeeping shows that
\[
 h\ge k\ell^{k+1}+2\ell^k+\ell
\]
already suffices.

Indeed, at the moment of choosing \(S'(w)\) for a given leaf \(w\):
- the tree \(B\) occupies at most \(|V(B)|=\sum_{i=0}^{k}\ell^i\le 2\ell^k\) vertices (hence blocks at most that many rays of \(S(w)\)),
- previously chosen \(S'(w')\) for other leaves \(w'\) occupy at most \(k\ell\) vertices each off their centres, so after handling up to \(\ell^k-1\) leaves they block at most \(k\ell(\ell^k-1)\le k\ell^{k+1}\) rays of \(S(w)\),
- different rays of \(S(w)\) are internally disjoint and each external vertex lies on at most one ray of \(S(w)\).
Thus, strictly fewer than \(k\ell^{k+1}+2\ell^k\) rays can be blocked, leaving at least \(h-(k\ell^{k+1}+2\ell^k)\) usable rays. If this is \(\ge \ell\), we can pick \(\ell\) disjoint rays to form \(S'(w)\).

Combining with Theorem A (taking \(\mathcal P\) to be “is the centre of a copy of \(S^-_{k,h}\)”), we obtain the following quantitative improvement of Theorem 2.6.

Corollary B (Improved Theorem 2.6). Let \(k\ge 1,\ \ell\ge 2\) and set \(h:=k\ell^{k+1}+2\ell^k+\ell\). If
\[
 \delta^+(G)\ \ge\ f(k,h)+S_{k,\ell},
\]
then \(G\) contains a copy of \(T(k,\ell)\). Here \(S_{k,\ell}\) is as in Theorem A, and can be bounded by \(S_{k,\ell}\le \tfrac{2\ell}{\ell-1}\,\ell^k+\ell\).

Remarks.
- This reduces the additive term from \(2k\ell^k\) to \(\Theta(\ell^k)\), a polynomial-in-\(\ell\) improvement independent of \(k\). The required \(h\) is also reduced by a factor \(\approx 3\).
- Any future improvement of \(f(k,h)\) (existence of \(S^-_{k,h}\)) instantly propagates to a better bound here.

# On S^-_{2,\ell}: why the current method seems near its limit

Trying to lower the constant in Theorem 3.1 by reparametrizing the partition \(V=A\cup B\) does not help unless one changes the “easy case” (greedy construction inside \(A\)). That case crucially uses the guarantee \(\deg^-(a)\ge 2\ell\) for every \(a\in A\) to pick distinct predecessors \(x_i\). If one lowers the threshold for \(A\) below \(2\ell\), that greedy step can fail. On the other hand, the counting step
\[
|V\to B\to A|\ge d(d-2\ell)|A|+e(G[B])(d-2\ell)
\]
appears tight under only \(\deg^+(v)\equiv d\), \(\deg^-_A\le 2\ell-1\) on \(A\), and \(\deg^-(b)\le 2\ell-1\) on \(B\). Marginal tweaks (e.g. replacing \(2\ell\) by \(2\ell-1\) in one place) give at best tiny constant improvements. A more substantial gain likely needs a new ingredient (e.g. a matching or augmenting-path argument in the bipartite graph of predecessors) that can certify many vertex-disjoint length-2 in-paths to some \(a\in A\) from degree information alone.

# Examples and sanity checks

- For \(\ell=2\), \(S_{k,2}<4\cdot 2^k\). In contrast, the paper’s additive term is \(2k\cdot 2^k\). Already for \(k=6\), this replaces \(128\,k\) by \(<256\).
- For \(\ell=10\) and general \(k\), we get \(S_{k,10}\le (20/9)\cdot 10^k+10\), versus the paper’s \(2k\cdot 10^k\).

# Obstacles

- The main bottleneck remains the bound \(f(k,h)\) for \(S^-_{k,h}\); the best available from \cite{aboulker1610subdivisions} is very large. Any linear-in-\(h\) bound (even with a \(k\)-dependent constant) would make Theorem 2.6 essentially linear in \(\ell^k\).
- Improving Theorem 3.1 to a constant \(<3.56\) by the same two-phase scheme seems unlikely without a new mechanism to create many disjoint \(V\to B\to a\) paths (e.g. a robust matching lower bound in the predecessor graph).

# Next steps

- Try to prove a polynomial (in \(h\)) bound for \(f(k,h)\) using a layering-plus-expansion scheme tailored to min out-degree (even \(h^{O(k)}\) would be impactful).
- Investigate extensions of Theorem 2.4 to grounded trees where the minimal subtree on \(U\) is “almost” an out-arborescence (e.g. bounded number of backward edges), by augmenting the above framework with small switching gadgets.
- Explore whether a genuine matching argument (Hall/Kőnig) in the predecessor bipartite graph can push the \(3.56\) constant for \(S^-_{2,\ell}\) closer to \(3\) or even \(2+\varepsilon\).

# Proof details to be checked by the verifier

- The two claims in Theorem A mirror those in Theorem 2.5 and only require replacing the uniform threshold by \(t_i\) and using the exact bound \(|V(B_i)|=(\ell^{i+1}-1)/(\ell-1)\). All inequalities are displayed above.
- The improved \(h\) bound in Corollary B follows from the refined ray-blocking count; each previously chosen vertex blocks at most one ray of a fixed \(S(w)\).



=== Prover 3 Output ===

Ideas

- Sharpen Theorem 3.3 (out-arborescence with leaves satisfying a δ+-common property): replace the factor 2 in the “2kℓ^k” term by 1 + 1/(ℓ−1). This yields a smaller δ+ threshold, provably sufficient by a refined greedy packing argument.
- Reduce the parameter h used in Theorem 3.4 (the size of the in-star subdivision we require at the leaves) from 3kℓ^{k+1} down to kℓ^{k+1} + 2ℓ^k + ℓ. This lowers the bound fed into f(k,h) from [1], and propagates to a significantly smaller quantitative δ+ bound (since f grows very quickly in h).
- Point out a gap in the proof of Theorem 4.3 (linear bound for S^-_{2,ℓ}): the step “by maximality of s, all these paths have their first vertex in Q” is not justified. Propose a corrected counting that gives a slightly weaker inequality; the original constant 3.56 seems to require a different augmentation argument.

Improvement 1: Sharpen Theorem 3.3

Statement (sharpened). Let ℓ ≥ 2, k ≥ 1, and let P be a δ+-common property with threshold d(P). Define
- M := (ℓ^k − 1)/(ℓ − 1), and
- β := ℓ^k + M.
If δ^+(G) ≥ d(P) + kβ, then G contains a copy B of B^+_{k,ℓ} such that all leaves of B satisfy P in G.

Why this helps here: This reduces the add-on from 2kℓ^k down to k(ℓ^k + (ℓ^k − 1)/(ℓ − 1)), improving Theorem 3.3 as stated in the paper.

Proof sketch (modification of the original argument).
- Define Γ(0) as in the paper, and for i ≥ 1 put Γ(i) := {v : deg^+_{Γ(i−1)}(v) ≥ β}.
- The lexicographic-minimum-vector argument (Claim 3.5 in the paper) carries through verbatim with 2ℓ^k replaced by β. In the case z ≠ 0, we have deg^+_W(v) < |I|β ≤ kβ; in the case z = 0, we get δ^+(G[X]) ≥ d(P), contradicting the anti-monotonicity of P. Hence Γ(k) ≠ ∅.
- Greedy construction of B: let v ∈ Γ(k). Build B_i inductively as in the paper. At step i (0 ≤ i ≤ k−1), the leaves L of B_i lie in Γ(k−i). For every w ∈ L we have deg^+_{Γ(k−i−1)}(w) ≥ β.
- We must show that for each w ∈ L we can choose ℓ new out-neighbours from Γ(k−i−1) disjoint from V(B_i) and also pairwise disjoint across w ∈ L. We use two facts:
  1) Fact A: |V(B_i)| ≤ 1 + ℓ + … + ℓ^i = (ℓ^{i+1}−1)/(ℓ−1) ≤ M. Hence each w has at least β − |V(B_i)| ≥ ℓ^k available neighbours in Γ(k−i−1) \ V(B_i).
  2) Fact B (simple packing lemma): If a family of at most t := |L| ≤ ℓ^{k−1} left vertices each has at least ℓ^k available neighbours in a common pool, then one can greedily assign to each left vertex a disjoint ℓ-set of neighbours. Indeed, when placing the j-th ℓ-set (j ≤ t), at most (j−1)ℓ ≤ ℓ^k − ℓ vertices have been used; since the current left vertex has at least ℓ^k available neighbours, there remain at least ℓ unused neighbours.
- Using Facts A and B, we extend B_i to B_{i+1} with leaves in Γ(k−i−1). After k steps we obtain B = B_k with leaves in Γ(0), i.e., all leaves satisfy P in G.

Thus the construction works under δ^+(G) ≥ d(P) + kβ.

Improvement 2: Reduce h in Theorem 3.4

Statement (sharpened). Let h* := kℓ^{k+1} + 2ℓ^k + ℓ and P be the property “v is the center of S^-_{k,h*}”. Then for any digraph G with δ^+(G) ≥ f(k,h*) + k(ℓ^k + (ℓ^k − 1)/(ℓ − 1)), there is a copy of T(k,ℓ) in G.

Why this helps here: The paper sets h = 3kℓ^{k+1}. The tighter packing below shows that h* suffices; since f(k,h) (from [1]) grows quickly with h, replacing h by h* yields a far smaller quantitative δ+.

Proof sketch (modification of Theorem 3.4).
- By Improvement 1 with P = “center of S^-_{k,h*}”, the graph G contains a copy B of B^+_{k,ℓ} whose ℓ^k leaves L are centers of S(w) ≅ S^-_{k,h*} (w ∈ L).
- We now choose for each w ∈ L a subspider S′(w) ≅ S^-_{k,ℓ} contained in S(w) so that the family {S′(w)} is pairwise vertex-disjoint and disjoint from B
except at w. We proceed greedily over w.
- The union of B with previously chosen S′(w′) has size at most |V(B)| + (|already chosen leaves|) · (kℓ) ≤ 2ℓ^k + (ℓ^k − 1)kℓ.
- Inside S(w), any vertex ≠ w lies on exactly one ray. Hence at most 2ℓ^k + (ℓ^k − 1)kℓ rays of S(w) can be blocked by the previously chosen union. Since S(w) has h* rays and h* − [2ℓ^k + (ℓ^k − 1)kℓ] = ℓ, at least ℓ rays remain available to form S′(w).
- Choosing these ℓ rays for each w yields the desired copy of T(k,ℓ).

Remarks.
- The proof only uses disjointness and does not assume any structure on overlaps between the various S(w); the h* bound is tight for this argument up to the additive +ℓ (which we keep for clarity).
- Numerically, h* = kℓ^{k+1} + 2ℓ^k + ℓ ≪ 3kℓ^{k+1} once ℓ ≥ 3.

Issue detected in the proof of Theorem 4.3 (k = 2 spiders)

- In the last part of the proof, after fixing a ∈ A with |V → B → {a}| ≥ d(d − 2ℓ), the argument takes a maximum-size family {(q_i,b_i)} with b_i ∈ N^-_B(a), q_i ∉ S ∪ {a}, and asserts: “By maximality of s, all the remaining paths V → (B \ S) → {a} start in Q.”
- This implication is not valid as stated: a remaining path may start in S or at a itself without contradicting maximality (since the choice q_i ∈ S is disallowed in the construction of the family {(q_i,b_i)}). Therefore, the lower bound used on the number of Q → (B \ S) → {a} paths does not follow.
- A safe correction is to bound the contribution from S ∪ {a} explicitly by s·d + d and deduce
  s·d ≥ [d(d − 2ℓ) − (2ℓ − 1)s] − (sd + d),
  which simplifies to s ≥ [d(d − 2ℓ − 1)]/[2d + (2ℓ − 1)]. This yields a weaker constant (about 2 + √6 ≈ 4.449 for large ℓ) rather than (3 + √17)/2 ≈ 3.561.
- Conclusion: the 3.56 constant needs a refined augmentation/matching argument that prevents S ∪ {a} from carrying many remaining paths. For instance, one might aim to pick S and Q as a maximum matching between (V \ (Y ∪ {a})) and Y = N^-_B(a) and then argue that edges from Y into Y \ S are sparse under δ+ regularity; or use an alternating-path rerouting to ensure that most paths from Y \ S enter Q rather than S ∪ {a}. We did not complete such a rerouting while preserving the vertex-disjointness constraints.

Examples/sanity checks

- Improvement 1 for k = 1: β = ℓ + (ℓ − 1)/(ℓ − 1) = ℓ + 1, so δ^+(G) ≥ d(P) + kβ = d(P) + (ℓ + 1) suffices. This matches the natural intuition that to grow an ℓ-ary out-star with leaves having property P, one needs the property threshold plus “ℓ + buffer”.
- Improvement 2 for ℓ = 2: h* = k·2^{k+1} + 2·2^k + 2 = (k + 1)·2^{k+1} + 2. The paper used 3k·2^{k+1}; for k ≥ 2 this is a factor ~3/(k+1) improvement inside f(k,h).

Obstacles and limits

- In Improvement 1 we used the crude bound |V(B_i)| ≤ M uniformly for all i, which is tight for i = k − 1 but pessimistic earlier. An attempt to reduce β further by tracking |V(B_i) ∩ Γ(k−i−1)| on the fly seems to require information about Γ-level intersections, which is not available in the abstract setting of δ+-common properties.
- For Theorem 4.3, the matching-based obstruction is genuine: left vertices in S are forbidden as sources for the matching by design, and hence can absorb many of the remaining paths. Avoiding this difficulty seems to require a different selection of S, Q (perhaps via a two-phase greedy that first limits out-degree from S to Y \ S) or a potential-function that charges such paths back to previously selected pairs.

Next steps

- Pursue a tightened version of Improvement 1 by replacing M with the exact bound for each stage: require deg^+_{Γ(k−i−1)}(w) ≥ ℓ^k + |V(B_i) ∩ Γ(k−i−1)|. Using a uniform upper bound for |V(B_i) ∩ Γ(k−i−1)| strictly smaller than M (e.g., M − ℓ^{k−1} in many stages) would improve β further.
- For Theorem 3.4, tighten the “2ℓ^k” term in h* to (ℓ^k − 1)/(ℓ − 1) by noticing that |V(B)| = (ℓ^{k+1} − 1)/(ℓ − 1) and only vertices of B that actually lie in S(w) can block rays. While worst-case overlap may still force using |V(B)|, in many regimes the effective overlap might be much smaller, permitting a refined h* with a smaller additive term.
- Repair Theorem 4.3 while keeping a 3.56-type constant: try selecting S, Q by an alternating-path augmentation that forbids edges from S ∪ {a} into Y \ S, or show that the flow from S ∪ {a} into Y \ S is o(d(d − 2ℓ)) under d-regularity. Alternatively, partition B into finer degree classes and show that many b ∈ N^-_B(a) have large in-degree from V \ (S ∪ {a}).

References mentioned

- [1] Aboulker, Cohen, Havet, Lochet, Moura, Thomassé: Subdivisions in digraphs with large out-degree (for f(k,ℓ) and δ^+-maderian in-arborescences).


=== Prover 4 Output ===

Ideas

- Improve the constant 2 in Theorem 3.4 (Theorem outstar_with_leaves_property) to 1+1/(ℓ−1), keeping the same proof skeleton but tightening the greedy step that expands leaves.
- Sharpen the “packing rays” step in Theorem 3.3 (supergraph_of_normalized) by replacing h=3kℓ^{k+1} with h=kℓ^{k+1}+2ℓ^k+ℓ, which is asymptotically a factor-3 improvement in h. This reduces f(k,h) and thus the overall δ^+-bound quantitatively.
- Slightly tighten the constant in Theorem 4.1 (linear spiders for k=2) by using 2ℓ−1 instead of 2ℓ in one place of the proof; this gives a small improvement for finite ℓ.

Results and proofs

1) Improved outstar-with-leaves property

Theorem A (improves Theorem 3.4). Let ℘ be δ^+-common with threshold d(℘). Let k≥1, ℓ≥2. Define
T := ℓ^k + ⌈ℓ^k/(ℓ−1)⌉.
If δ^+(G) ≥ d(℘) + kT, then G contains a copy B of B^+_{k,ℓ} whose leaves satisfy ℘ in G.

Why this improves Theorem 3.4: The original used T=2ℓ^k and the bound d(℘)+2kℓ^k. Since T=ℓ^k+⌈ℓ^k/(ℓ−1)⌉ = (1+1/(ℓ−1))ℓ^k+O(1), the new bound is d(℘) + k(1+1/(ℓ−1))ℓ^k + O(k), which strictly improves 2kℓ^k for all ℓ≥3 (and matches it for ℓ=2).

Proof. We follow the original proof verbatim, redefining the sets Γ(i) as
- Γ(0) = {v : v satisfies ℘},
- Γ(i) = {v : deg^+_{Γ(i−1)}(v) ≥ T}, for i=1,…,k.
The lexicographic-minimal-vector argument (Claim 3.5) goes through unchanged with T in place of 2ℓ^k; the only place T is used is to sum the bounds deg^+_{Γ(i)}(v) < T for indices i with z_{i+1}=0, so that deg^+_W(v) < ∑_{i∈I}T ≤ kT. Thus, if δ^+(G) ≥ d(℘) + kT, we again get Γ(k)≠∅.

To perform the greedy construction B_0,…,B_k, the only needed adjustment is the expansion step B_i→B_{i+1} from leaves L⊆Γ(k−i). Each leaf w∈L needs ℓ new out-neighbours in Γ(k−i−1) that avoid V(B_i) and avoid choices made for earlier leaves in L. We use that |V(B_i)| ≤ ∑_{j=0}^i ℓ^j = (ℓ^{i+1}−1)/(ℓ−1) ≤ ⌈ℓ^k/(ℓ−1)⌉ for i≤k−1, so for every leaf w
 deg^+_{Γ(k−i−1)\V(B_i)}(w) ≥ T − |V(B_i)| ≥ ℓ^k.
Now process the leaves in any order: when choosing for the r-th leaf, at most rℓ ≤ |L|ℓ ≤ ℓ^i·ℓ = ℓ^{i+1} ≤ ℓ^k neighbours have been reserved by previous leaves. Hence each leaf still has at least ℓ^k−ℓ^{i+1} ≥ ℓ available choices, so we can pick ℓ new, pairwise disjoint neighbours. This yields B_{i+1} with leaves in Γ(k−i−1). Iterating gives B_k with leaves in Γ(0), i.e., satisfying ℘. ∎

Corollary A (improves Theorem 3.3). Let k≥1, ℓ≥2 and put h := kℓ^{k+1}+2ℓ^k+ℓ. Then every digraph G with
 δ^+(G) ≥ f(k,h) + k(ℓ^k + ⌈ℓ^k/(ℓ−1)⌉)
contains T(k,ℓ) as a subgraph.

Proof. Take ℘ = “v is the centre of S^-_{k,h}”. By Proposition 3.2, ℘ is δ^+-common with d(℘)=f(k,h). Apply Theorem A to obtain an embedded B^+_{k,ℓ} whose leaves L (|L|=ℓ^k) each are centres of a copy S(w)≅S^-_{k,h}. We choose, greedily over w∈L, a substar S′(w)≅S^-_{k,ℓ} so that S′(w) is disjoint from B except at w, and so that all the S′(w) are pairwise disjoint. At the moment of choosing S′(w), the forbidden set has size at most |V(B)| + (number of previously chosen S′)·kℓ ≤ 2ℓ^k + (ℓ^k−1)kℓ < 2ℓ^k + kℓ^{k+1}. Since each vertex of S(w) lies on exactly one ray of S(w), a forbidden set of size F blocks at most F rays. Thus, with h ≥ (2ℓ^k + kℓ^{k+1}) + ℓ, there remain at least ℓ unblocked rays, enabling S′(w). ∎

Remark. The original choice h=3kℓ^{k+1} can be replaced by h=kℓ^{k+1}+2ℓ^k+ℓ. This materially improves the quantitative dependence on h in f(k,h).

2) Slight tightening for k=2 spiders

Theorem B (refines Theorem 4.1 slightly). For every ℓ≥1, if δ^+(G) > ((3+√(17−4/ℓ))/2)·ℓ, then G contains S^-_{2,ℓ}.

Proof. Repeat the proof of Theorem 4.1 verbatim, but note that for b∈B we have deg^−(b) ≤ 2ℓ−1 (strict inequality in the definition of B), so |V→S→{a}| ≤ (2ℓ−1)s rather than 2ℓs. This yields
 s ≥ d(d−2ℓ)/(d+2ℓ−1),
whence s>ℓ as soon as d satisfies
 d(d−2ℓ) > ℓ(d+2ℓ−1) ⇔ d > ((3+√(17−4/ℓ))/2)·ℓ.
For fixed ℓ this improves the constant slightly; asymptotically it matches (3+√17)/2. ∎

Examples and sanity checks

- For ℓ=2, Theorem A gives the same constant as the original (since 1+1/(ℓ−1)=2), so no loss occurs in the smallest nontrivial branching case.
- For ℓ=3, Theorem A replaces 2k·3^k by (3/2)k·3^k, a 25% improvement in the additive term beyond f(k,h).
- For large ℓ, Theorem A’s additive term is ≈ (1+1/(ℓ−1))kℓ^k = (1+o(1))kℓ^k, nearly halving the constant 2.
- In Corollary A, replacing h=3kℓ^{k+1} by h=kℓ^{k+1}+2ℓ^k+ℓ reduces h by a factor ≈3 for large ℓ (and thus reduces f(k,h) significantly when f is increasing in h).

Obstacles

- Further reducing the k-multiplicative loss in Theorem A requires a qualitatively new argument. The current lexicographic-layer method inherently sums a per-layer threshold T over up to k layers. Avoiding this additive accumulation would likely require a global matching/flow argument across all layers at once (e.g., Haxell-type demand matchings in suitable bipartite graphs) or a randomized nibble, but making such an approach robust to the anti-monotone “common property” constraint seems nontrivial.
- Large improvements to the k=2 spider constant (3.56…) appear to need a different counting scheme; the partition A∪B and 2-path double counting seems near its limit under this strategy.

Next steps

- Try to replace the layer-by-layer construction in Theorem A with a single multi-commodity flow on a directed auxiliary graph to get an O(ℓ^k) (not kℓ^k) additive term. A plausible route is to encode the demand “each internal vertex needs ℓ children” as capacities and use a max-flow/min-cut argument.
- Pursue k=3 of the Giant Spider: adapt the V→B→A path-counting to 3-step paths V→B→A→A (or similar) and optimize a τ-threshold partition to obtain δ^+ ≥ c·ℓ with a concrete c<9, aiming for c≈6.
- Explore whether “centre of S^-_{k,h} avoiding a fixed forbidden set F” is δ^+-common with a linear overhead in |F|. If so, the h in Corollary A might be further reduced to kℓ^{k+1} + O(ℓ^k) while keeping f(k,h+|F|) under control.
- Investigate additional grounded families beyond Theorem 2.1 by allowing the minimal subtree on U to have at most one “backward” edge per root-to-leaf path. A careful decomposition might combine Theorem A with a bounded number of extra local gadgets.



=== Papers (text) ===

=== Paper Description (papers/paper1.txt) ===
paper that we will try to improve upon.

=== Paper (papers/paper1.txt) ===
\section{Introduction}\label{sec:intro}

One of the main focuses in the study of finite\footnote{All digraphs considered in this paper will be finite. For better readability we will keep it implicit.} directed graphs has been the investigation of properties of digraphs and oriented graphs of large minimum out-degree. For instance, the famous Caccetta-H\"aggkvist conjecture~\cite{caccetta1978minimal} states that every digraph $G$ of order $n$ with minimum out-degree $\delta^+(G)\geq d$ has a directed cycle of length at most $\lceil n/d \rceil$. A conjecture of Thomass\'e  (see~\cite{bang2008digraphs, sullivan2006summary}) claims that any oriented graph $G$ with $\delta^+(G)\geq d$ contains a directed path of length $2d$, and recently Cheng and Keevash~\cite{cheng2024length}, proved a lower bound of $3d/2$. The Bermond-Thomassen conjecture~\cite{bermond1981cycles} states that every digraph $G$ with $\delta^+(G)\geq 2d-1$ contains $d$ disjoint directed cycles. Alon~\cite{alon1996disjoint} and, more recently, Buci\'c~\cite{bucic2018improved} proved it with $2d-1$ replaced by $64d$ and $18d$, respectively. 

As quantitative bounds in many of these problems are hard to obtain or sometimes even to guess, it is natural to ask for a property of digraphs if it holds in all digraphs of \emph{sufficiently large} minimum out-degree. For example, Stiebitz~\cite{stiebitz1996decomposing} and, independently, Alon~\cite{alon2006splitting} asked whether for every $a, b \geq 1$ there exists $F(a, b)$ such that $\delta^+(G)\geq F(a,b)$ implies that $V(G)$ can be partitioned
into two non-empty parts $A$ and $B$ with $\delta^+(G[A])\geq a$ and $\delta^+(G[B])\geq b$. In a recent breakthrough, Christoph, Petrova and Steiner~\cite{christoph2023note} reduced this question to that of existence of $F(2,2)$.  

Mader~\cite{mader1995exixtence} conjectured the existence of a function $f$ so that $\delta^+(G)\geq f(k)$ implies that $G$ contains a subdivision of the transitive tournament of order $k$, and proved it for $k \leq 4$~\cite{Mader1996}. This sparked an interest in finding subdivisions of fixed digraphs in digraphs of large out-degree. Aboulker, Cohen, Havet, Lochet, Moura and Thomass\'e~\cite{aboulker1610subdivisions} defined a digraph $H$ to be \emph {$\delta^+$-maderian} if, for some value $d$, every $G$ with $\delta^+(G)\geq d$ contains a subdivision of $H$. In this terminology, Mader's conjecture states that every acyclic digraph is $\delta^+$-maderian. In support of this, the authors of~\cite{aboulker1610subdivisions} proved among other results that every in-arborescence (i.e. a tree with all edges oriented towards a designated
root vertex) is $\delta^+$-maderian. They also conjectured that every orientation of a cycle is $\delta^+$-maderian, and this was recently confirmed by Gishboliner, Steiner and Szab\'o~\cite{gishboliner2022oriented}.

In this paper we are asking which digraphs $H$ must be contained in all digraphs of sufficiently large minimum out-degree \emph{as subgraphs}. To our surprise, we were not able to find any previous systematic study of the topic, despite the question being natural. Note that orientations of each graph with a cycle can be avoided by taking a $2d$-regular connected unoriented graph of large girth, and orienting its edges via an Euler circuit. Hence, we may assume that $H$ is an orientation of a tree (or a forest, which again reduces to trees). 

\begin{definition}
An oriented tree $T$ is $\delta^+$-enforcible if there exists $d=d(T)$ such that every digraph $G$ with $\delta^+(G)\geq d$ contains $T$ as a subgraph.     
\end{definition}

\noindent
A simple greedy embedding certifies that every out-arborescence is $\delta^+$-enforcible. Much less obviously, by the aforementioned result of Aboulker et al.~\cite{aboulker1610subdivisions} on in-arborescences, every subdivision of the in-star is $\delta^+$-enforcible. We remark that it is \emph{not} true that every in-arborescence is $\delta^+$-enforcible, as will follow from our Theorem~\ref{thm:level}. Another known family of $\delta^+$-enforcible trees are the antidirected trees (that is, trees containing no directed path of length $2$). By a theorem of Burr~\cite{Burr_1982}, $\delta^+(G)\geq 4k$ implies that $G$ contains every antidirected $k$-edge tree as a subgraph.  

For an oriented tree $T$, its \emph{height function} $h_T\colon V(T)\rightarrow \mathbb{Z}$ is a function satisfying $h_T(v)=h_T(u)+1$ for every edge $(u,v)\in E(T)$. It is clear that the height function is well-defined and unique up to an additive constant. Since we will only care about the relative values of $h_T$ between the vertices of $T$, we will, slightly abusing the notion, speak of ``the height function $h_T$.''

\begin{definition}\label{def:grounded}
An oriented tree $T$ is \emph{grounded} if $h_T(v)$ is constant for all vertices $v$ of in-degree at least $2$.
\end{definition}

\noindent
Note that all the above examples of $\delta^+$-enforcible trees are grounded. We show that they have to be, and conjecture that this is an `if and only if' relationship.

\begin{theorem}\label{thm:level}
Every $\delta^+$-enforcible tree is grounded.
\end{theorem}
\begin{conjecture}[KAMAK tree conjecture\footnote{Named after the KAMAK 2024 workshop where the present work was initiated.}]\label{conj:KAMAK-tree}
Every grounded tree is $\delta^+$-enforcible. Hence, an oriented tree is $\delta^+$-enforcible if and only if it is grounded.     
\end{conjecture}
\noindent
In support of Conjecture~\ref{conj:KAMAK-tree}, we prove it for a fairly general class of trees. 
\noindent

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.7]{fig_new_enforcible_trees.pdf}
  \caption{An example of a tree with the minimal subtree containing the set $U$ that is $\delta^+$-enforcible by Theorem~\ref{thm:groundedclass}.}
\end{figure}

\begin{theorem}\label{thm:groundedclass}
Suppose that $T$ is grounded and that the minimal subtree of $T$ containing the vertex set $U=\{v\in V(T): \deg^-(v)\geq 2\}$ is an out-arborescence. Then $T$ is $\delta^+$-enforcible.  
\end{theorem}

\begin{corollary}\label{cor:twosinks}
Every grounded tree with at most two vertices of in-degree at least $2$ is $\delta^+$-enforcible. 
\end{corollary}

\noindent
We remark that there has been a considerable body of past and recent work (\cite{jackson1981long, kathapurkar2022spanning, KLIMOSOVA2023113515, penev2025twoblockpathsorientedgraphs, skokan2024alternating}, see also~\cite{Stein_2024} for a survey) on finding oriented trees in digraphs and oriented graphs of large minimum \emph{semi-degree} $\delta^0(G)$, which is the minimum of all in- and out-degrees in $G$. The focus there is different, namely on explicit bounds on $\delta^0(G)$, as any fixed oriented tree can be greedily embedded into 
a digraph of sufficiently large minimum semi-degree. That being said, our last result deals with explicit bounds in the minimum out-degree setting. 

Let $\smkl$ be the $(k-1)$-subdivision of the in-star with $\ell$ leaves. An essential tool in our proof of Theorem~\ref{thm:groundedclass} is the existence of $\smkl$ in digraphs of large minimum out-degree $d$, established in~\cite{aboulker1610subdivisions}; an inspection of the proof shows that (in the proof) $d$ needs to be at least $\ell^{k!}$. In order to achieve better, perhaps even tight, quantitative bounds in Theorem~\ref{thm:groundedclass} and towards Conjecture~\ref{conj:KAMAK-tree}, it would be desirable to find tight out-degree bounds for the containment of $\smkl$. In this regard, we make the following conjecture.

\begin{conjecture}[Giant spider conjecture]
For every $k\geq 2$ and $\ell\geq 1$
\begin{enumerate}
    \item[(i)] any digraph $G$ with $\delta^+(G)\geq k\ell$ contains $\smkl$ as a subgraph.
    \item[(ii)] any oriented graph $G$ with $\delta^+(G)\geq k\ell/2$ contains $\smkl$ as a subgraph. 
\end{enumerate}
\end{conjecture} 

\noindent
These bounds would be tight, by the examples of the complete digraph and a regular tournament of order $k\ell$, respectively. 
Note that for $\ell=1$, when $\smkl$ is the path of length $k$, the first statement is the obvious greedy algorithm bound, while the second is Thomass\'e's conjecture~\cite{bang2008digraphs, sullivan2006summary}, mentioned earlier. Addressing the other `extreme' case $k=2$, we prove a linear bound.
\begin{theorem}\label{thm:linear_spiders}
For every $\ell\geq 1$, any digraph $G$ with $\delta^+(G)> \left(\frac{3+\sqrt{17}}{2}\right)\ell\approx 3.56\ell$ contains $S^-_{2,\ell}$ as a subgraph.
\end{theorem}

\noindent
The rest of the paper is structured as follows. In Section~\ref{sec:leveldconstr} we provide a construction proving Theorem~\ref{thm:level}. Section~\ref{sec:mainproof} contains the proof of our main result, Theorem~\ref{thm:groundedclass}. Finally, in Section~\ref{sec:spiders} we prove Theorem~\ref{thm:linear_spiders}. 

\noindent
\paragraph*{Notation.} Most of our notation is standard. $G=(V,E)$ denotes a \emph{digraph} (directed graph) with the vertex set $V$ and edge set $E\subseteq\{(u,v)\in V\times V: u\neq v\}$. That is, we do not allow loops and multiple copies of the same edge, but we do allow two edges in opposite directions between a pair of vertices. $G$ is an \emph{oriented graph} if between any two vertices there is at most one edge. 

An edge $(u,v)$ is considered oriented from $u$ to $v$. The \emph{in- and out-neighbourhoods} of a vertex $v\in V$ are defined as $N^-(v)=\{u\in V: (u,v)\in E\}$ and $N^+(v)=\{u\in V: (v,u)\in E\}$, respectively. The \emph{in- and out-degrees} of $v$ are $\deg^-(v)=\card{N^-(v)}$ and $\deg^+(v)=\card{N^+(v)}$, respectively. The \emph{minimum out-degree} in $G$ is $\delta^+(G)=\min\{\deg^+(v): v\in V\}$.
For a vertex set $W\subseteq V$ we use $G[W]$ to denote the subgraph of $G$ induced on $W$. Furthermore, for a vertex $v\in V$ we denote $N^-_W(v)=N^-(v)\cap W$, $\deg^-_W(v)=\card{N^-_W(v)}$, and similarly for $N^+_W(v)$ and $\deg^+_W(v)$. 

A \emph{directed path} is an orientation of an undirected path which can be traversed from one end to the other following the orientations of the edges. A \emph{subdivision} of a digraph $G$ introduces some new vertices on the edges of $G$ and replaces the edges with directed paths, inheriting the directions. A $k$-subdivision is the subdivision with $k$ new vertices for each edge. An \emph{oriented tree} is an orientation of an undirected tree. An \emph{in-arborescence}/\emph{out-arborescence} is an oriented tree in which all edges are oriented towards/away from a designated root vertex. By $B^+_{k,\ell}$ we denote the $\ell$-branching out-arborescence of depth $k$, i.e. the complete $\ell$-ary tree of depth (distance from the root to the leaves) $k$ oriented away from the root.
An \emph{in-star}/\emph{out-star} is the orientation of an undirected star towards/away from its centre. We denote by $\smkl$ the $(k-1)$-subdivision of the in-star with $\ell$ leaves, and the directed paths from the leaves of $\smkl$ to its centre are referred to as the \emph{rays}.\section{The level digraph construction}\label{sec:leveldconstr}

In this section we prove that every $\delta^+$-enforcible tree must be grounded. 

\begin{definition}
    A \emph{level digraph} $G_{k,d} = (V,E)$ is the digraph with the vertex set
\[
V = \{ v_{i,j} : 0 \le i \le k, \ 1 \le j \le d^{i+1} \},
\]
and the edge set
\[
E = \biggl( \bigcup_{i=0}^{k-1} E_{i,i+1} \biggr) \cup E_{k,0},
\]
where, for \(0 \le i < k\), 
\[
E_{i,i+1} = \Bigl\{ ( v_{i,j}, v_{i+1,(j-1)d + \ell}) : 1 \le j \le d^{i+1},\; 1 \le \ell \le d \Bigr\},
\]
and
\[
E_{k,0} = \Bigl\{ (v_{k,j},\, v_{0,\ell}) : 1 \le j \le d^{k+1},\; 1 \le \ell \le d \Bigr\}.
\]

\end{definition}

In other words, to construct $G_{k,d}$ we take $d$ disjoint copies of $B^+_{k,d}$ and add the edges from every leaf to every root.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.8]{fig_level_graph.pdf}
  \caption{The level digraph \(G_{3,2}\).} 
\end{figure}

\begin{observation}\label{obs:level_graph}
    In $G_{k,d} = (V,E)$ for all $v \in V$ we have: 
    \begin{itemize}
        \item $ \deg^+(v) = d$. 
        \item \begin{flushleft}
        $\displaystyle
        \deg^-(v)=
        \begin{cases}
          d^{k+1}, & \text{if } v = v_{0,j} \text{ for  some } 1 \le j \le d, \\
          1, & \text{otherwise}.
        \end{cases}$
        \end{flushleft}
     \end{itemize}
\end{observation}

\begin{proof}[Proof of Theorem~\ref{thm:level}]    
       
    Let $T$ be a $\delta^+$-enforcible tree. We aim to show that $T$ is grounded, i.e., the height function $h_T$ is constant on $U = \{v \in V(T) : \deg^-(v)\ge 2\}$. Let us assume that $U\neq \emptyset$, else $T$ is trivially grounded.
    Since $T$ is $\delta^+$-enforcible, there exists $d = d(T)$ such that every digraph $G$ with $\delta^+(G) \ge d$ contains $T$ as a subgraph. In particular, $G=G_{2t, d}=(V,E)$, where $t = \card{V(T)}$, contains $T$ as a subgraph, and let $\phi: T\rightarrow G$ be a witnessing embedding. For each $0 \le i \le 2t $, set $L_i = \{v_{i,j}  \in V\, \colon \, 1 \le j \le d^{i+1}\}$.  
    
    By Observation~\ref{obs:level_graph}, a vertex of $G$ has in-degree more than $1$ if and only if it belongs to $L_0$. Therefore $\phi(U)\subseteq L_0$, and in particular, $\phi(T)\cap L_0\neq \emptyset$. This implies $\phi(T)\cap L_t=\emptyset$, as $t=\card{V(T)}$ and the edges in $G$ are between $L_i$ and $L_{i+1}$ modulo $2t+1$.  So $\phi$ embeds $T$ in $G[V\setminus L_{t}]$. Note now that $G[V\setminus L_{t}]$ has a well-defined height function $\psi(v_{i,j})=i$ (equivalently, $G[V\setminus L_{t}]$ is homomorphic to a directed path), so $\psi \circ \phi$ is a height function of $T$ which is constant on $U$. Hence, $T$ is grounded.
\end{proof}\section{\texorpdfstring{A new family of $\delta^+$-enforcible trees}{A new family of δ+-enforcible trees}}\label{sec:mainproof}

In this section we prove Theorem~\ref{thm:groundedclass}.
Let $T$ be a tree satisfying the assumptions of Theorem~\ref{thm:groundedclass}, and let $T^*$ be its subtree obtained by iteratively removing leaves of in-degree $1$ until none remain. Note that every vertex of $T^*$ has the same in-degree in $T^*$ as in $T$, in particular, $U(T^*) = U(T)$. Hence, $T^*$ satisfies the assumptions of Theorem~\ref{thm:groundedclass}. On the other hand, if $T^*$ is $\delta^+$-enforcible then so is $T$, by a greedy embedding. Thus it suffices to prove that $T^*$ is $\delta^+$-enforcible. Furthermore, if $\card{U(T)}=\card{U(T^*)} = 0$, then $T^*$ is a single vertex, which is trivially $\delta^+$-enforcible, and if $\card{U(T)}=\card{U(T^*)} = 1$, then $T^*$ is a subdivision of an in-star, which is also $\delta^+$-enforcible, as was shown in~\cite{aboulker1610subdivisions} (see Proposition~\ref{prop:abetal} below). Hence, relabelling, we may assume that $T$ does not have any leaf of in-degree $1$ and that $U = U(T)$ is of size at least $2$. 

Let $T'$ be the minimal subtree of $T$ containing $U$. By our assumption, $T'$ is an out-arborescence, and let $r$ be its root vertex. Since $|U|\geq 2$ and $T$ is grounded we have $r\notin U$. Moreover, since $T$ is grounded and $h_T$ must extend $h_{T'}$, the latter must be constant on the vertices of $U$. By the minimality of $T'$, $U$ must be the set of leaves of $T'$. 

Recall that $S^-_{k,\ell}$ is the $(k-1)$-subdivision of the in-star with $\ell$ leaves and $B^+_{k,\ell}$ is the $\ell$-branching out-arborescence of depth $k$.
Let $T(k,\ell)$ denote the oriented tree created from $B^+_{k,\ell}$ by identifying each leaf with the centre of a new copy of $S^-_{k,\ell}$.

\begin{lemma}\label{lem:inarb}
$T$ is a subgraph of $T(k,\ell)$ for some sufficiently large $k$ and $\ell$. 
\end{lemma}
\begin{proof}
By definition of $T'$, every vertex $v \in V(T) \setminus V(T')$ has $\deg^-(v) \leq 1$.
Moreover, it has $\deg^+(v) \leq 1$, as otherwise $T$ would contain a leaf of in-degree $1$.
Therefore, $T \setminus T'$ is a collection of vertex disjoint paths $\mathcal{F}$, each of which is directed towards $T'$.
Since each $v'\in V(T')\setminus\{r\}$ has an in-neighbour in $T'$, the paths in $\mathcal{F}$ can only connect to $T'$ via $r$ or a vertex of $U$.
Moreover, the former holds for at most one path $P_r\in \mathcal{F}$.

It follows that the subtree of $T$ induced by $V(T') \cup V(P_r)$ (with $P_r$ possibly empty) is an out-arborescence and can be embedded in $B^+_{k,\ell}$ for some sufficiently large $k$ and $\ell$ such that $U$, the set of leaves of $T'$, maps to the leaves of $B^+_{k,\ell}$.
The remaining paths in $\mathcal{F}$ can be naturally grouped into disjoint in-stars, centred in the vertices of $U$. Increasing the values $k,\ell$ if necessary, we obtain that $T$ is a subgraph of $T(k,\ell)$.
\end{proof}
\noindent
Consequently, in order to prove Theorem~\ref{thm:groundedclass}, it is enough to consider the trees $T = T(k,\ell)$. We now recall the following result from~\cite{aboulker1610subdivisions}, which will play a crucial rule in our proof.  

\begin{proposition}[\cite{aboulker1610subdivisions}]\label{prop:abetal}
There exists a function $f(k,\ell)$ such that every digraph $G$ with $\delta^+(G)\geq f(k,\ell)$ contains $S^-_{k,\ell}$ as a subgraph.     
\end{proposition}

\noindent
Note that the graph $T(k,1)$ is isomorphic to $S^-_{k,2}$, which is known to be $\delta^+$-enforcible by Proposition~\ref{prop:abetal}.
Therefore, we may assume that $\ell \geq 2$.
We shall prove the following quantitative form of Theorem~\ref{thm:groundedclass}.\footnote{For clarity of presentation, we do not attempt to optimise the bounds.}

\begin{theorem}\label{thm:supergraph_of_normalized}
    Let $k \geq 1, \ell \geq 2$. Any digraph $G$ with $\delta^+(G) \geq f(k,3k\ell^{k+1})+2k\ell^k$ contains $T(k,\ell)$ as a subgraph.
\end{theorem}
\noindent
In fact, we shall prove a more general theorem stating that if $\delta^+(G)$ is sufficiently large, then $G$ contains a copy of $B^+_{k,\ell}$ whose leaves satisfy any \emph{$\delta^+$-common} vertex property. 

\begin{definition}\label{def:common_property}
    Let $\Pro$ be a vertex property in digraphs.
    We say that $\Pro$ is \emph{$\delta^+$-common} if
    \begin{enumerate}[label=(\roman*)]
        \item there is $d = d(\Pro)$ such that every digraph $G$ with $\delta^+(G) \geq d$ contains a vertex satisfying $\Pro$,
        \item $\Pro$ is anti-monotone.
        That is, if $H$ is a subgraph of $G$ and a vertex $v \in V(H)$ satisfies $\Pro$ in $H$, then $v$ satisfies $\Pro$ in $G$.
    \end{enumerate}     
\end{definition}
\noindent
A trivial example of a $\delta^+$-common property is ``$v$ is a vertex.''
A far less trivial (and important for us) $\delta^+$-common property is ``$v$ is the centre of a copy of $S^-_{k,\ell}$.''

\begin{theorem}\label{thm:outstar_with_leaves_property}
    Let $\Pro$ be a $\delta^+$-common property, $k \geq 1, \ell \geq 2$, and let $G$ be a digraph with $\delta^+(G) \geq d(\Pro)+2k\ell^k$. Then $G$ contains a copy $B$ of $B^+_{k,\ell}$ such that all leaves of $B$ satisfy $\Pro$ in $G$.
\end{theorem}
\noindent
Theorem~\ref{thm:supergraph_of_normalized} is a direct corollary of Theorem~\ref{thm:outstar_with_leaves_property}. 
\begin{proof}[Proof of Theorem~\ref{thm:supergraph_of_normalized}]
    Let $h=3k\ell^{k+1}$ and $\Pro$ be the property ``$v$ is the centre of a copy of $S^-_{k,h}$.'' By Proposition~\ref{prop:abetal}, $\Pro$ is $\delta^+$-common with $d(\Pro)=f(k,h)$. 
    Hence, $\delta^+(G) \geq d(\Pro)+2k\ell^k$ and we can apply Theorem~\ref{thm:outstar_with_leaves_property} to find in $G$ a copy $B$ of $B^+_{k,\ell}$, with the set of leaves $L$ of size $\ell^k$, such that each $w\in L$ satisfies $\Pro$ in $G$.
    
    So, each $w\in L$ is the centre of $S(w)$, a copy of $S^-_{k,h}$ in $G$.
    Now, take greedily from each $S(w)$ a subgraph $S'(w)$, a copy of $S^-_{k,\ell}$, such that all $S'(w)$ are disjoint from each other, and each $S'(w)$ is disjoint from $B$ save for $w$ --- together, $B$ and $\{S'(w):w\in L\}$ form a copy of $T(k,\ell)$ in $G$.
    This is possible since, when choosing $S'(w)$, the union of $B$ and all previously chosen $S'(w')$ contains at most 
    \[
        \card{V(B)} + \card{L} k\ell\leq 2\ell^k+k\ell^{k+1}
    \]
    vertices.
    Since each of them, except $w$, belongs to at most one ray of $S(w)$, there remain at least 
    \[
        h - 2\ell^k - k \ell^{k+1} \geq \ell
    \]
    rays of $S(w)$ that may be used to form $S'(w)$. 
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:outstar_with_leaves_property}]
    Let $G=(V,E)$. We will inductively define vertex sets $\Gamma(0), \dots, 
    \Gamma(k)\subseteq V$ that will guide our construction of the subgraph $B$.
    To do so, we define
    \begin{align*}
        \Gamma(0) &= \{ v \in V : \text{$v$ satisfies $\Pro$} \}, \\
        \Gamma(i) &= \{ v \in V : \deg^+_{\Gamma(i-1)}(v) \geq 2\ell^k \}\text{ for $1\leq i \leq k$.}
    \end{align*}
    \noindent
    The significance of the sets $\Gamma(i)$ is given by the following claim.
    
    \begin{claim}\label{claim:Gamma(k)_nonempty_implies_win}
    $\Gamma(k)\neq \emptyset$.
    \end{claim}
    Assuming Claim~\ref{claim:Gamma(k)_nonempty_implies_win}, we conclude the proof of Theorem~\ref{thm:outstar_with_leaves_property} as follows. Take some vertex $v\in \Gamma(k)$.
    We construct $B$ greedily from $v$ as the root.       
    For $i=0,\dots,k$ we will inductively construct $B_i$, a copy of $B^+_{i,\ell}$ in $G$, such that the leaves of $B_{i}$ (resp.~the single vertex of $B_0$) belong to $\Gamma(k-i)$.
    In particular, the leaves of $B_k$, a copy of $B^+_{k,\ell}$ in $G$, will satisfy $\Pro$ as they will belong to $\Gamma(0)$, so we can take $B=B_k$.
    
    To construct the trees $B_i$, set $B_0 = \{v\}$ and define $B_1$ to be an out-star with $v$ as the centre and $\ell$ of its out-neighbours in $\Gamma(k-1)$, which exist since $\deg^+_{\Gamma(k-1)}(v) \geq 2\ell^k > \ell$, as leaves.
    Now suppose we have constructed the tree $B_i$ for some $1\leq i \leq k-1$, and let  $L \subseteq \Gamma(k-i)$ be the set of its leaves.
    We have 
    \[
        \card{V(B_i)} = \sum_{j=0}^{i} \ell^j\leq 2\ell^{k-1},
    \]
    while $\deg^+_{\Gamma(k-i-1)}(w) \geq 2\ell^k$ for each $w\in L$. Hence, every $w\in L$ has at least $\ell^k$ neighbours in  $\Gamma(k-i-1)\setminus V(B_i)$. Since $\card{L} \leq \ell^{k-1}$, we can greedily choose for each $w\in L$ a set of $\ell$ out-neighbours in $\Gamma(k-i-1)\setminus V(B_i)$, such that the resulting sets are pairwise disjoint. These sets together with $B_i$ form a copy of $B_{i+1,\ell}^+$ in $G$, whose leaves belong to $\Gamma(k-i-1)$. We take this tree to be $B_{i+1}$.
\end{proof}
  
It remains to prove Claim~\ref{claim:Gamma(k)_nonempty_implies_win}. To this end, we partition the vertices of $G$ according to their presence in the sets $\Gamma(i)$.
That is, for a vertex $v\in V$ and an integer $0\leq i\leq k$, let $z_i(v)=1$ if $v\in \Gamma(i)$, and $z_i(v)=0$ otherwise, and let  $z(v) =(z_0(v),\dots,z_k(v))$. Conversely, for a vector $z =(z_0,\dots,z_k)\in \{0,1\}^{k+1}$ we set
\[
    V_z = \{ v \in V : z=z(v) \}
    .
\]
In this notation, Claim~\ref{claim:Gamma(k)_nonempty_implies_win} states that $V_z\neq \emptyset$ for some $z=(z_0,\dots,z_k)$ with $z_k = 1$.

Denote by $\prec$ the lexicographic ordering on $\{0,1\}^{\{0,\dots,k\}}$.
That is, for two vectors $z=(z_0\dots,z_k)$ and $z'=(z'_0,\dots,z'_k)$, we write $z \prec z'$ if there is an index $0\leq i \leq k$ such that $z_i = 0, z'_i = 1$ and $z_j = z'_j$ for all $j > i$.
We highlight the following property of the ordering.
\begin{observation}\label{obs:lex_order_property}
    If $z' \succ z$ and $z'_k = 0$, then there is an index $ i \leq k-1$ such that $z'_i = 1$ and $z_{i+1} = 0$.
\end{observation}
\noindent
We denote by $\vec{0}$ the all-zero vector $\vec{0} \in \{0,1\}^{k+1}$, and put $X=V_{\vec{0}}=V\setminus\bigcup_{i=0}^k\Gamma(i)$.

\begin{proof}[Proof of Claim~\ref{claim:Gamma(k)_nonempty_implies_win}]
    Suppose for a contradiction that $\Gamma_k=\emptyset$, or equivalently, 
    $V_{z'}=\emptyset$ for all $z'=(z'_0,\dots,z'_{k-1},1)$. Let $z =(z_0,\dots,z_k)$ be the $\prec$-smallest vector such that $V_z \not= \emptyset$; by the above assumption we have $z_k=0$. Let 
    \[
        I=\Big\{i \in \{0,\dots, k-1\}: z_{i+1}=0\Big\} \ \ \text{and} \ \
        W=\bigcup_{i\in I}\Gamma(i).
    \]
    We claim that
    \begin{align*}
        V =
        \begin{cases}
            W        &\text{ if } z \not= \vec{0},\\
            W \cup X &\text{ if } z = \vec{0}.
        \end{cases}
    \end{align*}
    Indeed, $\{V_{z'}:z'\in \{0,1\}^{k+1}\}$ is a partition of $V$, and for a vector $z'=(z'_0,\dots,z'_k)$, we have the following options:
    \begin{enumerate}[label=(\roman*)]
        \item if $z'_k = 1$, then $V_{z'} = \emptyset$ by assumption,
        \item if $z' \prec z$, we have $V_{z'} = \emptyset$ by the minimality of $z$,
        \item if $z' \succ z$ and $z'_k = 0$, then, by Observation~\ref{obs:lex_order_property}, for some $0\leq i \leq k-1$ we have $z'_i = 1$ and $z_{i+1} = 0$ . Therefore, $i\in I$ and $V_{z'} \subseteq \Gamma(i)\subseteq W$,
        \item lastly, if $z' = z \not= \vec{0}$, then, as $z_k=0$, for some $0\leq i \leq k-1$ we have $z_i = 1$ and $z_{i+1} = 0$. Therefore, $i\in I$ and $V_{z'} \subseteq \Gamma(i)\subseteq W$.
    \end{enumerate}
\noindent
    Let now $v\in V_z$ be an arbitrary vertex (recall that $V_z\neq \emptyset$ by definition of the vector $z$).
    For each $i\in I$ we have $v\notin \Gamma(i+1)$, as $z_{i+1}=0$. Hence,
    $\deg^+_{\Gamma(i)}(v)<2\ell^k$. Taking the sum over all $i\in I$ gives 
    \[
        \deg^+_W(v) < 2k\ell^k.
    \]
    So, if $z \not= \vec{0}$, then due to $V=W$, we get 
    \[
        2k\ell^k > \deg^+_W(v) = \deg^+(v) \geq \delta^+(G) \geq 2k\ell^k,
    \]
    a contradiction. 
    
    \noindent
    While if $z = \vec{0}$, we obtain 
    \[
        d_X^+(v) \geq \delta^+(G) - \deg^+_W(v) \geq \delta^+(G) - 2k\ell^k \geq d(\Pro).
    \]
    Since in this case $v$ was an arbitrary vertex of $V_z=V_{\vec{0}}=X$, it follows that the induced subgraph $G[X]$ satisfies $\delta^+(G[X]) \geq d(\Pro)$. Thus, there is a vertex $x \in X$ that satisfies the property $\Pro$ in $G[X]$.
    However, by the antimonotonicity of $\Pro$, $x$ must also satisfy $\Pro$ in $G$, meaning $x\in \Gamma(0)$. This is a contradiction with the fact that
    \[
        x \in X =V_{\vec{0}}\subseteq V\setminus \Gamma(0).
    \]
    Hence, our initial assumption that $\Gamma(k)=0$ was contradictory, and we must have $\Gamma(k)\neq 0$. 
\end{proof}\section{Giant spiders exist}\label{sec:spiders}

In this section we prove Theorem~\ref{thm:linear_spiders}, which gives a linear bound on the minimum out-degree that guarantees a copy of $\smtwol$.

\begin{proof}[Proof of Theorem~\ref{thm:linear_spiders}]
    Let $\ell\geq 1$ be fixed and $G = (V, E)$ be a digraph with $\delta^+(G) \geq d$, where $d> \left(\frac{3+\sqrt{17}}{2} \right)\ell$. By removing edges if necessary, we may assume that $\deg^+(v) = d$ for every vertex $v \in V$. We remark that this seemingly insignificant assumption is crucial for our argument. Our goal is to find a copy of $\smtwol$ in $G$. To this end, we partition $V$ into subsets $A$ and $B$, where 
    $$A = \{v \in V : \deg^-(v) \geq 2\ell\} \ \ \text{ and} \ \ B =\{v \in V : \deg^-(v) < 2\ell\},$$
    and note that $A\neq \emptyset$, since the average in-degree in $G$ is $d>2\ell$.

    If there exists a vertex $r \in A$ such that $\deg^-_A(r) \geq 2\ell$, we exhibit a copy of $\smtwol$ in $G$ by choosing greedily distinct vertices $a_1, x_1, a_2,x_2,\dots, a_\ell, x_\ell \in V$, such that $a_i\in N^-_A(r)$ and $x_i\in N^-_V(a_i)$.
    We will not run out of vertices: having chosen $a_1, x_1, \dots, a_i,x_i$ for some $0 \leq i < \ell$, $a_{i+1} \in A$ can be picked distinctly  because $r$ has at least $2\ell$ in-neighbours in $A$ and at most $2i<2\ell$ of them have already been chosen.
    Similarly, $x_{i+1}$ can be picked distinctly since $a_{i+1} \in A$ has at least $2\ell$ in-neighbours and at most $2i+1<2\ell$ of them have already been chosen. 

    Thus, for the rest of the proof we may assume that $\deg^-_A(v) \leq 2\ell-1$ for every $v \in A$. For three sets $X,Y,Z \subseteq V$, not necessarily distinct, we denote by $X \rightarrow Y \rightarrow Z$ the set of all $2$-edge directed paths, with the vertex set $\{x,y,z\}$ for some $x \in X$, $y\in Y$, and $z \in Z$ and the edges $\{(x,y),(y,z)\}$.

    \begin{figure}[htbp]
        \centering
        \includegraphics[scale=0.7]{fig_VBA_paths.pdf}
        \caption{An example of two paths in $V \rightarrow B \rightarrow A$, one starting in $B$ and the other in $A$.}
    \end{figure}
    
    Observe that
    \begin{align*}
        \card{V \rightarrow B \rightarrow A} &=  \card{V \rightarrow B \rightarrow V} - \card{V \rightarrow B \rightarrow B}\\
        &= \card{A \rightarrow B \rightarrow V} + \card{B \rightarrow B \rightarrow V} - \card{V \rightarrow B \rightarrow B}\\
        &= \card{A \rightarrow V \rightarrow V} - \card{A \rightarrow A \rightarrow V} + \card{B \rightarrow B \rightarrow V} - \card{V \rightarrow B \rightarrow B}, 
    \end{align*}
    and let us estimate the terms in the last expression.
    Because $\deg^+(v)=d$ for all $v$, $\deg^-_A(v) \leq 2\ell-1$ for every $v \in A$, and $\deg^-(v) \leq 2\ell-1$ for every $v \in B$, we obtain:
    \begin{align*}
        \card{A \rightarrow V \rightarrow V} &\geq \card{A} d(d-1), \\
        \card{A \rightarrow A \rightarrow V} &\leq e(G[A]) d \leq (2\ell-1) d\card{A}, \\
        \card{B \rightarrow B \rightarrow V} &\geq e(G[B])(d-1), \\
        \card{V \rightarrow B \rightarrow B} &\leq e(G[B])(2\ell-1).
    \end{align*}
    Hence
    \begin{align*}
        \card{V \rightarrow B \rightarrow A} &\geq d(d-1)\card{A} - (2\ell-1) d\card{A} + e(G[B])(d-1) - e(G[B])(2\ell-1) \\
            &\geq d(d - 2\ell )\card{A} + e(G[B])(d - 2\ell)\\
            &\geq d(d - 2\ell)\card{A}.
    \end{align*} 
    By the pigeonhole principle, there exists a vertex $a \in A$ such that 
    \[
        \card{V \rightarrow B \rightarrow \{a\}} \geq d(d-2\ell).
    \]

    Let $s$ be maximal such that there exists $S=\{b_1,\dots,b_s\}\subseteq N_B^-(a)$ and $Q=\{q_1,\dots,q_s\}\subseteq V\setminus (S\cup \{a\})$ with $(q_i,b_i)\in E$ for all $1\leq i\leq s$. Note that this gives a copy of $S^-_{2,s}$ in $G$. Since the in-degrees in $B$ are at most $2\ell$, we have 
    \[
        \card{V \rightarrow S \rightarrow \{a\}} \leq 2 \ell s,
    \]
    and consequently
    \[
        \card{V \rightarrow B\setminus S \rightarrow \{a\}} \geq  d(d-2\ell) - 2\ell s.
    \]
    By maximality of $s$, all these paths have their first vertex in $Q$.
    Hence, for some $1\leq i\leq s$ we have
    \[
        d=\deg^+(q_i)\geq \card{\{q_i\}\rightarrow B\setminus S \rightarrow \{a\}} \geq \frac{d(d-2\ell) - 2\ell s}{s},
    \]
    resulting in 
    \[
        s\geq \frac{d(d-2\ell)}{d+2\ell}.
    \]
    The last expression is greater than $\ell$ for $d>\left(\frac{3+\sqrt{17}}{2}\right)\ell$, since $\frac{3+\sqrt{17}}{2}$ is the positive root of the underlying quadratic equation. Thus, $G$ contains a copy of $\smtwol$.
\end{proof}
