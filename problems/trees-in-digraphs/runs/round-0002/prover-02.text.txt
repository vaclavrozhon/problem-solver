# Ideas

We give three quantitative refinements that are auditable and plug directly into the paper’s framework.
- Variable-threshold version of Theorem 3.4 with a sharp constant S_{k,ℓ} = (ℓ^2/(ℓ−1)^2+o_ℓ(1))·ℓ^k (independent of k up to the ℓ-dependent constant). This replaces the paper’s additive 2kℓ^k.
- A tighter “ray packing” bound for attaching in-spiders at the leaves: h ≥ kℓ^{k+1} + (ℓ^{k+1}−1)/(ℓ−1) + ℓ (replacing 3kℓ^{k+1} or kℓ^{k+1}+2ℓ^k+ℓ).
- For k=2, a matching-based refinement: s ≥ (d−1)(d−2ℓ+1)/(d+2ℓ−2), implying δ^+ > (3ℓ + √(17ℓ^2−16ℓ+4))/2 suffices for S^-_{2,ℓ}. This is a rigorous improvement over Theorem 4.3’s constant and fixes the “maximality” step via a clean matching lemma.

# 1) Out-arborescence with δ+-common leaves: variable thresholds and sharp S_{k,ℓ}

Let P be a δ^+-common property with threshold d(P). For k≥1, ℓ≥2, define Γ(0)= {v: v satisfies P} and for 1≤i≤k,
Γ(i) = { v ∈ V(G): deg^+_{Γ(i−1)}(v) ≥ t_i }.
We choose thresholds
- Base: t_k := ℓ.
- For 1≤i≤k−1 (i measures “depth already built”):
  t_{k−i} := ℓ^{i+1} + ⌈(ℓ^{i+1}−1)/(ℓ−1)⌉.

Rationale. At depth i (0≤i≤k−1), we have |V(B_i)| = 1+ℓ+…+ℓ^i = (ℓ^{i+1}−1)/(ℓ−1) vertices already used. To extend, each of the ℓ^i current leaves must receive ℓ fresh, pairwise-disjoint children in Γ(k−i−1). Requiring, for every current leaf w, at least ℓ^{i+1} candidates after subtracting |V(B_i)| guarantees (by the simple one-by-one greedy across the ℓ^i leaves) disjoint ℓ-sets at this depth. This yields the stated t_{k−i}.

Lemma 1 (Level-set contradiction with variable thresholds).
If δ^+(G) ≥ d(P) + ∑_{i=1}^k t_i, then Γ(k)≠∅.

Proof sketch. Exactly as in the lexicographic partition proof in Theorem 3.4: for z the minimal nonempty class and W=⋃_{i: z_{i+1}=0} Γ(i), every v∈V_z satisfies deg^+_W(v) < ∑_{i: z_{i+1}=0} t_{i+1}. If z≠⃗0 this contradicts δ^+(G). If z=⃗0, then δ^+(G[X]) ≥ d(P) on X=V_{⃗0}, hence some x∈X satisfies P (by anti-monotonicity), contradicting x∈X.

Lemma 2 (Greedy construction with the new thresholds).
From any v∈Γ(k) we construct B_0={v}, and inductively B_{i+1} by assigning ℓ disjoint children in Γ(k−i−1) to each leaf of B_i, avoiding V(B_i). This is feasible because for i≥1 we ensured t_{k−i}−|V(B_i)| ≥ ℓ^{i+1}, and for i=0 the base threshold t_k=ℓ suffices.

Theorem A (Refined Theorem 3.4).
If δ^+(G) ≥ d(P) + T_{k,ℓ}, where
T_{k,ℓ} := t_k + ∑_{i=1}^{k−1} t_{k−i} = ℓ + ∑_{i=1}^{k−1} [ℓ^{i+1} + ⌈(ℓ^{i+1}−1)/(ℓ−1)⌉],
then G contains a copy of B^+_{k,ℓ} whose leaves all satisfy P.

Sharp bound on T_{k,ℓ}.
Compute S_1=∑_{i=1}^{k−1} ℓ^{i+1}=(ℓ^{k+1}−ℓ^2)/(ℓ−1), and S_2=∑_{i=1}^{k−1} ⌈(ℓ^{i+1}−1)/(ℓ−1)⌉ ≤ (ℓ^{k+1}−ℓ^2)/(ℓ−1)^2 + O(k). Hence
T_{k,ℓ} ≤ ℓ + (ℓ^{k+1}−ℓ^2)/(ℓ−1) + (ℓ^{k+1}−ℓ^2)/(ℓ−1)^2 + O(k)
= (ℓ^2/(ℓ−1)^2)·ℓ^k + O(ℓ^k) + O(k).
In particular, T_{k,2} = 4·2^k − k − 5 (exact), and for ℓ≥3, T_{k,ℓ} ≤ (ℓ^2/(ℓ−1)^2 + o(1))·ℓ^k.

Example (ℓ=2, k=3): t_3=2, t_2=4+3=7, t_1=8+7=15. Sum T_{3,2}=24, versus the paper’s 2kℓ^k=48.

# 2) Improved ray packing for T(k,ℓ)

Let B be a copy of B^+_{k,ℓ} with leaf set L (|L|=ℓ^k). For each w∈L, let S(w)≅S^-_{k,h} be a subgraph with centre w. To extract disjoint S′(w)≅S^-_{k,ℓ} attached at each w, it suffices that, for every w,
#usable rays in S(w) ≥ ℓ.
Each previously used vertex blocks at most one ray in S(w). At the moment of choosing S′(w):
- B contributes at most |V(B)|−1 blocked rays, where |V(B)|=(ℓ^{k+1}−1)/(ℓ−1).
- The union of already chosen S′(w′), w′≠w, contributes at most kℓ·(|processed leaves|) ≤ kℓ(ℓ^k−1) blocked rays.
Hence ≤ kℓ^{k+1} + (ℓ^{k+1}−1)/(ℓ−1) − (kℓ+1) rays are blocked in total, and it suffices to require
h ≥ kℓ^{k+1} + (ℓ^{k+1}−1)/(ℓ−1) + ℓ.
This improves both 3kℓ^{k+1} and kℓ^{k+1}+2ℓ^k+ℓ (since (ℓ^{k+1}−1)/(ℓ−1) ≤ (ℓ/(ℓ−1))ℓ^k ≤ 1.5ℓ^k for ℓ≥3, and equals 2ℓ^k−1 for ℓ=2).

Corollary B (Refined Theorem 3.6).
Let h := kℓ^{k+1} + (ℓ^{k+1}−1)/(ℓ−1) + ℓ. If δ^+(G) ≥ f(k,h) + T_{k,ℓ} (with T_{k,ℓ} from Theorem A and P= “centre of S^-_{k,h}”), then G contains T(k,ℓ).

# 3) k=2 spiders via matching: a rigorous linear bound

We refine Theorem 4.3 using a maximum matching in the predecessor bipartite graph and exact “distinct-vertex” counting of 2-edge paths.

Setup. Let G=(V,E) be a digraph with deg^+(v)≡ d, and let A={v: deg^-(v)≥2ℓ}, B=V\A. As in the paper, if ∃ r∈A with deg^-_A(r)≥2ℓ, we greedily embed S^-_{2,ℓ}. Otherwise, deg^-_A(·)≤2ℓ−1 on A.

Counting 2-edge directed paths with distinct vertices:
|A→V→V| ≥ |A|·d(d−1) (from each a∈A pick x∈N^+(a), then y∈N^+(x)\{a}).
|A→A→V| ≤ e(G[A])·(d−1) ≤ (2ℓ−1)|A|(d−1).
|B→B→V| ≥ e(G[B])(d−1), and |V→B→B| ≤ e(G[B])(2ℓ−1).
Therefore
|V→B→A| ≥ |A|(d−1)(d−2ℓ+1) + e(G[B])(d−2ℓ) ≥ |A|(d−1)(d−2ℓ+1).
By averaging, ∃ a∈A with
t:=|V→B→{a}| ≥ (d−1)(d−2ℓ+1).

Matching step (fixes the “maximality” gap). In the bipartite graph H with left part L=V\{a} and right part R=N^-_B(a), let M be a maximum matching, R_M the matched right vertices, and L_M their left mates; set S:=R_M, Q:=L_M, s=|S|. Standard matching fact: there are no edges from unmatched left vertices L\L_M to unmatched right vertices R\R_M; hence every edge into R\S comes from Q. Consequently, the 2-edge paths V→(B\S)→{a} all start in Q.

Upper bounding t using S and Q:
- Paths via S: |V→S→{a}| ≤ ∑_{b∈S} deg^-(b) ≤ (2ℓ−1)s.
- Paths via B\S: each q∈Q has deg^+_{B\S}(q) ≤ d−1 (it has ≥1 edge to S, namely its matched edge), so |Q→(B\S)→{a}| ≤ s(d−1).
Thus t ≤ (2ℓ−1)s + s(d−1) = s(d+2ℓ−2).
Combining with t ≥ (d−1)(d−2ℓ+1) gives
s ≥ (d−1)(d−2ℓ+1)/(d+2ℓ−2).
In particular, if s≥ℓ then G contains S^-_{2,ℓ}.
Solving s≥ℓ yields
δ^+ > (3ℓ + √(17ℓ^2−16ℓ+4))/2.

Remarks.
- This strictly improves Theorem 4.3’s coefficient ((3+√17)/2)ℓ, with an O(1) additive savings (≈4/√17) on d.
- The matching lemma used above (neighbors of unmatched right vertices lie in the matched left set) is standard: otherwise there is an augmenting path, contradicting maximality.

# Obstacles
- The main bottleneck in Corollary B remains f(k,h) for S^-_{k,h}. Any polynomial-in-h bound (for fixed k) would sharply lower δ^+ thresholds.
- Our greedy per-depth construction incurs the exact term ⌈(ℓ^{i+1}−1)/(ℓ−1)⌉. A global selection (matching/nibble) across all ℓ^i leaves at depth i should improve T_{k,ℓ} to (1+o_ℓ(1))·ℓ^k, but needs a carefully controlled Hall/LLL argument.
- Similarly, one can likely lower h to (1+o(1))·kℓ^{k+1} by globally packing the S(w) rays.

# Next steps (auditable targets)
- Formalize the global matching at a fixed depth i using “leaf-clones” and a Hall deficit calculation to replace ⌈(ℓ^{i+1}−1)/(ℓ−1)⌉ by o(ℓ^{i+1}).
- Seek a polynomial bound for f(k,h) via expansion layers and pruning; even h^{O(k)} would substantially improve Corollary B.
- For k=2, combine the matching framework with a second-moment bound on |V→B→{a}| to try to replace d−1 by d in the numerator while keeping d−1 in the denominator, aiming at δ^+ ≥ ((3ℓ−1)+√(17ℓ^2−10ℓ+1))/2.

# Checks for the verifier
- Theorem A’s lexicographic proof and depth-greedy extension with thresholds t_i as above; confirm base case i=0 uses t_k=ℓ.
- Exact bound T_{k,2}=4·2^k−k−5; and for ℓ≥3, T_{k,ℓ} ≤ (ℓ^2/(ℓ−1)^2+o(1))·ℓ^k.
- Ray packing bound h ≥ kℓ^{k+1} + (ℓ^{k+1}−1)/(ℓ−1) + ℓ.
- Matching lemma and the inequality s ≥ (d−1)(d−2ℓ+1)/(d+2ℓ−2), with the quadratic threshold stated above.
