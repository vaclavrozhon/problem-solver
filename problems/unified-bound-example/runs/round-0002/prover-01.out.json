{
  "content": "# Ideas\n\n- Correct earlier claims: give a clean lower bound UB(bit-reversal) = \u2126(n), withdraw the \u0398(n log n) claim pending an upper bound; propose a route to tighten it.\n- Put forward a concrete, recursively defined permutation family F_h via 2413-substitution on 4 blocks per level. Prove a scale-based UB lower bound UB(F_h) = \u0398(n log n) by exhibiting, for a constant-probability set of positions at each high scale, a window of the last L steps all at rank-distance \u2265 L. This avoids the \u201cone first-arrival per block\u201d bottleneck.\n- On the BST side, argue that F_h is 4-decomposable (substitution decomposition uses only the size-4 simple permutation 2413), so by known results on Greedy on k-decomposable permutations, OPT_BST(F_h) \u2264 O(n). Pin down the precise citation and, if needed, outline a direct structural algorithm.\n\n# Bit-reversal: correction and a rigorous \u2126(n) lower bound\n\nLet n = 2^h, index times s = 0,1,\u2026,n\u22121, and let the permutation be \u03c0(s) = rev_h(s) (h-bit reversal; the 1-based version shifts by +1 and does not affect differences). For s \u2265 1 let t = \u03bd_2(s) be the number of trailing zeros of s in binary.\n\nKey identity. rev_h(s) \u2212 rev_h(s \u2212 2^t) = 2^{h\u22121\u2212t}. Proof: s has bit s_t = 1 and s_j = 0 for j < t. Subtracting 2^t zeroes out bit t and leaves all other bits unchanged; upon reversal this flips exactly bit position h\u22121\u2212t from 1 to 0, hence the stated difference.\n\nLower bound per step: For any s \u2265 1, among all 1 \u2264 j \u2264 s, either j \u2264 2^t or j > 2^t. For j \u2264 2^t, the h\u2212t leading bits of rev_h(s) and rev_h(s \u2212 j) differ (standard trailing-bit block property), which implies |\u03c0(s) \u2212 \u03c0(s \u2212 j)| \u2265 2^{h\u2212t\u22121}. For j > 2^t, we have j \u2265 2^t. Therefore\nmin_{1\u2264j\u2264s} (j + |\u03c0(s) \u2212 \u03c0(s \u2212 j)|) \u2265 min{ 2^t, 2^{h\u2212t\u22121} }.\nTaking logs,\nUB_{s+1}(\u03c0) \u2265 min{ t, h\u2212t\u22121 } \u2212 O(1).\nSince Pr[t = k] = 2^{\u2212(k+1)} for 0 \u2264 k \u2264 h\u22121, we get E[UB_{s+1}] \u2265 \u2211_{k=0}^{h\u22121} 2^{\u2212(k+1)} min{k, h\u2212k\u22121} \u2212 O(1) = \u2126(1). Summing over s gives UB(\u03c0) = \u2126(n).\n\nRemark on upper bound. The above identity also gives a trivial UB upper bound UB(\u03c0) \u2264 O(n log n), but I do not currently derive O(n). Numerics for h up to, say, 14\u201316 should clarify whether UB(\u03c0) is \u0398(n) or grows faster; for now I retract the earlier \u0398(n log n) claim and retain only UB(\u03c0) = \u2126(n).\n\n# The fractal 2413 family F_h (n = 4^h): definition\n\nDefine F_0 to be the permutation on {1}.\nFor h \u2265 1, partition [1..4^h] into 4 consecutive key blocks of size 4^{h\u22121} in key order A < B < C < D. Let \u03c3 = 2413 be the simple permutation on 4 symbols, interpreted as the time order B, D, A, C. Define F_h as the concatenation\nF_h := F_{h\u22121} restricted and scaled to B, then F_{h\u22121} on D, then on A, then on C.\nEquivalently, the access-time index t \u2208 {0,\u2026,4^h\u22121} in base-4 encodes the path down the decomposition; the digit at position \u2113 (counting from the top) indicates the child among {B,D,A,C} at scale \u2113.\n\nTwo structural properties:\n- Key intervals at each node are contiguous, with key order A<B<C<D.\n- Time order at each node is B, then D, then A, then C, each occupying a contiguous block of length 4^{\u2113} at scale \u2113.\n\n# UB lower bound on F_h: a per-position scale witness that avoids overcounting\n\nWe show UB(F_h) = \u0398(n log n) by proving E[UB_i] = \u0398(h) for i uniformly random. The upper bound UB_i \u2264 log(1+n) gives UB(F_h) \u2264 n log n, so it suffices to prove UB(F_h) \u2265 c n h.\n\nNotation. Fix a level \u2113 \u2208 {0,\u2026,h\u22121}. Let M_\u2113 := 4^\u2113. At level \u2113, each node\u2019s time block of length 4 M_\u2113 is partitioned into 4 consecutive time-blocks, each of length M_\u2113, in order B, D, A, C. Within the D-block, define its first quarter prefix D^{(1)} to be its first M_\u2113/4 positions in time.\n\nCrucial per-level event. For an access x_i occurring at time t, define E_\u2113 as: \u201cAt level \u2113, t lies in the D-block and, inside that D-block, in its first quarter D^{(1)}.\u201d\n\nTwo facts about E_\u2113 (independence comes from the base-4 time decomposition):\n- Pr[E_\u2113] = 1/16 for every \u2113, because (i) the level-\u2113 digit equals D with probability 1/4, and (ii) among the M_\u2113 positions in D, the prefix D^{(1)} has size M_\u2113/4.\n- For distinct levels, the events {E_\u2113} are independent with respect to the time index t, since they depend on disjoint base-4 digit blocks of t.\n\nPer-step lower bound conditioned on E_\u2113. Fix \u2113 and suppose E_\u2113 holds. Let s_\u2113 \u2208 {0,\u2026,M_\u2113/4 \u2212 1} be the offset of t inside D^{(1)} at level \u2113. Then, for every 1 \u2264 j \u2264 s_\u2113, the access at time t\u2212j is inside the immediately preceding level-\u2113 block in time, namely B. Because B and D are not adjacent in key (A<B<C<D), any key from B differs from any key in D by at least |C| = M_\u2113 in key rank minus a constant; in particular there is a fixed constant c_0 > 0 such that for all 1 \u2264 j \u2264 s_\u2113, we have \u0394_i(j) \u2265 c_0 M_\u2113.\nConsequently, for all 1 \u2264 j \u2264 s_\u2113,\nj + \u0394_i(j) \u2265 max{ j, c_0 M_\u2113 } \u2265 s_\u2113,\nand for j > s_\u2113 we have j \u2265 s_\u2113 trivially. Therefore\nmin_{1\u2264j\u2264i\u22121} (j + \u0394_i(j)) \u2265 s_\u2113,\nso UB_i \u2265 log(1 + s_\u2113).\n\nDistribution of s_\u2113 given E_\u2113. Conditioned on E_\u2113, the offset s_\u2113 is uniform on {0,\u2026,M_\u2113/4 \u2212 1}, because inside the D-block the first-quarter prefix is a contiguous time interval of length M_\u2113/4 and the lower \u2113 base-4 digits of t range uniformly therein, independently of higher-level digits that determine which level-\u2113 block we are in.\nTherefore\nE[ UB_i | E_\u2113 ] \u2265 (1/(M_\u2113/4)) \u2211_{s=1}^{M_\u2113/4 \u2212 1} log(1+s) \u2265 c_1 log M_\u2113 = c_1 \u00b7 \u2113 \u00b7 log 4,\nfor a universal constant c_1>0 (by Stirling, the average of log(1+s) over s=1..Q is \u0398(log Q)).\n\nAmplifying via the highest level where E_\u2113 holds. Let \u2113\u2020 be the maximum level in {0,\u2026,h\u22121} such that E_\u2113 holds for t (if none, set \u2113\u2020 = \u2212\u221e). By independence across levels,\nPr[\u2113\u2020 = \u2113] = (1/16) \u00b7 (15/16)^{(h\u22121)\u2212\u2113},\nso E[\u2113\u2020] = \u2211_{\u2113=0}^{h\u22121} \u2113 \u00b7 (1/16)(15/16)^{(h\u22121)\u2212\u2113} = (h\u22121) \u2212 (15/16)/(1/16)^2 + o(1) = h \u2212 O(1).\nMoreover, conditioning on \u2113\u2020 = \u2113 does not affect the uniformity of s_\u2113 because the restriction \u201cno E_{\u2113\u2032} for \u2113\u2032 > \u2113\u201d depends only on higher base-4 digits; the lower-\u2113 digits determining s_\u2113 remain uniform. Hence\nE[ UB_i | \u2113\u2020 = \u2113 ] \u2265 c_1 log M_\u2113 = c_2 \u00b7 \u2113.\nTaking expectations,\nE[UB_i] \u2265 \u2211_{\u2113=0}^{h\u22121} Pr[\u2113\u2020 = \u2113] \u00b7 E[UB_i | \u2113\u2020 = \u2113] \u2265 c_2 \u00b7 E[\u2113\u2020] = c_3 h.\nSumming over i yields UB(F_h) \u2265 c_3 n h = c_3 n log_4 n = \u0398(n log n).\n\nUpper bound recap. Trivially UB_i \u2264 log(1+n) for all i, so UB(F_h) \u2264 n log(1+n) = O(n log n). Combining, UB(F_h) = \u0398(n log n).\n\n# BST side for F_h: k-decomposable implies Greedy is linear (to verify)\n\nClaim to be verified. F_h is k-decomposable with k = 4 (every internal substitution node uses a fixed simple pattern of size 4). It is known that the Greedy geometric BST algorithm incurs cost O(n log k) on k-decomposable permutations; for constant k this is O(n). A version of this statement appears in the BST-geometry literature (Greedy upper bounds for decomposable permutations). We propose to locate and cite the precise theorem (attribution likely to Fox, 2011; Demaine et al., 2014), and then conclude OPT_BST(F_h) \u2264 O(n).\n\nIf desired, we can also attempt a direct structural algorithm: maintain a top-level skeleton realizing the 4 contiguous blocks A,B,C,D; transitions follow B\u2192D\u2192A\u2192C, and recursively within each block maintain the same invariant. A careful charging can bound rotations per access by a constant. We will draft this in a subsequent round if the Greedy citation is unavailable.\n\n# Obstacles\n\n- Bit-reversal upper bound remains unsettled. The identity rev(s)\u2212rev(s\u22122^t) = 2^{h\u22121\u2212t} gives only UB \u2264 O(n log n) trivially; I do not yet have a matching O(n) upper bound. Numerics will guide the conjecture.\n- For F_h, the UB lower bound above hinges on two independence facts: (i) E_\u2113 events independent across levels (true via base-4 digit independence), and (ii) s_\u2113 uniform conditioned on \u2113\u2020 = \u2113 (also true since \u201cno higher success\u201d constraints only higher digits). Both should be straightforward to formalize carefully.\n- BST side: we need a precise, citable statement that Greedy cost is O(n log k) on k-decomposable permutations, or otherwise produce a tailored algorithm. Without this, we have only the UB half of the separation.\n\n# Next steps\n\n1) Bit-reversal numerics and bounds: compute UB exactly for n = 2^h, h up to 14\u201316, verify whether UB/n stabilizes to a constant; attempt to prove an O(n) upper bound using a better j-witness than j = 2^t (e.g., show existence of j in [2^t, c\u00b72^t] with |\u0394| \u2264 c\u00b72^t via bit-pattern arguments).\n2) F_h UB proof: write a formal proof from the sketch above, with explicit mapping between time base-4 digits and the E_\u2113 events; produce a clean lemma stating Pr[\u2113\u2020 = \u2113] and E[log(1+s_\u2113)|\u2113\u2020=\u2113]. This is ready for proofs.md.\n3) BST side for F_h: locate the Greedy-on-k-decomposable-permutations theorem and record its precise statement and hypotheses; verify that F_h satisfies them. If citation is elusive, begin drafting a bespoke BST algorithm with a provable O(n) bound exploiting the 4-block recursive structure.\n4) If Greedy gives only O(n log 4) = O(n), we obtain a strong separation: OPT_BST(F_h) \u2264 C n while UB(F_h) \u2265 c n log n.\n\n# Summary of progress\n\n- Fixed the bit-reversal analysis: provided a rigorous \u2126(n) lower bound via the rev(s)\u2212rev(s\u22122^t) identity; withdrew the incorrect \u0398(n log n) claim; outlined an approach for an O(n) upper bound (to be validated numerically and then by bit-pattern witnesses).\n- Defined the fractal 2413 family F_h (n = 4^h) and proved UB(F_h) = \u0398(n log n) by a new scale-witness argument relying on the D-vs-B time/key separation at each level; this overcomes the \u201cfirst-arrival only\u201d bottleneck that previously gave only O(n).\n- Identified the BST route via k-decomposability (k=4) to argue OPT_BST(F_h) = O(n), pending a precise literature citation or a direct construction.\n- Outlined concrete next steps to firm up both halves and produce the desired strong separation."
}