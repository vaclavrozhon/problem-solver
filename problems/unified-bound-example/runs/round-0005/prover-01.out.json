{
  "content": "# Ideas\n\n- Give a complete, verifiable account of the recursively interleaved 2413-inflation family \u03c0_h (n=4^h).\n- Prove rigorously that Wilber\u20111 on a tailored static reference tree is \u0398(n), so Tango achieves O(n log log n) total cost.\n- Correct the unified-bound analysis: the boundary/LCA charging yields only \u0398(n) total; moreover, a general recurrence shows UB(\u03c0_h) = O(n). Thus the example does not realize large UB.\n- Provide a small concrete instance (n=16) to illustrate the alternation counts.\n- Suggest a general structural lemma: if a fixed decomposition has O(1) alternations per node, then UB = O(n).\n\n# Detailed definition of the 2413\u2011inflation family \u03c0_h (n = 4^h)\n\n- At the root, the key interval is [1..n]. Recursively, for any interval J of size 4^t, partition it into 4 equal contiguous subintervals A(J) < B(J) < C(J) < D(J), each of size 4^{t\u22121}.\n- Time order at each node is 2413: visit B(J), then D(J), then A(J), then C(J). Within each child interval recurse identically.\n- (Optional) Midpoint-first constraint: within any interval K, the first accessed key is the midpoint m(K). This is convenient for stating a clean boundary distance but not needed for the Wilber\u20111 analysis nor for the UB upper bound proved below.\n\nEquivalently, the sequence is a hierarchical concatenation: at every 4\u2011ary node the restricted subsequence is the concatenation of its children\u2019s subsequences in the fixed order B D A C.\n\n# Wilber\u20111 analysis: W_1(T_ref, \u03c0_h) = \u0398(n)\n\nReference tree T_ref.\nFor each 4\u2011ary node v with children A<B<C<D, insert the following three binary splits:\n- u_v: splits L := A\u222aB vs R := C\u222aD.\n- Left child of u_v: splits A vs B.\n- Right child of u_v: splits C vs D.\nRecurse inside A,B,C,D similarly. This produces a full BST on [n] with exactly 3 internal binary nodes per 4\u2011ary node. A full 4\u2011ary tree with n leaves has (n\u22121)/3 internal nodes, so T_ref has exactly n\u22121 internal nodes, as required.\n\nWilber\u20111 definition.\nFor a node w in T_ref, alt(w) is the number of alternations between left and right sides when scanning the access sequence restricted to keys in w\u2019s subtree. Then W_1(T_ref, \u03c0_h) = \u2211_w alt(w).\n\nLemma (constant alternations per 4\u2011ary node).\nFix a 4\u2011ary node v; its restricted sequence is B | D | A | C, each a contiguous time block.\n- At u_v (L vs R), the sequence of sides is L, R, L, R; so alt(u_v) = 3.\n- At the A vs B split (left child of u_v), the restricted sequence is B then A; alt = 1.\n- At the C vs D split (right child), it is D then C; alt = 1.\nNo further alternations arise at these nodes from deeper recursion, since each of B,D,A,C lies wholly on one side of each split.\n\nTherefore each 4\u2011ary node contributes 3+1+1 = 5 alternations. With (n\u22121)/3 4\u2011ary internal nodes,\nW_1(T_ref, \u03c0_h) = 5 \u00b7 (n\u22121)/3 = \u0398(n).\n\nCorollary (BST upper bound via Tango).\nTango trees achieve O(W_1(T_ref) \u00b7 log log n) = O(n log log n) total cost against a fixed reference tree. Thus OPT_BST(\u03c0_h) \u2264 O(n log log n).\n\n# Unified-bound analysis: boundary charging yields \u0398(n), and UB(\u03c0_h) = O(n)\n\nPer-boundary lower bound (correct but only \u0398(n) total).\nAt any 4\u2011ary node v with interval size s_v, consider the three child-boundary times in its restricted sequence (first time entering D after B, entering A after D, entering C after A). If midpoint-first is enforced, at each such boundary time i the accessed key is the midpoint of the new child. No earlier access is in that child, so any earlier key lies outside the child and is at rank distance \u2265 s_v/8 from x_i. Hence\nUB_i(\u03c0_h) \u2265 log(1 + s_v/8)\nfor those three boundary indices per v.\nThese indices across all 4\u2011ary nodes are disjoint and in bijection with the n\u22121 successive pairs (x_{i\u22121}, x_i), via the LCA in the 4\u2011ary decomposition. Summing over all v,\n\u2211_{i=1}^n UB_i(\u03c0_h) \u2265 \u2211_{v} 3 \u00b7 log(1 + s_v/8).\nLet nodes at level \u2113 have s_v = 4^{h\u2212\u2113}, with 4^\u2113 such nodes. Then\n\u2211_{v} log(1 + s_v/8) = \u2211_{\u2113=0}^{h\u22121} 4^\u2113 \u00b7 \u0398(1 + h\u2212\u2113) = 4^h \u00b7 \u2211_{t=1}^{h} t/4^t = \u0398(4^h) = \u0398(n),\nusing \u2211_{t\u22651} t x^t = x/(1\u2212x)^2 with x=1/4, giving \u2211_{t\u22651} t/4^t = 4/9.\nThus the boundary-only lower bound totals \u0398(n).\n\nGeneral O(n) upper bound on UB for hierarchical concatenations.\nDefine S(\u03c0) := \u2211_{i=2}^{n} log(2 + |x_i \u2212 x_{i\u22121}|). For any permutation, UB_i \u2264 log(2 + |x_i \u2212 x_{i\u22121}|), hence UB(\u03c0) \u2264 S(\u03c0).\nWe prove S(\u03c0_h) = O(n) by a recurrence over the 4\u2011ary decomposition. For a node v with interval I_v (|I_v| = m) and children v_1,\u2026,v_4 in time order B,D,A,C,\nS(\u03c0(v)) = \u2211_{k=1}^{4} S(\u03c0(v_k)) + \u2211_{p=1}^{3} log(2 + |last(v_p) \u2212 first(v_{p+1})|),\nwhere last(\u00b7), first(\u00b7) are the last and first keys of each child block in the time subsequence \u03c0(v). The two keys in each boundary term lie in adjacent child intervals of I_v, so their rank distance is at most m; thus each boundary contributes \u2264 log(2 + m), and there are 3 of them. Therefore\nS(\u03c0(v)) \u2264 \u2211_{k=1}^{4} S(\u03c0(v_k)) + 3 \u00b7 log(2 + m).\nAt leaves (singletons), S = 0. Summing this inequality over all nodes and telescoping down to leaves yields\nS(\u03c0_h) \u2264 \u2211_{v internal} 3 \u00b7 log(2 + |I_v|).\nTo bound the last sum, bucket internal nodes by size classes \ud835\udc9e_k := { v : 2^k \u2264 |I_v| < 2^{k+1} }. Intervals in each class are disjoint, so |\ud835\udc9e_k| \u2264 n/2^k. Hence\n\u2211_{v internal} log(2 + |I_v|) \u2264 \u2211_{k=0}^{\u230alog_2 n\u230b} |\ud835\udc9e_k| \u00b7 O(k+1) \u2264 \u2211_{k=0}^{\u230alog_2 n\u230b} (n/2^k) \u00b7 O(k+1) = O(n).\nThus S(\u03c0_h) = O(n), and therefore UB(\u03c0_h) \u2264 S(\u03c0_h) = O(n).\n\nConclusion (UB for \u03c0_h).\nUB(\u03c0_h) = \u0398(n): the boundary charging gives a matching \u2126(n) lower bound, and the general recurrence gives an O(n) upper bound.\n\n# Concrete small example (n = 16, h = 2)\n\nTop-level blocks of 4 keys: A=1..4, B=5..8, C=9..12, D=13..16. Time order BDAC. Within each block, apply BDAC on its four singletons. One valid \u03c0_2 is\n[6,8,5,7, 14,16,13,15, 2,4,1,3, 10,12,9,11].\n- At the top split (A\u222aB) vs (C\u222aD), the side pattern is L (B), R (D), L (A), R (C): 3 alternations.\n- At A vs B: the restricted sequence is B then A: 1 alternation. At C vs D: D then C: 1 alternation.\n- Deeper nodes behave identically inside each 4\u2011block. Summing gives W_1 = 5 \u00b7 (n\u22121)/3 = 25 for n=16.\n- For UB, the three top-level boundaries contribute roughly log(1+16/8) \u2248 log 3 each; boundaries inside the 4\u2011blocks contribute log(1+4/8) = O(1). Total UB is \u0398(n) across all levels.\n\n# Structural takeaway and next steps\n\n- The Wilber\u20111 analysis certifies small BST cost (up to log log n): W_1 = \u0398(n), Tango cost O(n log log n).\n- The unified-bound for this family is only \u0398(n), not \u0398(n log n). The mistake in output.md was mis-summing \u2211_{\u2113} 4^\u2113 (h\u2212\u2113); it equals \u0398(n), not \u0398(n log n).\n- Generalization: if a fixed decomposition tree has O(1) alternations per node (i.e., the sequence is a concatenation of O(1) runs of child-subsequences at each node), then the same recurrence shows UB = O(n). This suggests a tension: W_1 = O(n) via a fixed T_ref often entails UB = O(n), ruling out a strong separation within such hierarchical classes.\n\nNext steps.\n- Formalize the general \u201cO(1) alternations per node \u21d2 UB = O(n)\u201d lemma for arbitrary fixed binary trees T_ref (not only 4\u2011ary expansions), to either (i) prove a limitation theorem, or (ii) guide the design of families that escape the hypothesis.\n- Explore families with UB = \u2126(n log n) while maintaining W_1 = O(n), if possible, by allowing a bounded number of alternations per node that grows mildly with depth but sums to O(n) overall, and verifying whether the UB recurrence still forces O(n) or not.\n- Provide a clean UB = \u0398(n) proof for DFS traversals as a baseline (same recurrence applies), and compute UB numerically for other candidates to calibrate constants."
}